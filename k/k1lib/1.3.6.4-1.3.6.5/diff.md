# Comparing `tmp/k1lib-1.3.6.4-py3-none-any.whl.zip` & `tmp/k1lib-1.3.6.5-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,16 +1,16 @@
-Zip file size: 2529794 bytes, number of entries: 83
+Zip file size: 2530376 bytes, number of entries: 83
 -rw-rw-r--  2.0 unx     1435 b- defN 23-Feb-08 00:13 k1lib/__init__.py
 -rw-rw-r--  2.0 unx    53793 b- defN 23-Apr-02 08:25 k1lib/_baseClasses.py
 -rw-rw-r--  2.0 unx    13494 b- defN 23-May-05 13:41 k1lib/_basics.py
--rw-rw-r--  2.0 unx     4234 b- defN 22-Dec-23 14:19 k1lib/_context.py
+-rw-rw-r--  2.0 unx     4908 b- defN 23-May-08 18:53 k1lib/_context.py
 -rw-rw-r--  2.0 unx     2866 b- defN 22-Jul-20 04:30 k1lib/_higher.py
 -rw-rw-r--  2.0 unx      948 b- defN 22-Sep-21 23:54 k1lib/_k1a.py
 -rw-rw-r--  2.0 unx    11646 b- defN 23-Jan-14 15:37 k1lib/_learner.py
--rw-rw-r--  2.0 unx    19050 b- defN 23-Apr-17 06:59 k1lib/_monkey.py
+-rw-rw-r--  2.0 unx    19722 b- defN 23-May-08 18:56 k1lib/_monkey.py
 -rw-rw-r--  2.0 unx     3571 b- defN 21-Nov-04 18:35 k1lib/_perlin.py
 -rw-rw-r--  2.0 unx    13377 b- defN 21-Dec-29 02:58 k1lib/eqn.py
 -rw-rw-r--  2.0 unx     6317 b- defN 23-May-07 04:31 k1lib/fmt.py
 -rw-rw-r--  2.0 unx     6398 b- defN 22-Sep-29 08:23 k1lib/graphEqn.py
 -rw-rw-r--  2.0 unx     2650 b- defN 23-May-05 19:38 k1lib/imports.py
 -rw-rw-r--  2.0 unx     3107 b- defN 22-Oct-26 20:43 k1lib/knn.py
 -rw-rw-r--  2.0 unx     3564 b- defN 23-Jan-25 02:48 k1lib/p5.py
@@ -50,36 +50,36 @@
 -rw-rw-r--  2.0 unx     8308 b- defN 22-Nov-27 07:16 k1lib/cli/bio.py
 -rw-rw-r--  2.0 unx     4033 b- defN 23-Jan-25 02:02 k1lib/cli/cif.py
 -rw-rw-r--  2.0 unx    18911 b- defN 23-May-05 13:24 k1lib/cli/conv.py
 -rw-rw-r--  2.0 unx    24096 b- defN 23-Apr-29 07:15 k1lib/cli/filt.py
 -rw-rw-r--  2.0 unx     6672 b- defN 23-Jan-25 02:02 k1lib/cli/gb.py
 -rw-rw-r--  2.0 unx     6348 b- defN 23-Apr-05 15:10 k1lib/cli/grep.py
 -rw-rw-r--  2.0 unx    18312 b- defN 23-May-02 14:44 k1lib/cli/init.py
--rw-rw-r--  2.0 unx    21646 b- defN 23-May-04 03:16 k1lib/cli/inp.py
+-rw-rw-r--  2.0 unx    21754 b- defN 23-May-08 19:00 k1lib/cli/inp.py
 -rw-rw-r--  2.0 unx      623 b- defN 22-Jun-22 10:43 k1lib/cli/kcsv.py
 -rw-rw-r--  2.0 unx     4819 b- defN 22-Aug-11 20:44 k1lib/cli/kxml.py
 -rw-rw-r--  2.0 unx     1915 b- defN 21-Nov-12 16:48 k1lib/cli/mgi.py
--rw-rw-r--  2.0 unx    48243 b- defN 23-May-05 13:57 k1lib/cli/modifier.py
+-rw-rw-r--  2.0 unx    48729 b- defN 23-May-08 08:55 k1lib/cli/modifier.py
 -rw-rw-r--  2.0 unx      694 b- defN 22-Nov-27 07:17 k1lib/cli/mol.py
 -rw-rw-r--  2.0 unx     3551 b- defN 23-Feb-02 17:12 k1lib/cli/nb.py
 -rw-rw-r--  2.0 unx     3530 b- defN 22-Aug-16 15:08 k1lib/cli/optimizations.py
 -rw-rw-r--  2.0 unx    11559 b- defN 23-Apr-25 00:01 k1lib/cli/output.py
 -rw-rw-r--  2.0 unx     2394 b- defN 23-Jan-25 02:03 k1lib/cli/sam.py
--rw-rw-r--  2.0 unx    49588 b- defN 23-May-02 16:53 k1lib/cli/structural.py
+-rw-rw-r--  2.0 unx    49581 b- defN 23-May-07 08:06 k1lib/cli/structural.py
 -rw-rw-r--  2.0 unx    10399 b- defN 22-Aug-05 01:15 k1lib/cli/trace.py
 -rw-rw-r--  2.0 unx    23319 b- defN 22-Sep-29 07:14 k1lib/cli/typehint.py
 -rw-rw-r--  2.0 unx    20345 b- defN 23-Apr-26 17:09 k1lib/cli/utils.py
 -rw-rw-r--  2.0 unx       20 b- defN 23-Jan-19 22:00 k1lib/k1ui/__init__.py
 -rw-rw-r--  2.0 unx    61803 b- defN 23-Feb-10 12:10 k1lib/k1ui/main.py
 -rw-rw-r--  2.0 unx       20 b- defN 22-Sep-16 01:12 k1lib/serve/__init__.py
 -rw-rw-r--  2.0 unx    10361 b- defN 23-May-05 16:49 k1lib/serve/main.py
 -rw-rw-r--  2.0 unx      153 b- defN 23-May-05 16:00 k1lib/serve/suffix-dash.py
 -rw-rw-r--  2.0 unx      642 b- defN 23-Feb-13 19:00 k1lib/serve/suffix.py
--rw-rw-r--  2.0 unx  2453826 b- defN 23-Jan-19 22:50 k1lib-1.3.6.4.data/data/k1lib/k1ui/256.model.state_dict.pth
--rw-rw-r--  2.0 unx   304735 b- defN 23-Jan-17 19:16 k1lib-1.3.6.4.data/data/k1lib/k1ui/mouseKey.pth
--rw-rw-r--  2.0 unx    20544 b- defN 23-Mar-19 11:14 k1lib-1.3.6.4.data/data/k1lib/serve/main.html
--rw-rw-r--  2.0 unx     1049 b- defN 23-May-07 04:31 k1lib-1.3.6.4.dist-info/LICENSE
--rw-rw-r--  2.0 unx     3864 b- defN 23-May-07 04:31 k1lib-1.3.6.4.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-May-07 04:31 k1lib-1.3.6.4.dist-info/WHEEL
--rw-rw-r--  2.0 unx        6 b- defN 23-May-07 04:31 k1lib-1.3.6.4.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     6625 b- defN 23-May-07 04:31 k1lib-1.3.6.4.dist-info/RECORD
-83 files, 3474035 bytes uncompressed, 2519572 bytes compressed:  27.5%
+-rw-rw-r--  2.0 unx  2453826 b- defN 23-Jan-19 22:50 k1lib-1.3.6.5.data/data/k1lib/k1ui/256.model.state_dict.pth
+-rw-rw-r--  2.0 unx   304735 b- defN 23-Jan-17 19:16 k1lib-1.3.6.5.data/data/k1lib/k1ui/mouseKey.pth
+-rw-rw-r--  2.0 unx    20544 b- defN 23-Mar-19 11:14 k1lib-1.3.6.5.data/data/k1lib/serve/main.html
+-rw-rw-r--  2.0 unx     1049 b- defN 23-May-08 19:00 k1lib-1.3.6.5.dist-info/LICENSE
+-rw-rw-r--  2.0 unx     3864 b- defN 23-May-08 19:00 k1lib-1.3.6.5.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-May-08 19:00 k1lib-1.3.6.5.dist-info/WHEEL
+-rw-rw-r--  2.0 unx        6 b- defN 23-May-08 19:00 k1lib-1.3.6.5.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     6625 b- defN 23-May-08 19:00 k1lib-1.3.6.5.dist-info/RECORD
+83 files, 3475968 bytes uncompressed, 2520154 bytes compressed:  27.5%
```

## zipnote {}

```diff
@@ -219,32 +219,32 @@
 
 Filename: k1lib/serve/suffix-dash.py
 Comment: 
 
 Filename: k1lib/serve/suffix.py
 Comment: 
 
-Filename: k1lib-1.3.6.4.data/data/k1lib/k1ui/256.model.state_dict.pth
+Filename: k1lib-1.3.6.5.data/data/k1lib/k1ui/256.model.state_dict.pth
 Comment: 
 
-Filename: k1lib-1.3.6.4.data/data/k1lib/k1ui/mouseKey.pth
+Filename: k1lib-1.3.6.5.data/data/k1lib/k1ui/mouseKey.pth
 Comment: 
 
-Filename: k1lib-1.3.6.4.data/data/k1lib/serve/main.html
+Filename: k1lib-1.3.6.5.data/data/k1lib/serve/main.html
 Comment: 
 
-Filename: k1lib-1.3.6.4.dist-info/LICENSE
+Filename: k1lib-1.3.6.5.dist-info/LICENSE
 Comment: 
 
-Filename: k1lib-1.3.6.4.dist-info/METADATA
+Filename: k1lib-1.3.6.5.dist-info/METADATA
 Comment: 
 
-Filename: k1lib-1.3.6.4.dist-info/WHEEL
+Filename: k1lib-1.3.6.5.dist-info/WHEEL
 Comment: 
 
-Filename: k1lib-1.3.6.4.dist-info/top_level.txt
+Filename: k1lib-1.3.6.5.dist-info/top_level.txt
 Comment: 
 
-Filename: k1lib-1.3.6.4.dist-info/RECORD
+Filename: k1lib-1.3.6.5.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## k1lib/_context.py

```diff
@@ -1,14 +1,16 @@
 # AUTOGENERATED FILE! PLEASE DON'T EDIT
 import io, sys, warnings, time, k1lib, os
 from contextlib import contextmanager
 from functools import partial
 try: import rdkit; hasRdkit = True
 except: hasRdkit = False
-__all__ = ["captureStdout", "ignoreWarnings", "timer", "attrContext"]
+try: import matplotlib.pyplot as plt
+except: pass
+__all__ = ["captureStdout", "capturePlt", "ignoreWarnings", "timer", "attrContext"]
 @contextmanager
 def captureStdout(out=True, c=False) -> k1lib.Wrapper:
     """Captures every print() statement. Taken from https://stackoverflow.com/questions/16571150/how-to-capture-stdout-output-from-a-python-function-call.
 Example::
 
     with k1lib.captureStdout() as outer:
         print("something")
@@ -49,27 +51,48 @@
 
 :param out: if True, captures stdout, else captures stderr
 :param c: whether to capture at the C/C++ level or not"""
     if c is True:
         import wurlitzer; w = k1lib.Wrapper("")
         try:
             with wurlitzer.pipes() as (_out, _err): yield w
+        except BrokenPipeError: pass
         finally: w.value = _out.read().split("\n") if out else _err.read().split("\n")
     else:
         if out: _stdout = sys.stdout; sys.stdout = _stringio = io.StringIO()
         else:   _stdout = sys.stderr; sys.stderr = _stringio = io.StringIO()
         w = k1lib.Wrapper([])
         w.print = partial(print, file=_stdout)
         w.old = _stdout
         try: yield w
         finally:
             w.value = [l.split("\r")[-1] for l in _stringio.getvalue().split("\n")]
             if out: sys.stdout = _stdout
             else:   sys.stderr = _stdout
 @contextmanager
+def capturePlt():
+    """Tries to capture matplotlib plot.
+Example::
+
+    x = np.linspace(-2, 2)
+    with k1.capturePlt() as fig:
+        plt.plot(x, x**2)
+        plt.show()
+
+    capturedImage = fig() # reference it here
+
+This is a convenience function to deal with libraries that call ``plt.show()``
+and doesn't let us intercept at the middle to generate an image."""
+    try:
+        ans = k1lib.Wrapper(None)
+        with k1lib._settings.monkey.context(capturePlt=True):
+            yield ans
+        ans.value = plt._k1_capturedImg()
+    finally: pass
+@contextmanager
 def ignoreWarnings():
     """Context manager to ignore every warning.
 Example::
 
     import warnings
     with k1lib.ignoreWarnings():
         warnings.warn("some random stuff") # will not show anything"""
```

## k1lib/_monkey.py

```diff
@@ -3,19 +3,23 @@
 from k1lib import cli
 from typing import List, Tuple, ContextManager
 from contextlib import contextmanager
 try: import torch; from torch import nn; hasTorch = True
 except: hasTorch = False
 try: import matplotlib.animation
 except: pass
+try: import matplotlib.pyplot as plt
+except: pass
 __all__ = ["dummy"]
 def dummy():
     """Does nothing. Only here so that you can read source code of this file and
 see whatâ€™s up."""
     pass
+settings = k1lib.settings.add("monkey", k1lib.Settings(), "monkey-patched settings").monkey
+k1lib._settings.add("monkey", k1lib.Settings(), "monkey-patched settings")
 if hasTorch:
     @k1lib.patch(nn.Module)
     def importParams(self:nn.Module, params:List[nn.Parameter]):
         """Given a list of :class:`torch.nn.parameter.Parameter`/:class:`torch.Tensor`,
 update the current :class:`torch.nn.Module`'s parameters with it'"""
         for oldParam, newParam in zip(self.parameters(), params):
             oldParam.data = newParam.data.clone()
@@ -385,14 +389,23 @@
 
 Internally, this just calls ``plt.gcf()`` and that's it, pretty simple.
 But I usually plot things as a part of the cli pipeline, and it's very
 annoying that I can't quite chain ``plt.gcf()`` operation, so I created
 this"""
         def inner(_): return plt.gcf()
         return cli.aS(inner)
+    k1lib._settings.monkey.add("capturePlt", False, "whether to intercept matplotlib's show() and turn it into an image or not")
+    _oldShow = plt.show; _recentImg = [None]
+    @k1lib.patch(plt)
+    def show(*args, **kwargs):
+        try:
+            if k1lib._settings.monkey.capturePlt: _recentImg[0] = plt.gcf() | k1lib.cli.toImg()
+        except: return _oldShow(*args, **kwargs)
+    @k1lib.patch(plt)
+    def _k1_capturedImg(): return _recentImg[0]
 except: pass
 try:
     @k1lib.patch(Axes3D)
     def plane(self, origin, v1, v2=None, s1:float=1, s2:float=1, **kwargs):
         """Plots a 3d plane.
 
 :param origin: origin vector, shape (3,)
```

## k1lib/cli/inp.py

```diff
@@ -8,30 +8,32 @@
 except: hasMinio = False
 __all__ = ["cat", "splitSeek", "curl", "wget", "ls", "cmd", "walk", "requireCli"]
 settings = k1lib.settings.cli
 catSettings = k1lib.Settings().add("chunkSize", 100000, "file reading chunk size for binary+chunk mode. Decrease it to avoid wasting memory and increase it to avoid disk latency")
 catSettings.add("every", k1lib.Settings().add("text", 1000, "for text mode, will print every n lines").add("binary", 10, "for binary mode, will print every n 100000-byte blocks"), "profiler print frequency")
 settings.add("cat", catSettings, "inp.cat() settings")
 def _catGenText(fn, sB, eB): # fn for "file name"
-    if sB == 0 and eB == -1: # fast path without bounds (90-160 MB/s expected)
-        with open(fn) as f:
-            while True:
-                line = f.readline()
-                if line == "": return
-                yield line[:-1] if line[-1] == "\n" else line
-    else: # slow path with bounds (15 MB/s expected)
-        sB = wrap(fn, sB); eB = wrap(fn, eB)
-        with open(fn) as f:
-            f.seek(sB); b = sB # current byte
-            while True:
-                line = f.readline()
-                if line == "": return
-                if f.tell() > eB: yield line[:len(line)-(f.tell()-eB)]; return
-                if line[-1] == "\n": yield line[:-1]
-                else: yield line
+    try:
+        if sB == 0 and eB == -1: # fast path without bounds (90-160 MB/s expected)
+            with open(fn) as f:
+                while True:
+                    line = f.readline()
+                    if line == "": return
+                    yield line[:-1] if line[-1] == "\n" else line
+        else: # slow path with bounds (15 MB/s expected)
+            sB = wrap(fn, sB); eB = wrap(fn, eB)
+            with open(fn) as f:
+                f.seek(sB); b = sB # current byte
+                while True:
+                    line = f.readline()
+                    if line == "": return
+                    if f.tell() > eB: yield line[:len(line)-(f.tell()-eB)]; return
+                    if line[-1] == "\n": yield line[:-1]
+                    else: yield line
+    except FileNotFoundError: pass
 def _catGenBin(fn, sB, eB):
     chunkSize = settings.cat.chunkSize; sB = wrap(fn, sB); eB = wrap(fn, eB); nB = eB - sB # number of bytes to read total
     with open(fn, "rb") as f:
         f.seek(sB); nChunks = math.ceil(nB / chunkSize); lastChunkSize = nB - chunkSize*(nChunks-1)
         yield from range(nChunks) | cli.applyTh(lambda i: f.read(chunkSize) if i < nChunks-1 else f.read(chunkSize)[:lastChunkSize], prefetch=10)
 def fileLength(fn):
     with open(fn, 'rb') as f: return f.seek(0, os.SEEK_END)
```

## k1lib/cli/modifier.py

```diff
@@ -272,22 +272,22 @@
                         fs.append(self.p.apply_async(executeFunc, [common, dill.dumps(line)]))
                     for line in it:
                         yield fs.popleft().get(timeout)
                         fs.append(self.p.apply_async(executeFunc, [common, dill.dumps(line)]))
                     for f in fs: yield f.get(timeout)
                 except KeyboardInterrupt as e:
                     print("applyMp interrupted. Terminating pool now")
-                    for p in self.ps: p.terminate();
+                    for p in self.ps: p.close(); p.terminate();
                     raise e
                 except Exception as e:
                     print("applyMp encounter errors. Terminating pool now")
-                    for p in self.ps: p.terminate();
+                    for p in self.ps: p.close(); p.terminate();
                     raise e
                 else:
-                    for p in self.ps: p.terminate();
+                    for p in self.ps: p.close(); p.terminate();
         return gen(it)
     def _copy(self): return applyMp(self.f, self.prefetch, self.timeout, self.utilization, self.bs, self.newPoolEvery, **self.kwargs)
     def __invert__(self):
         """Expands the arguments out, just like :class:`apply`.
 Example::
 
     # returns [20, 20, 18, 14, 8, 0, -10, -22, -36, -52]
@@ -397,32 +397,33 @@
 
 :param prefetch: if not specified, schedules all jobs at the same time. If
     specified, schedules jobs so that there'll only be a specified amount of
     jobs, and will only schedule more if results are actually being used.
 :param timeout: seconds to wait for job before raising an error
 :param bs: if specified, groups ``bs`` number of transforms into 1 job to be more
     efficient.
-:param rss: resources required for the task. Can be {"CPU": 2} or "CPU" as a shortcut
+:param rss: resources required for the task. Can be {"custom_resource1": 2} or "custom_resource1" as a shortcut
 :param pre: "preserve", same convention as :meth:`applyCl.aS`. If True, then allow passing
     through node ids as the first column to shedule jobs on those specific nodes only
 :param orPatch: whether to automatically patch __or__ function so that cli tools can
     work with numpy arrays on that remote worker
 :param num_cpus: how many cpu does each task take?
 :param kwargs: extra arguments to be passed to the function. ``args`` not
     included as there're a couple of options you can pass for this cli."""
-        super().__init__(fs=[f]); _fC = fastF(f); self.pre = pre
-        if isinstance(rss, str): rss = {rss: 1}
-        def ogF(e):
+        super().__init__(fs=[f]); _fC = fastF(f); self.ogF = f; self.pre = pre
+        self.rss = rss = {rss: 1} if isinstance(rss, str) else rss
+        def remoteF(e):
             if orPatch:
                 import k1lib; k1lib.cli.init.patchNumpy()
                 k1lib.cli.init.patchDict(); k1lib.cli.init.patchPandas()
             return _fC(e, **kwargs)
-        self.ogF = ogF; self.f = ray.remote(resources=rss, num_cpus=num_cpus)(ogF)
+        self.remoteF = remoteF; self.f = ray.remote(resources=rss, num_cpus=num_cpus)(remoteF)
         self.prefetch = prefetch or int(1e9)
         self.timeout = timeout; self.bs = bs
+        self._copyCtx = lambda: [f, [prefetch, timeout, bs, rss, pre, orPatch, num_cpus], kwargs]
         def preprocessF(f, e): # return future (if pre=False), or [nodeId, future] (if pre=True)
             if pre: nodeId, e = e; return [nodeId, specificNode(f, nodeId).remote(e)]
             else: return f.remote(e)
         def resolveF(e):
             if pre: return [e[0], ray.get(e[1], timeout=timeout)]
             else: return ray.get(e, timeout=timeout)
         self.preprocessF = preprocessF; self.resolveF = resolveF
@@ -431,14 +432,21 @@
         if bs > 1: return it | cli.batched(bs, True) | applyCl(lambda x: x | apply(ogF) | cli.aS(list), self.prefetch, timeout) | cli.joinStreams()
         def gen(it):
             futures = deque(); it = iter(it)
             for i, e in zip(range(self.prefetch), it): futures.append(preprocessF(f, e))
             for e in it: yield resolveF(futures.popleft()); futures.append(preprocessF(f, e))
             for e in futures: yield resolveF(e)
         return gen(it)
+    def __invert__(self):
+        """Expands the arguments out, just like :class:`apply`.
+Example::
+
+    # returns [20, 20, 18, 14, 8, 0, -10, -22, -36, -52]
+    [range(10), range(20, 30)] | transpose() | ~applyCl(lambda x, y: y-x**2) | deref()"""
+        f, rest, kwargs = self._copyCtx(); return applyCl(lambda x: f(*x), *rest, **kwargs)
     @staticmethod
     def nodeIds(includeSelf=True) -> List[str]:
         """Returns a list of all node ids in the current cluster.
 Example::
 
     applyCl.nodeIds() # returns something like ['7bb387b2920694abe9f7d2a2ed939b6d31843faf91d174d0221e871d', '1051dafd2b0dac13561c46fe052f561400592f0723df2cd746a41068']
 
@@ -547,15 +555,15 @@
         with open(fn, 'a') as f: f.truncate(ranges[0][1])
     @staticmethod
     def cat(fn:str, f:Callable, timeout:float=30, keepNodeIds:bool=False, multiplier:int=1, includeId:bool=False):
         """Reads a file distributedly, does some operation on them, collects and
 returns all of the data together. Example::
 
     fn = "~/repos/labs/k1lib/k1lib/cli/test/applyCl.cat.data"
-    ("0123456789"*5 + "\n") * 1000 | file(fn)
+    ("0123456789"*5 + "\\n") * 1000 | file(fn)
     applyCl.splitFile(fn)
     applyCl.cat(fn, shape(0), keepNodeIds=True) | deref()
 
 That returns something like this (for a 2-node cluster, with 2 (node A) and 4 (node B) cpus respectively)::
 
     [['7bb387b2920694abe9f7d2a2ed939b6d31843faf91d174d0221e871d', 167],
      ['7bb387b2920694abe9f7d2a2ed939b6d31843faf91d174d0221e871d', 167],
@@ -572,20 +580,18 @@
 are collected together and returned.
 
 If you want to distinguish between different processes inside f, for example you
 want to write results into different files, you can do something like this::
 
     dir_ = "~/repos/labs/k1lib/k1lib/cli/test"
     fn = f"{dir_}/applyCl.cat.data"
-    # clear out old folders
-    None | applyCl.aS(lambda: None | cmd(f"rm -r {dir_}/applyCl")) | deref()
-    # creating folders
-    None | applyCl.aS(lambda: None | cmd(f"mkdir -p {dir_}/applyCl")) | deref()
+    applyCl.cmd(f"rm -r {dir_}/applyCl")    # clear out old folders
+    applyCl.cmd(f"mkdir -p {dir_}/applyCl") # creating folders
     # do processing on fn distributedly, then dump results into multiple files
-    applyCl.cat(fn, ~aS(lambda idx, lines: lines | shape(0) | aS(dill.dumps) | file(f"{dir_}/applyCl/{idx}.pth"))) | deref()
+    applyCl.cat(fn, ~aS(lambda idx, lines: lines | shape(0) | aS(dill.dumps) | file(f"{dir_}/applyCl/{idx}.pth")), includeId=True) | deref()
     # reading all files and summing them together
     None | applyCl.aS(lambda: ls(f"{dir_}/applyCl")) | ungroup(single=True, begin=True) | applyCl(cat(text=False) | aS(dill.loads), pre=True) | cut(1) | toSum()
 
 :param fn: file name
 :param f: function to execute in every process
 :param timeout: kills the processes if it takes longer than this amount of seconds
 :param keepNodeIds: whether to keep the node id column or not
```

## k1lib/cli/structural.py

```diff
@@ -145,32 +145,32 @@
         if self.dims[0] == -1:
             try:
                 while True: yield _formStructure(it, self.dims, 1)
             except StopIteration: pass
         else:
             for i in range(self.dims[0]): yield _formStructure(it, self.dims, 1)
 class insert(BaseCli):
-    def __init__(self, elements, begin=True):
+    def __init__(self, element, begin=True):
         """Join element into list.
 Example::
 
     # returns [5, 2, 6, 8]
     [2, 6, 8] | insert(5) | deref()
     # returns [2, 6, 8, 5]
     [2, 6, 8] | insert(5, begin=False) | deref()
 
     # returns [[3, 1], 2, 6, 8]
     [2, 6, 8] | insert([3, 1]) | deref()
 
 :param element: the element to insert"""
-        super().__init__(); self.elements = elements; self.begin = begin; self.expand = False
+        super().__init__(); self.element = element; self.begin = begin; self.expand = False
     def __ror__(self, it:Tuple[T, Iterator[T]]) -> Iterator[T]:
-        elements = self.elements; it = iter(it)
-        if self.begin: yield elements; yield from it
-        else: yield from it; yield elements
+        element = self.element; it = iter(it)
+        if self.begin: yield element; yield from it
+        else: yield from it; yield element
 class splitW(BaseCli):
     def __init__(self, *weights:List[float]):
         """Splits elements into multiple weighted lists. If no weights are provided,
 then automatically defaults to [0.8, 0.2]. Example::
 
     # returns [[0, 1, 2, 3, 4, 5, 6, 7], [8, 9]]
     range(10) | splitW(0.8, 0.2) | deref()
```

## Comparing `k1lib-1.3.6.4.data/data/k1lib/k1ui/256.model.state_dict.pth` & `k1lib-1.3.6.5.data/data/k1lib/k1ui/256.model.state_dict.pth`

 * *Files identical despite different names*

## Comparing `k1lib-1.3.6.4.data/data/k1lib/k1ui/mouseKey.pth` & `k1lib-1.3.6.5.data/data/k1lib/k1ui/mouseKey.pth`

 * *Files identical despite different names*

## Comparing `k1lib-1.3.6.4.data/data/k1lib/serve/main.html` & `k1lib-1.3.6.5.data/data/k1lib/serve/main.html`

 * *Files identical despite different names*

## Comparing `k1lib-1.3.6.4.dist-info/LICENSE` & `k1lib-1.3.6.5.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `k1lib-1.3.6.4.dist-info/METADATA` & `k1lib-1.3.6.5.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: k1lib
-Version: 1.3.6.4
+Version: 1.3.6.5
 Summary: Some nice ML overhaul
 Home-page: https://k1lib.com
 Author: Quang Ho
 Author-email: 157239q@gmail.com
 License: MIT
 Requires-Python: >=3.7
 Description-Content-Type: text/markdown
```

## Comparing `k1lib-1.3.6.4.dist-info/RECORD` & `k1lib-1.3.6.5.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,15 +1,15 @@
 k1lib/__init__.py,sha256=zdjKwxgRuNNLKhHen5zaW-zmo6DmOlGBR9frAQI0jh0,1435
 k1lib/_baseClasses.py,sha256=0uR1wDKqLHP2FJmMqb8ao3M-gGMHzyJ85UzUxtpUqGI,53793
 k1lib/_basics.py,sha256=f9Hn4UTRfhbzKotZ9eRMmb4Ic8A4_1ORP0qWnInkLu8,13494
-k1lib/_context.py,sha256=8GnsFmpVcksToG4jhD3TXfufc0U6633hR7DMoLpLpH4,4234
+k1lib/_context.py,sha256=wZB8OhBZiJNgfk-CA9tVWmhyC38J-6vVXSn1vEIkCtE,4908
 k1lib/_higher.py,sha256=BZ54rlMNygGrKBZjLpakicQ_FDSt936X5sgfJnvns2Y,2866
 k1lib/_k1a.py,sha256=i-_CPMBdiE-CCI375eaguwcC01dGHar4SlaaQDFsRwg,948
 k1lib/_learner.py,sha256=63aPrhGE5jO1YApvsIcn_HXA1E4ttLfyZVkIUE-meqA,11646
-k1lib/_monkey.py,sha256=EykKKRgP6P4GoRyA-nSwYIMWEPaDgHGHURuhzW2PI3I,19050
+k1lib/_monkey.py,sha256=UnI0vUg0gWk7zzsCQ6FJEutBpfBX9mqH5_aYgDqQtK4,19722
 k1lib/_perlin.py,sha256=sL4B8caVEz4xgWj65Oy3FYxELGDM8wPAtsn0Ro8R3dc,3571
 k1lib/eqn.py,sha256=1wchJwyCIOxbEzf9keQsnvhQfqbHe_cgPzI2crtuHRw,13377
 k1lib/fmt.py,sha256=0dGvEl_oewAXIKXLzaye4bDeX5AJ4yykNS7DGILQbmc,6317
 k1lib/graphEqn.py,sha256=DkdJlDcgC8THRuOFXGsbNuuA94_pUYy3jaU7XcggDLw,6398
 k1lib/imports.py,sha256=8gLOfbaITvT5ba85z6UBceghNLUV994OrcHYLYD0-NU,2650
 k1lib/knn.py,sha256=LASgb0z_9x1u4eZTsat_FspX1g5aIyxjkEWHhKRTn1g,3107
 k1lib/p5.py,sha256=nB0XmMXSz6CuDDZveGgsMCMhoKBXOG_rF0tjkCxJCec,3564
@@ -49,35 +49,35 @@
 k1lib/cli/bio.py,sha256=PhGvy-fDA-wrUzzEDpuRe4x-Kbylx0sNmoXCEZfE_FA,8308
 k1lib/cli/cif.py,sha256=77FX83m1FRYEeZkdXJ8MiVapqCSzZ-1xOQ8ZLeHfhf8,4033
 k1lib/cli/conv.py,sha256=EIaZPZ4oCG2mr7Y-Esa1TjV2PnmrUCRWNjJSS7ZEYn4,18911
 k1lib/cli/filt.py,sha256=uZlB3qbaOSZZhBpfX2Wt0JSDcB72Z98bRlE_eNtb7gc,24096
 k1lib/cli/gb.py,sha256=xxjuNYgWrrElRckon3gP0sj-dShYnKs3jmHAb1U0kVI,6672
 k1lib/cli/grep.py,sha256=Lu4PFOe2pkaqd-UfJe_HhHCUFTUifE6Bh96_k80sQDA,6348
 k1lib/cli/init.py,sha256=jtOLSw3PR_0VIepOzK5cDmeAea4WmDNa3jy6WIM6qV4,18312
-k1lib/cli/inp.py,sha256=dAGpzcHG8DZykzqdBxHk2gaiN-srqEYE5t78jfdJaWU,21646
+k1lib/cli/inp.py,sha256=ZllbDCi-tmwbiPVLPYrg55kN3mpc6IXPcvHe4B-0SvI,21754
 k1lib/cli/kcsv.py,sha256=YGUVVLTZGGujokhxtj5MfjU9t1jRGqp23d58JK8lhq0,623
 k1lib/cli/kxml.py,sha256=YQGutvKNm0_xAi_NhCNtuGey7fx3zZSmSo33kS--54c,4819
 k1lib/cli/mgi.py,sha256=aLke90nG89tgWLPwyKmTj3kM8yJnIBCJSrPS1jT8mUk,1915
-k1lib/cli/modifier.py,sha256=km-FR9XV8cixkTI1SmQWis68PRJqKIOGHeJ4tV6TPr8,48243
+k1lib/cli/modifier.py,sha256=ZM51FuC6pR0lU3f9MEanxFqeoMxJyHqLbQUtlvEx31s,48729
 k1lib/cli/mol.py,sha256=wNFuCPXtdEcH4DRBbmYaLAWxtDzjN2MOKFX7ynJhaJs,694
 k1lib/cli/nb.py,sha256=SHqhYHJrzV8IzH3wM1Kb0LOVseOa1XXDKUtYE_2KTkQ,3551
 k1lib/cli/optimizations.py,sha256=iZ73DwLqZCxRm0sECVZ7A2nDxf5D4rsoSGzrKTgzGaI,3530
 k1lib/cli/output.py,sha256=HQD61-Epy6WfteMHXW6SV14SiprXF55ELnfer2CWXEA,11559
 k1lib/cli/sam.py,sha256=_ersEPP2ue0Oa3AyftNjQu2PABpH4L7iFBbRJDOkeug,2394
-k1lib/cli/structural.py,sha256=HgYG8t8tbj4PN4TNeenhnW0CQQsI0qN1y_uh-avNT-8,49588
+k1lib/cli/structural.py,sha256=XQqBkDOgKVrBM4mGnPJZyK6AjZJZbPKCSlE4ZozxJrg,49581
 k1lib/cli/trace.py,sha256=nzZgOyXqFJYkQfbpR0lpX0Nnp0bQHXPjk8sDUBIe2hk,10399
 k1lib/cli/typehint.py,sha256=VBYxrOQaSnu5266lNWpgXIhXF7htdT0FT_NEvXjYBVk,23319
 k1lib/cli/utils.py,sha256=gaHYEw2_gjqNjOQFLUfa3JAXXwi6vZPCQqKwDuhrUDg,20345
 k1lib/k1ui/__init__.py,sha256=8D5a8oKgqd6WA1RUkiKCn4l_PVemtyuckxQut0vDHXM,20
 k1lib/k1ui/main.py,sha256=PnmdOhkjYgRSZnDyGYNMYtQ5Nvcb1NhQ9yjfP_3QORI,61803
 k1lib/serve/__init__.py,sha256=8D5a8oKgqd6WA1RUkiKCn4l_PVemtyuckxQut0vDHXM,20
 k1lib/serve/main.py,sha256=Xh2SzgABfsBp2dRLUJRMftsG_We8ReVHYqXLi3ntMVA,10361
 k1lib/serve/suffix-dash.py,sha256=HMNJvB4d-PTHXDRDQTdYUKtzgirJ0LVnqqAkXxO0B4w,153
 k1lib/serve/suffix.py,sha256=UH3ITN6O2vzoha2f6v4bcQG3_Boav7VA7EC8wf8r9f8,642
-k1lib-1.3.6.4.data/data/k1lib/k1ui/256.model.state_dict.pth,sha256=Ga-UXlAJfUPNOZsvP_c1-1cfB2Hp_-oQ4ghdouX1d7g,2453826
-k1lib-1.3.6.4.data/data/k1lib/k1ui/mouseKey.pth,sha256=KULhK_gdK2Ppju9gQnv1zV2kf_A0K-vX2W7trY6DIg8,304735
-k1lib-1.3.6.4.data/data/k1lib/serve/main.html,sha256=gHFNqzE9JKb4eCwCJN-Du45jj75lDRED4Ico91T-b4g,20544
-k1lib-1.3.6.4.dist-info/LICENSE,sha256=psuy2wnTg9zacuCQ0dXfxS44iaa89aTgsNzHDzx4UGM,1049
-k1lib-1.3.6.4.dist-info/METADATA,sha256=AuyJ0cvQHfb63yVXr47mI-vJJ5iMbBaCJ4TWzGAyxWg,3864
-k1lib-1.3.6.4.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-k1lib-1.3.6.4.dist-info/top_level.txt,sha256=xxWmqZzuThnLZn49Mse6A6j41-IVduPVnQW54imcOTA,6
-k1lib-1.3.6.4.dist-info/RECORD,,
+k1lib-1.3.6.5.data/data/k1lib/k1ui/256.model.state_dict.pth,sha256=Ga-UXlAJfUPNOZsvP_c1-1cfB2Hp_-oQ4ghdouX1d7g,2453826
+k1lib-1.3.6.5.data/data/k1lib/k1ui/mouseKey.pth,sha256=KULhK_gdK2Ppju9gQnv1zV2kf_A0K-vX2W7trY6DIg8,304735
+k1lib-1.3.6.5.data/data/k1lib/serve/main.html,sha256=gHFNqzE9JKb4eCwCJN-Du45jj75lDRED4Ico91T-b4g,20544
+k1lib-1.3.6.5.dist-info/LICENSE,sha256=psuy2wnTg9zacuCQ0dXfxS44iaa89aTgsNzHDzx4UGM,1049
+k1lib-1.3.6.5.dist-info/METADATA,sha256=UzvHXt5LoMOqlfbyNs6YLXs0rHiPh2mDuG6MzXuZ-zY,3864
+k1lib-1.3.6.5.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+k1lib-1.3.6.5.dist-info/top_level.txt,sha256=xxWmqZzuThnLZn49Mse6A6j41-IVduPVnQW54imcOTA,6
+k1lib-1.3.6.5.dist-info/RECORD,,
```

