# Comparing `tmp/ai-executor-0.2.1.tar.gz` & `tmp/ai-executor-0.2.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "ai-executor-0.2.1.tar", last modified: Mon May  8 05:00:53 2023, max compression
+gzip compressed data, was "ai-executor-0.2.2.tar", last modified: Mon May  8 06:34:59 2023, max compression
```

## Comparing `ai-executor-0.2.1.tar` & `ai-executor-0.2.2.tar`

### file list

```diff
@@ -1,13 +1,13 @@
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-05-08 05:00:53.953776 ai-executor-0.2.1/
--rw-r--r--   0 root         (0) root         (0)      784 2023-05-08 05:00:53.953776 ai-executor-0.2.1/PKG-INFO
--rw-r--r--   0 root         (0) root         (0)      478 2023-05-08 04:32:13.000000 ai-executor-0.2.1/README.md
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-05-08 05:00:53.952776 ai-executor-0.2.1/ai_executor/
--rw-r--r--   0 root         (0) root         (0)     2903 2023-05-08 04:57:00.000000 ai-executor-0.2.1/ai_executor/__init__.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-05-08 05:00:53.953776 ai-executor-0.2.1/ai_executor.egg-info/
--rw-r--r--   0 root         (0) root         (0)      784 2023-05-08 05:00:53.000000 ai-executor-0.2.1/ai_executor.egg-info/PKG-INFO
--rw-r--r--   0 root         (0) root         (0)      216 2023-05-08 05:00:53.000000 ai-executor-0.2.1/ai_executor.egg-info/SOURCES.txt
--rw-r--r--   0 root         (0) root         (0)        1 2023-05-08 05:00:53.000000 ai-executor-0.2.1/ai_executor.egg-info/dependency_links.txt
--rw-r--r--   0 root         (0) root         (0)        7 2023-05-08 05:00:53.000000 ai-executor-0.2.1/ai_executor.egg-info/requires.txt
--rw-r--r--   0 root         (0) root         (0)       12 2023-05-08 05:00:53.000000 ai-executor-0.2.1/ai_executor.egg-info/top_level.txt
--rw-r--r--   0 root         (0) root         (0)       38 2023-05-08 05:00:53.953776 ai-executor-0.2.1/setup.cfg
--rw-r--r--   0 root         (0) root         (0)      487 2023-05-08 05:00:52.000000 ai-executor-0.2.1/setup.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-05-08 06:34:59.784424 ai-executor-0.2.2/
+-rw-r--r--   0 root         (0) root         (0)      784 2023-05-08 06:34:59.784424 ai-executor-0.2.2/PKG-INFO
+-rw-r--r--   0 root         (0) root         (0)      478 2023-05-08 04:32:13.000000 ai-executor-0.2.2/README.md
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-05-08 06:34:59.783424 ai-executor-0.2.2/ai_executor/
+-rw-r--r--   0 root         (0) root         (0)     3280 2023-05-08 06:34:26.000000 ai-executor-0.2.2/ai_executor/__init__.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-05-08 06:34:59.784424 ai-executor-0.2.2/ai_executor.egg-info/
+-rw-r--r--   0 root         (0) root         (0)      784 2023-05-08 06:34:59.000000 ai-executor-0.2.2/ai_executor.egg-info/PKG-INFO
+-rw-r--r--   0 root         (0) root         (0)      216 2023-05-08 06:34:59.000000 ai-executor-0.2.2/ai_executor.egg-info/SOURCES.txt
+-rw-r--r--   0 root         (0) root         (0)        1 2023-05-08 06:34:59.000000 ai-executor-0.2.2/ai_executor.egg-info/dependency_links.txt
+-rw-r--r--   0 root         (0) root         (0)        7 2023-05-08 06:34:59.000000 ai-executor-0.2.2/ai_executor.egg-info/requires.txt
+-rw-r--r--   0 root         (0) root         (0)       12 2023-05-08 06:34:59.000000 ai-executor-0.2.2/ai_executor.egg-info/top_level.txt
+-rw-r--r--   0 root         (0) root         (0)       38 2023-05-08 06:34:59.784424 ai-executor-0.2.2/setup.cfg
+-rw-r--r--   0 root         (0) root         (0)      487 2023-05-08 06:34:52.000000 ai-executor-0.2.2/setup.py
```

### Comparing `ai-executor-0.2.1/PKG-INFO` & `ai-executor-0.2.2/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: ai-executor
-Version: 0.2.1
+Version: 0.2.2
 Summary: A Python package for executing methods generated by ChatGPT
 Home-page: https://github.com/ZS520L/LegoAI-by-AUST
 Author: LegoAI
 Author-email: li17719333702@gmail.com
 License: UNKNOWN
 Platform: UNKNOWN
 Description-Content-Type: text/markdown
```

### Comparing `ai-executor-0.2.1/ai_executor/__init__.py` & `ai-executor-0.2.2/ai_executor/__init__.py`

 * *Files 6% similar despite different names*

```diff
@@ -20,34 +20,42 @@
                 print("代码从缓存中获取")
             else:
                 generated_code = self.call_chatgpt(method_name, *args, **kwargs)
                 print("首次生成的代码")
 
             print('#################code#################')
             print(generated_code)
-            print('\n################result################')
+            print('######################################')
 
             try:
                 exec(generated_code, globals())
-                print('\n\n\n')
 
                 if method_name not in self.generated_code_cache:
                     self.generated_code_cache[method_name] = generated_code
                     with open(self.cache_file, "w") as f:
                         json.dump(self.generated_code_cache, f)
 
             except Exception as e:
                 print(f"执行生成代码时出错: {e}")
                 return None
+            # 使用 eval 根据函数名称从全局名称空间调用函数，并将参数传递给函数
+            try:
+                result = eval(f"{method_name}(*args, **kwargs)")
+                # print('######################################')
+                print(result,'\n\n')
+                return result
+            except Exception as e:
+                print(f"调用函数时出错: {e}")
+                return None
 
         return method
 
     def call_chatgpt(self, method_name, *args, **kwargs):
-        # prompt = f"编写一个Python函数，名为{method_name}，接受以下参数：{args} {kwargs}。请根据函数名推理并实现该函数，并在最后增加函数调用代码。注意：只输出函数代码，不要包含其他无关信息。"
-        prompt = f"编写一个Python函数，名为{method_name}，接受以下参数：{args} {kwargs}，请根据函数名推理并实现该函数，并在最后增加函数调用代码。要求只输出代码，无需任何解释"
+        # prompt = f"编写一个Python函数，名为{method_name}，接受以下参数：{args} {kwargs}。请根据函数名推理并实现该函数，不需要测试。注意：只输出函数代码，不要包含其他无关信息。"
+        prompt = f"编写一个Python函数，函数名必须为{method_name}，接受以下参数：{args} {kwargs}，请根据函数名推理并实现该函数，不需要测试。要求只输出代码，无需任何解释"
         
         openai.api_key = self.chatgpt_api_key
 
         if self.mode == 'davinci':
             response = openai.Completion.create(
                 engine="text-davinci-003",
                 prompt=prompt,
@@ -61,10 +69,8 @@
         if self.mode == 'gpt':
             response = openai.ChatCompletion.create(
                 model='gpt-3.5-turbo',
                 messages=eval('[{"role":"user", "content":"' + prompt + '"}]'),
                 temperature=0
             )
             assistant_response = response.choices[0].message['content']
-            return assistant_response.replace('```python','').replace('```','').strip()
-
-
+            return assistant_response.replace('```python','').replace('```','').strip()
```

### Comparing `ai-executor-0.2.1/ai_executor.egg-info/PKG-INFO` & `ai-executor-0.2.2/ai_executor.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: ai-executor
-Version: 0.2.1
+Version: 0.2.2
 Summary: A Python package for executing methods generated by ChatGPT
 Home-page: https://github.com/ZS520L/LegoAI-by-AUST
 Author: LegoAI
 Author-email: li17719333702@gmail.com
 License: UNKNOWN
 Platform: UNKNOWN
 Description-Content-Type: text/markdown
```

