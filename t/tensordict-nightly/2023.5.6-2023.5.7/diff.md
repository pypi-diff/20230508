# Comparing `tmp/tensordict_nightly-2023.5.6-py39-none-any.whl.zip` & `tmp/tensordict_nightly-2023.5.7-py39-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,29 +1,29 @@
-Zip file size: 129630 bytes, number of entries: 27
--rw-r--r--  2.0 unx     1088 b- defN 23-May-06 11:18 tensordict/__init__.py
--rw-r--r--  2.0 unx     6000 b- defN 23-May-06 11:18 tensordict/_contextlib.py
--rw-r--r--  2.0 unx    29601 b- defN 23-May-06 11:18 tensordict/memmap.py
--rw-r--r--  2.0 unx    33049 b- defN 23-May-06 11:18 tensordict/persistent.py
--rw-r--r--  2.0 unx    30420 b- defN 23-May-06 11:18 tensordict/tensorclass.py
--rw-r--r--  2.0 unx   266932 b- defN 23-May-06 11:18 tensordict/tensordict.py
--rw-r--r--  2.0 unx    26209 b- defN 23-May-06 11:18 tensordict/utils.py
--rw-r--r--  2.0 unx       84 b- defN 23-May-06 11:19 tensordict/version.py
--rw-r--r--  2.0 unx     1314 b- defN 23-May-06 11:18 tensordict/nn/__init__.py
--rw-r--r--  2.0 unx    35649 b- defN 23-May-06 11:18 tensordict/nn/common.py
--rw-r--r--  2.0 unx    18838 b- defN 23-May-06 11:18 tensordict/nn/functional_modules.py
--rw-r--r--  2.0 unx    22301 b- defN 23-May-06 11:18 tensordict/nn/probabilistic.py
--rw-r--r--  2.0 unx    19564 b- defN 23-May-06 11:18 tensordict/nn/sequence.py
--rw-r--r--  2.0 unx    10621 b- defN 23-May-06 11:18 tensordict/nn/utils.py
--rw-r--r--  2.0 unx      499 b- defN 23-May-06 11:18 tensordict/nn/distributions/__init__.py
--rw-r--r--  2.0 unx     7073 b- defN 23-May-06 11:18 tensordict/nn/distributions/continuous.py
--rw-r--r--  2.0 unx     2580 b- defN 23-May-06 11:18 tensordict/nn/distributions/discrete.py
--rw-r--r--  2.0 unx     6504 b- defN 23-May-06 11:18 tensordict/nn/distributions/truncated_normal.py
--rw-r--r--  2.0 unx     1226 b- defN 23-May-06 11:18 tensordict/nn/distributions/utils.py
--rw-r--r--  2.0 unx      381 b- defN 23-May-06 11:18 tensordict/prototype/__init__.py
--rw-r--r--  2.0 unx     7507 b- defN 23-May-06 11:18 tensordict/prototype/fx.py
--rw-r--r--  2.0 unx      739 b- defN 23-May-06 11:18 tensordict/prototype/tensorclass.py
--rw-r--r--  2.0 unx     1098 b- defN 23-May-06 11:19 tensordict_nightly-2023.5.6.dist-info/LICENSE
--rw-r--r--  2.0 unx    15208 b- defN 23-May-06 11:19 tensordict_nightly-2023.5.6.dist-info/METADATA
--rw-r--r--  2.0 unx       93 b- defN 23-May-06 11:19 tensordict_nightly-2023.5.6.dist-info/WHEEL
--rw-r--r--  2.0 unx       11 b- defN 23-May-06 11:19 tensordict_nightly-2023.5.6.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2352 b- defN 23-May-06 11:19 tensordict_nightly-2023.5.6.dist-info/RECORD
-27 files, 546941 bytes uncompressed, 125828 bytes compressed:  77.0%
+Zip file size: 129732 bytes, number of entries: 27
+-rw-r--r--  2.0 unx     1088 b- defN 23-May-07 11:18 tensordict/__init__.py
+-rw-r--r--  2.0 unx     6000 b- defN 23-May-07 11:18 tensordict/_contextlib.py
+-rw-r--r--  2.0 unx    29601 b- defN 23-May-07 11:18 tensordict/memmap.py
+-rw-r--r--  2.0 unx    33049 b- defN 23-May-07 11:18 tensordict/persistent.py
+-rw-r--r--  2.0 unx    30420 b- defN 23-May-07 11:18 tensordict/tensorclass.py
+-rw-r--r--  2.0 unx   267125 b- defN 23-May-07 11:18 tensordict/tensordict.py
+-rw-r--r--  2.0 unx    26209 b- defN 23-May-07 11:18 tensordict/utils.py
+-rw-r--r--  2.0 unx       84 b- defN 23-May-07 11:18 tensordict/version.py
+-rw-r--r--  2.0 unx     1314 b- defN 23-May-07 11:18 tensordict/nn/__init__.py
+-rw-r--r--  2.0 unx    35649 b- defN 23-May-07 11:18 tensordict/nn/common.py
+-rw-r--r--  2.0 unx    19188 b- defN 23-May-07 11:18 tensordict/nn/functional_modules.py
+-rw-r--r--  2.0 unx    22301 b- defN 23-May-07 11:18 tensordict/nn/probabilistic.py
+-rw-r--r--  2.0 unx    19564 b- defN 23-May-07 11:18 tensordict/nn/sequence.py
+-rw-r--r--  2.0 unx    10621 b- defN 23-May-07 11:18 tensordict/nn/utils.py
+-rw-r--r--  2.0 unx      499 b- defN 23-May-07 11:18 tensordict/nn/distributions/__init__.py
+-rw-r--r--  2.0 unx     7073 b- defN 23-May-07 11:18 tensordict/nn/distributions/continuous.py
+-rw-r--r--  2.0 unx     2580 b- defN 23-May-07 11:18 tensordict/nn/distributions/discrete.py
+-rw-r--r--  2.0 unx     6504 b- defN 23-May-07 11:18 tensordict/nn/distributions/truncated_normal.py
+-rw-r--r--  2.0 unx     1226 b- defN 23-May-07 11:18 tensordict/nn/distributions/utils.py
+-rw-r--r--  2.0 unx      381 b- defN 23-May-07 11:18 tensordict/prototype/__init__.py
+-rw-r--r--  2.0 unx     7507 b- defN 23-May-07 11:18 tensordict/prototype/fx.py
+-rw-r--r--  2.0 unx      739 b- defN 23-May-07 11:18 tensordict/prototype/tensorclass.py
+-rw-r--r--  2.0 unx     1098 b- defN 23-May-07 11:18 tensordict_nightly-2023.5.7.dist-info/LICENSE
+-rw-r--r--  2.0 unx    15208 b- defN 23-May-07 11:18 tensordict_nightly-2023.5.7.dist-info/METADATA
+-rw-r--r--  2.0 unx       93 b- defN 23-May-07 11:18 tensordict_nightly-2023.5.7.dist-info/WHEEL
+-rw-r--r--  2.0 unx       11 b- defN 23-May-07 11:18 tensordict_nightly-2023.5.7.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2352 b- defN 23-May-07 11:18 tensordict_nightly-2023.5.7.dist-info/RECORD
+27 files, 547484 bytes uncompressed, 125930 bytes compressed:  77.0%
```

## zipnote {}

```diff
@@ -60,23 +60,23 @@
 
 Filename: tensordict/prototype/fx.py
 Comment: 
 
 Filename: tensordict/prototype/tensorclass.py
 Comment: 
 
-Filename: tensordict_nightly-2023.5.6.dist-info/LICENSE
+Filename: tensordict_nightly-2023.5.7.dist-info/LICENSE
 Comment: 
 
-Filename: tensordict_nightly-2023.5.6.dist-info/METADATA
+Filename: tensordict_nightly-2023.5.7.dist-info/METADATA
 Comment: 
 
-Filename: tensordict_nightly-2023.5.6.dist-info/WHEEL
+Filename: tensordict_nightly-2023.5.7.dist-info/WHEEL
 Comment: 
 
-Filename: tensordict_nightly-2023.5.6.dist-info/top_level.txt
+Filename: tensordict_nightly-2023.5.7.dist-info/top_level.txt
 Comment: 
 
-Filename: tensordict_nightly-2023.5.6.dist-info/RECORD
+Filename: tensordict_nightly-2023.5.7.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## tensordict/tensordict.py

```diff
@@ -1257,14 +1257,15 @@
         return self.apply(fn, inplace=True)
 
     def apply(
         self,
         fn: Callable,
         *others: TensorDictBase,
         batch_size: Sequence[int] | None = None,
+        names: Sequence[str] | None = None,
         inplace: bool = False,
         **constructor_kwargs,
     ) -> TensorDictBase:
         """Applies a callable to all values stored in the tensordict and sets them in a new tensordict.
 
         The apply method will return an TensorDict instance, regardless of the
         input type. To keep the same type, one can execute
@@ -1279,14 +1280,16 @@
                 current tensordict. The :obj:`fn` argument should receive as many
                 inputs as the number of tensordicts, including the one where apply is
                 being called.
             batch_size (sequence of int, optional): if provided,
                 the resulting TensorDict will have the desired batch_size.
                 The :obj:`batch_size` argument should match the batch_size after
                 the transformation. This is a keyword only argument.
+            names (list of str, optional): the new dimension names, in case the
+                batch_size is modified.
             inplace (bool, optional): if True, changes are made in-place.
                 Default is False. This is a keyword only argument.
             **constructor_kwargs: additional keyword arguments to be passed to the
                 TensorDict constructor.
 
         Returns:
             a new tensordict with transformed_in tensors.
@@ -1302,14 +1305,15 @@
         """
         if inplace:
             out = self
         elif batch_size is not None:
             out = TensorDict(
                 {},
                 batch_size=torch.Size(batch_size),
+                names=names,
                 device=self.device,
                 _run_checks=False,
                 **constructor_kwargs,
             )
         else:
             out = TensorDict(
                 {},
```

## tensordict/version.py

```diff
@@ -1,2 +1,2 @@
-__version__ = '2023.05.06'
-git_version = '8f579eaa9b34797183f059241694bb4dfcdc80fa'
+__version__ = '2023.05.07'
+git_version = '21c4a0d565dd57dd8ce9d44e5b93664969fc273d'
```

## tensordict/nn/functional_modules.py

```diff
@@ -135,14 +135,15 @@
         # the batched tensors. This will be added in _unwrap_batched
         batched_inputs = [
             arg
             if in_dim is None
             else arg.apply(
                 lambda _arg, in_dim=in_dim: _add_batch_dim(_arg, in_dim, vmap_level),
                 batch_size=[b for i, b in enumerate(arg.batch_size) if i != in_dim],
+                names=[name for i, name in enumerate(arg.names) if i != in_dim],
             )
             if isinstance(arg, TensorDictBase)
             else _add_batch_dim(arg, in_dim, vmap_level)
             for in_dim, arg in zip(flat_in_dims, flat_args)
         ]
         return tree_unflatten(batched_inputs, args_spec)
 
@@ -193,20 +194,25 @@
         flat_outputs = []
         for batched_output, out_dim in zip(flat_batched_outputs, flat_out_dims):
             if not isinstance(batched_output, TensorDictBase):
                 out = _remove_batch_dim(batched_output, vmap_level, batch_size, out_dim)
             else:
                 new_batch_size = list(batched_output.batch_size)
                 new_batch_size.insert(out_dim, batch_size)
+                new_names = list(batched_output.names)
+                new_names.insert(out_dim, None)
+                print(batched_output.names)
                 out = batched_output.apply(
                     lambda x, out_dim=out_dim: _remove_batch_dim(
                         x, vmap_level, batch_size, out_dim
                     ),
                     batch_size=new_batch_size,
+                    names=new_names,
                 )
+                print(new_batch_size, out_dim, batch_size, flat_out_dims, out.names)
             flat_outputs.append(out)
         return tree_unflatten(flat_outputs, output_spec)
 
     vmap_src._unwrap_batched = _unwrap_batched
 
 
 # Tensordict-compatible Functional modules
```

## Comparing `tensordict_nightly-2023.5.6.dist-info/LICENSE` & `tensordict_nightly-2023.5.7.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `tensordict_nightly-2023.5.6.dist-info/METADATA` & `tensordict_nightly-2023.5.7.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: tensordict-nightly
-Version: 2023.5.6
+Version: 2023.5.7
 Home-page: https://github.com/pytorch-labs/tensordict
 Author: tensordict contributors
 Author-email: vmoens@fb.com
 License: BSD
 Classifier: Programming Language :: Python :: 3.7
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
@@ -358,15 +358,15 @@
 
 If you're using TensorDict, please refer to this BibTeX entry to cite this work:
 ```
 @software{TensorDict,
   author = {Moens, Vincent},
   title = {{TensorDict: your PyTorch universal data carrier}},
   url = {https://github.com/pytorch-labs/tensordict},
-  version = {0.1.0},
+  version = {0.1.1},
   year = {2023}
 }
 ```
 
 ## Disclaimer
 
 TensorDict is at the *beta*-stage, meaning that there may be bc-breaking changes introduced, but
```

### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: tensordict-nightly Version: 2023.5.6 Home-page:
+Metadata-Version: 2.1 Name: tensordict-nightly Version: 2023.5.7 Home-page:
 https://github.com/pytorch-labs/tensordict Author: tensordict contributors
 Author-email: vmoens@fb.com License: BSD Classifier: Programming Language ::
 Python :: 3.7 Classifier: Programming Language :: Python :: 3.8 Classifier:
 Programming Language :: Python :: 3.9 Classifier: Programming Language ::
 Python :: 3.10 Classifier: Development Status :: 4 - Beta Description-Content-
 Type: text/markdown License-File: LICENSE Requires-Dist: torch Requires-Dist:
 numpy Requires-Dist: cloudpickle Provides-Extra: checkpointing Requires-Dist:
@@ -181,13 +181,13 @@
 This will work with Python 3.7 and upward as well as PyTorch 1.12 and upward.
 To enjoy the latest features, one can use ```bash pip install tensordict-
 nightly ``` **With Conda**: Install `tensordict` from `conda-forge` channel.
 ```sh conda install -c conda-forge tensordict ``` ## Citation If you're using
 TensorDict, please refer to this BibTeX entry to cite this work: ``` @software
 {TensorDict, author = {Moens, Vincent}, title = {{TensorDict: your PyTorch
 universal data carrier}}, url = {https://github.com/pytorch-labs/tensordict},
-version = {0.1.0}, year = {2023} } ``` ## Disclaimer TensorDict is at the
+version = {0.1.1}, year = {2023} } ``` ## Disclaimer TensorDict is at the
 *beta*-stage, meaning that there may be bc-breaking changes introduced, but
 they should come with a warranty. Hopefully these should not happen too often,
 as the current roadmap mostly involves adding new features and building
 compatibility with the broader PyTorch ecosystem. ## License TensorDict is
 licensed under the MIT License. See [LICENSE](LICENSE) for details.
```

## Comparing `tensordict_nightly-2023.5.6.dist-info/RECORD` & `tensordict_nightly-2023.5.7.dist-info/RECORD`

 * *Files 12% similar despite different names*

```diff
@@ -1,27 +1,27 @@
 tensordict/__init__.py,sha256=dDQidc208swLADInUxPlfvgfERJr2xeVTNC5NRvwN4A,1088
 tensordict/_contextlib.py,sha256=F4b0KH4FSeKsY9dkRuIXgHEn1dL_aNk7lFs1DonDYn4,6000
 tensordict/memmap.py,sha256=sBIRRJVadGiXlT5A8UfxoQqn6EEE1TBUDUaCyz65Yws,29601
 tensordict/persistent.py,sha256=CkF6hVsKAO21Le-7fuUChsLczoUr7Eflj6A6H7Z1XEo,33049
 tensordict/tensorclass.py,sha256=6eGhArep4GwEOeMFrdvv9MyVuy6oc4G58mhI2AVPh8M,30420
-tensordict/tensordict.py,sha256=l8_Yo_1RWHHgglwnpNG2ryVJLWchzEJZs_OLEd-JQbo,266932
+tensordict/tensordict.py,sha256=raNiDj7w5CKompvO7wGDFxaPMfvqGPDR3YnOau0tko4,267125
 tensordict/utils.py,sha256=rZjY_b8mGys_YDWyWIQbZ1xeiJrXvG-u7sUxaSsjqIc,26209
-tensordict/version.py,sha256=TDblZahTTz3wRuVcIbvP5u7Ep0DN452WphS-cE_hg0I,84
+tensordict/version.py,sha256=Kpf2zEmP_NgiTFq8qEUmptFdndFbobk44cit7nfiSyA,84
 tensordict/nn/__init__.py,sha256=gjahPjJuC1uGPppYt7yZ8Ifusf2hTnOJHZGf8IutgoU,1314
 tensordict/nn/common.py,sha256=ncXtR3RsA3Ma5xxJILMi-W6or_hAmRwqZYsEaBxD208,35649
-tensordict/nn/functional_modules.py,sha256=4nyf-klgEZck-9OV3V3P8JMsXTGZtngQUJ-J2As7fC8,18838
+tensordict/nn/functional_modules.py,sha256=jGJOUTaqCKO6Pmp8IuzGLWvej5WIOV26akH_0AMU7FI,19188
 tensordict/nn/probabilistic.py,sha256=ZYa7f2PzWqgwTw3TJAcd125HRpD4p6aPc1HD5o709WM,22301
 tensordict/nn/sequence.py,sha256=l5nuYu0Ja11IO9qWSlijvRZH4XDLbUy8lwkFmyAHrHE,19564
 tensordict/nn/utils.py,sha256=Hb8zIWL_wGs8OSaGjqQJ4DAadLqA9d4GARR7EboKOFU,10621
 tensordict/nn/distributions/__init__.py,sha256=sD3yMuMceDJ8EqtptE4HEaS9Q_3keskCB9npPNFKXUo,499
 tensordict/nn/distributions/continuous.py,sha256=Y31G7ozOnlGUgzdqYZaKeXVjDOVMoSW1hIQWtcbyDO0,7073
 tensordict/nn/distributions/discrete.py,sha256=gUzTKs3yO8GkSY0ghBWVaZdHdmFyMMLWd5LV52CfrXY,2580
 tensordict/nn/distributions/truncated_normal.py,sha256=d1ontYbG_Q-W5gcVnWLadvZ1OBBeZGmBb5EUmr3ekak,6504
 tensordict/nn/distributions/utils.py,sha256=fX6NUeNnWKK6kDdOp8NTM43Lls3vMCF5h-S2teVZw3E,1226
 tensordict/prototype/__init__.py,sha256=b9Wmi1tbh2Em_wmKa52IXwxuudd6CUqdLgaob0bSWqQ,381
 tensordict/prototype/fx.py,sha256=Z3X821miRKcrOYwApvBDYt2_hST3IXNVe4v03tVvQKo,7507
 tensordict/prototype/tensorclass.py,sha256=pE53rWFqcPmuJOyOkI7cBZL9sMVfPx8bdQR1hNgYPvU,739
-tensordict_nightly-2023.5.6.dist-info/LICENSE,sha256=xdjS4_xk-IwnLuIFCvTYTl9Y8aXRejqpmke3dGam_nI,1098
-tensordict_nightly-2023.5.6.dist-info/METADATA,sha256=_ZO4YTvOF51tWD88kgTDtHOJtU2Dr_nuWZp91iSZ0FI,15208
-tensordict_nightly-2023.5.6.dist-info/WHEEL,sha256=ns_9KNZvwSNZtRgVV_clzMUG_fXjGc5Z8Tx4hxQ0gkw,93
-tensordict_nightly-2023.5.6.dist-info/top_level.txt,sha256=4EMgKpsnmq04uFLPJXf8tMQb1POT8QqR1pR74y5wycc,11
-tensordict_nightly-2023.5.6.dist-info/RECORD,,
+tensordict_nightly-2023.5.7.dist-info/LICENSE,sha256=xdjS4_xk-IwnLuIFCvTYTl9Y8aXRejqpmke3dGam_nI,1098
+tensordict_nightly-2023.5.7.dist-info/METADATA,sha256=Np0_nHRUrfu0oluvOIN7FfE5emxE3Q7r95fl362rvQg,15208
+tensordict_nightly-2023.5.7.dist-info/WHEEL,sha256=ns_9KNZvwSNZtRgVV_clzMUG_fXjGc5Z8Tx4hxQ0gkw,93
+tensordict_nightly-2023.5.7.dist-info/top_level.txt,sha256=4EMgKpsnmq04uFLPJXf8tMQb1POT8QqR1pR74y5wycc,11
+tensordict_nightly-2023.5.7.dist-info/RECORD,,
```

