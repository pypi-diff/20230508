# Comparing `tmp/pydal-20221110.1.tar.gz` & `tmp/PyDAL-20230407.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "pydal-20221110.1.tar", last modified: Fri Nov 11 06:39:15 2022, max compression
+gzip compressed data, was "PyDAL-20230407.2.tar", last modified: Sun May  7 23:28:12 2023, max compression
```

## Comparing `pydal-20221110.1.tar` & `PyDAL-20230407.2.tar`

### file list

```diff
@@ -1,132 +1,163 @@
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.541653 pydal-20221110.1/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      344 2022-10-17 00:44:46.000000 pydal-20221110.1/AUTHORS
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     6546 2022-10-17 00:44:46.000000 pydal-20221110.1/CHANGES
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1555 2022-10-17 00:44:46.000000 pydal-20221110.1/LICENSE.txt
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      170 2022-11-11 06:37:56.000000 pydal-20221110.1/MANIFEST.in
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1642 2022-11-11 06:39:15.541653 pydal-20221110.1/PKG-INFO
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     2034 2022-10-17 00:44:46.000000 pydal-20221110.1/README.md
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.525670 pydal-20221110.1/docs/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     6758 2022-10-17 00:44:46.000000 pydal-20221110.1/docs/Makefile
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     8079 2022-10-17 00:44:46.000000 pydal-20221110.1/docs/conf.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      833 2022-10-17 00:44:46.000000 pydal-20221110.1/docs/index.rst
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     2834 2022-10-17 00:44:46.000000 pydal-20221110.1/docs/pydal.adapters.rst
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      664 2022-10-17 00:44:46.000000 pydal-20221110.1/docs/pydal.helpers.rst
--rw-rw-r--   0 massimo   (1000) massimo   (1000)       29 2022-10-17 00:44:46.000000 pydal-20221110.1/docs/requirements.txt
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.529666 pydal-20221110.1/pydal/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      179 2022-11-11 06:38:39.000000 pydal-20221110.1/pydal/__init__.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     5440 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/_compat.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      466 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/_gae.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      208 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/_globals.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      396 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/_load.py
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.529666 pydal-20221110.1/pydal/adapters/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     2372 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/__init__.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    38893 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/base.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     5691 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/couchdb.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     2000 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/db2.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3145 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/firebird.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    18365 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/google.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     2076 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/informix.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1882 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/ingres.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    37772 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/mongo.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     6161 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/mssql.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3412 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/mysql.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     9170 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/oracle.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     9327 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/postgres.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1460 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/sap.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     4894 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/snowflake.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     4392 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/sqlite.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      799 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/adapters/teradata.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    38526 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/base.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     6429 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/connection.py
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.533662 pydal-20221110.1/pydal/contrib/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)        1 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/contrib/__init__.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    44550 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/contrib/imap_adapter.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    79374 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/contrib/ipaddress.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    10686 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/contrib/mockimaplib.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     4071 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/contrib/ordereddict.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     5586 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/contrib/portalocker.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    33372 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/contrib/reserved_sql_keywords.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3544 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/default_validators.py
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.533662 pydal-20221110.1/pydal/dialects/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3803 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/__init__.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    23536 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/base.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1390 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/couchdb.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3374 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/db2.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     4307 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/firebird.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     5953 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/google.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3275 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/informix.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3929 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/ingres.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    22074 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/mongo.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    15736 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/mssql.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3391 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/mysql.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     8895 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/oracle.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    14382 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/postgre.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3001 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/sap.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    12059 2022-11-11 06:37:56.000000 pydal-20221110.1/pydal/dialects/snowflake.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     4273 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/sqlite.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3400 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/dialects/teradata.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3179 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/drivers.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      347 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/exceptions.py
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.533662 pydal-20221110.1/pydal/helpers/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)        1 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/helpers/__init__.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      652 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/helpers/_internals.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    16435 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/helpers/classes.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      971 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/helpers/gae.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    14800 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/helpers/methods.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1144 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/helpers/regex.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    16447 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/helpers/rest.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1839 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/helpers/serializers.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    27227 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/migrator.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)   128660 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/objects.py
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.537658 pydal-20221110.1/pydal/parsers/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3394 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/parsers/__init__.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     4718 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/parsers/base.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      360 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/parsers/google.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1605 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/parsers/mongo.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1654 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/parsers/oracle.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      815 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/parsers/postgre.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1064 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/parsers/sqlite.py
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.537658 pydal-20221110.1/pydal/representers/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     8831 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/__init__.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     8810 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/base.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1210 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/couchdb.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      680 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/db2.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1446 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/google.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      884 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/informix.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1757 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/mongo.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      948 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/mssql.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      214 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/mysql.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1286 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/oracle.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1643 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/postgre.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      752 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/representers/sqlite.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    22878 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/restapi.py
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.537658 pydal-20221110.1/pydal/tools/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)        1 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/tools/__init__.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1946 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/tools/tags.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1904 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/utils.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)   158800 2022-10-17 00:44:46.000000 pydal-20221110.1/pydal/validators.py
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.529666 pydal-20221110.1/pydal.egg-info/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     1642 2022-11-11 06:39:15.000000 pydal-20221110.1/pydal.egg-info/PKG-INFO
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     2694 2022-11-11 06:39:15.000000 pydal-20221110.1/pydal.egg-info/SOURCES.txt
--rw-rw-r--   0 massimo   (1000) massimo   (1000)        1 2022-11-11 06:39:15.000000 pydal-20221110.1/pydal.egg-info/dependency_links.txt
--rw-rw-r--   0 massimo   (1000) massimo   (1000)        1 2022-10-23 18:32:13.000000 pydal-20221110.1/pydal.egg-info/not-zip-safe
--rw-rw-r--   0 massimo   (1000) massimo   (1000)        6 2022-11-11 06:39:15.000000 pydal-20221110.1/pydal.egg-info/top_level.txt
--rw-rw-r--   0 massimo   (1000) massimo   (1000)       99 2022-11-11 06:39:15.541653 pydal-20221110.1/setup.cfg
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     2109 2022-10-17 00:44:46.000000 pydal-20221110.1/setup.py
-drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2022-11-11 06:39:15.541653 pydal-20221110.1/tests/
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      355 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/__init__.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      954 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/_adapt.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)       95 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/_compat.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      764 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/_helpers.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     8110 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/base.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     2552 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/caching.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     4961 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/contribs.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     2278 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/indexes.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    29428 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/is_url_validators.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    99848 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/nosql.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    14074 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/restapi.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    12551 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/smart_query.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)   137565 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/sql.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)      989 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/tags.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)     3577 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/validation.py
--rw-rw-r--   0 massimo   (1000) massimo   (1000)    67679 2022-10-17 00:44:46.000000 pydal-20221110.1/tests/validators.py
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:12.496863 PyDAL-20230407.2/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      344 2022-10-17 00:44:46.000000 PyDAL-20230407.2/AUTHORS
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     6546 2022-10-17 00:44:46.000000 PyDAL-20230407.2/CHANGES
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1555 2022-10-17 00:44:46.000000 PyDAL-20230407.2/LICENSE.txt
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      170 2022-11-11 06:37:56.000000 PyDAL-20230407.2/MANIFEST.in
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     2903 2023-05-07 23:28:12.496863 PyDAL-20230407.2/PKG-INFO
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:11.560876 PyDAL-20230407.2/PyDAL.egg-info/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     2903 2023-05-07 23:28:11.000000 PyDAL-20230407.2/PyDAL.egg-info/PKG-INFO
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3965 2023-05-07 23:28:11.000000 PyDAL-20230407.2/PyDAL.egg-info/SOURCES.txt
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)        1 2023-05-07 23:28:11.000000 PyDAL-20230407.2/PyDAL.egg-info/dependency_links.txt
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)        6 2023-05-07 23:28:11.000000 PyDAL-20230407.2/PyDAL.egg-info/top_level.txt
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     2034 2022-10-17 00:44:46.000000 PyDAL-20230407.2/README.md
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:11.592875 PyDAL-20230407.2/docs/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     6758 2022-10-17 00:44:46.000000 PyDAL-20230407.2/docs/Makefile
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     8083 2023-05-07 23:00:04.000000 PyDAL-20230407.2/docs/conf.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      833 2022-10-17 00:44:46.000000 PyDAL-20230407.2/docs/index.rst
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     2834 2022-10-17 00:44:46.000000 PyDAL-20230407.2/docs/pydal.adapters.rst
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      664 2022-10-17 00:44:46.000000 PyDAL-20230407.2/docs/pydal.helpers.rst
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)       29 2022-10-17 00:44:46.000000 PyDAL-20230407.2/docs/requirements.txt
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:11.752873 PyDAL-20230407.2/pydal/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      179 2023-05-07 23:14:34.000000 PyDAL-20230407.2/pydal/__init__.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     5439 2023-05-07 22:57:55.000000 PyDAL-20230407.2/pydal/_compat.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      466 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/_gae.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      208 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/_globals.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      396 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/_load.py
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:11.904871 PyDAL-20230407.2/pydal/adapters/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     2372 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/__init__.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    38893 2023-05-07 23:00:01.000000 PyDAL-20230407.2/pydal/adapters/base.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     5691 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/couchdb.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     2000 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/db2.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3145 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/firebird.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    18365 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/google.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     2076 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/informix.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1882 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/ingres.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    37772 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/mongo.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     6161 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/mssql.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3412 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/mysql.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     9170 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/oracle.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     9327 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/postgres.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1460 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/sap.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     4894 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/snowflake.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     4392 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/sqlite.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      799 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/adapters/teradata.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    38526 2023-05-07 22:59:58.000000 PyDAL-20230407.2/pydal/base.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     6427 2023-05-07 22:57:59.000000 PyDAL-20230407.2/pydal/connection.py
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:11.944870 PyDAL-20230407.2/pydal/contrib/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)        1 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/contrib/__init__.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    44547 2023-05-07 22:58:08.000000 PyDAL-20230407.2/pydal/contrib/imap_adapter.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    79364 2023-05-07 22:58:11.000000 PyDAL-20230407.2/pydal/contrib/ipaddress.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    10686 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/contrib/mockimaplib.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     4071 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/contrib/ordereddict.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     5584 2023-05-07 22:58:06.000000 PyDAL-20230407.2/pydal/contrib/portalocker.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    33372 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/contrib/reserved_sql_keywords.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3532 2023-05-07 22:58:07.000000 PyDAL-20230407.2/pydal/default_validators.py
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:12.032869 PyDAL-20230407.2/pydal/dialects/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3803 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/dialects/__init__.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    23464 2023-05-07 22:58:13.000000 PyDAL-20230407.2/pydal/dialects/base.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1390 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/dialects/couchdb.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3374 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/dialects/db2.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     4307 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/dialects/firebird.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     5953 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/dialects/google.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3275 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/dialects/informix.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3929 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/dialects/ingres.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    22110 2023-05-07 22:58:11.000000 PyDAL-20230407.2/pydal/dialects/mongo.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    15758 2023-05-07 23:00:00.000000 PyDAL-20230407.2/pydal/dialects/mssql.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3413 2023-05-07 22:51:50.000000 PyDAL-20230407.2/pydal/dialects/mysql.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     8928 2023-05-07 22:58:13.000000 PyDAL-20230407.2/pydal/dialects/oracle.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    14396 2023-05-07 22:58:15.000000 PyDAL-20230407.2/pydal/dialects/postgre.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3001 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/dialects/sap.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    12077 2023-05-07 22:58:18.000000 PyDAL-20230407.2/pydal/dialects/snowflake.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     4295 2023-05-07 22:52:12.000000 PyDAL-20230407.2/pydal/dialects/sqlite.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3400 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/dialects/teradata.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3179 2023-05-07 22:59:59.000000 PyDAL-20230407.2/pydal/drivers.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      347 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/exceptions.py
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:12.036869 PyDAL-20230407.2/pydal/helpers/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)        1 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/helpers/__init__.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      652 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/helpers/_internals.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    16529 2023-05-07 22:59:59.000000 PyDAL-20230407.2/pydal/helpers/classes.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      971 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/helpers/gae.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    14800 2023-05-07 22:59:59.000000 PyDAL-20230407.2/pydal/helpers/methods.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1144 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/helpers/regex.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    16447 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/helpers/rest.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1839 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/helpers/serializers.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    27287 2023-05-07 22:58:25.000000 PyDAL-20230407.2/pydal/migrator.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)   128633 2023-05-07 22:59:58.000000 PyDAL-20230407.2/pydal/objects.py
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:12.052869 PyDAL-20230407.2/pydal/parsers/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3394 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/parsers/__init__.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     4718 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/parsers/base.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      360 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/parsers/google.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1605 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/parsers/mongo.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1654 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/parsers/oracle.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      815 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/parsers/postgre.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1064 2023-05-07 23:00:00.000000 PyDAL-20230407.2/pydal/parsers/sqlite.py
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:12.148867 PyDAL-20230407.2/pydal/representers/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     8831 2023-05-07 22:59:59.000000 PyDAL-20230407.2/pydal/representers/__init__.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     8810 2023-05-07 22:59:59.000000 PyDAL-20230407.2/pydal/representers/base.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1210 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/representers/couchdb.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      680 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/representers/db2.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1446 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/representers/google.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      884 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/representers/informix.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1757 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/representers/mongo.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      948 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/representers/mssql.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      214 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/representers/mysql.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1286 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/representers/oracle.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1643 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/representers/postgre.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      752 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/representers/sqlite.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    22876 2023-05-07 22:58:33.000000 PyDAL-20230407.2/pydal/restapi.py
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:12.164867 PyDAL-20230407.2/pydal/tools/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)        1 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/tools/__init__.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1946 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/tools/tags.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1904 2022-10-17 00:44:46.000000 PyDAL-20230407.2/pydal/utils.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)   158796 2023-05-07 22:59:58.000000 PyDAL-20230407.2/pydal/validators.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      822 2023-05-07 23:26:45.000000 PyDAL-20230407.2/pyproject.toml
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)       99 2023-05-07 23:28:12.508862 PyDAL-20230407.2/setup.cfg
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:12.280866 PyDAL-20230407.2/tests/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      355 2023-05-07 23:00:04.000000 PyDAL-20230407.2/tests/__init__.py
+drwxrwxr-x   0 massimo   (1000) massimo   (1000)        0 2023-05-07 23:28:12.496863 PyDAL-20230407.2/tests/__pycache__/
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      463 2023-05-07 22:38:51.000000 PyDAL-20230407.2/tests/__pycache__/__init__.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      463 2023-05-07 22:45:50.000000 PyDAL-20230407.2/tests/__pycache__/__init__.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1002 2023-05-07 22:38:51.000000 PyDAL-20230407.2/tests/__pycache__/_adapt.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1002 2023-05-07 22:45:50.000000 PyDAL-20230407.2/tests/__pycache__/_adapt.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      235 2023-05-07 22:38:51.000000 PyDAL-20230407.2/tests/__pycache__/_compat.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      235 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/_compat.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1189 2023-05-07 22:38:51.000000 PyDAL-20230407.2/tests/__pycache__/_helpers.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1197 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/_helpers.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     7191 2023-05-07 22:38:51.000000 PyDAL-20230407.2/tests/__pycache__/base.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     7225 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/base.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3136 2023-05-07 22:38:51.000000 PyDAL-20230407.2/tests/__pycache__/caching.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3136 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/caching.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     5395 2023-05-07 22:38:51.000000 PyDAL-20230407.2/tests/__pycache__/contribs.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     5421 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/contribs.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     2539 2023-05-07 22:38:51.000000 PyDAL-20230407.2/tests/__pycache__/indexes.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     2567 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/indexes.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    22630 2023-05-07 22:38:52.000000 PyDAL-20230407.2/tests/__pycache__/is_url_validators.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    22147 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/is_url_validators.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    69633 2023-05-07 22:38:52.000000 PyDAL-20230407.2/tests/__pycache__/nosql.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     5459 2023-05-07 22:38:52.000000 PyDAL-20230407.2/tests/__pycache__/restapi.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     5457 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/restapi.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3467 2023-05-07 22:38:51.000000 PyDAL-20230407.2/tests/__pycache__/smart_query.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3467 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/smart_query.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    91125 2023-05-07 22:38:51.000000 PyDAL-20230407.2/tests/__pycache__/sql.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    90877 2023-05-07 22:45:50.000000 PyDAL-20230407.2/tests/__pycache__/sql.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1086 2023-05-07 22:38:52.000000 PyDAL-20230407.2/tests/__pycache__/tags.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     1086 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/tags.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3312 2023-05-07 22:38:51.000000 PyDAL-20230407.2/tests/__pycache__/validation.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3304 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/validation.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    37800 2023-05-07 22:38:52.000000 PyDAL-20230407.2/tests/__pycache__/validators.cpython-38.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    37774 2023-05-07 22:45:51.000000 PyDAL-20230407.2/tests/__pycache__/validators.cpython-39.pyc
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      954 2022-10-17 00:44:46.000000 PyDAL-20230407.2/tests/_adapt.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)       95 2022-10-17 00:44:46.000000 PyDAL-20230407.2/tests/_compat.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      765 2023-05-07 23:00:04.000000 PyDAL-20230407.2/tests/_helpers.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     8127 2023-05-07 23:00:04.000000 PyDAL-20230407.2/tests/base.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     2554 2023-05-07 23:00:03.000000 PyDAL-20230407.2/tests/caching.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     4967 2023-05-07 23:00:01.000000 PyDAL-20230407.2/tests/contribs.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     2279 2023-05-07 23:00:03.000000 PyDAL-20230407.2/tests/indexes.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    29377 2023-05-07 23:00:03.000000 PyDAL-20230407.2/tests/is_url_validators.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    99834 2023-05-07 23:00:04.000000 PyDAL-20230407.2/tests/nosql.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    14103 2023-05-07 23:00:01.000000 PyDAL-20230407.2/tests/restapi.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    12552 2023-05-07 23:00:04.000000 PyDAL-20230407.2/tests/smart_query.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)   137742 2023-05-07 23:00:03.000000 PyDAL-20230407.2/tests/sql.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)      990 2023-05-07 23:00:04.000000 PyDAL-20230407.2/tests/tags.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)     3579 2023-05-07 23:00:03.000000 PyDAL-20230407.2/tests/validation.py
+-rw-rw-r--   0 massimo   (1000) massimo   (1000)    67656 2023-05-07 23:00:02.000000 PyDAL-20230407.2/tests/validators.py
```

### Comparing `pydal-20221110.1/CHANGES` & `PyDAL-20230407.2/CHANGES`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/LICENSE.txt` & `PyDAL-20230407.2/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/README.md` & `PyDAL-20230407.2/README.md`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/docs/Makefile` & `PyDAL-20230407.2/docs/Makefile`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/docs/conf.py` & `PyDAL-20230407.2/docs/conf.py`

 * *Files 2% similar despite different names*

```diff
@@ -7,15 +7,17 @@
 #
 # Note that not all possible configuration values are present in this
 # autogenerated file.
 #
 # All configuration values have a default; values that are commented out
 # serve to show the default.
 
-import sys, os, shutil
+import os
+import shutil
+import sys
 
 on_rtd = os.environ.get("READTHEDOCS", None) == "True"
 
 if not on_rtd:  # only import and set the theme if we're building docs locally
     import sphinx_rtd_theme
 
     html_theme = "sphinx_rtd_theme"
@@ -52,16 +54,16 @@
 # The encoding of source files.
 # source_encoding = 'utf-8-sig'
 
 # The master toctree document.
 master_doc = "index"
 
 # General information about the project.
-project = u"pyDAL"
-copyright = u"2014, web2py-developers"
+project = "pyDAL"
+copyright = "2014, web2py-developers"
 
 # The version info for the project you're documenting, acts as replacement for
 # |version| and |release|, also used in various other places throughout the
 # built documents.
 #
 # The short X.Y version.
 version = version_
@@ -184,15 +186,15 @@
     # Additional stuff for the LaTeX preamble.
     #'preamble': '',
 }
 
 # Grouping the document tree into LaTeX files. List of tuples
 # (source start file, target name, title, author, documentclass [howto/manual]).
 latex_documents = [
-    ("index", "pydal.tex", u"pyDAL Documentation", u"web2py-developers", "manual"),
+    ("index", "pydal.tex", "pyDAL Documentation", "web2py-developers", "manual"),
 ]
 
 # The name of an image file (relative to this directory) to place at the top of
 # the title page.
 # latex_logo = None
 
 # For "manual" documents, if this is true, then toplevel headings are parts,
@@ -212,31 +214,31 @@
 # latex_domain_indices = True
 
 
 # -- Options for manual page output --------------------------------------------
 
 # One entry per manual page. List of tuples
 # (source start file, name, description, authors, manual section).
-man_pages = [("index", "pyDAL", u"pyDAL Documentation", [u"web2py-developers"], 1)]
+man_pages = [("index", "pyDAL", "pyDAL Documentation", ["web2py-developers"], 1)]
 
 # If true, show URL addresses after external links.
 # man_show_urls = False
 
 
 # -- Options for Texinfo output ------------------------------------------------
 
 # Grouping the document tree into Texinfo files. List of tuples
 # (source start file, target name, title, author,
 #  dir menu entry, description, category)
 texinfo_documents = [
     (
         "index",
         "pyDAL",
-        u"pyDAL Documentation",
-        u"web2py-developers",
+        "pyDAL Documentation",
+        "web2py-developers",
         "pyDAL",
         "pyDAL",
         "Miscellaneous",
     ),
 ]
 
 # Documents to append as an appendix to all manuals.
```

### Comparing `pydal-20221110.1/docs/index.rst` & `PyDAL-20230407.2/docs/index.rst`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/docs/pydal.adapters.rst` & `PyDAL-20230407.2/docs/pydal.adapters.rst`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/docs/pydal.helpers.rst` & `PyDAL-20230407.2/docs/pydal.helpers.rst`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/_compat.py` & `PyDAL-20230407.2/pydal/_compat.py`

 * *Files 0% similar despite different names*

```diff
@@ -77,15 +77,14 @@
         raise TypeError("Expected bytes")
 
     def to_native(obj, charset="utf8", errors="strict"):
         if obj is None or isinstance(obj, str):
             return obj
         return obj.encode(charset, errors)
 
-
 else:
     import _thread as thread
     import builtins as builtin
     import configparser
     import copyreg
     import html  # warning, this is the python3 module and not the web2py html module
     import ipaddress
```

### Comparing `pydal-20221110.1/pydal/adapters/__init__.py` & `PyDAL-20230407.2/pydal/adapters/__init__.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/base.py` & `PyDAL-20230407.2/pydal/adapters/base.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/couchdb.py` & `PyDAL-20230407.2/pydal/adapters/couchdb.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/db2.py` & `PyDAL-20230407.2/pydal/adapters/db2.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/firebird.py` & `PyDAL-20230407.2/pydal/adapters/firebird.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/google.py` & `PyDAL-20230407.2/pydal/adapters/google.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/informix.py` & `PyDAL-20230407.2/pydal/adapters/informix.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/ingres.py` & `PyDAL-20230407.2/pydal/adapters/ingres.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/mongo.py` & `PyDAL-20230407.2/pydal/adapters/mongo.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/mssql.py` & `PyDAL-20230407.2/pydal/adapters/mssql.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/mysql.py` & `PyDAL-20230407.2/pydal/adapters/mysql.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/oracle.py` & `PyDAL-20230407.2/pydal/adapters/oracle.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/postgres.py` & `PyDAL-20230407.2/pydal/adapters/postgres.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/sap.py` & `PyDAL-20230407.2/pydal/adapters/sap.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/snowflake.py` & `PyDAL-20230407.2/pydal/adapters/snowflake.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/sqlite.py` & `PyDAL-20230407.2/pydal/adapters/sqlite.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/adapters/teradata.py` & `PyDAL-20230407.2/pydal/adapters/teradata.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/base.py` & `PyDAL-20230407.2/pydal/base.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/connection.py` & `PyDAL-20230407.2/pydal/connection.py`

 * *Files 1% similar despite different names*

```diff
@@ -135,15 +135,15 @@
             except:
                 pass
         #: always unset `connection` attribute
         self.set_connection(None)
 
     @staticmethod
     def close_all_instances(action):
-        """ to close cleanly databases in a multithreaded environment """
+        """to close cleanly databases in a multithreaded environment"""
         dbs = getattr(THREAD_LOCAL, "_pydal_db_instances_", {}).items()
         for db_uid, db_group in dbs:
             for db in db_group:
                 if hasattr(db, "_adapter"):
                     db._adapter.close(action)
         getattr(THREAD_LOCAL, "_pydal_db_instances_", {}).clear()
         getattr(THREAD_LOCAL, "_pydal_db_instances_zombie_", {}).clear()
```

### Comparing `pydal-20221110.1/pydal/contrib/imap_adapter.py` & `PyDAL-20230407.2/pydal/contrib/imap_adapter.py`

 * *Files 0% similar despite different names*

```diff
@@ -403,15 +403,15 @@
 
         text, encoding = decode_header(f)[0]
         if encoding:
             text = text.decode(encoding).encode("utf-8")
         return text
 
     def encode_text(self, text, charset, errors="replace"):
-        """ convert text for mail to unicode"""
+        """convert text for mail to unicode"""
         if text is None:
             text = ""
         if PY2:
             if isinstance(text, str):
                 if charset is None:
                     text = unicode(text, "utf-8", errors)
                 else:
@@ -425,15 +425,15 @@
             return text
 
     def get_charset(self, message):
         charset = message.get_content_charset()
         return charset
 
     def get_mailboxes(self):
-        """ Query the mail database for mailbox names """
+        """Query the mail database for mailbox names"""
         if self.static_names:
             # statically defined mailbox names
             self.connection.mailbox_names = self.static_names
             return self.static_names.keys()
 
         mailboxes_list = self.connection.list()
         self.connection.mailbox_names = dict()
```

### Comparing `pydal-20221110.1/pydal/contrib/ipaddress.py` & `PyDAL-20230407.2/pydal/contrib/ipaddress.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,15 +27,14 @@
     _compat_str = str
     assert bytes != str
 if b"\0"[0] == 0:  # Python 3 semantics
 
     def _compat_bytes_to_byte_vals(byt):
         return byt
 
-
 else:
 
     def _compat_bytes_to_byte_vals(byt):
         return [struct.unpack(b"!B", b)[0] for b in byt]
 
 
 try:
@@ -51,31 +50,30 @@
         return res
 
 
 def _compat_to_bytes(intval, length, endianess):
     assert isinstance(intval, _compat_int_types)
     assert endianess == "big"
     if length == 4:
-        if intval < 0 or intval >= 2 ** 32:
+        if intval < 0 or intval >= 2**32:
             raise struct.error("integer out of range for 'I' format code")
         return struct.pack(b"!I", intval)
     elif length == 16:
-        if intval < 0 or intval >= 2 ** 128:
+        if intval < 0 or intval >= 2**128:
             raise struct.error("integer out of range for 'QQ' format code")
         return struct.pack(b"!QQ", intval >> 64, intval & 0xFFFFFFFFFFFFFFFF)
     else:
         raise NotImplementedError()
 
 
 if hasattr(int, "bit_length"):
     # Not int.bit_length , since that won't work in 2.7 where long exists
     def _compat_bit_length(i):
         return i.bit_length()
 
-
 else:
 
     def _compat_bit_length(i):
         for res in itertools.count():
             if i >> res == 0:
                 return res
 
@@ -1221,15 +1219,15 @@
     addresses and networks.
 
     """
 
     __slots__ = ()
     _version = 4
     # Equivalent to 255.255.255.255 or 32 bits of 1's.
-    _ALL_ONES = (2 ** IPV4LENGTH) - 1
+    _ALL_ONES = (2**IPV4LENGTH) - 1
     _DECIMAL_DIGITS = frozenset("0123456789")
 
     # the valid octets for host and netmasks. only useful for IPv4.
     _valid_mask_octets = frozenset([255, 254, 252, 248, 240, 224, 192, 128, 0])
 
     _max_prefixlen = IPV4LENGTH
     # There are only a handful of valid v4 netmasks, so we cache them all
@@ -1736,15 +1734,15 @@
     The following methods are used by IPv6 objects in both single IP
     addresses and networks.
 
     """
 
     __slots__ = ()
     _version = 6
-    _ALL_ONES = (2 ** IPV6LENGTH) - 1
+    _ALL_ONES = (2**IPV6LENGTH) - 1
     _HEXTET_COUNT = 8
     _HEX_DIGITS = frozenset("0123456789ABCDEFabcdef")
     _max_prefixlen = IPV6LENGTH
 
     # There are only a bunch of valid v6 netmasks, so we cache them all
     # when constructed (see _make_netmask()).
     _netmask_cache = {}
```

### Comparing `pydal-20221110.1/pydal/contrib/mockimaplib.py` & `PyDAL-20230407.2/pydal/contrib/mockimaplib.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/contrib/ordereddict.py` & `PyDAL-20230407.2/pydal/contrib/ordereddict.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/contrib/portalocker.py` & `PyDAL-20230407.2/pydal/contrib/portalocker.py`

 * *Files 1% similar despite different names*

```diff
@@ -134,27 +134,25 @@
         LockFileEx(hfile, flags, 0, 0, 0xFFFF0000, ctypes.byref(overlapped))
 
     def unlock(file):
         hfile = msvcrt.get_osfhandle(file.fileno())
         overlapped = OVERLAPPED()
         UnlockFileEx(hfile, 0, 0, 0xFFFF0000, ctypes.byref(overlapped))
 
-
 elif os_locking == "posix":
     LOCK_EX = fcntl.LOCK_EX
     LOCK_SH = fcntl.LOCK_SH
     LOCK_NB = fcntl.LOCK_NB
 
     def lock(file, flags):
         fcntl.flock(file.fileno(), flags)
 
     def unlock(file):
         fcntl.flock(file.fileno(), fcntl.LOCK_UN)
 
-
 else:
     if os_locking != "gae":
         logger.debug("no file locking, this will cause problems")
 
     LOCK_EX = None
     LOCK_SH = None
     LOCK_NB = None
```

### Comparing `pydal-20221110.1/pydal/contrib/reserved_sql_keywords.py` & `PyDAL-20230407.2/pydal/contrib/reserved_sql_keywords.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/default_validators.py` & `PyDAL-20230407.2/pydal/default_validators.py`

 * *Files 9% similar despite different names*

```diff
@@ -61,19 +61,19 @@
         if field_type in (("string", "text", "password")):
             requires.append(validators.IS_LENGTH(field.length))
         elif field_type == "json":
             requires.append(validators.IS_EMPTY_OR(validators.IS_JSON()))
         elif field_type == "double" or field_type == "float":
             requires.append(validators.IS_FLOAT_IN_RANGE(-1e100, 1e100))
         elif field_type == "integer":
-            requires.append(validators.IS_INT_IN_RANGE(-(2 ** 31), 2 ** 31))
+            requires.append(validators.IS_INT_IN_RANGE(-(2**31), 2**31))
         elif field_type == "bigint":
-            requires.append(validators.IS_INT_IN_RANGE(-(2 ** 63), 2 ** 63))
+            requires.append(validators.IS_INT_IN_RANGE(-(2**63), 2**63))
         elif field_type.startswith("decimal"):
-            requires.append(validators.IS_DECIMAL_IN_RANGE(-(10 ** 10), 10 ** 10))
+            requires.append(validators.IS_DECIMAL_IN_RANGE(-(10**10), 10**10))
         elif field_type == "date":
             requires.append(validators.IS_DATE())
         elif field_type == "time":
             requires.append(validators.IS_TIME())
         elif field_type == "datetime":
             requires.append(validators.IS_DATETIME())
```

### Comparing `pydal-20221110.1/pydal/dialects/__init__.py` & `PyDAL-20230407.2/pydal/dialects/__init__.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/dialects/base.py` & `PyDAL-20230407.2/pydal/dialects/base.py`

 * *Files 1% similar despite different names*

```diff
@@ -497,25 +497,21 @@
                 )
         return "(%s >= %s)" % (
             self.expand(first, query_env=query_env),
             self.expand(second, first.type, query_env=query_env),
         )
 
     def _is_numerical(self, field_type):
-        return (
-            field_type
-            in (
-                "integer",
-                "float",
-                "double",
-                "bigint",
-                "boolean",
-            )
-            or field_type.startswith("decimal")
-        )
+        return field_type in (
+            "integer",
+            "float",
+            "double",
+            "bigint",
+            "boolean",
+        ) or field_type.startswith("decimal")
 
     def add(self, first, second, query_env={}):
         if self._is_numerical(first.type) or isinstance(first.type, Field):
             return "(%s + %s)" % (
                 self.expand(first, query_env=query_env),
                 self.expand(second, first.type, query_env=query_env),
             )
```

### Comparing `pydal-20221110.1/pydal/dialects/couchdb.py` & `PyDAL-20230407.2/pydal/dialects/couchdb.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/dialects/db2.py` & `PyDAL-20230407.2/pydal/dialects/db2.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/dialects/firebird.py` & `PyDAL-20230407.2/pydal/dialects/firebird.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/dialects/google.py` & `PyDAL-20230407.2/pydal/dialects/google.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/dialects/informix.py` & `PyDAL-20230407.2/pydal/dialects/informix.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/dialects/ingres.py` & `PyDAL-20230407.2/pydal/dialects/ingres.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/dialects/mongo.py` & `PyDAL-20230407.2/pydal/dialects/mongo.py`

 * *Files 0% similar despite different names*

```diff
@@ -532,15 +532,17 @@
     def lower(self, first, query_env={}):
         return {"$toLower": self.expand(first, query_env=query_env)}
 
     @needs_aggregation_pipeline
     def upper(self, first, query_env={}):
         return {"$toUpper": self.expand(first, query_env=query_env)}
 
-    def regexp(self, first, second, case_sensitive=True, query_env={}):
+    def regexp(
+        self, first, second, match_parameter=None, case_sensitive=True, query_env={}
+    ):
         """MongoDB provides regular expression capabilities for pattern
         matching strings in queries. MongoDB uses Perl compatible
         regular expressions (i.e. 'PCRE') version 8.36 with UTF-8 support.
         """
         if isinstance(first, Field) and first.type in [
             "integer",
             "bigint",
```

### Comparing `pydal-20221110.1/pydal/dialects/mssql.py` & `PyDAL-20230407.2/pydal/dialects/mssql.py`

 * *Files 0% similar despite different names*

```diff
@@ -193,15 +193,15 @@
         )
 
     def concat(self, *items, **kwargs):
         query_env = kwargs.get("query_env", {})
         tmp = (self.expand(x, "string", query_env=query_env) for x in items)
         return "(%s)" % " + ".join(tmp)
 
-    def regexp(self, first, second, query_env={}):
+    def regexp(self, first, second, match_parameter=None, query_env={}):
         second = self.expand(second, "string", query_env=query_env)
         second = second.replace("\\", "\\\\")
         second = second.replace(r"%", r"\%").replace("*", "%").replace(".", "_")
         return "(%s LIKE %s ESCAPE '\\')" % (
             self.expand(first, query_env=query_env),
             second,
         )
```

### Comparing `pydal-20221110.1/pydal/dialects/mysql.py` & `PyDAL-20230407.2/pydal/dialects/mysql.py`

 * *Files 2% similar despite different names*

```diff
@@ -84,15 +84,15 @@
         return "UNIX_TIMESTAMP(%s)" % self.expand(first, query_env=query_env)
 
     def concat(self, *items, **kwargs):
         query_env = kwargs.get("query_env", {})
         tmp = (self.expand(x, "string", query_env=query_env) for x in items)
         return "CONCAT(%s)" % ",".join(tmp)
 
-    def regexp(self, first, second, query_env={}):
+    def regexp(self, first, second, match_parameter=None, query_env={}):
         return "(%s REGEXP %s)" % (
             self.expand(first, query_env=query_env),
             self.expand(second, "string", query_env=query_env),
         )
 
     def cast(self, first, second, query_env={}):
         if second == "LONGTEXT":
```

### Comparing `pydal-20221110.1/pydal/dialects/oracle.py` & `PyDAL-20230407.2/pydal/dialects/oracle.py`

 * *Files 2% similar despite different names*

```diff
@@ -168,22 +168,24 @@
                 self.expand(first, query_env=query_env),
                 self.expand(second, first.type, query_env=query_env),
             )
         return super(OracleDialect, self).eq(first, second, query_env)
 
     def regexp(self, first, second, match_parameter, query_env={}):
         if match_parameter:
-            _match_parameter = ","+self.expand(match_parameter, "string", query_env=query_env)
+            _match_parameter = "," + self.expand(
+                match_parameter, "string", query_env=query_env
+            )
         else:
             _match_parameter = ""
 
         return "REGEXP_LIKE(%s, %s %s)" % (
             self.expand(first, query_env=query_env),
             self.expand(second, "string", query_env=query_env),
-            _match_parameter
+            _match_parameter,
         )
 
     def insert(self, table, fields, values):
         return "INSERT INTO %s(%s) VALUES (%s);" % (self.quote(table), fields, values)
 
     def insert_empty(self, table):
         return "INSERT INTO %s VALUES (DEFAULT);" % table
```

### Comparing `pydal-20221110.1/pydal/dialects/postgre.py` & `PyDAL-20230407.2/pydal/dialects/postgre.py`

 * *Files 1% similar despite different names*

```diff
@@ -79,15 +79,15 @@
             )
         else:
             return "(%s + %s)" % (
                 self.expand(first, query_env=query_env),
                 self.expand(second, first.type, query_env=query_env),
             )
 
-    def regexp(self, first, second, query_env={}):
+    def regexp(self, first, second, match_parameter=None, query_env={}):
         return "(%s ~ %s)" % (
             self.expand(first, query_env=query_env),
             self.expand(second, "string", query_env=query_env),
         )
 
     def like(self, first, second, escape=None, query_env={}):
         if isinstance(second, Expression):
@@ -299,37 +299,37 @@
         return "ST_AsGeoJSON(%s,%s,%s)" % (
             self.expand(first, query_env=query_env),
             second["precision"],
             second["options"],
         )
 
     def json_key(self, first, key, query_env=None):
-        """ Get the json in key which you can use for more queries """
+        """Get the json in key which you can use for more queries"""
         if isinstance(key, basestring):
             key = self.expand(key, "string", query_env=query_env)
         elif not isinstance(key, integer_types):
             raise TypeError("Key must be a string or int")
         return "%s->%s" % (self.expand(first, query_env=query_env or {}), key)
 
     def json_key_value(self, first, key, query_env=None):
-        """ Get the value int or text in key """
+        """Get the value int or text in key"""
         if isinstance(key, basestring):
             key = self.expand(key, "string", query_env=query_env)
         elif isinstance(key, integer_types):
             key = self.expand(key, "integer", query_env=query_env)
         else:
             raise TypeError("Key must be a string or int")
         return "%s->>%s" % (self.expand(first, query_env=query_env or {}), key)
 
     def json_path(self, first, path, query_env=None):
-        """ Get the json in path which you can use for more queries """
+        """Get the json in path which you can use for more queries"""
         return "%s#>'%s'" % (self.expand(first, query_env=query_env or {}), path)
 
     def json_path_value(self, first, path, query_env=None):
-        """ Get the json in path which you can use for more queries """
+        """Get the json in path which you can use for more queries"""
         return "%s#>>'%s'" % (self.expand(first, query_env=query_env or {}), path)
 
     # JSON Queries
     def json_contains(self, first, jsonvalue, query_env=None):
         # requires jsonb, value is json e.g. '{"country": "Peru"}'
         return "%s::jsonb@>'%s'::jsonb" % (
             self.expand(first, query_env=query_env or {}),
```

### Comparing `pydal-20221110.1/pydal/dialects/sap.py` & `PyDAL-20230407.2/pydal/dialects/sap.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/dialects/snowflake.py` & `PyDAL-20230407.2/pydal/dialects/snowflake.py`

 * *Files 1% similar despite different names*

```diff
@@ -94,15 +94,14 @@
         if limitby:
             (lmin, lmax) = limitby
             if whr:
                 whr2 = whr + " AND w_row > %i" % lmin
             else:
                 whr2 = self.where("w_row > %i" % lmin)
 
-
         return "SELECT%s%s%s %s FROM %s%s%s%s;" % (
             dst,
             limit,
             offset,
             fields,
             tables,
             whr,
@@ -141,15 +140,15 @@
             )
         else:
             return "(%s + %s)" % (
                 self.expand(first, query_env=query_env),
                 self.expand(second, first.type, query_env=query_env),
             )
 
-    def regexp(self, first, second, query_env={}):
+    def regexp(self, first, second, match_parameter=None, query_env={}):
         return "(%s ~ %s)" % (
             self.expand(first, query_env=query_env),
             self.expand(second, "string", query_env=query_env),
         )
 
     def like(self, first, second, escape=None, query_env={}):
         if isinstance(second, Expression):
@@ -228,18 +227,18 @@
 
     def st_asgeojson(self, first, second, query_env={}):
         return "ST_AsGeoJSON(%s,%s,%s)" % (
             self.expand(first, query_env=query_env),
             second["precision"],
             second["options"],
         )
-    
+
     def unquote(self, val):
-        if (val[0] == '"' and val[-1] == '"'):
-            val=val.replace('"','')
+        if val[0] == '"' and val[-1] == '"':
+            val = val.replace('"', "")
         return val
 
     def st_astext(self, first, query_env={}):
         return "ST_AsText(%s)" % self.expand(first, query_env=query_env)
 
     def st_aswkb(self, first, query_env={}):
         return "%s" % self.expand(first, query_env=query_env)
```

### Comparing `pydal-20221110.1/pydal/dialects/sqlite.py` & `PyDAL-20230407.2/pydal/dialects/sqlite.py`

 * *Files 1% similar despite different names*

```diff
@@ -23,15 +23,15 @@
 
     def extract(self, field, what, query_env={}):
         return "web2py_extract('%s', %s)" % (
             what,
             self.expand(field, query_env=query_env),
         )
 
-    def regexp(self, first, second, query_env={}):
+    def regexp(self, first, second, match_parameter=None, query_env={}):
         return "(%s REGEXP %s)" % (
             self.expand(first, query_env=query_env),
             self.expand(second, "string", query_env=query_env),
         )
 
     def select(
         self,
```

### Comparing `pydal-20221110.1/pydal/dialects/teradata.py` & `PyDAL-20230407.2/pydal/dialects/teradata.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/drivers.py` & `PyDAL-20230407.2/pydal/drivers.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/helpers/_internals.py` & `PyDAL-20230407.2/pydal/helpers/_internals.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/helpers/classes.py` & `PyDAL-20230407.2/pydal/helpers/classes.py`

 * *Files 1% similar despite different names*

```diff
@@ -484,16 +484,19 @@
     @staticmethod
     def try_create_web2py_filesystem(db):
         if db._uri not in DatabaseStoredFile.web2py_filesystems:
             if db._adapter.dbengine not in ("mysql", "postgres", "sqlite"):
                 raise NotImplementedError(
                     "DatabaseStoredFile only supported by mysql, potresql, sqlite"
                 )
-            blobType = "BYTEA" if db._adapter.dbengine == "postgres" else "BLOB" 
-            sql = "CREATE TABLE IF NOT EXISTS web2py_filesystem (path VARCHAR(255), content %(blobType)s, PRIMARY KEY(path));" % {"blobType": blobType}
+            blobType = "BYTEA" if db._adapter.dbengine == "postgres" else "BLOB"
+            sql = (
+                "CREATE TABLE IF NOT EXISTS web2py_filesystem (path VARCHAR(255), content %(blobType)s, PRIMARY KEY(path));"
+                % {"blobType": blobType}
+            )
             if db._adapter.dbengine == "mysql":
                 sql = sql[:-1] + " ENGINE=InnoDB;"
             db.executesql(sql)
             DatabaseStoredFile.web2py_filesystems.add(db._uri)
 
     def __init__(self, db, filename, mode):
         if db._adapter.dbengine not in ("mysql", "postgres", "sqlite"):
@@ -543,16 +546,19 @@
         self.data += data
 
     def close_connection(self):
         if self.db is not None:
             self.db.executesql(
                 "DELETE FROM web2py_filesystem WHERE path='%s'" % self.filename
             )
-            placeholder = "?" if self.db._adapter.dbengine == "sqlite" else "%s" 
-            query = "INSERT INTO web2py_filesystem(path,content) VALUES (%(placeholder)s, %(placeholder)s)" % {"placeholder": placeholder}
+            placeholder = "?" if self.db._adapter.dbengine == "sqlite" else "%s"
+            query = (
+                "INSERT INTO web2py_filesystem(path,content) VALUES (%(placeholder)s, %(placeholder)s)"
+                % {"placeholder": placeholder}
+            )
             args = (self.filename, self.data)
             self.db.executesql(query, args)
             self.db.commit()
             self.db = None
 
     def close(self):
         self.close_connection()
```

### Comparing `pydal-20221110.1/pydal/helpers/gae.py` & `PyDAL-20230407.2/pydal/helpers/gae.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/helpers/methods.py` & `PyDAL-20230407.2/pydal/helpers/methods.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/helpers/regex.py` & `PyDAL-20230407.2/pydal/helpers/regex.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/helpers/rest.py` & `PyDAL-20230407.2/pydal/helpers/rest.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/helpers/serializers.py` & `PyDAL-20230407.2/pydal/helpers/serializers.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/migrator.py` & `PyDAL-20230407.2/pydal/migrator.py`

 * *Files 2% similar despite different names*

```diff
@@ -313,16 +313,16 @@
             )
         else:
             query = "CREATE TABLE %s(\n    %s\n)%s" % (table_rname, fields, other)
 
         uri = self.adapter.uri
         if isinstance(self, InDBMigrator):
             # No filesystem path should be used when storing table details in database.
-            dbpath = ''
-            self.adapter.folder = ''
+            dbpath = ""
+            self.adapter.folder = ""
         elif uri.startswith("sqlite:///") or uri.startswith("spatialite:///"):
             if PY2:
                 path_encoding = (
                     sys.getfilesystemencoding()
                     or locale.getdefaultlocale()[1]
                     or "utf8"
                 )
@@ -582,15 +582,20 @@
 
     def log(self, message, table=None):
         isabs = None
         logfilename = self.adapter.adapter_args.get("logfile", "sql.log")
         writelog = bool(logfilename)
         if writelog:
             isabs = os.path.isabs(logfilename)
-        if table and table._dbt and writelog and (self.adapter.folder or isinstance(self, InDBMigrator)):
+        if (
+            table
+            and table._dbt
+            and writelog
+            and (self.adapter.folder or isinstance(self, InDBMigrator))
+        ):
             if isabs:
                 table._loggername = logfilename
             else:
                 table._loggername = pjoin(self.adapter.folder, logfilename)
             logfile = self.file_open(table._loggername, "ab")
             logfile.write(to_bytes(message))
             self.file_close(logfile)
```

### Comparing `pydal-20221110.1/pydal/objects.py` & `PyDAL-20230407.2/pydal/objects.py`

 * *Files 1% similar despite different names*

```diff
@@ -42,16 +42,16 @@
 if not PY2:
     unicode = str
 
 DEFAULTLENGTH = {
     "string": 512,
     "password": 512,
     "upload": 512,
-    "text": 2 ** 15,
-    "blob": 2 ** 31,
+    "text": 2**15,
+    "blob": 2**31,
 }
 
 DEFAULT_REGEX = {
     "id": r"[1-9]\d*",
     "decimal": r"\d{1,10}\.\d{2}",
     "integer": r"[+-]?\d*",
     "float": r"[+-]?\d*(\.\d*)?",
@@ -596,15 +596,15 @@
                 (k, v)
                 for (k, v) in iteritems(record)
                 if k in self.fields and (getattr(self, k).type != "id" or id)
             ]
         )
 
     def _build_query(self, key):
-        """ for keyed table only """
+        """for keyed table only"""
         query = None
         for k, v in iteritems(key):
             if k in self._primarykey:
                 if query:
                     query = query & (getattr(self, k) == v)
                 else:
                     query = getattr(self, k) == v
@@ -857,59 +857,59 @@
             for f in self._after_insert:
                 f(row, ret)
         return ret
 
     def _validate_fields(self, fields, defattr="default", id=None):
         from .validators import CRYPT
 
-        response = Row()
-        response.id, response.errors, new_fields = None, Row(), Row()
+        response = {"id": None, "errors": {}}
+        new_fields = Row()
         for field in self:
             # we validate even if not passed in case it is required
             error = default = None
             if not field.required and not field.compute:
                 default = getattr(field, defattr)
                 if callable(default):
                     default = default()
             if not field.compute:
                 ovalue = fields.get(field.name, default)
                 value, error = field.validate(ovalue, id)
             if error:
-                response.errors[field.name] = "%s" % error
+                response["errors"][field.name] = "%s" % error
             elif field.type == "password" and ovalue == CRYPT.STARS:
                 pass
             elif field.name in fields:
                 # only write if the field was passed and no error
                 new_fields[field.name] = value
         return response, new_fields
 
     def validate_and_insert(self, **fields):
         response, new_fields = self._validate_fields(fields, "default")
-        if not response.errors:
-            response.id = self.insert(**new_fields)
+        if not response.get("errors"):
+            response["id"] = self.insert(**new_fields)
         return response
 
     def validate_and_update(self, _key, **fields):
         record = self(**_key) if isinstance(_key, dict) else self(_key)
         response, new_fields = self._validate_fields(fields, "update", record.id)
         #: do the update
-        if not response.errors and record:
+        if not response.get("errors") and record:
             if "_id" in self:
                 myset = self._db(self._id == record[self._id.name])
             else:
                 query = None
                 for key, value in iteritems(_key):
                     if query is None:
                         query = getattr(self, key) == value
                     else:
                         query = query & (getattr(self, key) == value)
                 myset = self._db(query)
-            response.updated = myset.update(**new_fields)
+            response["updated"] = myset.update(**new_fields)
         if record:
-            response.id = record.id
+            response["id"] = record.id
         return response
 
     def update_or_insert(self, _key=DEFAULT, **values):
         if _key is DEFAULT:
             record = self(**values)
         elif isinstance(_key, dict):
             record = self(**_key)
@@ -1575,16 +1575,18 @@
     def like(self, value, case_sensitive=True, escape=None):
         op = case_sensitive and self._dialect.like or self._dialect.ilike
         return Query(self.db, op, self, value, escape=escape)
 
     def ilike(self, value, escape=None):
         return self.like(value, case_sensitive=False, escape=escape)
 
-    def regexp(self, value,match_parameter=None):
-        return Query(self.db, self._dialect.regexp, self, value, match_parameter=match_parameter)
+    def regexp(self, value, match_parameter=None):
+        return Query(
+            self.db, self._dialect.regexp, self, value, match_parameter=match_parameter
+        )
 
     def belongs(self, *value, **kwattr):
         """
         Accepts the following inputs::
 
            field.belongs(1, 2)
            field.belongs((1, 2))
@@ -1633,25 +1635,21 @@
                 for v in value
                 if str(v)
             ]
             if not subqueries:
                 return self.contains("")
             else:
                 return reduce(all and AND or OR, subqueries)
-        if (
-            self.type
-            not in (
-                "string",
-                "text",
-                "json",
-                "jsonb",
-                "upload",
-            )
-            and not self.type.startswith("list:")
-        ):
+        if self.type not in (
+            "string",
+            "text",
+            "json",
+            "jsonb",
+            "upload",
+        ) and not self.type.startswith("list:"):
             raise SyntaxError("contains used with incompatible field type")
         return Query(
             self.db, self._dialect.contains, self, value, case_sensitive=case_sensitive
         )
 
     def with_alias(self, alias):
         return Expression(self.db, self._dialect._as, self, alias, self.type)
@@ -2068,15 +2066,17 @@
             filename = file.name
         filename = os.path.basename(filename.replace("/", os.sep).replace("\\", os.sep))
         m = re.search(REGEX_UPLOAD_EXTENSION, filename)
         extension = m and m.group(1) or "txt"
         uuid_key = self._db.uuid().replace("-", "")[-16:] if self._db else uuidstr()
         encoded_filename = to_native(base64.urlsafe_b64encode(to_bytes(filename)))
         newfilename = "%s.%s.%s.%s" % (
-            self._tablename if '_tablename' in self.__dir__() and self._tablename else 'no_table',
+            self._tablename
+            if "_tablename" in self.__dir__() and self._tablename
+            else "no_table",
             self.name,
             uuid_key,
             encoded_filename,
         )
         newfilename = (
             newfilename[: (self.length - 1 - len(extension))] + "." + extension
         )
```

### Comparing `pydal-20221110.1/pydal/parsers/__init__.py` & `PyDAL-20230407.2/pydal/parsers/__init__.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/parsers/base.py` & `PyDAL-20230407.2/pydal/parsers/base.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/parsers/mongo.py` & `PyDAL-20230407.2/pydal/parsers/mongo.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/parsers/oracle.py` & `PyDAL-20230407.2/pydal/parsers/oracle.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/parsers/postgre.py` & `PyDAL-20230407.2/pydal/parsers/postgre.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/parsers/sqlite.py` & `PyDAL-20230407.2/pydal/parsers/sqlite.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/representers/__init__.py` & `PyDAL-20230407.2/pydal/representers/__init__.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/representers/base.py` & `PyDAL-20230407.2/pydal/representers/base.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/representers/couchdb.py` & `PyDAL-20230407.2/pydal/representers/couchdb.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/representers/db2.py` & `PyDAL-20230407.2/pydal/representers/db2.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/representers/google.py` & `PyDAL-20230407.2/pydal/representers/google.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/representers/informix.py` & `PyDAL-20230407.2/pydal/representers/informix.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/representers/mongo.py` & `PyDAL-20230407.2/pydal/representers/mongo.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/representers/mssql.py` & `PyDAL-20230407.2/pydal/representers/mssql.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/representers/oracle.py` & `PyDAL-20230407.2/pydal/representers/oracle.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/representers/postgre.py` & `PyDAL-20230407.2/pydal/representers/postgre.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/representers/sqlite.py` & `PyDAL-20230407.2/pydal/representers/sqlite.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/restapi.py` & `PyDAL-20230407.2/pydal/restapi.py`

 * *Files 0% similar despite different names*

```diff
@@ -249,15 +249,15 @@
             table = self.db[tablename]
             deleted = self.db(table._id == id).delete()
             if not deleted:
                 raise NotFound("Item not found")
             return {"deleted": deleted}
 
     def table_model(self, table, fieldnames):
-        """ converts a table into its form template """
+        """converts a table into its form template"""
         items = []
         fields = post_fields = put_fields = table.fields
         if self.policy:
             fields = self.policy.allowed_fieldnames(table, method="GET")
             put_fields = self.policy.allowed_fieldnames(table, method="PUT")
             post_fields = self.policy.allowed_fieldnames(table, method="POST")
         for fieldname in fields:
```

### Comparing `pydal-20221110.1/pydal/tools/tags.py` & `PyDAL-20230407.2/pydal/tools/tags.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/utils.py` & `PyDAL-20230407.2/pydal/utils.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/pydal/validators.py` & `PyDAL-20230407.2/pydal/validators.py`

 * *Files 0% similar despite different names*

```diff
@@ -2865,7061 +2865,7061 @@
 0000b300: 2331 0a23 2055 7365 2074 6869 7320 7265  #1.# Use this re
 0000b310: 6765 7820 746f 2073 706c 6974 2074 6865  gex to split the
 0000b320: 2061 7574 686f 7269 7479 2063 6f6d 706f   authority compo
 0000b330: 6e65 6e74 206f 6620 6120 756e 6963 6f64  nent of a unicod
 0000b340: 6520 5552 4c20 696e 746f 0a23 2069 7473  e URL into.# its
 0000b350: 2063 6f6d 706f 6e65 6e74 206c 6162 656c   component label
 0000b360: 730a 5245 4745 585f 4155 5448 4f52 4954  s.REGEX_AUTHORIT
-0000b370: 595f 5350 4c49 5454 4552 203d 2075 225b  Y_SPLITTER = u"[
-0000b380: 5c75 3030 3265 5c75 3330 3032 5c75 6666  \u002e\u3002\uff
-0000b390: 3065 5c75 6666 3631 5d22 0a0a 0a64 6566  0e\uff61]"...def
-0000b3a0: 2065 7363 6170 655f 756e 6963 6f64 6528   escape_unicode(
-0000b3b0: 7374 7269 6e67 293a 0a0a 2020 2020 2222  string):..    ""
-0000b3c0: 220a 2020 2020 436f 6e76 6572 7473 2061  ".    Converts a
-0000b3d0: 2075 6e69 636f 6465 2073 7472 696e 6720   unicode string 
-0000b3e0: 696e 746f 2055 532d 4153 4349 492c 2075  into US-ASCII, u
-0000b3f0: 7369 6e67 2061 2073 696d 706c 6520 636f  sing a simple co
-0000b400: 6e76 6572 7369 6f6e 2073 6368 656d 652e  nversion scheme.
-0000b410: 0a20 2020 2045 6163 6820 756e 6963 6f64  .    Each unicod
-0000b420: 6520 6368 6172 6163 7465 7220 7468 6174  e character that
-0000b430: 2064 6f65 7320 6e6f 7420 6861 7665 2061   does not have a
-0000b440: 2055 532d 4153 4349 4920 6571 7569 7661   US-ASCII equiva
-0000b450: 6c65 6e74 2069 730a 2020 2020 636f 6e76  lent is.    conv
-0000b460: 6572 7465 6420 696e 746f 2061 2055 524c  erted into a URL
-0000b470: 2065 7363 6170 6564 2066 6f72 6d20 6261   escaped form ba
-0000b480: 7365 6420 6f6e 2069 7473 2068 6578 6164  sed on its hexad
-0000b490: 6563 696d 616c 2076 616c 7565 2e0a 2020  ecimal value..  
-0000b4a0: 2020 466f 7220 6578 616d 706c 652c 2074    For example, t
-0000b4b0: 6865 2075 6e69 636f 6465 2063 6861 7261  he unicode chara
-0000b4c0: 6374 6572 2027 5c5c 7534 6538 3627 2077  cter '\\u4e86' w
-0000b4d0: 696c 6c20 6265 636f 6d65 2074 6865 2073  ill become the s
-0000b4e0: 7472 696e 6720 2725 3465 2538 3627 0a0a  tring '%4e%86'..
-0000b4f0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0000b500: 2020 7374 7269 6e67 3a20 756e 6963 6f64    string: unicod
-0000b510: 6520 7374 7269 6e67 2c20 7468 6520 756e  e string, the un
-0000b520: 6963 6f64 6520 7374 7269 6e67 2074 6f20  icode string to 
-0000b530: 636f 6e76 6572 7420 696e 746f 2061 6e0a  convert into an.
-0000b540: 2020 2020 2020 2020 2020 2020 6573 6361              esca
-0000b550: 7065 6420 5553 2d41 5343 4949 2066 6f72  ped US-ASCII for
-0000b560: 6d0a 0a20 2020 2052 6574 7572 6e73 3a0a  m..    Returns:.
-0000b570: 2020 2020 2020 2020 7374 7269 6e67 3a20          string: 
-0000b580: 7468 6520 5553 2d41 5343 4949 2065 7363  the US-ASCII esc
-0000b590: 6170 6564 2066 6f72 6d20 6f66 2074 6865  aped form of the
-0000b5a0: 2069 6e70 7574 7465 6420 7374 7269 6e67   inputted string
-0000b5b0: 0a0a 2020 2020 4061 7574 686f 723a 204a  ..    @author: J
-0000b5c0: 6f6e 6174 6861 6e20 4265 6e6e 0a20 2020  onathan Benn.   
-0000b5d0: 2022 2222 0a20 2020 2072 6574 7572 6e56   """.    returnV
-0000b5e0: 616c 7565 203d 2053 7472 696e 6749 4f28  alue = StringIO(
-0000b5f0: 290a 0a20 2020 2066 6f72 2063 6861 7261  )..    for chara
-0000b600: 6374 6572 2069 6e20 7374 7269 6e67 3a0a  cter in string:.
-0000b610: 2020 2020 2020 2020 636f 6465 203d 206f          code = o
-0000b620: 7264 2863 6861 7261 6374 6572 290a 2020  rd(character).  
-0000b630: 2020 2020 2020 6966 2063 6f64 6520 3e20        if code > 
-0000b640: 3078 3746 3a0a 2020 2020 2020 2020 2020  0x7F:.          
-0000b650: 2020 6865 7843 6f64 6520 3d20 6865 7828    hexCode = hex(
-0000b660: 636f 6465 290a 2020 2020 2020 2020 2020  code).          
-0000b670: 2020 7265 7475 726e 5661 6c75 652e 7772    returnValue.wr
-0000b680: 6974 6528 2225 2220 2b20 6865 7843 6f64  ite("%" + hexCod
-0000b690: 655b 323a 345d 202b 2022 2522 202b 2068  e[2:4] + "%" + h
-0000b6a0: 6578 436f 6465 5b34 3a36 5d29 0a20 2020  exCode[4:6]).   
-0000b6b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000b6c0: 2020 2020 2020 2072 6574 7572 6e56 616c         returnVal
-0000b6d0: 7565 2e77 7269 7465 2863 6861 7261 6374  ue.write(charact
-0000b6e0: 6572 290a 0a20 2020 2072 6574 7572 6e20  er)..    return 
-0000b6f0: 7265 7475 726e 5661 6c75 652e 6765 7476  returnValue.getv
-0000b700: 616c 7565 2829 0a0a 0a64 6566 2075 6e69  alue()...def uni
-0000b710: 636f 6465 5f74 6f5f 6173 6369 695f 6175  code_to_ascii_au
-0000b720: 7468 6f72 6974 7928 6175 7468 6f72 6974  thority(authorit
-0000b730: 7929 3a0a 2020 2020 2222 220a 2020 2020  y):.    """.    
-0000b740: 466f 6c6c 6f77 7320 7468 6520 7374 6570  Follows the step
-0000b750: 7320 696e 2052 4643 2033 3439 302c 2053  s in RFC 3490, S
-0000b760: 6563 7469 6f6e 2034 2074 6f20 636f 6e76  ection 4 to conv
-0000b770: 6572 7420 6120 756e 6963 6f64 6520 6175  ert a unicode au
-0000b780: 7468 6f72 6974 790a 2020 2020 7374 7269  thority.    stri
-0000b790: 6e67 2069 6e74 6f20 6974 7320 4153 4349  ng into its ASCI
-0000b7a0: 4920 6571 7569 7661 6c65 6e74 2e0a 2020  I equivalent..  
-0000b7b0: 2020 466f 7220 6578 616d 706c 652c 2075    For example, u
-0000b7c0: 2777 7777 2e41 6c6c 6961 6e63 6566 7261  'www.Alliancefra
-0000b7d0: 6e5c 5c78 6537 6169 7365 2e6e 7527 2077  n\\xe7aise.nu' w
-0000b7e0: 696c 6c20 6265 2063 6f6e 7665 7274 6564  ill be converted
-0000b7f0: 2069 6e74 6f0a 2020 2020 2777 7777 2e78   into.    'www.x
-0000b800: 6e2d 2d61 6c6c 6961 6e63 6566 7261 6e61  n--alliancefrana
-0000b810: 6973 652d 6e70 622e 6e75 270a 0a20 2020  ise-npb.nu'..   
-0000b820: 2041 7267 733a 0a20 2020 2020 2020 2061   Args:.        a
-0000b830: 7574 686f 7269 7479 3a20 756e 6963 6f64  uthority: unicod
-0000b840: 6520 7374 7269 6e67 2c20 7468 6520 5552  e string, the UR
-0000b850: 4c20 6175 7468 6f72 6974 7920 636f 6d70  L authority comp
-0000b860: 6f6e 656e 7420 746f 2063 6f6e 7665 7274  onent to convert
-0000b870: 2c0a 2020 2020 2020 2020 2020 2020 652e  ,.            e.
-0000b880: 672e 2075 2777 7777 2e41 6c6c 6961 6e63  g. u'www.Allianc
-0000b890: 6566 7261 6e5c 5c78 6537 6169 7365 2e6e  efran\\xe7aise.n
-0000b8a0: 7527 0a0a 2020 2020 5265 7475 726e 733a  u'..    Returns:
-0000b8b0: 0a20 2020 2020 2020 2073 7472 696e 673a  .        string:
-0000b8c0: 2074 6865 2055 532d 4153 4349 4920 6368   the US-ASCII ch
-0000b8d0: 6172 6163 7465 7220 6571 7569 7661 6c65  aracter equivale
-0000b8e0: 6e74 2074 6f20 7468 6520 696e 7075 7474  nt to the inputt
-0000b8f0: 6564 2061 7574 686f 7269 7479 2c0a 2020  ed authority,.  
-0000b900: 2020 2020 2020 2020 2020 2065 2e67 2e20             e.g. 
-0000b910: 2777 7777 2e78 6e2d 2d61 6c6c 6961 6e63  'www.xn--allianc
-0000b920: 6566 7261 6e61 6973 652d 6e70 622e 6e75  efranaise-npb.nu
-0000b930: 270a 0a20 2020 2052 6169 7365 733a 0a20  '..    Raises:. 
-0000b940: 2020 2020 2020 2045 7863 6570 7469 6f6e         Exception
-0000b950: 3a20 6966 2074 6865 2066 756e 6374 696f  : if the functio
-0000b960: 6e20 6973 206e 6f74 2061 626c 6520 746f  n is not able to
-0000b970: 2063 6f6e 7665 7274 2074 6865 2069 6e70   convert the inp
-0000b980: 7574 7465 640a 2020 2020 2020 2020 2020  utted.          
-0000b990: 2020 6175 7468 6f72 6974 790a 0a20 2020    authority..   
-0000b9a0: 2040 6175 7468 6f72 3a20 4a6f 6e61 7468   @author: Jonath
-0000b9b0: 616e 2042 656e 6e0a 2020 2020 2222 220a  an Benn.    """.
-0000b9c0: 2020 2020 2320 5246 4320 3334 3930 2c20      # RFC 3490, 
-0000b9d0: 5365 6374 696f 6e20 342c 2053 7465 7020  Section 4, Step 
-0000b9e0: 310a 2020 2020 2320 5468 6520 656e 636f  1.    # The enco
-0000b9f0: 6469 6e67 732e 6964 6e61 2050 7974 686f  dings.idna Pytho
-0000ba00: 6e20 6d6f 6475 6c65 2061 7373 756d 6573  n module assumes
-0000ba10: 2074 6861 7420 416c 6c6f 7755 6e61 7373   that AllowUnass
-0000ba20: 6967 6e65 6420 3d3d 2054 7275 650a 0a20  igned == True.. 
-0000ba30: 2020 2023 2052 4643 2033 3439 302c 2053     # RFC 3490, S
-0000ba40: 6563 7469 6f6e 2034 2c20 5374 6570 2032  ection 4, Step 2
-0000ba50: 0a20 2020 206c 6162 656c 7320 3d20 7265  .    labels = re
-0000ba60: 2e73 706c 6974 2852 4547 4558 5f41 5554  .split(REGEX_AUT
-0000ba70: 484f 5249 5459 5f53 504c 4954 5445 522c  HORITY_SPLITTER,
-0000ba80: 2061 7574 686f 7269 7479 290a 0a20 2020   authority)..   
-0000ba90: 2023 2052 4643 2033 3439 302c 2053 6563   # RFC 3490, Sec
-0000baa0: 7469 6f6e 2034 2c20 5374 6570 2033 0a20  tion 4, Step 3. 
-0000bab0: 2020 2023 2054 6865 2065 6e63 6f64 696e     # The encodin
-0000bac0: 6773 2e69 646e 6120 5079 7468 6f6e 206d  gs.idna Python m
-0000bad0: 6f64 756c 6520 6173 7375 6d65 7320 7468  odule assumes th
-0000bae0: 6174 2055 7365 5354 4433 4153 4349 4952  at UseSTD3ASCIIR
-0000baf0: 756c 6573 203d 3d20 4661 6c73 650a 0a20  ules == False.. 
-0000bb00: 2020 2023 2052 4643 2033 3439 302c 2053     # RFC 3490, S
-0000bb10: 6563 7469 6f6e 2034 2c20 5374 6570 2034  ection 4, Step 4
-0000bb20: 0a20 2020 2023 2057 6520 7573 6520 7468  .    # We use th
-0000bb30: 6520 546f 4153 4349 4920 6f70 6572 6174  e ToASCII operat
-0000bb40: 696f 6e20 6265 6361 7573 6520 7765 2061  ion because we a
-0000bb50: 7265 2061 626f 7574 2074 6f20 7075 7420  re about to put 
-0000bb60: 7468 6520 6175 7468 6f72 6974 790a 2020  the authority.  
-0000bb70: 2020 2320 696e 746f 2061 6e20 4944 4e2d    # into an IDN-
-0000bb80: 756e 6177 6172 6520 736c 6f74 0a20 2020  unaware slot.   
-0000bb90: 2061 7363 6969 4c61 6265 6c73 203d 205b   asciiLabels = [
-0000bba0: 5d0a 2020 2020 666f 7220 6c61 6265 6c20  ].    for label 
-0000bbb0: 696e 206c 6162 656c 733a 0a20 2020 2020  in labels:.     
-0000bbc0: 2020 2069 6620 6c61 6265 6c3a 0a20 2020     if label:.   
-0000bbd0: 2020 2020 2020 2020 2061 7363 6969 4c61           asciiLa
-0000bbe0: 6265 6c73 2e61 7070 656e 6428 746f 5f6e  bels.append(to_n
-0000bbf0: 6174 6976 6528 656e 636f 6469 6e67 732e  ative(encodings.
-0000bc00: 6964 6e61 2e54 6f41 5343 4949 286c 6162  idna.ToASCII(lab
-0000bc10: 656c 2929 290a 2020 2020 2020 2020 656c  el))).        el
-0000bc20: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000bc30: 2320 656e 636f 6469 6e67 732e 6964 6e61  # encodings.idna
-0000bc40: 2e54 6f41 5343 4949 2064 6f65 7320 6e6f  .ToASCII does no
-0000bc50: 7420 6163 6365 7074 2061 6e20 656d 7074  t accept an empt
-0000bc60: 7920 7374 7269 6e67 2c20 6275 740a 2020  y string, but.  
-0000bc70: 2020 2020 2020 2020 2020 2320 6974 2069            # it i
-0000bc80: 7320 6e65 6365 7373 6172 7920 666f 7220  s necessary for 
-0000bc90: 7573 2074 6f20 616c 6c6f 7720 666f 7220  us to allow for 
-0000bca0: 656d 7074 7920 6c61 6265 6c73 2073 6f20  empty labels so 
-0000bcb0: 7468 6174 2077 650a 2020 2020 2020 2020  that we.        
-0000bcc0: 2020 2020 2320 646f 6e27 7420 6d6f 6469      # don't modi
-0000bcd0: 6679 2074 6865 2055 524c 0a20 2020 2020  fy the URL.     
-0000bce0: 2020 2020 2020 2061 7363 6969 4c61 6265         asciiLabe
-0000bcf0: 6c73 2e61 7070 656e 6428 2222 290a 2020  ls.append("").  
-0000bd00: 2020 2320 5246 4320 3334 3930 2c20 5365    # RFC 3490, Se
-0000bd10: 6374 696f 6e20 342c 2053 7465 7020 350a  ction 4, Step 5.
-0000bd20: 2020 2020 7265 7475 726e 2073 7472 2872      return str(r
-0000bd30: 6564 7563 6528 6c61 6d62 6461 2078 2c20  educe(lambda x, 
-0000bd40: 793a 2078 202b 2075 6e69 6368 7228 3078  y: x + unichr(0x
-0000bd50: 3030 3245 2920 2b20 792c 2061 7363 6969  002E) + y, ascii
-0000bd60: 4c61 6265 6c73 2929 0a0a 0a64 6566 2075  Labels))...def u
-0000bd70: 6e69 636f 6465 5f74 6f5f 6173 6369 695f  nicode_to_ascii_
-0000bd80: 7572 6c28 7572 6c2c 2070 7265 7065 6e64  url(url, prepend
-0000bd90: 5f73 6368 656d 6529 3a0a 2020 2020 2222  _scheme):.    ""
-0000bda0: 220a 2020 2020 436f 6e76 6572 7473 2074  ".    Converts t
-0000bdb0: 6865 2069 6e70 7574 7465 6420 756e 6963  he inputted unic
-0000bdc0: 6f64 6520 7572 6c20 696e 746f 2061 2055  ode url into a U
-0000bdd0: 532d 4153 4349 4920 6571 7569 7661 6c65  S-ASCII equivale
-0000bde0: 6e74 2e20 5468 6973 2066 756e 6374 696f  nt. This functio
-0000bdf0: 6e0a 2020 2020 676f 6573 2061 206c 6974  n.    goes a lit
-0000be00: 746c 6520 6265 796f 6e64 2052 4643 2033  tle beyond RFC 3
-0000be10: 3439 302c 2077 6869 6368 2069 7320 6c69  490, which is li
-0000be20: 6d69 7465 6420 696e 2073 636f 7065 2074  mited in scope t
-0000be30: 6f20 7468 6520 646f 6d61 696e 206e 616d  o the domain nam
-0000be40: 650a 2020 2020 2861 7574 686f 7269 7479  e.    (authority
-0000be50: 2920 6f6e 6c79 2e20 4865 7265 2c20 7468  ) only. Here, th
-0000be60: 6520 6675 6e63 7469 6f6e 616c 6974 7920  e functionality 
-0000be70: 6973 2065 7870 616e 6465 6420 746f 2077  is expanded to w
-0000be80: 6861 7420 7761 7320 6f62 7365 7276 6564  hat was observed
-0000be90: 0a20 2020 206f 6e20 5769 6b69 7065 6469  .    on Wikipedi
-0000bea0: 6120 6f6e 2032 3030 392d 4a61 6e2d 3232  a on 2009-Jan-22
-0000beb0: 3a0a 0a20 2020 2020 2020 436f 6d70 6f6e  :..       Compon
-0000bec0: 656e 7420 2020 2043 616e 2055 7365 2055  ent    Can Use U
-0000bed0: 6e69 636f 6465 3f0a 2020 2020 2020 202d  nicode?.       -
-0000bee0: 2d2d 2d2d 2d2d 2d2d 2020 2020 2d2d 2d2d  --------    ----
-0000bef0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0000bf00: 2020 2020 7363 6865 6d65 2020 2020 2020      scheme      
-0000bf10: 204e 6f0a 2020 2020 2020 2061 7574 686f   No.       autho
-0000bf20: 7269 7479 2020 2020 5965 730a 2020 2020  rity    Yes.    
-0000bf30: 2020 2070 6174 6820 2020 2020 2020 2020     path         
-0000bf40: 5965 730a 2020 2020 2020 2071 7565 7279  Yes.       query
-0000bf50: 2020 2020 2020 2020 5965 730a 2020 2020          Yes.    
-0000bf60: 2020 2066 7261 676d 656e 7420 2020 2020     fragment     
-0000bf70: 4e6f 0a0a 2020 2020 5468 6520 6175 7468  No..    The auth
-0000bf80: 6f72 6974 7920 636f 6d70 6f6e 656e 7420  ority component 
-0000bf90: 6765 7473 2063 6f6e 7665 7274 6564 2074  gets converted t
-0000bfa0: 6f20 7075 6e79 636f 6465 2c20 6275 7420  o punycode, but 
-0000bfb0: 6f63 6375 7272 656e 6365 7320 6f66 0a20  occurrences of. 
-0000bfc0: 2020 2075 6e69 636f 6465 2069 6e20 6f74     unicode in ot
-0000bfd0: 6865 7220 636f 6d70 6f6e 656e 7473 2067  her components g
-0000bfe0: 6574 2063 6f6e 7665 7274 6564 2069 6e74  et converted int
-0000bff0: 6f20 6120 7061 6972 206f 6620 5552 4920  o a pair of URI 
-0000c000: 6573 6361 7065 7320 2877 650a 2020 2020  escapes (we.    
-0000c010: 6173 7375 6d65 2034 2d62 7974 6520 756e  assume 4-byte un
-0000c020: 6963 6f64 6529 2e20 452e 672e 2074 6865  icode). E.g. the
-0000c030: 2075 6e69 636f 6465 2063 6861 7261 6374   unicode charact
-0000c040: 6572 2055 2b34 4532 4420 7769 6c6c 2062  er U+4E2D will b
-0000c050: 650a 2020 2020 636f 6e76 6572 7465 6420  e.    converted 
-0000c060: 696e 746f 2027 2534 4525 3244 272e 2054  into '%4E%2D'. T
-0000c070: 6573 7469 6e67 2077 6974 6820 4669 7265  esting with Fire
-0000c080: 666f 7820 7633 2e30 2e35 2068 6173 2073  fox v3.0.5 has s
-0000c090: 686f 776e 2074 6861 7420 6974 2063 616e  hown that it can
-0000c0a0: 0a20 2020 2075 6e64 6572 7374 616e 6420  .    understand 
-0000c0b0: 7468 6973 206b 696e 6420 6f66 2055 5249  this kind of URI
-0000c0c0: 2065 6e63 6f64 696e 672e 0a0a 2020 2020   encoding...    
-0000c0d0: 4172 6773 3a0a 2020 2020 2020 2020 7572  Args:.        ur
-0000c0e0: 6c3a 2075 6e69 636f 6465 2073 7472 696e  l: unicode strin
-0000c0f0: 672c 2074 6865 2055 524c 2074 6f20 636f  g, the URL to co
-0000c100: 6e76 6572 7420 6672 6f6d 2075 6e69 636f  nvert from unico
-0000c110: 6465 2069 6e74 6f20 5553 2d41 5343 4949  de into US-ASCII
-0000c120: 0a20 2020 2020 2020 2070 7265 7065 6e64  .        prepend
-0000c130: 5f73 6368 656d 653a 2073 7472 696e 672c  _scheme: string,
-0000c140: 2061 2070 726f 746f 636f 6c20 7363 6865   a protocol sche
-0000c150: 6d65 2074 6f20 7072 6570 656e 6420 746f  me to prepend to
-0000c160: 2074 6865 2055 524c 2069 660a 2020 2020   the URL if.    
-0000c170: 2020 2020 2020 2020 7765 2772 6520 6861          we're ha
-0000c180: 7669 6e67 2074 726f 7562 6c65 2070 6172  ving trouble par
-0000c190: 7369 6e67 2069 742e 0a20 2020 2020 2020  sing it..       
-0000c1a0: 2020 2020 2065 2e67 2e20 2268 7474 7022       e.g. "http"
-0000c1b0: 2e20 496e 7075 7420 4e6f 6e65 2074 6f20  . Input None to 
-0000c1c0: 6469 7361 626c 6520 7468 6973 2066 756e  disable this fun
-0000c1d0: 6374 696f 6e61 6c69 7479 0a0a 2020 2020  ctionality..    
-0000c1e0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-0000c1f0: 2073 7472 696e 673a 2061 2055 532d 4153   string: a US-AS
-0000c200: 4349 4920 6571 7569 7661 6c65 6e74 206f  CII equivalent o
-0000c210: 6620 7468 6520 696e 7075 7474 6564 2075  f the inputted u
-0000c220: 726c 0a0a 2020 2020 4061 7574 686f 723a  rl..    @author:
-0000c230: 204a 6f6e 6174 6861 6e20 4265 6e6e 0a20   Jonathan Benn. 
-0000c240: 2020 2022 2222 0a20 2020 2023 2063 6f6e     """.    # con
-0000c250: 7665 7274 2074 6865 2061 7574 686f 7269  vert the authori
-0000c260: 7479 2063 6f6d 706f 6e65 6e74 206f 6620  ty component of 
-0000c270: 7468 6520 5552 4c20 696e 746f 2061 6e20  the URL into an 
-0000c280: 4153 4349 4920 7075 6e79 636f 6465 2073  ASCII punycode s
-0000c290: 7472 696e 672c 0a20 2020 2023 2062 7574  tring,.    # but
-0000c2a0: 2065 6e63 6f64 6520 7468 6520 7265 7374   encode the rest
-0000c2b0: 2075 7369 6e67 2074 6865 2072 6567 756c   using the regul
-0000c2c0: 6172 2055 5249 2063 6861 7261 6374 6572  ar URI character
-0000c2d0: 2065 6e63 6f64 696e 670a 2020 2020 636f   encoding.    co
-0000c2e0: 6d70 6f6e 656e 7473 203d 2075 726c 7061  mponents = urlpa
-0000c2f0: 7273 652e 7572 6c70 6172 7365 2875 726c  rse.urlparse(url
-0000c300: 290a 2020 2020 7072 6570 656e 6465 6420  ).    prepended 
-0000c310: 3d20 4661 6c73 650a 2020 2020 2320 4966  = False.    # If
-0000c320: 206e 6f20 6175 7468 6f72 6974 7920 7761   no authority wa
-0000c330: 7320 666f 756e 640a 2020 2020 6966 206e  s found.    if n
-0000c340: 6f74 2063 6f6d 706f 6e65 6e74 732e 6e65  ot components.ne
-0000c350: 746c 6f63 3a0a 2020 2020 2020 2020 2320  tloc:.        # 
-0000c360: 5472 7920 6170 7065 6e64 696e 6720 6120  Try appending a 
-0000c370: 7363 6865 6d65 2074 6f20 7365 6520 6966  scheme to see if
-0000c380: 2074 6861 7420 6669 7865 7320 7468 6520   that fixes the 
-0000c390: 7072 6f62 6c65 6d0a 2020 2020 2020 2020  problem.        
-0000c3a0: 7363 6865 6d65 5f74 6f5f 7072 6570 656e  scheme_to_prepen
-0000c3b0: 6420 3d20 7072 6570 656e 645f 7363 6865  d = prepend_sche
-0000c3c0: 6d65 206f 7220 2268 7474 7022 0a20 2020  me or "http".   
-0000c3d0: 2020 2020 2063 6f6d 706f 6e65 6e74 7320       components 
-0000c3e0: 3d20 7572 6c70 6172 7365 2e75 726c 7061  = urlparse.urlpa
-0000c3f0: 7273 6528 746f 5f75 6e69 636f 6465 2873  rse(to_unicode(s
-0000c400: 6368 656d 655f 746f 5f70 7265 7065 6e64  cheme_to_prepend
-0000c410: 2920 2b20 7522 3a2f 2f22 202b 2075 726c  ) + u"://" + url
-0000c420: 290a 2020 2020 2020 2020 7072 6570 656e  ).        prepen
-0000c430: 6465 6420 3d20 5472 7565 0a0a 2020 2020  ded = True..    
-0000c440: 2320 6966 2077 6520 7374 696c 6c20 6361  # if we still ca
-0000c450: 6e27 7420 6669 6e64 2074 6865 2061 7574  n't find the aut
-0000c460: 686f 7269 7479 0a20 2020 2069 6620 6e6f  hority.    if no
-0000c470: 7420 636f 6d70 6f6e 656e 7473 2e6e 6574  t components.net
-0000c480: 6c6f 633a 0a20 2020 2020 2020 2023 2041  loc:.        # A
-0000c490: 6e64 2069 7427 7320 6e6f 7420 6265 6361  nd it's not beca
-0000c4a0: 7573 6520 7468 6520 7572 6c20 6973 2061  use the url is a
-0000c4b0: 2072 656c 6174 6976 6520 7572 6c0a 2020   relative url.  
-0000c4c0: 2020 2020 2020 6966 206e 6f74 2075 726c        if not url
-0000c4d0: 2e73 7461 7274 7377 6974 6828 222f 2229  .startswith("/")
-0000c4e0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000c4f0: 6973 6520 4578 6365 7074 696f 6e28 0a20  ise Exception(. 
-0000c500: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000c510: 4e6f 2061 7574 686f 7269 7479 2063 6f6d  No authority com
-0000c520: 706f 6e65 6e74 2066 6f75 6e64 2c20 220a  ponent found, ".
-0000c530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c540: 2b20 2263 6f75 6c64 206e 6f74 2064 6563  + "could not dec
-0000c550: 6f64 6520 756e 6963 6f64 6520 746f 2055  ode unicode to U
-0000c560: 532d 4153 4349 4922 0a20 2020 2020 2020  S-ASCII".       
-0000c570: 2020 2020 2029 0a0a 2020 2020 2320 5765       )..    # We
-0000c580: 2772 6520 6865 7265 2069 6620 7765 2066  're here if we f
-0000c590: 6f75 6e64 2061 6e20 6175 7468 6f72 6974  ound an authorit
-0000c5a0: 792c 206c 6574 2773 2072 6562 7569 6c64  y, let's rebuild
-0000c5b0: 2074 6865 2055 524c 0a20 2020 2073 6368   the URL.    sch
-0000c5c0: 656d 6520 3d20 636f 6d70 6f6e 656e 7473  eme = components
-0000c5d0: 2e73 6368 656d 650a 2020 2020 6175 7468  .scheme.    auth
-0000c5e0: 6f72 6974 7920 3d20 636f 6d70 6f6e 656e  ority = componen
-0000c5f0: 7473 2e6e 6574 6c6f 630a 2020 2020 7061  ts.netloc.    pa
-0000c600: 7468 203d 2063 6f6d 706f 6e65 6e74 732e  th = components.
-0000c610: 7061 7468 0a20 2020 2071 7565 7279 203d  path.    query =
-0000c620: 2063 6f6d 706f 6e65 6e74 732e 7175 6572   components.quer
-0000c630: 790a 2020 2020 6672 6167 6d65 6e74 203d  y.    fragment =
-0000c640: 2063 6f6d 706f 6e65 6e74 732e 6672 6167   components.frag
-0000c650: 6d65 6e74 0a0a 2020 2020 6966 2070 7265  ment..    if pre
-0000c660: 7065 6e64 6564 3a0a 2020 2020 2020 2020  pended:.        
-0000c670: 7363 6865 6d65 203d 2022 220a 0a20 2020  scheme = ""..   
-0000c680: 2075 6e70 6172 7365 6420 3d20 7572 6c70   unparsed = urlp
-0000c690: 6172 7365 2e75 726c 756e 7061 7273 6528  arse.urlunparse(
-0000c6a0: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-0000c6b0: 2020 2020 2020 2073 6368 656d 652c 0a20         scheme,. 
-0000c6c0: 2020 2020 2020 2020 2020 2075 6e69 636f             unico
-0000c6d0: 6465 5f74 6f5f 6173 6369 695f 6175 7468  de_to_ascii_auth
-0000c6e0: 6f72 6974 7928 6175 7468 6f72 6974 7929  ority(authority)
-0000c6f0: 2c0a 2020 2020 2020 2020 2020 2020 6573  ,.            es
-0000c700: 6361 7065 5f75 6e69 636f 6465 2870 6174  cape_unicode(pat
-0000c710: 6829 2c0a 2020 2020 2020 2020 2020 2020  h),.            
-0000c720: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-0000c730: 6573 6361 7065 5f75 6e69 636f 6465 2871  escape_unicode(q
-0000c740: 7565 7279 292c 0a20 2020 2020 2020 2020  uery),.         
-0000c750: 2020 2073 7472 2866 7261 676d 656e 7429     str(fragment)
-0000c760: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0000c770: 290a 2020 2020 6966 2075 6e70 6172 7365  ).    if unparse
-0000c780: 642e 7374 6172 7473 7769 7468 2822 2f2f  d.startswith("//
-0000c790: 2229 3a0a 2020 2020 2020 2020 756e 7061  "):.        unpa
-0000c7a0: 7273 6564 203d 2075 6e70 6172 7365 645b  rsed = unparsed[
-0000c7b0: 323a 5d20 2023 2052 656d 6f76 6520 7468  2:]  # Remove th
-0000c7c0: 6520 2f2f 2075 726c 756e 7061 7273 6520  e // urlunparse 
-0000c7d0: 7075 7473 2069 6e20 7468 6520 6265 6769  puts in the begi
-0000c7e0: 6e6e 696e 670a 2020 2020 7265 7475 726e  nning.    return
-0000c7f0: 2075 6e70 6172 7365 640a 0a0a 636c 6173   unparsed...clas
-0000c800: 7320 4953 5f47 454e 4552 4943 5f55 524c  s IS_GENERIC_URL
-0000c810: 2856 616c 6964 6174 6f72 293a 0a20 2020  (Validator):.   
-0000c820: 2022 2222 0a20 2020 2052 656a 6563 7473   """.    Rejects
-0000c830: 2061 2055 524c 2073 7472 696e 6720 6966   a URL string if
-0000c840: 2061 6e79 206f 6620 7468 6520 666f 6c6c   any of the foll
-0000c850: 6f77 696e 6720 6973 2074 7275 653a 0a20  owing is true:. 
-0000c860: 2020 2020 2020 2a20 5468 6520 7374 7269        * The stri
-0000c870: 6e67 2069 7320 656d 7074 7920 6f72 204e  ng is empty or N
-0000c880: 6f6e 650a 2020 2020 2020 202a 2054 6865  one.       * The
-0000c890: 2073 7472 696e 6720 7573 6573 2063 6861   string uses cha
-0000c8a0: 7261 6374 6572 7320 7468 6174 2061 7265  racters that are
-0000c8b0: 206e 6f74 2061 6c6c 6f77 6564 2069 6e20   not allowed in 
-0000c8c0: 6120 5552 4c0a 2020 2020 2020 202a 2054  a URL.       * T
-0000c8d0: 6865 2055 524c 2073 6368 656d 6520 7370  he URL scheme sp
-0000c8e0: 6563 6966 6965 6420 2869 6620 6f6e 6520  ecified (if one 
-0000c8f0: 6973 2073 7065 6369 6669 6564 2920 6973  is specified) is
-0000c900: 206e 6f74 2076 616c 6964 0a0a 2020 2020   not valid..    
-0000c910: 4261 7365 6420 6f6e 2052 4643 2032 3339  Based on RFC 239
-0000c920: 363a 2068 7474 703a 2f2f 7777 772e 6661  6: http://www.fa
-0000c930: 7173 2e6f 7267 2f72 6663 732f 7266 6332  qs.org/rfcs/rfc2
-0000c940: 3339 362e 6874 6d6c 0a0a 2020 2020 5468  396.html..    Th
-0000c950: 6973 2066 756e 6374 696f 6e20 6f6e 6c79  is function only
-0000c960: 2063 6865 636b 7320 7468 6520 5552 4c27   checks the URL'
-0000c970: 7320 7379 6e74 6178 2e20 4974 2064 6f65  s syntax. It doe
-0000c980: 7320 6e6f 7420 6368 6563 6b20 7468 6174  s not check that
-0000c990: 2074 6865 2055 524c 0a20 2020 2070 6f69   the URL.    poi
-0000c9a0: 6e74 7320 746f 2061 2072 6561 6c20 646f  nts to a real do
-0000c9b0: 6375 6d65 6e74 2c20 666f 7220 6578 616d  cument, for exam
-0000c9c0: 706c 652c 206f 7220 7468 6174 2069 7420  ple, or that it 
-0000c9d0: 6f74 6865 7277 6973 6520 6d61 6b65 7320  otherwise makes 
-0000c9e0: 7365 6e73 650a 2020 2020 7365 6d61 6e74  sense.    semant
-0000c9f0: 6963 616c 6c79 2e20 5468 6973 2066 756e  ically. This fun
-0000ca00: 6374 696f 6e20 646f 6573 2061 7574 6f6d  ction does autom
-0000ca10: 6174 6963 616c 6c79 2070 7265 7065 6e64  atically prepend
-0000ca20: 2027 6874 7470 3a2f 2f27 2069 6e20 6672   'http://' in fr
-0000ca30: 6f6e 740a 2020 2020 6f66 2061 2055 524c  ont.    of a URL
-0000ca40: 2069 6620 616e 6420 6f6e 6c79 2069 6620   if and only if 
-0000ca50: 7468 6174 2773 206e 6563 6573 7361 7279  that's necessary
-0000ca60: 2074 6f20 7375 6363 6573 7366 756c 6c79   to successfully
-0000ca70: 2070 6172 7365 2074 6865 2055 524c 2e0a   parse the URL..
-0000ca80: 2020 2020 506c 6561 7365 206e 6f74 6520      Please note 
-0000ca90: 7468 6174 2061 2073 6368 656d 6520 7769  that a scheme wi
-0000caa0: 6c6c 2062 6520 7072 6570 656e 6465 6420  ll be prepended 
-0000cab0: 6f6e 6c79 2066 6f72 2072 6172 6520 6361  only for rare ca
-0000cac0: 7365 730a 2020 2020 2865 2e67 2e20 2767  ses.    (e.g. 'g
-0000cad0: 6f6f 676c 652e 6361 3a38 3027 290a 0a20  oogle.ca:80').. 
-0000cae0: 2020 2054 6865 206c 6973 7420 6f66 2061     The list of a
-0000caf0: 6c6c 6f77 6564 2073 6368 656d 6573 2069  llowed schemes i
-0000cb00: 7320 6375 7374 6f6d 697a 6162 6c65 2077  s customizable w
-0000cb10: 6974 6820 7468 6520 616c 6c6f 7765 645f  ith the allowed_
-0000cb20: 7363 6865 6d65 730a 2020 2020 7061 7261  schemes.    para
-0000cb30: 6d65 7465 722e 2049 6620 796f 7520 6578  meter. If you ex
-0000cb40: 636c 7564 6520 4e6f 6e65 2066 726f 6d20  clude None from 
-0000cb50: 7468 6520 6c69 7374 2c20 7468 656e 2061  the list, then a
-0000cb60: 6262 7265 7669 6174 6564 2055 524c 730a  bbreviated URLs.
-0000cb70: 2020 2020 286c 6163 6b69 6e67 2061 2073      (lacking a s
-0000cb80: 6368 656d 6520 7375 6368 2061 7320 2768  cheme such as 'h
-0000cb90: 7474 7027 2920 7769 6c6c 2062 6520 7265  ttp') will be re
-0000cba0: 6a65 6374 6564 2e0a 0a20 2020 2054 6865  jected...    The
-0000cbb0: 2064 6566 6175 6c74 2070 7265 7065 6e64   default prepend
-0000cbc0: 6564 2073 6368 656d 6520 6973 2063 7573  ed scheme is cus
-0000cbd0: 746f 6d69 7a61 626c 6520 7769 7468 2074  tomizable with t
-0000cbe0: 6865 2070 7265 7065 6e64 5f73 6368 656d  he prepend_schem
-0000cbf0: 650a 2020 2020 7061 7261 6d65 7465 722e  e.    parameter.
-0000cc00: 2049 6620 796f 7520 7365 7420 7072 6570   If you set prep
-0000cc10: 656e 645f 7363 6865 6d65 2074 6f20 4e6f  end_scheme to No
-0000cc20: 6e65 2074 6865 6e20 7072 6570 656e 6469  ne then prependi
-0000cc30: 6e67 2077 696c 6c20 6265 0a20 2020 2064  ng will be.    d
-0000cc40: 6973 6162 6c65 642e 2055 524c 7320 7468  isabled. URLs th
-0000cc50: 6174 2072 6571 7569 7265 2070 7265 7065  at require prepe
-0000cc60: 6e64 696e 6720 746f 2070 6172 7365 2077  nding to parse w
-0000cc70: 696c 6c20 7374 696c 6c20 6265 2061 6363  ill still be acc
-0000cc80: 6570 7465 642c 0a20 2020 2062 7574 2074  epted,.    but t
-0000cc90: 6865 2072 6574 7572 6e20 7661 6c75 6520  he return value 
-0000cca0: 7769 6c6c 206e 6f74 2062 6520 6d6f 6469  will not be modi
-0000ccb0: 6669 6564 2e0a 0a20 2020 2040 6175 7468  fied...    @auth
-0000ccc0: 6f72 3a20 4a6f 6e61 7468 616e 2042 656e  or: Jonathan Ben
-0000ccd0: 6e0a 0a20 2020 2020 2020 203e 3e3e 2049  n..        >>> I
-0000cce0: 535f 4745 4e45 5249 435f 5552 4c28 2928  S_GENERIC_URL()(
-0000ccf0: 2768 7474 703a 2f2f 7573 6572 4061 6263  'http://user@abc
-0000cd00: 2e63 6f6d 2729 0a20 2020 2020 2020 2028  .com').        (
-0000cd10: 2768 7474 703a 2f2f 7573 6572 4061 6263  'http://user@abc
-0000cd20: 2e63 6f6d 272c 204e 6f6e 6529 0a0a 2020  .com', None)..  
-0000cd30: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-0000cd40: 6572 726f 725f 6d65 7373 6167 653a 2061  error_message: a
-0000cd50: 2073 7472 696e 672c 2074 6865 2065 7272   string, the err
-0000cd60: 6f72 206d 6573 7361 6765 2074 6f20 6769  or message to gi
-0000cd70: 7665 2074 6865 2065 6e64 2075 7365 720a  ve the end user.
-0000cd80: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-0000cd90: 6865 2055 524c 2064 6f65 7320 6e6f 7420  he URL does not 
-0000cda0: 7661 6c69 6461 7465 0a20 2020 2020 2020  validate.       
-0000cdb0: 2061 6c6c 6f77 6564 5f73 6368 656d 6573   allowed_schemes
-0000cdc0: 3a20 6120 6c69 7374 2063 6f6e 7461 696e  : a list contain
-0000cdd0: 696e 6720 7374 7269 6e67 7320 6f72 204e  ing strings or N
-0000cde0: 6f6e 652e 2045 6163 6820 656c 656d 656e  one. Each elemen
-0000cdf0: 740a 2020 2020 2020 2020 2020 2020 6973  t.            is
-0000ce00: 2061 2073 6368 656d 6520 7468 6520 696e   a scheme the in
-0000ce10: 7075 7474 6564 2055 524c 2069 7320 616c  putted URL is al
-0000ce20: 6c6f 7765 6420 746f 2075 7365 0a20 2020  lowed to use.   
-0000ce30: 2020 2020 2070 7265 7065 6e64 5f73 6368       prepend_sch
-0000ce40: 656d 653a 2061 2073 7472 696e 672c 2074  eme: a string, t
-0000ce50: 6869 7320 7363 6865 6d65 2069 7320 7072  his scheme is pr
-0000ce60: 6570 656e 6465 6420 6966 2069 7427 730a  epended if it's.
-0000ce70: 2020 2020 2020 2020 2020 2020 6e65 6365              nece
-0000ce80: 7373 6172 7920 746f 206d 616b 6520 7468  ssary to make th
-0000ce90: 6520 5552 4c20 7661 6c69 640a 0a20 2020  e URL valid..   
-0000cea0: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
-0000ceb0: 696e 6974 5f5f 280a 2020 2020 2020 2020  init__(.        
-0000cec0: 7365 6c66 2c0a 2020 2020 2020 2020 6572  self,.        er
-0000ced0: 726f 725f 6d65 7373 6167 653d 2245 6e74  ror_message="Ent
-0000cee0: 6572 2061 2076 616c 6964 2055 524c 222c  er a valid URL",
-0000cef0: 0a20 2020 2020 2020 2061 6c6c 6f77 6564  .        allowed
-0000cf00: 5f73 6368 656d 6573 3d4e 6f6e 652c 0a20  _schemes=None,. 
-0000cf10: 2020 2020 2020 2070 7265 7065 6e64 5f73         prepend_s
-0000cf20: 6368 656d 653d 4e6f 6e65 2c0a 2020 2020  cheme=None,.    
-0000cf30: 293a 0a0a 2020 2020 2020 2020 7365 6c66  ):..        self
-0000cf40: 2e65 7272 6f72 5f6d 6573 7361 6765 203d  .error_message =
-0000cf50: 2065 7272 6f72 5f6d 6573 7361 6765 0a20   error_message. 
-0000cf60: 2020 2020 2020 2069 6620 616c 6c6f 7765         if allowe
-0000cf70: 645f 7363 6865 6d65 7320 6973 204e 6f6e  d_schemes is Non
-0000cf80: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0000cf90: 656c 662e 616c 6c6f 7765 645f 7363 6865  elf.allowed_sche
-0000cfa0: 6d65 7320 3d20 616c 6c5f 7572 6c5f 7363  mes = all_url_sc
-0000cfb0: 6865 6d65 730a 2020 2020 2020 2020 656c  hemes.        el
-0000cfc0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000cfd0: 7365 6c66 2e61 6c6c 6f77 6564 5f73 6368  self.allowed_sch
-0000cfe0: 656d 6573 203d 2061 6c6c 6f77 6564 5f73  emes = allowed_s
-0000cff0: 6368 656d 6573 0a20 2020 2020 2020 2073  chemes.        s
-0000d000: 656c 662e 7072 6570 656e 645f 7363 6865  elf.prepend_sche
-0000d010: 6d65 203d 2070 7265 7065 6e64 5f73 6368  me = prepend_sch
-0000d020: 656d 650a 2020 2020 2020 2020 6966 2073  eme.        if s
-0000d030: 656c 662e 7072 6570 656e 645f 7363 6865  elf.prepend_sche
-0000d040: 6d65 206e 6f74 2069 6e20 7365 6c66 2e61  me not in self.a
-0000d050: 6c6c 6f77 6564 5f73 6368 656d 6573 3a0a  llowed_schemes:.
-0000d060: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000d070: 6520 5379 6e74 6178 4572 726f 7228 0a20  e SyntaxError(. 
-0000d080: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000d090: 7072 6570 656e 645f 7363 6865 6d65 3d27  prepend_scheme='
-0000d0a0: 2573 2720 6973 206e 6f74 2069 6e20 616c  %s' is not in al
-0000d0b0: 6c6f 7765 645f 7363 6865 6d65 733d 2573  lowed_schemes=%s
-0000d0c0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000d0d0: 2020 2520 2873 656c 662e 7072 6570 656e    % (self.prepen
-0000d0e0: 645f 7363 6865 6d65 2c20 7365 6c66 2e61  d_scheme, self.a
-0000d0f0: 6c6c 6f77 6564 5f73 6368 656d 6573 290a  llowed_schemes).
-0000d100: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0000d110: 2020 2052 4547 4558 5f47 454e 4552 4943     REGEX_GENERIC
-0000d120: 5f55 524c 203d 2072 2225 5b5e 302d 3941  _URL = r"%[^0-9A
-0000d130: 2d46 612d 665d 7b32 7d7c 255b 5e30 2d39  -Fa-f]{2}|%[^0-9
-0000d140: 412d 4661 2d66 5d5b 302d 3941 2d46 612d  A-Fa-f][0-9A-Fa-
-0000d150: 665d 7c25 5b30 2d39 412d 4661 2d66 5d5b  f]|%[0-9A-Fa-f][
-0000d160: 5e30 2d39 412d 4661 2d66 5d7c 2524 7c25  ^0-9A-Fa-f]|%$|%
-0000d170: 5b30 2d39 412d 4661 2d66 5d24 7c25 5b5e  [0-9A-Fa-f]$|%[^
-0000d180: 302d 3941 2d46 612d 665d 2422 0a20 2020  0-9A-Fa-f]$".   
-0000d190: 2052 4547 4558 5f47 454e 4552 4943 5f55   REGEX_GENERIC_U
-0000d1a0: 524c 5f56 414c 4944 203d 2072 225b 412d  RL_VALID = r"[A-
-0000d1b0: 5a61 2d7a 302d 393b 2f3f 3a40 263d 2b24  Za-z0-9;/?:@&=+$
-0000d1c0: 2c5c 2d5f 5c2e 217e 2a27 5c28 5c29 255d  ,\-_\.!~*'\(\)%]
-0000d1d0: 2b24 220a 2020 2020 5245 4745 585f 5552  +$".    REGEX_UR
-0000d1e0: 4c5f 4652 4147 4d45 4e54 5f56 414c 4944  L_FRAGMENT_VALID
-0000d1f0: 203d 2072 225b 7c41 2d5a 612d 7a30 2d39   = r"[|A-Za-z0-9
-0000d200: 3b2f 3f3a 4026 3d2b 242c 5c2d 5f5c 2e21  ;/?:@&=+$,\-_\.!
-0000d210: 7e2a 275c 285c 2925 5d2b 2422 0a0a 2020  ~*'\(\)%]+$"..  
-0000d220: 2020 6465 6620 7661 6c69 6461 7465 2873    def validate(s
-0000d230: 656c 662c 2076 616c 7565 2c20 7265 636f  elf, value, reco
-0000d240: 7264 5f69 643d 4e6f 6e65 293a 0a20 2020  rd_id=None):.   
-0000d250: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000d260: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-0000d270: 2020 2076 616c 7565 3a20 6120 7374 7269     value: a stri
-0000d280: 6e67 2c20 7468 6520 5552 4c20 746f 2076  ng, the URL to v
-0000d290: 616c 6964 6174 650a 0a20 2020 2020 2020  alidate..       
-0000d2a0: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-0000d2b0: 2020 2020 2020 6120 7475 706c 652c 2077        a tuple, w
-0000d2c0: 6865 7265 2074 7570 6c65 5b30 5d20 6973  here tuple[0] is
-0000d2d0: 2074 6865 2069 6e70 7574 7465 6420 7661   the inputted va
-0000d2e0: 6c75 6520 2870 6f73 7369 626c 650a 2020  lue (possible.  
-0000d2f0: 2020 2020 2020 2020 2020 7072 6570 656e            prepen
-0000d300: 6465 6420 7769 7468 2070 7265 7065 6e64  ded with prepend
-0000d310: 5f73 6368 656d 6529 2c20 616e 6420 7475  _scheme), and tu
-0000d320: 706c 655b 315d 2069 7320 6569 7468 6572  ple[1] is either
-0000d330: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-0000d340: 6520 2873 7563 6365 7373 2129 206f 7220  e (success!) or 
-0000d350: 7468 6520 7374 7269 6e67 2065 7272 6f72  the string error
-0000d360: 5f6d 6573 7361 6765 0a20 2020 2020 2020  _message.       
-0000d370: 2022 2222 0a0a 2020 2020 2020 2020 2320   """..        # 
-0000d380: 6966 2077 6520 646f 6e74 2068 6176 6520  if we dont have 
-0000d390: 616e 7974 6869 6e67 206f 7220 7468 6520  anything or the 
-0000d3a0: 5552 4c20 6d69 7375 7365 7320 7468 6520  URL misuses the 
-0000d3b0: 2725 2720 6368 6172 6163 7465 720a 0a20  '%' character.. 
-0000d3c0: 2020 2020 2020 2069 6620 6e6f 7420 7661         if not va
-0000d3d0: 6c75 6520 6f72 2072 652e 7365 6172 6368  lue or re.search
-0000d3e0: 2873 656c 662e 5245 4745 585f 4745 4e45  (self.REGEX_GENE
-0000d3f0: 5249 435f 5552 4c2c 2076 616c 7565 293a  RIC_URL, value):
-0000d400: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000d410: 7365 2056 616c 6964 6174 696f 6e45 7272  se ValidationErr
-0000d420: 6f72 2873 656c 662e 7472 616e 736c 6174  or(self.translat
-0000d430: 6f72 2873 656c 662e 6572 726f 725f 6d65  or(self.error_me
-0000d440: 7373 6167 6529 290a 0a20 2020 2020 2020  ssage))..       
-0000d450: 2069 6620 2223 2220 696e 2076 616c 7565   if "#" in value
-0000d460: 3a0a 2020 2020 2020 2020 2020 2020 7572  :.            ur
-0000d470: 6c2c 2066 7261 676d 656e 745f 7061 7274  l, fragment_part
-0000d480: 203d 2076 616c 7565 2e73 706c 6974 2822   = value.split("
-0000d490: 2322 290a 2020 2020 2020 2020 656c 7365  #").        else
-0000d4a0: 3a0a 2020 2020 2020 2020 2020 2020 7572  :.            ur
-0000d4b0: 6c2c 2066 7261 676d 656e 745f 7061 7274  l, fragment_part
-0000d4c0: 203d 2076 616c 7565 2c20 2222 0a20 2020   = value, "".   
-0000d4d0: 2020 2020 2023 2069 6620 7468 6520 5552       # if the UR
-0000d4e0: 4c20 6973 206f 6e6c 7920 636f 6d70 6f73  L is only compos
-0000d4f0: 6564 206f 6620 7661 6c69 6420 6368 6172  ed of valid char
-0000d500: 6163 7465 7273 0a20 2020 2020 2020 2069  acters.        i
-0000d510: 6620 6e6f 7420 7265 2e6d 6174 6368 2873  f not re.match(s
-0000d520: 656c 662e 5245 4745 585f 4745 4e45 5249  elf.REGEX_GENERI
-0000d530: 435f 5552 4c5f 5641 4c49 442c 2075 726c  C_URL_VALID, url
-0000d540: 2920 6f72 2028 0a20 2020 2020 2020 2020  ) or (.         
-0000d550: 2020 2066 7261 676d 656e 745f 7061 7274     fragment_part
-0000d560: 2061 6e64 206e 6f74 2072 652e 6d61 7463   and not re.matc
-0000d570: 6828 7365 6c66 2e52 4547 4558 5f55 524c  h(self.REGEX_URL
-0000d580: 5f46 5241 474d 454e 545f 5641 4c49 442c  _FRAGMENT_VALID,
-0000d590: 2066 7261 676d 656e 745f 7061 7274 290a   fragment_part).
-0000d5a0: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-0000d5b0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000d5c0: 6964 6174 696f 6e45 7272 6f72 2873 656c  idationError(sel
-0000d5d0: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
-0000d5e0: 662e 6572 726f 725f 6d65 7373 6167 6529  f.error_message)
-0000d5f0: 290a 2020 2020 2020 2020 2320 5468 656e  ).        # Then
-0000d600: 2070 6172 7365 2074 6865 2055 524c 2069   parse the URL i
-0000d610: 6e74 6f20 6974 7320 636f 6d70 6f6e 656e  nto its componen
-0000d620: 7473 2061 6e64 2063 6865 636b 206f 6e0a  ts and check on.
-0000d630: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0000d640: 2020 2020 2020 2020 2063 6f6d 706f 6e65           compone
-0000d650: 6e74 7320 3d20 7572 6c70 6172 7365 2e75  nts = urlparse.u
-0000d660: 726c 7061 7273 6528 7572 6c6c 6962 5f75  rlparse(urllib_u
-0000d670: 6e71 756f 7465 2876 616c 7565 2929 2e5f  nquote(value))._
-0000d680: 6173 6469 6374 2829 0a20 2020 2020 2020  asdict().       
-0000d690: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
-0000d6a0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-0000d6b0: 7261 6973 6520 5661 6c69 6461 7469 6f6e  raise Validation
-0000d6c0: 4572 726f 7228 7365 6c66 2e74 7261 6e73  Error(self.trans
-0000d6d0: 6c61 746f 7228 7365 6c66 2e65 7272 6f72  lator(self.error
-0000d6e0: 5f6d 6573 7361 6765 2929 0a0a 2020 2020  _message))..    
-0000d6f0: 2020 2020 2320 436c 6561 6e20 7570 2074      # Clean up t
-0000d700: 6865 2073 6368 656d 6520 6265 666f 7265  he scheme before
-0000d710: 2077 6520 6368 6563 6b20 6974 0a20 2020   we check it.   
-0000d720: 2020 2020 2073 6368 656d 6520 3d20 636f       scheme = co
-0000d730: 6d70 6f6e 656e 7473 5b22 7363 6865 6d65  mponents["scheme
-0000d740: 225d 0a20 2020 2020 2020 2069 6620 6c65  "].        if le
-0000d750: 6e28 7363 6865 6d65 2920 3d3d 2030 3a0a  n(scheme) == 0:.
-0000d760: 2020 2020 2020 2020 2020 2020 7363 6865              sche
-0000d770: 6d65 203d 204e 6f6e 650a 2020 2020 2020  me = None.      
-0000d780: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000d790: 2020 2020 7363 6865 6d65 203d 2063 6f6d      scheme = com
-0000d7a0: 706f 6e65 6e74 735b 2273 6368 656d 6522  ponents["scheme"
-0000d7b0: 5d2e 6c6f 7765 7228 290a 2020 2020 2020  ].lower().      
-0000d7c0: 2020 2320 4966 2074 6865 2073 6368 656d    # If the schem
-0000d7d0: 6520 646f 6573 6e27 7420 7265 616c 6c79  e doesn't really
-0000d7e0: 2065 7869 7374 730a 2020 2020 2020 2020   exists.        
-0000d7f0: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
-0000d800: 2073 6368 656d 6520 6e6f 7420 696e 2073   scheme not in s
-0000d810: 656c 662e 616c 6c6f 7765 645f 7363 6865  elf.allowed_sche
-0000d820: 6d65 730a 2020 2020 2020 2020 2020 2020  mes.            
-0000d830: 6f72 206e 6f74 2073 6368 656d 650a 2020  or not scheme.  
-0000d840: 2020 2020 2020 2020 2020 616e 6420 223a            and ":
-0000d850: 2220 696e 2063 6f6d 706f 6e65 6e74 735b  " in components[
-0000d860: 2270 6174 6822 5d0a 2020 2020 2020 2020  "path"].        
-0000d870: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-0000d880: 2066 6f72 2074 6865 2070 6f73 7369 626c   for the possibl
-0000d890: 6520 6361 7365 206f 6620 6162 6272 6576  e case of abbrev
-0000d8a0: 6961 7465 6420 5552 4c73 2077 6974 680a  iated URLs with.
-0000d8b0: 2020 2020 2020 2020 2020 2020 2320 706f              # po
-0000d8c0: 7274 732c 2063 6865 636b 2074 6f20 7365  rts, check to se
-0000d8d0: 6520 6966 2061 6464 696e 6720 6120 7661  e if adding a va
-0000d8e0: 6c69 6420 7363 6865 6d65 2066 6978 6573  lid scheme fixes
-0000d8f0: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
-0000d900: 6865 2070 726f 626c 656d 2028 6275 7420  he problem (but 
-0000d910: 6f6e 6c79 2064 6f20 7468 6973 2069 6620  only do this if 
-0000d920: 6974 2064 6f65 736e 2774 2068 6176 650a  it doesn't have.
-0000d930: 2020 2020 2020 2020 2020 2020 2320 6f6e              # on
-0000d940: 6520 616c 7265 6164 7921 290a 2020 2020  e already!).    
-0000d950: 2020 2020 2020 2020 6966 2022 3a2f 2f22          if "://"
-0000d960: 206e 6f74 2069 6e20 7661 6c75 6520 616e   not in value an
-0000d970: 6420 4e6f 6e65 2069 6e20 7365 6c66 2e61  d None in self.a
-0000d980: 6c6c 6f77 6564 5f73 6368 656d 6573 3a0a  llowed_schemes:.
-0000d990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d9a0: 7363 6865 6d65 546f 5573 6520 3d20 7365  schemeToUse = se
-0000d9b0: 6c66 2e70 7265 7065 6e64 5f73 6368 656d  lf.prepend_schem
-0000d9c0: 6520 6f72 2022 6874 7470 220a 2020 2020  e or "http".    
-0000d9d0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-0000d9e0: 7661 6c75 6520 3d20 7365 6c66 2e76 616c  value = self.val
-0000d9f0: 6964 6174 6528 7363 6865 6d65 546f 5573  idate(schemeToUs
-0000da00: 6520 2b20 223a 2f2f 2220 2b20 7661 6c75  e + "://" + valu
-0000da10: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-0000da20: 2020 2072 6574 7572 6e20 6e65 775f 7661     return new_va
-0000da30: 6c75 6520 6966 2073 656c 662e 7072 6570  lue if self.prep
-0000da40: 656e 645f 7363 6865 6d65 2065 6c73 6520  end_scheme else 
-0000da50: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-0000da60: 2020 7261 6973 6520 5661 6c69 6461 7469    raise Validati
-0000da70: 6f6e 4572 726f 7228 7365 6c66 2e74 7261  onError(self.tra
-0000da80: 6e73 6c61 746f 7228 7365 6c66 2e65 7272  nslator(self.err
-0000da90: 6f72 5f6d 6573 7361 6765 2929 0a20 2020  or_message)).   
-0000daa0: 2020 2020 2072 6574 7572 6e20 7661 6c75       return valu
-0000dab0: 650a 0a0a 2320 536f 7572 6365 7320 286f  e...# Sources (o
-0000dac0: 6274 6169 6e65 6420 3230 3137 2d4e 6f76  btained 2017-Nov
-0000dad0: 2d31 3129 3a0a 2320 2020 2068 7474 703a  -11):.#    http:
-0000dae0: 2f2f 6461 7461 2e69 616e 612e 6f72 672f  //data.iana.org/
-0000daf0: 544c 442f 746c 6473 2d61 6c70 6861 2d62  TLD/tlds-alpha-b
-0000db00: 792d 646f 6d61 696e 2e74 7874 0a23 2073  y-domain.txt.# s
-0000db10: 6565 2073 6372 6970 7473 2f70 6172 7365  ee scripts/parse
-0000db20: 5f74 6f70 5f6c 6576 656c 5f64 6f6d 6169  _top_level_domai
-0000db30: 6e73 2e70 7920 666f 7220 616e 2065 6173  ns.py for an eas
-0000db40: 7920 7570 6461 7465 0a0a 6f66 6669 6369  y update..offici
-0000db50: 616c 5f74 6f70 5f6c 6576 656c 5f64 6f6d  al_top_level_dom
-0000db60: 6169 6e73 203d 205b 0a20 2020 2023 2061  ains = [.    # a
-0000db70: 0a20 2020 2022 6161 6122 2c0a 2020 2020  .    "aaa",.    
-0000db80: 2261 6172 7022 2c0a 2020 2020 2261 6261  "aarp",.    "aba
-0000db90: 7274 6822 2c0a 2020 2020 2261 6262 222c  rth",.    "abb",
-0000dba0: 0a20 2020 2022 6162 626f 7474 222c 0a20  .    "abbott",. 
-0000dbb0: 2020 2022 6162 6276 6965 222c 0a20 2020     "abbvie",.   
-0000dbc0: 2022 6162 6322 2c0a 2020 2020 2261 626c   "abc",.    "abl
-0000dbd0: 6522 2c0a 2020 2020 2261 626f 6761 646f  e",.    "abogado
-0000dbe0: 222c 0a20 2020 2022 6162 7564 6861 6269  ",.    "abudhabi
-0000dbf0: 222c 0a20 2020 2022 6163 222c 0a20 2020  ",.    "ac",.   
-0000dc00: 2022 6163 6164 656d 7922 2c0a 2020 2020   "academy",.    
-0000dc10: 2261 6363 656e 7475 7265 222c 0a20 2020  "accenture",.   
-0000dc20: 2022 6163 636f 756e 7461 6e74 222c 0a20   "accountant",. 
-0000dc30: 2020 2022 6163 636f 756e 7461 6e74 7322     "accountants"
-0000dc40: 2c0a 2020 2020 2261 636f 222c 0a20 2020  ,.    "aco",.   
-0000dc50: 2022 6163 7469 7665 222c 0a20 2020 2022   "active",.    "
-0000dc60: 6163 746f 7222 2c0a 2020 2020 2261 6422  actor",.    "ad"
-0000dc70: 2c0a 2020 2020 2261 6461 6322 2c0a 2020  ,.    "adac",.  
-0000dc80: 2020 2261 6473 222c 0a20 2020 2022 6164    "ads",.    "ad
-0000dc90: 756c 7422 2c0a 2020 2020 2261 6522 2c0a  ult",.    "ae",.
-0000dca0: 2020 2020 2261 6567 222c 0a20 2020 2022      "aeg",.    "
-0000dcb0: 6165 726f 222c 0a20 2020 2022 6165 746e  aero",.    "aetn
-0000dcc0: 6122 2c0a 2020 2020 2261 6622 2c0a 2020  a",.    "af",.  
-0000dcd0: 2020 2261 6661 6d69 6c79 636f 6d70 616e    "afamilycompan
-0000dce0: 7922 2c0a 2020 2020 2261 666c 222c 0a20  y",.    "afl",. 
-0000dcf0: 2020 2022 6166 7269 6361 222c 0a20 2020     "africa",.   
-0000dd00: 2022 6167 222c 0a20 2020 2022 6167 616b   "ag",.    "agak
-0000dd10: 6861 6e22 2c0a 2020 2020 2261 6765 6e63  han",.    "agenc
-0000dd20: 7922 2c0a 2020 2020 2261 6922 2c0a 2020  y",.    "ai",.  
-0000dd30: 2020 2261 6967 222c 0a20 2020 2022 6169    "aig",.    "ai
-0000dd40: 676f 222c 0a20 2020 2022 6169 7262 7573  go",.    "airbus
-0000dd50: 222c 0a20 2020 2022 6169 7266 6f72 6365  ",.    "airforce
-0000dd60: 222c 0a20 2020 2022 6169 7274 656c 222c  ",.    "airtel",
-0000dd70: 0a20 2020 2022 616b 646e 222c 0a20 2020  .    "akdn",.   
-0000dd80: 2022 616c 222c 0a20 2020 2022 616c 6661   "al",.    "alfa
-0000dd90: 726f 6d65 6f22 2c0a 2020 2020 2261 6c69  romeo",.    "ali
-0000dda0: 6261 6261 222c 0a20 2020 2022 616c 6970  baba",.    "alip
-0000ddb0: 6179 222c 0a20 2020 2022 616c 6c66 696e  ay",.    "allfin
-0000ddc0: 616e 7a22 2c0a 2020 2020 2261 6c6c 7374  anz",.    "allst
-0000ddd0: 6174 6522 2c0a 2020 2020 2261 6c6c 7922  ate",.    "ally"
-0000dde0: 2c0a 2020 2020 2261 6c73 6163 6522 2c0a  ,.    "alsace",.
-0000ddf0: 2020 2020 2261 6c73 746f 6d22 2c0a 2020      "alstom",.  
-0000de00: 2020 2261 6d22 2c0a 2020 2020 2261 6d65    "am",.    "ame
-0000de10: 7269 6361 6e65 7870 7265 7373 222c 0a20  ricanexpress",. 
-0000de20: 2020 2022 616d 6572 6963 616e 6661 6d69     "americanfami
-0000de30: 6c79 222c 0a20 2020 2022 616d 6578 222c  ly",.    "amex",
-0000de40: 0a20 2020 2022 616d 6661 6d22 2c0a 2020  .    "amfam",.  
-0000de50: 2020 2261 6d69 6361 222c 0a20 2020 2022    "amica",.    "
-0000de60: 616d 7374 6572 6461 6d22 2c0a 2020 2020  amsterdam",.    
-0000de70: 2261 6e61 6c79 7469 6373 222c 0a20 2020  "analytics",.   
-0000de80: 2022 616e 6472 6f69 6422 2c0a 2020 2020   "android",.    
-0000de90: 2261 6e71 7561 6e22 2c0a 2020 2020 2261  "anquan",.    "a
-0000dea0: 6e7a 222c 0a20 2020 2022 616f 222c 0a20  nz",.    "ao",. 
-0000deb0: 2020 2022 616f 6c22 2c0a 2020 2020 2261     "aol",.    "a
-0000dec0: 7061 7274 6d65 6e74 7322 2c0a 2020 2020  partments",.    
-0000ded0: 2261 7070 222c 0a20 2020 2022 6170 706c  "app",.    "appl
-0000dee0: 6522 2c0a 2020 2020 2261 7122 2c0a 2020  e",.    "aq",.  
-0000def0: 2020 2261 7175 6172 656c 6c65 222c 0a20    "aquarelle",. 
-0000df00: 2020 2022 6172 222c 0a20 2020 2022 6172     "ar",.    "ar
-0000df10: 6162 222c 0a20 2020 2022 6172 616d 636f  ab",.    "aramco
-0000df20: 222c 0a20 2020 2022 6172 6368 6922 2c0a  ",.    "archi",.
-0000df30: 2020 2020 2261 726d 7922 2c0a 2020 2020      "army",.    
-0000df40: 2261 7270 6122 2c0a 2020 2020 2261 7274  "arpa",.    "art
-0000df50: 222c 0a20 2020 2022 6172 7465 222c 0a20  ",.    "arte",. 
-0000df60: 2020 2022 6173 222c 0a20 2020 2022 6173     "as",.    "as
-0000df70: 6461 222c 0a20 2020 2022 6173 6961 222c  da",.    "asia",
-0000df80: 0a20 2020 2022 6173 736f 6369 6174 6573  .    "associates
-0000df90: 222c 0a20 2020 2022 6174 222c 0a20 2020  ",.    "at",.   
-0000dfa0: 2022 6174 686c 6574 6122 2c0a 2020 2020   "athleta",.    
-0000dfb0: 2261 7474 6f72 6e65 7922 2c0a 2020 2020  "attorney",.    
-0000dfc0: 2261 7522 2c0a 2020 2020 2261 7563 7469  "au",.    "aucti
-0000dfd0: 6f6e 222c 0a20 2020 2022 6175 6469 222c  on",.    "audi",
-0000dfe0: 0a20 2020 2022 6175 6469 626c 6522 2c0a  .    "audible",.
-0000dff0: 2020 2020 2261 7564 696f 222c 0a20 2020      "audio",.   
-0000e000: 2022 6175 7370 6f73 7422 2c0a 2020 2020   "auspost",.    
-0000e010: 2261 7574 686f 7222 2c0a 2020 2020 2261  "author",.    "a
-0000e020: 7574 6f22 2c0a 2020 2020 2261 7574 6f73  uto",.    "autos
-0000e030: 222c 0a20 2020 2022 6176 6961 6e63 6122  ",.    "avianca"
-0000e040: 2c0a 2020 2020 2261 7722 2c0a 2020 2020  ,.    "aw",.    
-0000e050: 2261 7773 222c 0a20 2020 2022 6178 222c  "aws",.    "ax",
-0000e060: 0a20 2020 2022 6178 6122 2c0a 2020 2020  .    "axa",.    
-0000e070: 2261 7a22 2c0a 2020 2020 2261 7a75 7265  "az",.    "azure
-0000e080: 222c 0a20 2020 2023 2062 0a20 2020 2022  ",.    # b.    "
-0000e090: 6261 222c 0a20 2020 2022 6261 6279 222c  ba",.    "baby",
-0000e0a0: 0a20 2020 2022 6261 6964 7522 2c0a 2020  .    "baidu",.  
-0000e0b0: 2020 2262 616e 616d 6578 222c 0a20 2020    "banamex",.   
-0000e0c0: 2022 6261 6e61 6e61 7265 7075 626c 6963   "bananarepublic
-0000e0d0: 222c 0a20 2020 2022 6261 6e64 222c 0a20  ",.    "band",. 
-0000e0e0: 2020 2022 6261 6e6b 222c 0a20 2020 2022     "bank",.    "
-0000e0f0: 6261 7222 2c0a 2020 2020 2262 6172 6365  bar",.    "barce
-0000e100: 6c6f 6e61 222c 0a20 2020 2022 6261 7263  lona",.    "barc
-0000e110: 6c61 7963 6172 6422 2c0a 2020 2020 2262  laycard",.    "b
-0000e120: 6172 636c 6179 7322 2c0a 2020 2020 2262  arclays",.    "b
-0000e130: 6172 6566 6f6f 7422 2c0a 2020 2020 2262  arefoot",.    "b
-0000e140: 6172 6761 696e 7322 2c0a 2020 2020 2262  argains",.    "b
-0000e150: 6173 6562 616c 6c22 2c0a 2020 2020 2262  aseball",.    "b
-0000e160: 6173 6b65 7462 616c 6c22 2c0a 2020 2020  asketball",.    
-0000e170: 2262 6175 6861 7573 222c 0a20 2020 2022  "bauhaus",.    "
-0000e180: 6261 7965 726e 222c 0a20 2020 2022 6262  bayern",.    "bb
-0000e190: 222c 0a20 2020 2022 6262 6322 2c0a 2020  ",.    "bbc",.  
-0000e1a0: 2020 2262 6274 222c 0a20 2020 2022 6262    "bbt",.    "bb
-0000e1b0: 7661 222c 0a20 2020 2022 6263 6722 2c0a  va",.    "bcg",.
-0000e1c0: 2020 2020 2262 636e 222c 0a20 2020 2022      "bcn",.    "
-0000e1d0: 6264 222c 0a20 2020 2022 6265 222c 0a20  bd",.    "be",. 
-0000e1e0: 2020 2022 6265 6174 7322 2c0a 2020 2020     "beats",.    
-0000e1f0: 2262 6561 7574 7922 2c0a 2020 2020 2262  "beauty",.    "b
-0000e200: 6565 7222 2c0a 2020 2020 2262 656e 746c  eer",.    "bentl
-0000e210: 6579 222c 0a20 2020 2022 6265 726c 696e  ey",.    "berlin
-0000e220: 222c 0a20 2020 2022 6265 7374 222c 0a20  ",.    "best",. 
-0000e230: 2020 2022 6265 7374 6275 7922 2c0a 2020     "bestbuy",.  
-0000e240: 2020 2262 6574 222c 0a20 2020 2022 6266    "bet",.    "bf
-0000e250: 222c 0a20 2020 2022 6267 222c 0a20 2020  ",.    "bg",.   
-0000e260: 2022 6268 222c 0a20 2020 2022 6268 6172   "bh",.    "bhar
-0000e270: 7469 222c 0a20 2020 2022 6269 222c 0a20  ti",.    "bi",. 
-0000e280: 2020 2022 6269 626c 6522 2c0a 2020 2020     "bible",.    
-0000e290: 2262 6964 222c 0a20 2020 2022 6269 6b65  "bid",.    "bike
-0000e2a0: 222c 0a20 2020 2022 6269 6e67 222c 0a20  ",.    "bing",. 
-0000e2b0: 2020 2022 6269 6e67 6f22 2c0a 2020 2020     "bingo",.    
-0000e2c0: 2262 696f 222c 0a20 2020 2022 6269 7a22  "bio",.    "biz"
-0000e2d0: 2c0a 2020 2020 2262 6a22 2c0a 2020 2020  ,.    "bj",.    
-0000e2e0: 2262 6c61 636b 222c 0a20 2020 2022 626c  "black",.    "bl
-0000e2f0: 6163 6b66 7269 6461 7922 2c0a 2020 2020  ackfriday",.    
-0000e300: 2262 6c61 6e63 6f22 2c0a 2020 2020 2262  "blanco",.    "b
-0000e310: 6c6f 636b 6275 7374 6572 222c 0a20 2020  lockbuster",.   
-0000e320: 2022 626c 6f67 222c 0a20 2020 2022 626c   "blog",.    "bl
-0000e330: 6f6f 6d62 6572 6722 2c0a 2020 2020 2262  oomberg",.    "b
-0000e340: 6c75 6522 2c0a 2020 2020 2262 6d22 2c0a  lue",.    "bm",.
-0000e350: 2020 2020 2262 6d73 222c 0a20 2020 2022      "bms",.    "
-0000e360: 626d 7722 2c0a 2020 2020 2262 6e22 2c0a  bmw",.    "bn",.
-0000e370: 2020 2020 2262 6e6c 222c 0a20 2020 2022      "bnl",.    "
-0000e380: 626e 7070 6172 6962 6173 222c 0a20 2020  bnpparibas",.   
-0000e390: 2022 626f 222c 0a20 2020 2022 626f 6174   "bo",.    "boat
-0000e3a0: 7322 2c0a 2020 2020 2262 6f65 6872 696e  s",.    "boehrin
-0000e3b0: 6765 7222 2c0a 2020 2020 2262 6f66 6122  ger",.    "bofa"
-0000e3c0: 2c0a 2020 2020 2262 6f6d 222c 0a20 2020  ,.    "bom",.   
-0000e3d0: 2022 626f 6e64 222c 0a20 2020 2022 626f   "bond",.    "bo
-0000e3e0: 6f22 2c0a 2020 2020 2262 6f6f 6b22 2c0a  o",.    "book",.
-0000e3f0: 2020 2020 2262 6f6f 6b69 6e67 222c 0a20      "booking",. 
-0000e400: 2020 2022 626f 6f74 7322 2c0a 2020 2020     "boots",.    
-0000e410: 2262 6f73 6368 222c 0a20 2020 2022 626f  "bosch",.    "bo
-0000e420: 7374 696b 222c 0a20 2020 2022 626f 7374  stik",.    "bost
-0000e430: 6f6e 222c 0a20 2020 2022 626f 7422 2c0a  on",.    "bot",.
-0000e440: 2020 2020 2262 6f75 7469 7175 6522 2c0a      "boutique",.
-0000e450: 2020 2020 2262 6f78 222c 0a20 2020 2022      "box",.    "
-0000e460: 6272 222c 0a20 2020 2022 6272 6164 6573  br",.    "brades
-0000e470: 636f 222c 0a20 2020 2022 6272 6964 6765  co",.    "bridge
-0000e480: 7374 6f6e 6522 2c0a 2020 2020 2262 726f  stone",.    "bro
-0000e490: 6164 7761 7922 2c0a 2020 2020 2262 726f  adway",.    "bro
-0000e4a0: 6b65 7222 2c0a 2020 2020 2262 726f 7468  ker",.    "broth
-0000e4b0: 6572 222c 0a20 2020 2022 6272 7573 7365  er",.    "brusse
-0000e4c0: 6c73 222c 0a20 2020 2022 6273 222c 0a20  ls",.    "bs",. 
-0000e4d0: 2020 2022 6274 222c 0a20 2020 2022 6275     "bt",.    "bu
-0000e4e0: 6461 7065 7374 222c 0a20 2020 2022 6275  dapest",.    "bu
-0000e4f0: 6761 7474 6922 2c0a 2020 2020 2262 7569  gatti",.    "bui
-0000e500: 6c64 222c 0a20 2020 2022 6275 696c 6465  ld",.    "builde
-0000e510: 7273 222c 0a20 2020 2022 6275 7369 6e65  rs",.    "busine
-0000e520: 7373 222c 0a20 2020 2022 6275 7922 2c0a  ss",.    "buy",.
-0000e530: 2020 2020 2262 757a 7a22 2c0a 2020 2020      "buzz",.    
-0000e540: 2262 7622 2c0a 2020 2020 2262 7722 2c0a  "bv",.    "bw",.
-0000e550: 2020 2020 2262 7922 2c0a 2020 2020 2262      "by",.    "b
-0000e560: 7a22 2c0a 2020 2020 2262 7a68 222c 0a20  z",.    "bzh",. 
-0000e570: 2020 2023 2063 0a20 2020 2022 6361 222c     # c.    "ca",
-0000e580: 0a20 2020 2022 6361 6222 2c0a 2020 2020  .    "cab",.    
-0000e590: 2263 6166 6522 2c0a 2020 2020 2263 616c  "cafe",.    "cal
-0000e5a0: 222c 0a20 2020 2022 6361 6c6c 222c 0a20  ",.    "call",. 
-0000e5b0: 2020 2022 6361 6c76 696e 6b6c 6569 6e22     "calvinklein"
-0000e5c0: 2c0a 2020 2020 2263 616d 222c 0a20 2020  ,.    "cam",.   
-0000e5d0: 2022 6361 6d65 7261 222c 0a20 2020 2022   "camera",.    "
-0000e5e0: 6361 6d70 222c 0a20 2020 2022 6361 6e63  camp",.    "canc
-0000e5f0: 6572 7265 7365 6172 6368 222c 0a20 2020  erresearch",.   
-0000e600: 2022 6361 6e6f 6e22 2c0a 2020 2020 2263   "canon",.    "c
-0000e610: 6170 6574 6f77 6e22 2c0a 2020 2020 2263  apetown",.    "c
-0000e620: 6170 6974 616c 222c 0a20 2020 2022 6361  apital",.    "ca
-0000e630: 7069 7461 6c6f 6e65 222c 0a20 2020 2022  pitalone",.    "
-0000e640: 6361 7222 2c0a 2020 2020 2263 6172 6176  car",.    "carav
-0000e650: 616e 222c 0a20 2020 2022 6361 7264 7322  an",.    "cards"
-0000e660: 2c0a 2020 2020 2263 6172 6522 2c0a 2020  ,.    "care",.  
-0000e670: 2020 2263 6172 6565 7222 2c0a 2020 2020    "career",.    
-0000e680: 2263 6172 6565 7273 222c 0a20 2020 2022  "careers",.    "
-0000e690: 6361 7273 222c 0a20 2020 2022 6361 7274  cars",.    "cart
-0000e6a0: 6965 7222 2c0a 2020 2020 2263 6173 6122  ier",.    "casa"
-0000e6b0: 2c0a 2020 2020 2263 6173 6522 2c0a 2020  ,.    "case",.  
-0000e6c0: 2020 2263 6173 6569 6822 2c0a 2020 2020    "caseih",.    
-0000e6d0: 2263 6173 6822 2c0a 2020 2020 2263 6173  "cash",.    "cas
-0000e6e0: 696e 6f22 2c0a 2020 2020 2263 6174 222c  ino",.    "cat",
-0000e6f0: 0a20 2020 2022 6361 7465 7269 6e67 222c  .    "catering",
-0000e700: 0a20 2020 2022 6361 7468 6f6c 6963 222c  .    "catholic",
-0000e710: 0a20 2020 2022 6362 6122 2c0a 2020 2020  .    "cba",.    
-0000e720: 2263 626e 222c 0a20 2020 2022 6362 7265  "cbn",.    "cbre
-0000e730: 222c 0a20 2020 2022 6362 7322 2c0a 2020  ",.    "cbs",.  
-0000e740: 2020 2263 6322 2c0a 2020 2020 2263 6422    "cc",.    "cd"
-0000e750: 2c0a 2020 2020 2263 6562 222c 0a20 2020  ,.    "ceb",.   
-0000e760: 2022 6365 6e74 6572 222c 0a20 2020 2022   "center",.    "
-0000e770: 6365 6f22 2c0a 2020 2020 2263 6572 6e22  ceo",.    "cern"
-0000e780: 2c0a 2020 2020 2263 6622 2c0a 2020 2020  ,.    "cf",.    
-0000e790: 2263 6661 222c 0a20 2020 2022 6366 6422  "cfa",.    "cfd"
-0000e7a0: 2c0a 2020 2020 2263 6722 2c0a 2020 2020  ,.    "cg",.    
-0000e7b0: 2263 6822 2c0a 2020 2020 2263 6861 6e65  "ch",.    "chane
-0000e7c0: 6c22 2c0a 2020 2020 2263 6861 6e6e 656c  l",.    "channel
-0000e7d0: 222c 0a20 2020 2022 6368 6173 6522 2c0a  ",.    "chase",.
-0000e7e0: 2020 2020 2263 6861 7422 2c0a 2020 2020      "chat",.    
-0000e7f0: 2263 6865 6170 222c 0a20 2020 2022 6368  "cheap",.    "ch
-0000e800: 696e 7461 6922 2c0a 2020 2020 2263 6872  intai",.    "chr
-0000e810: 6973 746d 6173 222c 0a20 2020 2022 6368  istmas",.    "ch
-0000e820: 726f 6d65 222c 0a20 2020 2022 6368 7279  rome",.    "chry
-0000e830: 736c 6572 222c 0a20 2020 2022 6368 7572  sler",.    "chur
-0000e840: 6368 222c 0a20 2020 2022 6369 222c 0a20  ch",.    "ci",. 
-0000e850: 2020 2022 6369 7072 6961 6e69 222c 0a20     "cipriani",. 
-0000e860: 2020 2022 6369 7263 6c65 222c 0a20 2020     "circle",.   
-0000e870: 2022 6369 7363 6f22 2c0a 2020 2020 2263   "cisco",.    "c
-0000e880: 6974 6164 656c 222c 0a20 2020 2022 6369  itadel",.    "ci
-0000e890: 7469 222c 0a20 2020 2022 6369 7469 6322  ti",.    "citic"
-0000e8a0: 2c0a 2020 2020 2263 6974 7922 2c0a 2020  ,.    "city",.  
-0000e8b0: 2020 2263 6974 7965 6174 7322 2c0a 2020    "cityeats",.  
-0000e8c0: 2020 2263 6b22 2c0a 2020 2020 2263 6c22    "ck",.    "cl"
-0000e8d0: 2c0a 2020 2020 2263 6c61 696d 7322 2c0a  ,.    "claims",.
-0000e8e0: 2020 2020 2263 6c65 616e 696e 6722 2c0a      "cleaning",.
-0000e8f0: 2020 2020 2263 6c69 636b 222c 0a20 2020      "click",.   
-0000e900: 2022 636c 696e 6963 222c 0a20 2020 2022   "clinic",.    "
-0000e910: 636c 696e 6971 7565 222c 0a20 2020 2022  clinique",.    "
-0000e920: 636c 6f74 6869 6e67 222c 0a20 2020 2022  clothing",.    "
-0000e930: 636c 6f75 6422 2c0a 2020 2020 2263 6c75  cloud",.    "clu
-0000e940: 6222 2c0a 2020 2020 2263 6c75 626d 6564  b",.    "clubmed
-0000e950: 222c 0a20 2020 2022 636d 222c 0a20 2020  ",.    "cm",.   
-0000e960: 2022 636e 222c 0a20 2020 2022 636f 222c   "cn",.    "co",
-0000e970: 0a20 2020 2022 636f 6163 6822 2c0a 2020  .    "coach",.  
-0000e980: 2020 2263 6f64 6573 222c 0a20 2020 2022    "codes",.    "
-0000e990: 636f 6666 6565 222c 0a20 2020 2022 636f  coffee",.    "co
-0000e9a0: 6c6c 6567 6522 2c0a 2020 2020 2263 6f6c  llege",.    "col
-0000e9b0: 6f67 6e65 222c 0a20 2020 2022 636f 6d22  ogne",.    "com"
-0000e9c0: 2c0a 2020 2020 2263 6f6d 6361 7374 222c  ,.    "comcast",
-0000e9d0: 0a20 2020 2022 636f 6d6d 6261 6e6b 222c  .    "commbank",
-0000e9e0: 0a20 2020 2022 636f 6d6d 756e 6974 7922  .    "community"
-0000e9f0: 2c0a 2020 2020 2263 6f6d 7061 6e79 222c  ,.    "company",
-0000ea00: 0a20 2020 2022 636f 6d70 6172 6522 2c0a  .    "compare",.
-0000ea10: 2020 2020 2263 6f6d 7075 7465 7222 2c0a      "computer",.
-0000ea20: 2020 2020 2263 6f6d 7365 6322 2c0a 2020      "comsec",.  
-0000ea30: 2020 2263 6f6e 646f 7322 2c0a 2020 2020    "condos",.    
-0000ea40: 2263 6f6e 7374 7275 6374 696f 6e22 2c0a  "construction",.
-0000ea50: 2020 2020 2263 6f6e 7375 6c74 696e 6722      "consulting"
-0000ea60: 2c0a 2020 2020 2263 6f6e 7461 6374 222c  ,.    "contact",
-0000ea70: 0a20 2020 2022 636f 6e74 7261 6374 6f72  .    "contractor
-0000ea80: 7322 2c0a 2020 2020 2263 6f6f 6b69 6e67  s",.    "cooking
-0000ea90: 222c 0a20 2020 2022 636f 6f6b 696e 6763  ",.    "cookingc
-0000eaa0: 6861 6e6e 656c 222c 0a20 2020 2022 636f  hannel",.    "co
-0000eab0: 6f6c 222c 0a20 2020 2022 636f 6f70 222c  ol",.    "coop",
-0000eac0: 0a20 2020 2022 636f 7273 6963 6122 2c0a  .    "corsica",.
-0000ead0: 2020 2020 2263 6f75 6e74 7279 222c 0a20      "country",. 
-0000eae0: 2020 2022 636f 7570 6f6e 222c 0a20 2020     "coupon",.   
-0000eaf0: 2022 636f 7570 6f6e 7322 2c0a 2020 2020   "coupons",.    
-0000eb00: 2263 6f75 7273 6573 222c 0a20 2020 2022  "courses",.    "
-0000eb10: 6372 222c 0a20 2020 2022 6372 6564 6974  cr",.    "credit
-0000eb20: 222c 0a20 2020 2022 6372 6564 6974 6361  ",.    "creditca
-0000eb30: 7264 222c 0a20 2020 2022 6372 6564 6974  rd",.    "credit
-0000eb40: 756e 696f 6e22 2c0a 2020 2020 2263 7269  union",.    "cri
-0000eb50: 636b 6574 222c 0a20 2020 2022 6372 6f77  cket",.    "crow
-0000eb60: 6e22 2c0a 2020 2020 2263 7273 222c 0a20  n",.    "crs",. 
-0000eb70: 2020 2022 6372 7569 7365 222c 0a20 2020     "cruise",.   
-0000eb80: 2022 6372 7569 7365 7322 2c0a 2020 2020   "cruises",.    
-0000eb90: 2263 7363 222c 0a20 2020 2022 6375 222c  "csc",.    "cu",
-0000eba0: 0a20 2020 2022 6375 6973 696e 656c 6c61  .    "cuisinella
-0000ebb0: 222c 0a20 2020 2022 6376 222c 0a20 2020  ",.    "cv",.   
-0000ebc0: 2022 6377 222c 0a20 2020 2022 6378 222c   "cw",.    "cx",
-0000ebd0: 0a20 2020 2022 6379 222c 0a20 2020 2022  .    "cy",.    "
-0000ebe0: 6379 6d72 7522 2c0a 2020 2020 2263 796f  cymru",.    "cyo
-0000ebf0: 7522 2c0a 2020 2020 2263 7a22 2c0a 2020  u",.    "cz",.  
-0000ec00: 2020 2320 640a 2020 2020 2264 6162 7572    # d.    "dabur
-0000ec10: 222c 0a20 2020 2022 6461 6422 2c0a 2020  ",.    "dad",.  
-0000ec20: 2020 2264 616e 6365 222c 0a20 2020 2022    "dance",.    "
-0000ec30: 6461 7461 222c 0a20 2020 2022 6461 7465  data",.    "date
-0000ec40: 222c 0a20 2020 2022 6461 7469 6e67 222c  ",.    "dating",
-0000ec50: 0a20 2020 2022 6461 7473 756e 222c 0a20  .    "datsun",. 
-0000ec60: 2020 2022 6461 7922 2c0a 2020 2020 2264     "day",.    "d
-0000ec70: 636c 6b22 2c0a 2020 2020 2264 6473 222c  clk",.    "dds",
-0000ec80: 0a20 2020 2022 6465 222c 0a20 2020 2022  .    "de",.    "
-0000ec90: 6465 616c 222c 0a20 2020 2022 6465 616c  deal",.    "deal
-0000eca0: 6572 222c 0a20 2020 2022 6465 616c 7322  er",.    "deals"
-0000ecb0: 2c0a 2020 2020 2264 6567 7265 6522 2c0a  ,.    "degree",.
-0000ecc0: 2020 2020 2264 656c 6976 6572 7922 2c0a      "delivery",.
-0000ecd0: 2020 2020 2264 656c 6c22 2c0a 2020 2020      "dell",.    
-0000ece0: 2264 656c 6f69 7474 6522 2c0a 2020 2020  "deloitte",.    
-0000ecf0: 2264 656c 7461 222c 0a20 2020 2022 6465  "delta",.    "de
-0000ed00: 6d6f 6372 6174 222c 0a20 2020 2022 6465  mocrat",.    "de
-0000ed10: 6e74 616c 222c 0a20 2020 2022 6465 6e74  ntal",.    "dent
-0000ed20: 6973 7422 2c0a 2020 2020 2264 6573 6922  ist",.    "desi"
-0000ed30: 2c0a 2020 2020 2264 6573 6967 6e22 2c0a  ,.    "design",.
-0000ed40: 2020 2020 2264 6576 222c 0a20 2020 2022      "dev",.    "
-0000ed50: 6468 6c22 2c0a 2020 2020 2264 6961 6d6f  dhl",.    "diamo
-0000ed60: 6e64 7322 2c0a 2020 2020 2264 6965 7422  nds",.    "diet"
-0000ed70: 2c0a 2020 2020 2264 6967 6974 616c 222c  ,.    "digital",
-0000ed80: 0a20 2020 2022 6469 7265 6374 222c 0a20  .    "direct",. 
-0000ed90: 2020 2022 6469 7265 6374 6f72 7922 2c0a     "directory",.
-0000eda0: 2020 2020 2264 6973 636f 756e 7422 2c0a      "discount",.
-0000edb0: 2020 2020 2264 6973 636f 7665 7222 2c0a      "discover",.
-0000edc0: 2020 2020 2264 6973 6822 2c0a 2020 2020      "dish",.    
-0000edd0: 2264 6979 222c 0a20 2020 2022 646a 222c  "diy",.    "dj",
-0000ede0: 0a20 2020 2022 646b 222c 0a20 2020 2022  .    "dk",.    "
-0000edf0: 646d 222c 0a20 2020 2022 646e 7022 2c0a  dm",.    "dnp",.
-0000ee00: 2020 2020 2264 6f22 2c0a 2020 2020 2264      "do",.    "d
-0000ee10: 6f63 7322 2c0a 2020 2020 2264 6f63 746f  ocs",.    "docto
-0000ee20: 7222 2c0a 2020 2020 2264 6f64 6765 222c  r",.    "dodge",
-0000ee30: 0a20 2020 2022 646f 6722 2c0a 2020 2020  .    "dog",.    
-0000ee40: 2264 6f68 6122 2c0a 2020 2020 2264 6f6d  "doha",.    "dom
-0000ee50: 6169 6e73 222c 0a20 2020 2022 646f 7422  ains",.    "dot"
-0000ee60: 2c0a 2020 2020 2264 6f77 6e6c 6f61 6422  ,.    "download"
-0000ee70: 2c0a 2020 2020 2264 7269 7665 222c 0a20  ,.    "drive",. 
-0000ee80: 2020 2022 6474 7622 2c0a 2020 2020 2264     "dtv",.    "d
-0000ee90: 7562 6169 222c 0a20 2020 2022 6475 636b  ubai",.    "duck
-0000eea0: 222c 0a20 2020 2022 6475 6e6c 6f70 222c  ",.    "dunlop",
-0000eeb0: 0a20 2020 2022 6475 6e73 222c 0a20 2020  .    "duns",.   
-0000eec0: 2022 6475 706f 6e74 222c 0a20 2020 2022   "dupont",.    "
-0000eed0: 6475 7262 616e 222c 0a20 2020 2022 6476  durban",.    "dv
-0000eee0: 6167 222c 0a20 2020 2022 6476 7222 2c0a  ag",.    "dvr",.
-0000eef0: 2020 2020 2264 7a22 2c0a 2020 2020 2320      "dz",.    # 
-0000ef00: 650a 2020 2020 2265 6172 7468 222c 0a20  e.    "earth",. 
-0000ef10: 2020 2022 6561 7422 2c0a 2020 2020 2265     "eat",.    "e
-0000ef20: 6322 2c0a 2020 2020 2265 636f 222c 0a20  c",.    "eco",. 
-0000ef30: 2020 2022 6564 656b 6122 2c0a 2020 2020     "edeka",.    
-0000ef40: 2265 6475 222c 0a20 2020 2022 6564 7563  "edu",.    "educ
-0000ef50: 6174 696f 6e22 2c0a 2020 2020 2265 6522  ation",.    "ee"
-0000ef60: 2c0a 2020 2020 2265 6722 2c0a 2020 2020  ,.    "eg",.    
-0000ef70: 2265 6d61 696c 222c 0a20 2020 2022 656d  "email",.    "em
-0000ef80: 6572 636b 222c 0a20 2020 2022 656e 6572  erck",.    "ener
-0000ef90: 6779 222c 0a20 2020 2022 656e 6769 6e65  gy",.    "engine
-0000efa0: 6572 222c 0a20 2020 2022 656e 6769 6e65  er",.    "engine
-0000efb0: 6572 696e 6722 2c0a 2020 2020 2265 6e74  ering",.    "ent
-0000efc0: 6572 7072 6973 6573 222c 0a20 2020 2022  erprises",.    "
-0000efd0: 6570 6f73 7422 2c0a 2020 2020 2265 7073  epost",.    "eps
-0000efe0: 6f6e 222c 0a20 2020 2022 6571 7569 706d  on",.    "equipm
-0000eff0: 656e 7422 2c0a 2020 2020 2265 7222 2c0a  ent",.    "er",.
-0000f000: 2020 2020 2265 7269 6373 736f 6e22 2c0a      "ericsson",.
-0000f010: 2020 2020 2265 726e 6922 2c0a 2020 2020      "erni",.    
-0000f020: 2265 7322 2c0a 2020 2020 2265 7371 222c  "es",.    "esq",
-0000f030: 0a20 2020 2022 6573 7461 7465 222c 0a20  .    "estate",. 
-0000f040: 2020 2022 6573 7572 616e 6365 222c 0a20     "esurance",. 
-0000f050: 2020 2022 6574 222c 0a20 2020 2022 6574     "et",.    "et
-0000f060: 6973 616c 6174 222c 0a20 2020 2022 6575  isalat",.    "eu
-0000f070: 222c 0a20 2020 2022 6575 726f 7669 7369  ",.    "eurovisi
-0000f080: 6f6e 222c 0a20 2020 2022 6575 7322 2c0a  on",.    "eus",.
-0000f090: 2020 2020 2265 7665 6e74 7322 2c0a 2020      "events",.  
-0000f0a0: 2020 2265 7665 7262 616e 6b22 2c0a 2020    "everbank",.  
-0000f0b0: 2020 2265 7863 6861 6e67 6522 2c0a 2020    "exchange",.  
-0000f0c0: 2020 2265 7870 6572 7422 2c0a 2020 2020    "expert",.    
-0000f0d0: 2265 7870 6f73 6564 222c 0a20 2020 2022  "exposed",.    "
-0000f0e0: 6578 7072 6573 7322 2c0a 2020 2020 2265  express",.    "e
-0000f0f0: 7874 7261 7370 6163 6522 2c0a 2020 2020  xtraspace",.    
-0000f100: 2320 660a 2020 2020 2266 6167 6522 2c0a  # f.    "fage",.
-0000f110: 2020 2020 2266 6169 6c22 2c0a 2020 2020      "fail",.    
-0000f120: 2266 6169 7277 696e 6473 222c 0a20 2020  "fairwinds",.   
-0000f130: 2022 6661 6974 6822 2c0a 2020 2020 2266   "faith",.    "f
-0000f140: 616d 696c 7922 2c0a 2020 2020 2266 616e  amily",.    "fan
-0000f150: 222c 0a20 2020 2022 6661 6e73 222c 0a20  ",.    "fans",. 
-0000f160: 2020 2022 6661 726d 222c 0a20 2020 2022     "farm",.    "
-0000f170: 6661 726d 6572 7322 2c0a 2020 2020 2266  farmers",.    "f
-0000f180: 6173 6869 6f6e 222c 0a20 2020 2022 6661  ashion",.    "fa
-0000f190: 7374 222c 0a20 2020 2022 6665 6465 7822  st",.    "fedex"
-0000f1a0: 2c0a 2020 2020 2266 6565 6462 6163 6b22  ,.    "feedback"
-0000f1b0: 2c0a 2020 2020 2266 6572 7261 7269 222c  ,.    "ferrari",
-0000f1c0: 0a20 2020 2022 6665 7272 6572 6f22 2c0a  .    "ferrero",.
-0000f1d0: 2020 2020 2266 6922 2c0a 2020 2020 2266      "fi",.    "f
-0000f1e0: 6961 7422 2c0a 2020 2020 2266 6964 656c  iat",.    "fidel
-0000f1f0: 6974 7922 2c0a 2020 2020 2266 6964 6f22  ity",.    "fido"
-0000f200: 2c0a 2020 2020 2266 696c 6d22 2c0a 2020  ,.    "film",.  
-0000f210: 2020 2266 696e 616c 222c 0a20 2020 2022    "final",.    "
-0000f220: 6669 6e61 6e63 6522 2c0a 2020 2020 2266  finance",.    "f
-0000f230: 696e 616e 6369 616c 222c 0a20 2020 2022  inancial",.    "
-0000f240: 6669 7265 222c 0a20 2020 2022 6669 7265  fire",.    "fire
-0000f250: 7374 6f6e 6522 2c0a 2020 2020 2266 6972  stone",.    "fir
-0000f260: 6d64 616c 6522 2c0a 2020 2020 2266 6973  mdale",.    "fis
-0000f270: 6822 2c0a 2020 2020 2266 6973 6869 6e67  h",.    "fishing
-0000f280: 222c 0a20 2020 2022 6669 7422 2c0a 2020  ",.    "fit",.  
-0000f290: 2020 2266 6974 6e65 7373 222c 0a20 2020    "fitness",.   
-0000f2a0: 2022 666a 222c 0a20 2020 2022 666b 222c   "fj",.    "fk",
-0000f2b0: 0a20 2020 2022 666c 6963 6b72 222c 0a20  .    "flickr",. 
-0000f2c0: 2020 2022 666c 6967 6874 7322 2c0a 2020     "flights",.  
-0000f2d0: 2020 2266 6c69 7222 2c0a 2020 2020 2266    "flir",.    "f
-0000f2e0: 6c6f 7269 7374 222c 0a20 2020 2022 666c  lorist",.    "fl
-0000f2f0: 6f77 6572 7322 2c0a 2020 2020 2266 6c79  owers",.    "fly
-0000f300: 222c 0a20 2020 2022 666d 222c 0a20 2020  ",.    "fm",.   
-0000f310: 2022 666f 222c 0a20 2020 2022 666f 6f22   "fo",.    "foo"
-0000f320: 2c0a 2020 2020 2266 6f6f 6422 2c0a 2020  ,.    "food",.  
-0000f330: 2020 2266 6f6f 646e 6574 776f 726b 222c    "foodnetwork",
-0000f340: 0a20 2020 2022 666f 6f74 6261 6c6c 222c  .    "football",
-0000f350: 0a20 2020 2022 666f 7264 222c 0a20 2020  .    "ford",.   
-0000f360: 2022 666f 7265 7822 2c0a 2020 2020 2266   "forex",.    "f
-0000f370: 6f72 7361 6c65 222c 0a20 2020 2022 666f  orsale",.    "fo
-0000f380: 7275 6d22 2c0a 2020 2020 2266 6f75 6e64  rum",.    "found
-0000f390: 6174 696f 6e22 2c0a 2020 2020 2266 6f78  ation",.    "fox
-0000f3a0: 222c 0a20 2020 2022 6672 222c 0a20 2020  ",.    "fr",.   
-0000f3b0: 2022 6672 6565 222c 0a20 2020 2022 6672   "free",.    "fr
-0000f3c0: 6573 656e 6975 7322 2c0a 2020 2020 2266  esenius",.    "f
-0000f3d0: 726c 222c 0a20 2020 2022 6672 6f67 616e  rl",.    "frogan
-0000f3e0: 7322 2c0a 2020 2020 2266 726f 6e74 646f  s",.    "frontdo
-0000f3f0: 6f72 222c 0a20 2020 2022 6672 6f6e 7469  or",.    "fronti
-0000f400: 6572 222c 0a20 2020 2022 6674 7222 2c0a  er",.    "ftr",.
-0000f410: 2020 2020 2266 756a 6974 7375 222c 0a20      "fujitsu",. 
-0000f420: 2020 2022 6675 6a69 7865 726f 7822 2c0a     "fujixerox",.
-0000f430: 2020 2020 2266 756e 222c 0a20 2020 2022      "fun",.    "
-0000f440: 6675 6e64 222c 0a20 2020 2022 6675 726e  fund",.    "furn
-0000f450: 6974 7572 6522 2c0a 2020 2020 2266 7574  iture",.    "fut
-0000f460: 626f 6c22 2c0a 2020 2020 2266 7969 222c  bol",.    "fyi",
-0000f470: 0a20 2020 2023 2067 0a20 2020 2022 6761  .    # g.    "ga
-0000f480: 222c 0a20 2020 2022 6761 6c22 2c0a 2020  ",.    "gal",.  
-0000f490: 2020 2267 616c 6c65 7279 222c 0a20 2020    "gallery",.   
-0000f4a0: 2022 6761 6c6c 6f22 2c0a 2020 2020 2267   "gallo",.    "g
-0000f4b0: 616c 6c75 7022 2c0a 2020 2020 2267 616d  allup",.    "gam
-0000f4c0: 6522 2c0a 2020 2020 2267 616d 6573 222c  e",.    "games",
-0000f4d0: 0a20 2020 2022 6761 7022 2c0a 2020 2020  .    "gap",.    
-0000f4e0: 2267 6172 6465 6e22 2c0a 2020 2020 2267  "garden",.    "g
-0000f4f0: 6222 2c0a 2020 2020 2267 6269 7a22 2c0a  b",.    "gbiz",.
-0000f500: 2020 2020 2267 6422 2c0a 2020 2020 2267      "gd",.    "g
-0000f510: 646e 222c 0a20 2020 2022 6765 222c 0a20  dn",.    "ge",. 
-0000f520: 2020 2022 6765 6122 2c0a 2020 2020 2267     "gea",.    "g
-0000f530: 656e 7422 2c0a 2020 2020 2267 656e 7469  ent",.    "genti
-0000f540: 6e67 222c 0a20 2020 2022 6765 6f72 6765  ng",.    "george
-0000f550: 222c 0a20 2020 2022 6766 222c 0a20 2020  ",.    "gf",.   
-0000f560: 2022 6767 222c 0a20 2020 2022 6767 6565   "gg",.    "ggee
-0000f570: 222c 0a20 2020 2022 6768 222c 0a20 2020  ",.    "gh",.   
-0000f580: 2022 6769 222c 0a20 2020 2022 6769 6674   "gi",.    "gift
-0000f590: 222c 0a20 2020 2022 6769 6674 7322 2c0a  ",.    "gifts",.
-0000f5a0: 2020 2020 2267 6976 6573 222c 0a20 2020      "gives",.   
-0000f5b0: 2022 6769 7669 6e67 222c 0a20 2020 2022   "giving",.    "
-0000f5c0: 676c 222c 0a20 2020 2022 676c 6164 6522  gl",.    "glade"
-0000f5d0: 2c0a 2020 2020 2267 6c61 7373 222c 0a20  ,.    "glass",. 
-0000f5e0: 2020 2022 676c 6522 2c0a 2020 2020 2267     "gle",.    "g
-0000f5f0: 6c6f 6261 6c22 2c0a 2020 2020 2267 6c6f  lobal",.    "glo
-0000f600: 626f 222c 0a20 2020 2022 676d 222c 0a20  bo",.    "gm",. 
-0000f610: 2020 2022 676d 6169 6c22 2c0a 2020 2020     "gmail",.    
-0000f620: 2267 6d62 6822 2c0a 2020 2020 2267 6d6f  "gmbh",.    "gmo
-0000f630: 222c 0a20 2020 2022 676d 7822 2c0a 2020  ",.    "gmx",.  
-0000f640: 2020 2267 6e22 2c0a 2020 2020 2267 6f64    "gn",.    "god
-0000f650: 6164 6479 222c 0a20 2020 2022 676f 6c64  addy",.    "gold
-0000f660: 222c 0a20 2020 2022 676f 6c64 706f 696e  ",.    "goldpoin
-0000f670: 7422 2c0a 2020 2020 2267 6f6c 6622 2c0a  t",.    "golf",.
-0000f680: 2020 2020 2267 6f6f 222c 0a20 2020 2022      "goo",.    "
-0000f690: 676f 6f64 6861 6e64 7322 2c0a 2020 2020  goodhands",.    
-0000f6a0: 2267 6f6f 6479 6561 7222 2c0a 2020 2020  "goodyear",.    
-0000f6b0: 2267 6f6f 6722 2c0a 2020 2020 2267 6f6f  "goog",.    "goo
-0000f6c0: 676c 6522 2c0a 2020 2020 2267 6f70 222c  gle",.    "gop",
-0000f6d0: 0a20 2020 2022 676f 7422 2c0a 2020 2020  .    "got",.    
-0000f6e0: 2267 6f76 222c 0a20 2020 2022 6770 222c  "gov",.    "gp",
-0000f6f0: 0a20 2020 2022 6771 222c 0a20 2020 2022  .    "gq",.    "
-0000f700: 6772 222c 0a20 2020 2022 6772 6169 6e67  gr",.    "graing
-0000f710: 6572 222c 0a20 2020 2022 6772 6170 6869  er",.    "graphi
-0000f720: 6373 222c 0a20 2020 2022 6772 6174 6973  cs",.    "gratis
-0000f730: 222c 0a20 2020 2022 6772 6565 6e22 2c0a  ",.    "green",.
-0000f740: 2020 2020 2267 7269 7065 222c 0a20 2020      "gripe",.   
-0000f750: 2022 6772 6f63 6572 7922 2c0a 2020 2020   "grocery",.    
-0000f760: 2267 726f 7570 222c 0a20 2020 2022 6773  "group",.    "gs
-0000f770: 222c 0a20 2020 2022 6774 222c 0a20 2020  ",.    "gt",.   
-0000f780: 2022 6775 222c 0a20 2020 2022 6775 6172   "gu",.    "guar
-0000f790: 6469 616e 222c 0a20 2020 2022 6775 6363  dian",.    "gucc
-0000f7a0: 6922 2c0a 2020 2020 2267 7567 6522 2c0a  i",.    "guge",.
-0000f7b0: 2020 2020 2267 7569 6465 222c 0a20 2020      "guide",.   
-0000f7c0: 2022 6775 6974 6172 7322 2c0a 2020 2020   "guitars",.    
-0000f7d0: 2267 7572 7522 2c0a 2020 2020 2267 7722  "guru",.    "gw"
-0000f7e0: 2c0a 2020 2020 2267 7922 2c0a 2020 2020  ,.    "gy",.    
-0000f7f0: 2320 680a 2020 2020 2268 6169 7222 2c0a  # h.    "hair",.
-0000f800: 2020 2020 2268 616d 6275 7267 222c 0a20      "hamburg",. 
-0000f810: 2020 2022 6861 6e67 6f75 7422 2c0a 2020     "hangout",.  
-0000f820: 2020 2268 6175 7322 2c0a 2020 2020 2268    "haus",.    "h
-0000f830: 626f 222c 0a20 2020 2022 6864 6663 222c  bo",.    "hdfc",
-0000f840: 0a20 2020 2022 6864 6663 6261 6e6b 222c  .    "hdfcbank",
-0000f850: 0a20 2020 2022 6865 616c 7468 222c 0a20  .    "health",. 
-0000f860: 2020 2022 6865 616c 7468 6361 7265 222c     "healthcare",
-0000f870: 0a20 2020 2022 6865 6c70 222c 0a20 2020  .    "help",.   
-0000f880: 2022 6865 6c73 696e 6b69 222c 0a20 2020   "helsinki",.   
-0000f890: 2022 6865 7265 222c 0a20 2020 2022 6865   "here",.    "he
-0000f8a0: 726d 6573 222c 0a20 2020 2022 6867 7476  rmes",.    "hgtv
-0000f8b0: 222c 0a20 2020 2022 6869 7068 6f70 222c  ",.    "hiphop",
-0000f8c0: 0a20 2020 2022 6869 7361 6d69 7473 7522  .    "hisamitsu"
-0000f8d0: 2c0a 2020 2020 2268 6974 6163 6869 222c  ,.    "hitachi",
-0000f8e0: 0a20 2020 2022 6869 7622 2c0a 2020 2020  .    "hiv",.    
-0000f8f0: 2268 6b22 2c0a 2020 2020 2268 6b74 222c  "hk",.    "hkt",
-0000f900: 0a20 2020 2022 686d 222c 0a20 2020 2022  .    "hm",.    "
-0000f910: 686e 222c 0a20 2020 2022 686f 636b 6579  hn",.    "hockey
-0000f920: 222c 0a20 2020 2022 686f 6c64 696e 6773  ",.    "holdings
-0000f930: 222c 0a20 2020 2022 686f 6c69 6461 7922  ",.    "holiday"
-0000f940: 2c0a 2020 2020 2268 6f6d 6564 6570 6f74  ,.    "homedepot
-0000f950: 222c 0a20 2020 2022 686f 6d65 676f 6f64  ",.    "homegood
-0000f960: 7322 2c0a 2020 2020 2268 6f6d 6573 222c  s",.    "homes",
-0000f970: 0a20 2020 2022 686f 6d65 7365 6e73 6522  .    "homesense"
-0000f980: 2c0a 2020 2020 2268 6f6e 6461 222c 0a20  ,.    "honda",. 
-0000f990: 2020 2022 686f 6e65 7977 656c 6c22 2c0a     "honeywell",.
-0000f9a0: 2020 2020 2268 6f72 7365 222c 0a20 2020      "horse",.   
-0000f9b0: 2022 686f 7370 6974 616c 222c 0a20 2020   "hospital",.   
-0000f9c0: 2022 686f 7374 222c 0a20 2020 2022 686f   "host",.    "ho
-0000f9d0: 7374 696e 6722 2c0a 2020 2020 2268 6f74  sting",.    "hot
-0000f9e0: 222c 0a20 2020 2022 686f 7465 6c65 7322  ",.    "hoteles"
-0000f9f0: 2c0a 2020 2020 2268 6f74 656c 7322 2c0a  ,.    "hotels",.
-0000fa00: 2020 2020 2268 6f74 6d61 696c 222c 0a20      "hotmail",. 
-0000fa10: 2020 2022 686f 7573 6522 2c0a 2020 2020     "house",.    
-0000fa20: 2268 6f77 222c 0a20 2020 2022 6872 222c  "how",.    "hr",
-0000fa30: 0a20 2020 2022 6873 6263 222c 0a20 2020  .    "hsbc",.   
-0000fa40: 2022 6874 222c 0a20 2020 2022 6875 222c   "ht",.    "hu",
-0000fa50: 0a20 2020 2022 6875 6768 6573 222c 0a20  .    "hughes",. 
-0000fa60: 2020 2022 6879 6174 7422 2c0a 2020 2020     "hyatt",.    
-0000fa70: 2268 7975 6e64 6169 222c 0a20 2020 2023  "hyundai",.    #
-0000fa80: 2069 0a20 2020 2022 6962 6d22 2c0a 2020   i.    "ibm",.  
-0000fa90: 2020 2269 6362 6322 2c0a 2020 2020 2269    "icbc",.    "i
-0000faa0: 6365 222c 0a20 2020 2022 6963 7522 2c0a  ce",.    "icu",.
-0000fab0: 2020 2020 2269 6422 2c0a 2020 2020 2269      "id",.    "i
-0000fac0: 6522 2c0a 2020 2020 2269 6565 6522 2c0a  e",.    "ieee",.
-0000fad0: 2020 2020 2269 666d 222c 0a20 2020 2022      "ifm",.    "
-0000fae0: 696b 616e 6f22 2c0a 2020 2020 2269 6c22  ikano",.    "il"
-0000faf0: 2c0a 2020 2020 2269 6d22 2c0a 2020 2020  ,.    "im",.    
-0000fb00: 2269 6d61 6d61 7422 2c0a 2020 2020 2269  "imamat",.    "i
-0000fb10: 6d64 6222 2c0a 2020 2020 2269 6d6d 6f22  mdb",.    "immo"
-0000fb20: 2c0a 2020 2020 2269 6d6d 6f62 696c 6965  ,.    "immobilie
-0000fb30: 6e22 2c0a 2020 2020 2269 6e22 2c0a 2020  n",.    "in",.  
-0000fb40: 2020 2269 6e64 7573 7472 6965 7322 2c0a    "industries",.
-0000fb50: 2020 2020 2269 6e66 696e 6974 6922 2c0a      "infiniti",.
-0000fb60: 2020 2020 2269 6e66 6f22 2c0a 2020 2020      "info",.    
-0000fb70: 2269 6e67 222c 0a20 2020 2022 696e 6b22  "ing",.    "ink"
-0000fb80: 2c0a 2020 2020 2269 6e73 7469 7475 7465  ,.    "institute
-0000fb90: 222c 0a20 2020 2022 696e 7375 7261 6e63  ",.    "insuranc
-0000fba0: 6522 2c0a 2020 2020 2269 6e73 7572 6522  e",.    "insure"
-0000fbb0: 2c0a 2020 2020 2269 6e74 222c 0a20 2020  ,.    "int",.   
-0000fbc0: 2022 696e 7465 6c22 2c0a 2020 2020 2269   "intel",.    "i
-0000fbd0: 6e74 6572 6e61 7469 6f6e 616c 222c 0a20  nternational",. 
-0000fbe0: 2020 2022 696e 7475 6974 222c 0a20 2020     "intuit",.   
-0000fbf0: 2022 696e 7665 7374 6d65 6e74 7322 2c0a   "investments",.
-0000fc00: 2020 2020 2269 6f22 2c0a 2020 2020 2269      "io",.    "i
-0000fc10: 7069 7261 6e67 6122 2c0a 2020 2020 2269  piranga",.    "i
-0000fc20: 7122 2c0a 2020 2020 2269 7222 2c0a 2020  q",.    "ir",.  
-0000fc30: 2020 2269 7269 7368 222c 0a20 2020 2022    "irish",.    "
-0000fc40: 6973 222c 0a20 2020 2022 6973 656c 6563  is",.    "iselec
-0000fc50: 7422 2c0a 2020 2020 2269 736d 6169 6c69  t",.    "ismaili
-0000fc60: 222c 0a20 2020 2022 6973 7422 2c0a 2020  ",.    "ist",.  
-0000fc70: 2020 2269 7374 616e 6275 6c22 2c0a 2020    "istanbul",.  
-0000fc80: 2020 2269 7422 2c0a 2020 2020 2269 7461    "it",.    "ita
-0000fc90: 7522 2c0a 2020 2020 2269 7476 222c 0a20  u",.    "itv",. 
-0000fca0: 2020 2022 6976 6563 6f22 2c0a 2020 2020     "iveco",.    
-0000fcb0: 2269 7763 222c 0a20 2020 2023 206a 0a20  "iwc",.    # j. 
-0000fcc0: 2020 2022 6a61 6775 6172 222c 0a20 2020     "jaguar",.   
-0000fcd0: 2022 6a61 7661 222c 0a20 2020 2022 6a63   "java",.    "jc
-0000fce0: 6222 2c0a 2020 2020 226a 6370 222c 0a20  b",.    "jcp",. 
-0000fcf0: 2020 2022 6a65 222c 0a20 2020 2022 6a65     "je",.    "je
-0000fd00: 6570 222c 0a20 2020 2022 6a65 747a 7422  ep",.    "jetzt"
-0000fd10: 2c0a 2020 2020 226a 6577 656c 7279 222c  ,.    "jewelry",
-0000fd20: 0a20 2020 2022 6a69 6f22 2c0a 2020 2020  .    "jio",.    
-0000fd30: 226a 6c63 222c 0a20 2020 2022 6a6c 6c22  "jlc",.    "jll"
-0000fd40: 2c0a 2020 2020 226a 6d22 2c0a 2020 2020  ,.    "jm",.    
-0000fd50: 226a 6d70 222c 0a20 2020 2022 6a6e 6a22  "jmp",.    "jnj"
-0000fd60: 2c0a 2020 2020 226a 6f22 2c0a 2020 2020  ,.    "jo",.    
-0000fd70: 226a 6f62 7322 2c0a 2020 2020 226a 6f62  "jobs",.    "job
-0000fd80: 7572 6722 2c0a 2020 2020 226a 6f74 222c  urg",.    "jot",
-0000fd90: 0a20 2020 2022 6a6f 7922 2c0a 2020 2020  .    "joy",.    
-0000fda0: 226a 7022 2c0a 2020 2020 226a 706d 6f72  "jp",.    "jpmor
-0000fdb0: 6761 6e22 2c0a 2020 2020 226a 7072 7322  gan",.    "jprs"
-0000fdc0: 2c0a 2020 2020 226a 7565 676f 7322 2c0a  ,.    "juegos",.
-0000fdd0: 2020 2020 226a 756e 6970 6572 222c 0a20      "juniper",. 
-0000fde0: 2020 2023 206b 0a20 2020 2022 6b61 7566     # k.    "kauf
-0000fdf0: 656e 222c 0a20 2020 2022 6b64 6469 222c  en",.    "kddi",
-0000fe00: 0a20 2020 2022 6b65 222c 0a20 2020 2022  .    "ke",.    "
-0000fe10: 6b65 7272 7968 6f74 656c 7322 2c0a 2020  kerryhotels",.  
-0000fe20: 2020 226b 6572 7279 6c6f 6769 7374 6963    "kerrylogistic
-0000fe30: 7322 2c0a 2020 2020 226b 6572 7279 7072  s",.    "kerrypr
-0000fe40: 6f70 6572 7469 6573 222c 0a20 2020 2022  operties",.    "
-0000fe50: 6b66 6822 2c0a 2020 2020 226b 6722 2c0a  kfh",.    "kg",.
-0000fe60: 2020 2020 226b 6822 2c0a 2020 2020 226b      "kh",.    "k
-0000fe70: 6922 2c0a 2020 2020 226b 6961 222c 0a20  i",.    "kia",. 
-0000fe80: 2020 2022 6b69 6d22 2c0a 2020 2020 226b     "kim",.    "k
-0000fe90: 696e 6465 7222 2c0a 2020 2020 226b 696e  inder",.    "kin
-0000fea0: 646c 6522 2c0a 2020 2020 226b 6974 6368  dle",.    "kitch
-0000feb0: 656e 222c 0a20 2020 2022 6b69 7769 222c  en",.    "kiwi",
-0000fec0: 0a20 2020 2022 6b6d 222c 0a20 2020 2022  .    "km",.    "
-0000fed0: 6b6e 222c 0a20 2020 2022 6b6f 656c 6e22  kn",.    "koeln"
-0000fee0: 2c0a 2020 2020 226b 6f6d 6174 7375 222c  ,.    "komatsu",
-0000fef0: 0a20 2020 2022 6b6f 7368 6572 222c 0a20  .    "kosher",. 
-0000ff00: 2020 2022 6b70 222c 0a20 2020 2022 6b70     "kp",.    "kp
-0000ff10: 6d67 222c 0a20 2020 2022 6b70 6e22 2c0a  mg",.    "kpn",.
-0000ff20: 2020 2020 226b 7222 2c0a 2020 2020 226b      "kr",.    "k
-0000ff30: 7264 222c 0a20 2020 2022 6b72 6564 222c  rd",.    "kred",
-0000ff40: 0a20 2020 2022 6b75 6f6b 6772 6f75 7022  .    "kuokgroup"
-0000ff50: 2c0a 2020 2020 226b 7722 2c0a 2020 2020  ,.    "kw",.    
-0000ff60: 226b 7922 2c0a 2020 2020 226b 796f 746f  "ky",.    "kyoto
-0000ff70: 222c 0a20 2020 2022 6b7a 222c 0a20 2020  ",.    "kz",.   
-0000ff80: 2023 206c 0a20 2020 2022 6c61 222c 0a20   # l.    "la",. 
-0000ff90: 2020 2022 6c61 6361 6978 6122 2c0a 2020     "lacaixa",.  
-0000ffa0: 2020 226c 6164 6272 6f6b 6573 222c 0a20    "ladbrokes",. 
-0000ffb0: 2020 2022 6c61 6d62 6f72 6768 696e 6922     "lamborghini"
-0000ffc0: 2c0a 2020 2020 226c 616d 6572 222c 0a20  ,.    "lamer",. 
-0000ffd0: 2020 2022 6c61 6e63 6173 7465 7222 2c0a     "lancaster",.
-0000ffe0: 2020 2020 226c 616e 6369 6122 2c0a 2020      "lancia",.  
-0000fff0: 2020 226c 616e 636f 6d65 222c 0a20 2020    "lancome",.   
-00010000: 2022 6c61 6e64 222c 0a20 2020 2022 6c61   "land",.    "la
-00010010: 6e64 726f 7665 7222 2c0a 2020 2020 226c  ndrover",.    "l
-00010020: 616e 7865 7373 222c 0a20 2020 2022 6c61  anxess",.    "la
-00010030: 7361 6c6c 6522 2c0a 2020 2020 226c 6174  salle",.    "lat
-00010040: 222c 0a20 2020 2022 6c61 7469 6e6f 222c  ",.    "latino",
-00010050: 0a20 2020 2022 6c61 7472 6f62 6522 2c0a  .    "latrobe",.
-00010060: 2020 2020 226c 6177 222c 0a20 2020 2022      "law",.    "
-00010070: 6c61 7779 6572 222c 0a20 2020 2022 6c62  lawyer",.    "lb
-00010080: 222c 0a20 2020 2022 6c63 222c 0a20 2020  ",.    "lc",.   
-00010090: 2022 6c64 7322 2c0a 2020 2020 226c 6561   "lds",.    "lea
-000100a0: 7365 222c 0a20 2020 2022 6c65 636c 6572  se",.    "lecler
-000100b0: 6322 2c0a 2020 2020 226c 6566 7261 6b22  c",.    "lefrak"
-000100c0: 2c0a 2020 2020 226c 6567 616c 222c 0a20  ,.    "legal",. 
-000100d0: 2020 2022 6c65 676f 222c 0a20 2020 2022     "lego",.    "
-000100e0: 6c65 7875 7322 2c0a 2020 2020 226c 6762  lexus",.    "lgb
-000100f0: 7422 2c0a 2020 2020 226c 6922 2c0a 2020  t",.    "li",.  
-00010100: 2020 226c 6961 6973 6f6e 222c 0a20 2020    "liaison",.   
-00010110: 2022 6c69 646c 222c 0a20 2020 2022 6c69   "lidl",.    "li
-00010120: 6665 222c 0a20 2020 2022 6c69 6665 696e  fe",.    "lifein
-00010130: 7375 7261 6e63 6522 2c0a 2020 2020 226c  surance",.    "l
-00010140: 6966 6573 7479 6c65 222c 0a20 2020 2022  ifestyle",.    "
-00010150: 6c69 6768 7469 6e67 222c 0a20 2020 2022  lighting",.    "
-00010160: 6c69 6b65 222c 0a20 2020 2022 6c69 6c6c  like",.    "lill
-00010170: 7922 2c0a 2020 2020 226c 696d 6974 6564  y",.    "limited
-00010180: 222c 0a20 2020 2022 6c69 6d6f 222c 0a20  ",.    "limo",. 
-00010190: 2020 2022 6c69 6e63 6f6c 6e22 2c0a 2020     "lincoln",.  
-000101a0: 2020 226c 696e 6465 222c 0a20 2020 2022    "linde",.    "
-000101b0: 6c69 6e6b 222c 0a20 2020 2022 6c69 7073  link",.    "lips
-000101c0: 7922 2c0a 2020 2020 226c 6976 6522 2c0a  y",.    "live",.
-000101d0: 2020 2020 226c 6976 696e 6722 2c0a 2020      "living",.  
-000101e0: 2020 226c 6978 696c 222c 0a20 2020 2022    "lixil",.    "
-000101f0: 6c6b 222c 0a20 2020 2022 6c6f 616e 222c  lk",.    "loan",
-00010200: 0a20 2020 2022 6c6f 616e 7322 2c0a 2020  .    "loans",.  
-00010210: 2020 226c 6f63 616c 686f 7374 222c 0a20    "localhost",. 
-00010220: 2020 2022 6c6f 636b 6572 222c 0a20 2020     "locker",.   
-00010230: 2022 6c6f 6375 7322 2c0a 2020 2020 226c   "locus",.    "l
-00010240: 6f66 7422 2c0a 2020 2020 226c 6f6c 222c  oft",.    "lol",
-00010250: 0a20 2020 2022 6c6f 6e64 6f6e 222c 0a20  .    "london",. 
-00010260: 2020 2022 6c6f 7474 6522 2c0a 2020 2020     "lotte",.    
-00010270: 226c 6f74 746f 222c 0a20 2020 2022 6c6f  "lotto",.    "lo
-00010280: 7665 222c 0a20 2020 2022 6c70 6c22 2c0a  ve",.    "lpl",.
-00010290: 2020 2020 226c 706c 6669 6e61 6e63 6961      "lplfinancia
-000102a0: 6c22 2c0a 2020 2020 226c 7222 2c0a 2020  l",.    "lr",.  
-000102b0: 2020 226c 7322 2c0a 2020 2020 226c 7422    "ls",.    "lt"
-000102c0: 2c0a 2020 2020 226c 7464 222c 0a20 2020  ,.    "ltd",.   
-000102d0: 2022 6c74 6461 222c 0a20 2020 2022 6c75   "ltda",.    "lu
-000102e0: 222c 0a20 2020 2022 6c75 6e64 6265 636b  ",.    "lundbeck
-000102f0: 222c 0a20 2020 2022 6c75 7069 6e22 2c0a  ",.    "lupin",.
-00010300: 2020 2020 226c 7578 6522 2c0a 2020 2020      "luxe",.    
-00010310: 226c 7578 7572 7922 2c0a 2020 2020 226c  "luxury",.    "l
-00010320: 7622 2c0a 2020 2020 226c 7922 2c0a 2020  v",.    "ly",.  
-00010330: 2020 2320 6d0a 2020 2020 226d 6122 2c0a    # m.    "ma",.
-00010340: 2020 2020 226d 6163 7973 222c 0a20 2020      "macys",.   
-00010350: 2022 6d61 6472 6964 222c 0a20 2020 2022   "madrid",.    "
-00010360: 6d61 6966 222c 0a20 2020 2022 6d61 6973  maif",.    "mais
-00010370: 6f6e 222c 0a20 2020 2022 6d61 6b65 7570  on",.    "makeup
-00010380: 222c 0a20 2020 2022 6d61 6e22 2c0a 2020  ",.    "man",.  
-00010390: 2020 226d 616e 6167 656d 656e 7422 2c0a    "management",.
-000103a0: 2020 2020 226d 616e 676f 222c 0a20 2020      "mango",.   
-000103b0: 2022 6d61 7022 2c0a 2020 2020 226d 6172   "map",.    "mar
-000103c0: 6b65 7422 2c0a 2020 2020 226d 6172 6b65  ket",.    "marke
-000103d0: 7469 6e67 222c 0a20 2020 2022 6d61 726b  ting",.    "mark
-000103e0: 6574 7322 2c0a 2020 2020 226d 6172 7269  ets",.    "marri
-000103f0: 6f74 7422 2c0a 2020 2020 226d 6172 7368  ott",.    "marsh
-00010400: 616c 6c73 222c 0a20 2020 2022 6d61 7365  alls",.    "mase
-00010410: 7261 7469 222c 0a20 2020 2022 6d61 7474  rati",.    "matt
-00010420: 656c 222c 0a20 2020 2022 6d62 6122 2c0a  el",.    "mba",.
-00010430: 2020 2020 226d 6322 2c0a 2020 2020 226d      "mc",.    "m
-00010440: 636b 696e 7365 7922 2c0a 2020 2020 226d  ckinsey",.    "m
-00010450: 6422 2c0a 2020 2020 226d 6522 2c0a 2020  d",.    "me",.  
-00010460: 2020 226d 6564 222c 0a20 2020 2022 6d65    "med",.    "me
-00010470: 6469 6122 2c0a 2020 2020 226d 6565 7422  dia",.    "meet"
-00010480: 2c0a 2020 2020 226d 656c 626f 7572 6e65  ,.    "melbourne
-00010490: 222c 0a20 2020 2022 6d65 6d65 222c 0a20  ",.    "meme",. 
-000104a0: 2020 2022 6d65 6d6f 7269 616c 222c 0a20     "memorial",. 
-000104b0: 2020 2022 6d65 6e22 2c0a 2020 2020 226d     "men",.    "m
-000104c0: 656e 7522 2c0a 2020 2020 226d 656f 222c  enu",.    "meo",
-000104d0: 0a20 2020 2022 6d65 7263 6b6d 7364 222c  .    "merckmsd",
-000104e0: 0a20 2020 2022 6d65 746c 6966 6522 2c0a  .    "metlife",.
-000104f0: 2020 2020 226d 6722 2c0a 2020 2020 226d      "mg",.    "m
-00010500: 6822 2c0a 2020 2020 226d 6961 6d69 222c  h",.    "miami",
-00010510: 0a20 2020 2022 6d69 6372 6f73 6f66 7422  .    "microsoft"
-00010520: 2c0a 2020 2020 226d 696c 222c 0a20 2020  ,.    "mil",.   
-00010530: 2022 6d69 6e69 222c 0a20 2020 2022 6d69   "mini",.    "mi
-00010540: 6e74 222c 0a20 2020 2022 6d69 7422 2c0a  nt",.    "mit",.
-00010550: 2020 2020 226d 6974 7375 6269 7368 6922      "mitsubishi"
-00010560: 2c0a 2020 2020 226d 6b22 2c0a 2020 2020  ,.    "mk",.    
-00010570: 226d 6c22 2c0a 2020 2020 226d 6c62 222c  "ml",.    "mlb",
-00010580: 0a20 2020 2022 6d6c 7322 2c0a 2020 2020  .    "mls",.    
-00010590: 226d 6d22 2c0a 2020 2020 226d 6d61 222c  "mm",.    "mma",
-000105a0: 0a20 2020 2022 6d6e 222c 0a20 2020 2022  .    "mn",.    "
-000105b0: 6d6f 222c 0a20 2020 2022 6d6f 6269 222c  mo",.    "mobi",
-000105c0: 0a20 2020 2022 6d6f 6269 6c65 222c 0a20  .    "mobile",. 
-000105d0: 2020 2022 6d6f 6269 6c79 222c 0a20 2020     "mobily",.   
-000105e0: 2022 6d6f 6461 222c 0a20 2020 2022 6d6f   "moda",.    "mo
-000105f0: 6522 2c0a 2020 2020 226d 6f69 222c 0a20  e",.    "moi",. 
-00010600: 2020 2022 6d6f 6d22 2c0a 2020 2020 226d     "mom",.    "m
-00010610: 6f6e 6173 6822 2c0a 2020 2020 226d 6f6e  onash",.    "mon
-00010620: 6579 222c 0a20 2020 2022 6d6f 6e73 7465  ey",.    "monste
-00010630: 7222 2c0a 2020 2020 226d 6f70 6172 222c  r",.    "mopar",
-00010640: 0a20 2020 2022 6d6f 726d 6f6e 222c 0a20  .    "mormon",. 
-00010650: 2020 2022 6d6f 7274 6761 6765 222c 0a20     "mortgage",. 
-00010660: 2020 2022 6d6f 7363 6f77 222c 0a20 2020     "moscow",.   
-00010670: 2022 6d6f 746f 222c 0a20 2020 2022 6d6f   "moto",.    "mo
-00010680: 746f 7263 7963 6c65 7322 2c0a 2020 2020  torcycles",.    
-00010690: 226d 6f76 222c 0a20 2020 2022 6d6f 7669  "mov",.    "movi
-000106a0: 6522 2c0a 2020 2020 226d 6f76 6973 7461  e",.    "movista
-000106b0: 7222 2c0a 2020 2020 226d 7022 2c0a 2020  r",.    "mp",.  
-000106c0: 2020 226d 7122 2c0a 2020 2020 226d 7222    "mq",.    "mr"
-000106d0: 2c0a 2020 2020 226d 7322 2c0a 2020 2020  ,.    "ms",.    
-000106e0: 226d 7364 222c 0a20 2020 2022 6d74 222c  "msd",.    "mt",
-000106f0: 0a20 2020 2022 6d74 6e22 2c0a 2020 2020  .    "mtn",.    
-00010700: 226d 7472 222c 0a20 2020 2022 6d75 222c  "mtr",.    "mu",
-00010710: 0a20 2020 2022 6d75 7365 756d 222c 0a20  .    "museum",. 
-00010720: 2020 2022 6d75 7475 616c 222c 0a20 2020     "mutual",.   
-00010730: 2022 6d76 222c 0a20 2020 2022 6d77 222c   "mv",.    "mw",
-00010740: 0a20 2020 2022 6d78 222c 0a20 2020 2022  .    "mx",.    "
-00010750: 6d79 222c 0a20 2020 2022 6d7a 222c 0a20  my",.    "mz",. 
-00010760: 2020 2023 206e 0a20 2020 2022 6e61 222c     # n.    "na",
-00010770: 0a20 2020 2022 6e61 6222 2c0a 2020 2020  .    "nab",.    
-00010780: 226e 6164 6578 222c 0a20 2020 2022 6e61  "nadex",.    "na
-00010790: 676f 7961 222c 0a20 2020 2022 6e61 6d65  goya",.    "name
-000107a0: 222c 0a20 2020 2022 6e61 7469 6f6e 7769  ",.    "nationwi
-000107b0: 6465 222c 0a20 2020 2022 6e61 7475 7261  de",.    "natura
-000107c0: 222c 0a20 2020 2022 6e61 7679 222c 0a20  ",.    "navy",. 
-000107d0: 2020 2022 6e62 6122 2c0a 2020 2020 226e     "nba",.    "n
-000107e0: 6322 2c0a 2020 2020 226e 6522 2c0a 2020  c",.    "ne",.  
-000107f0: 2020 226e 6563 222c 0a20 2020 2022 6e65    "nec",.    "ne
-00010800: 7422 2c0a 2020 2020 226e 6574 6261 6e6b  t",.    "netbank
-00010810: 222c 0a20 2020 2022 6e65 7466 6c69 7822  ",.    "netflix"
-00010820: 2c0a 2020 2020 226e 6574 776f 726b 222c  ,.    "network",
-00010830: 0a20 2020 2022 6e65 7573 7461 7222 2c0a  .    "neustar",.
-00010840: 2020 2020 226e 6577 222c 0a20 2020 2022      "new",.    "
-00010850: 6e65 7768 6f6c 6c61 6e64 222c 0a20 2020  newholland",.   
-00010860: 2022 6e65 7773 222c 0a20 2020 2022 6e65   "news",.    "ne
-00010870: 7874 222c 0a20 2020 2022 6e65 7874 6469  xt",.    "nextdi
-00010880: 7265 6374 222c 0a20 2020 2022 6e65 7875  rect",.    "nexu
-00010890: 7322 2c0a 2020 2020 226e 6622 2c0a 2020  s",.    "nf",.  
-000108a0: 2020 226e 666c 222c 0a20 2020 2022 6e67    "nfl",.    "ng
-000108b0: 222c 0a20 2020 2022 6e67 6f22 2c0a 2020  ",.    "ngo",.  
-000108c0: 2020 226e 686b 222c 0a20 2020 2022 6e69    "nhk",.    "ni
-000108d0: 222c 0a20 2020 2022 6e69 636f 222c 0a20  ",.    "nico",. 
-000108e0: 2020 2022 6e69 6b65 222c 0a20 2020 2022     "nike",.    "
-000108f0: 6e69 6b6f 6e22 2c0a 2020 2020 226e 696e  nikon",.    "nin
-00010900: 6a61 222c 0a20 2020 2022 6e69 7373 616e  ja",.    "nissan
-00010910: 222c 0a20 2020 2022 6e69 7373 6179 222c  ",.    "nissay",
-00010920: 0a20 2020 2022 6e6c 222c 0a20 2020 2022  .    "nl",.    "
-00010930: 6e6f 222c 0a20 2020 2022 6e6f 6b69 6122  no",.    "nokia"
-00010940: 2c0a 2020 2020 226e 6f72 7468 7765 7374  ,.    "northwest
-00010950: 6572 6e6d 7574 7561 6c22 2c0a 2020 2020  ernmutual",.    
-00010960: 226e 6f72 746f 6e22 2c0a 2020 2020 226e  "norton",.    "n
-00010970: 6f77 222c 0a20 2020 2022 6e6f 7772 757a  ow",.    "nowruz
-00010980: 222c 0a20 2020 2022 6e6f 7774 7622 2c0a  ",.    "nowtv",.
-00010990: 2020 2020 226e 7022 2c0a 2020 2020 226e      "np",.    "n
-000109a0: 7222 2c0a 2020 2020 226e 7261 222c 0a20  r",.    "nra",. 
-000109b0: 2020 2022 6e72 7722 2c0a 2020 2020 226e     "nrw",.    "n
-000109c0: 7474 222c 0a20 2020 2022 6e75 222c 0a20  tt",.    "nu",. 
-000109d0: 2020 2022 6e79 6322 2c0a 2020 2020 226e     "nyc",.    "n
-000109e0: 7a22 2c0a 2020 2020 2320 6f0a 2020 2020  z",.    # o.    
-000109f0: 226f 6269 222c 0a20 2020 2022 6f62 7365  "obi",.    "obse
-00010a00: 7276 6572 222c 0a20 2020 2022 6f66 6622  rver",.    "off"
-00010a10: 2c0a 2020 2020 226f 6666 6963 6522 2c0a  ,.    "office",.
-00010a20: 2020 2020 226f 6b69 6e61 7761 222c 0a20      "okinawa",. 
-00010a30: 2020 2022 6f6c 6179 616e 222c 0a20 2020     "olayan",.   
-00010a40: 2022 6f6c 6179 616e 6772 6f75 7022 2c0a   "olayangroup",.
-00010a50: 2020 2020 226f 6c64 6e61 7679 222c 0a20      "oldnavy",. 
-00010a60: 2020 2022 6f6c 6c6f 222c 0a20 2020 2022     "ollo",.    "
-00010a70: 6f6d 222c 0a20 2020 2022 6f6d 6567 6122  om",.    "omega"
-00010a80: 2c0a 2020 2020 226f 6e65 222c 0a20 2020  ,.    "one",.   
-00010a90: 2022 6f6e 6722 2c0a 2020 2020 226f 6e6c   "ong",.    "onl
-00010aa0: 222c 0a20 2020 2022 6f6e 6c69 6e65 222c  ",.    "online",
-00010ab0: 0a20 2020 2022 6f6e 796f 7572 7369 6465  .    "onyourside
-00010ac0: 222c 0a20 2020 2022 6f6f 6f22 2c0a 2020  ",.    "ooo",.  
-00010ad0: 2020 226f 7065 6e22 2c0a 2020 2020 226f    "open",.    "o
-00010ae0: 7261 636c 6522 2c0a 2020 2020 226f 7261  racle",.    "ora
-00010af0: 6e67 6522 2c0a 2020 2020 226f 7267 222c  nge",.    "org",
-00010b00: 0a20 2020 2022 6f72 6761 6e69 6322 2c0a  .    "organic",.
-00010b10: 2020 2020 226f 7269 6769 6e73 222c 0a20      "origins",. 
-00010b20: 2020 2022 6f73 616b 6122 2c0a 2020 2020     "osaka",.    
-00010b30: 226f 7473 756b 6122 2c0a 2020 2020 226f  "otsuka",.    "o
-00010b40: 7474 222c 0a20 2020 2022 6f76 6822 2c0a  tt",.    "ovh",.
-00010b50: 2020 2020 2320 700a 2020 2020 2270 6122      # p.    "pa"
-00010b60: 2c0a 2020 2020 2270 6167 6522 2c0a 2020  ,.    "page",.  
-00010b70: 2020 2270 616e 6173 6f6e 6963 222c 0a20    "panasonic",. 
-00010b80: 2020 2022 7061 6e65 7261 6922 2c0a 2020     "panerai",.  
-00010b90: 2020 2270 6172 6973 222c 0a20 2020 2022    "paris",.    "
-00010ba0: 7061 7273 222c 0a20 2020 2022 7061 7274  pars",.    "part
-00010bb0: 6e65 7273 222c 0a20 2020 2022 7061 7274  ners",.    "part
-00010bc0: 7322 2c0a 2020 2020 2270 6172 7479 222c  s",.    "party",
-00010bd0: 0a20 2020 2022 7061 7373 6167 656e 7322  .    "passagens"
-00010be0: 2c0a 2020 2020 2270 6179 222c 0a20 2020  ,.    "pay",.   
-00010bf0: 2022 7063 6377 222c 0a20 2020 2022 7065   "pccw",.    "pe
-00010c00: 222c 0a20 2020 2022 7065 7422 2c0a 2020  ",.    "pet",.  
-00010c10: 2020 2270 6622 2c0a 2020 2020 2270 6669    "pf",.    "pfi
-00010c20: 7a65 7222 2c0a 2020 2020 2270 6722 2c0a  zer",.    "pg",.
-00010c30: 2020 2020 2270 6822 2c0a 2020 2020 2270      "ph",.    "p
-00010c40: 6861 726d 6163 7922 2c0a 2020 2020 2270  harmacy",.    "p
-00010c50: 6864 222c 0a20 2020 2022 7068 696c 6970  hd",.    "philip
-00010c60: 7322 2c0a 2020 2020 2270 686f 6e65 222c  s",.    "phone",
-00010c70: 0a20 2020 2022 7068 6f74 6f22 2c0a 2020  .    "photo",.  
-00010c80: 2020 2270 686f 746f 6772 6170 6879 222c    "photography",
-00010c90: 0a20 2020 2022 7068 6f74 6f73 222c 0a20  .    "photos",. 
-00010ca0: 2020 2022 7068 7973 696f 222c 0a20 2020     "physio",.   
-00010cb0: 2022 7069 6167 6574 222c 0a20 2020 2022   "piaget",.    "
-00010cc0: 7069 6373 222c 0a20 2020 2022 7069 6374  pics",.    "pict
-00010cd0: 6574 222c 0a20 2020 2022 7069 6374 7572  et",.    "pictur
-00010ce0: 6573 222c 0a20 2020 2022 7069 6422 2c0a  es",.    "pid",.
-00010cf0: 2020 2020 2270 696e 222c 0a20 2020 2022      "pin",.    "
-00010d00: 7069 6e67 222c 0a20 2020 2022 7069 6e6b  ping",.    "pink
-00010d10: 222c 0a20 2020 2022 7069 6f6e 6565 7222  ",.    "pioneer"
-00010d20: 2c0a 2020 2020 2270 697a 7a61 222c 0a20  ,.    "pizza",. 
-00010d30: 2020 2022 706b 222c 0a20 2020 2022 706c     "pk",.    "pl
-00010d40: 222c 0a20 2020 2022 706c 6163 6522 2c0a  ",.    "place",.
-00010d50: 2020 2020 2270 6c61 7922 2c0a 2020 2020      "play",.    
-00010d60: 2270 6c61 7973 7461 7469 6f6e 222c 0a20  "playstation",. 
-00010d70: 2020 2022 706c 756d 6269 6e67 222c 0a20     "plumbing",. 
-00010d80: 2020 2022 706c 7573 222c 0a20 2020 2022     "plus",.    "
-00010d90: 706d 222c 0a20 2020 2022 706e 222c 0a20  pm",.    "pn",. 
-00010da0: 2020 2022 706e 6322 2c0a 2020 2020 2270     "pnc",.    "p
-00010db0: 6f68 6c22 2c0a 2020 2020 2270 6f6b 6572  ohl",.    "poker
-00010dc0: 222c 0a20 2020 2022 706f 6c69 7469 6522  ",.    "politie"
-00010dd0: 2c0a 2020 2020 2270 6f72 6e22 2c0a 2020  ,.    "porn",.  
-00010de0: 2020 2270 6f73 7422 2c0a 2020 2020 2270    "post",.    "p
-00010df0: 7222 2c0a 2020 2020 2270 7261 6d65 7269  r",.    "prameri
-00010e00: 6361 222c 0a20 2020 2022 7072 6178 6922  ca",.    "praxi"
-00010e10: 2c0a 2020 2020 2270 7265 7373 222c 0a20  ,.    "press",. 
-00010e20: 2020 2022 7072 696d 6522 2c0a 2020 2020     "prime",.    
-00010e30: 2270 726f 222c 0a20 2020 2022 7072 6f64  "pro",.    "prod
-00010e40: 222c 0a20 2020 2022 7072 6f64 7563 7469  ",.    "producti
-00010e50: 6f6e 7322 2c0a 2020 2020 2270 726f 6622  ons",.    "prof"
-00010e60: 2c0a 2020 2020 2270 726f 6772 6573 7369  ,.    "progressi
-00010e70: 7665 222c 0a20 2020 2022 7072 6f6d 6f22  ve",.    "promo"
-00010e80: 2c0a 2020 2020 2270 726f 7065 7274 6965  ,.    "propertie
-00010e90: 7322 2c0a 2020 2020 2270 726f 7065 7274  s",.    "propert
-00010ea0: 7922 2c0a 2020 2020 2270 726f 7465 6374  y",.    "protect
-00010eb0: 696f 6e22 2c0a 2020 2020 2270 7275 222c  ion",.    "pru",
-00010ec0: 0a20 2020 2022 7072 7564 656e 7469 616c  .    "prudential
-00010ed0: 222c 0a20 2020 2022 7073 222c 0a20 2020  ",.    "ps",.   
-00010ee0: 2022 7074 222c 0a20 2020 2022 7075 6222   "pt",.    "pub"
-00010ef0: 2c0a 2020 2020 2270 7722 2c0a 2020 2020  ,.    "pw",.    
-00010f00: 2270 7763 222c 0a20 2020 2022 7079 222c  "pwc",.    "py",
-00010f10: 0a20 2020 2023 2071 0a20 2020 2022 7161  .    # q.    "qa
-00010f20: 222c 0a20 2020 2022 7170 6f6e 222c 0a20  ",.    "qpon",. 
-00010f30: 2020 2022 7175 6562 6563 222c 0a20 2020     "quebec",.   
-00010f40: 2022 7175 6573 7422 2c0a 2020 2020 2271   "quest",.    "q
-00010f50: 7663 222c 0a20 2020 2023 2072 0a20 2020  vc",.    # r.   
-00010f60: 2022 7261 6369 6e67 222c 0a20 2020 2022   "racing",.    "
-00010f70: 7261 6469 6f22 2c0a 2020 2020 2272 6169  radio",.    "rai
-00010f80: 6422 2c0a 2020 2020 2272 6522 2c0a 2020  d",.    "re",.  
-00010f90: 2020 2272 6561 6422 2c0a 2020 2020 2272    "read",.    "r
-00010fa0: 6561 6c65 7374 6174 6522 2c0a 2020 2020  ealestate",.    
-00010fb0: 2272 6561 6c74 6f72 222c 0a20 2020 2022  "realtor",.    "
-00010fc0: 7265 616c 7479 222c 0a20 2020 2022 7265  realty",.    "re
-00010fd0: 6369 7065 7322 2c0a 2020 2020 2272 6564  cipes",.    "red
-00010fe0: 222c 0a20 2020 2022 7265 6473 746f 6e65  ",.    "redstone
-00010ff0: 222c 0a20 2020 2022 7265 6475 6d62 7265  ",.    "redumbre
-00011000: 6c6c 6122 2c0a 2020 2020 2272 6568 6162  lla",.    "rehab
-00011010: 222c 0a20 2020 2022 7265 6973 6522 2c0a  ",.    "reise",.
-00011020: 2020 2020 2272 6569 7365 6e22 2c0a 2020      "reisen",.  
-00011030: 2020 2272 6569 7422 2c0a 2020 2020 2272    "reit",.    "r
-00011040: 656c 6961 6e63 6522 2c0a 2020 2020 2272  eliance",.    "r
-00011050: 656e 222c 0a20 2020 2022 7265 6e74 222c  en",.    "rent",
-00011060: 0a20 2020 2022 7265 6e74 616c 7322 2c0a  .    "rentals",.
-00011070: 2020 2020 2272 6570 6169 7222 2c0a 2020      "repair",.  
-00011080: 2020 2272 6570 6f72 7422 2c0a 2020 2020    "report",.    
-00011090: 2272 6570 7562 6c69 6361 6e22 2c0a 2020  "republican",.  
-000110a0: 2020 2272 6573 7422 2c0a 2020 2020 2272    "rest",.    "r
-000110b0: 6573 7461 7572 616e 7422 2c0a 2020 2020  estaurant",.    
-000110c0: 2272 6576 6965 7722 2c0a 2020 2020 2272  "review",.    "r
-000110d0: 6576 6965 7773 222c 0a20 2020 2022 7265  eviews",.    "re
-000110e0: 7872 6f74 6822 2c0a 2020 2020 2272 6963  xroth",.    "ric
-000110f0: 6822 2c0a 2020 2020 2272 6963 6861 7264  h",.    "richard
-00011100: 6c69 222c 0a20 2020 2022 7269 636f 6822  li",.    "ricoh"
-00011110: 2c0a 2020 2020 2272 6967 6874 6174 686f  ,.    "rightatho
-00011120: 6d65 222c 0a20 2020 2022 7269 6c22 2c0a  me",.    "ril",.
-00011130: 2020 2020 2272 696f 222c 0a20 2020 2022      "rio",.    "
-00011140: 7269 7022 2c0a 2020 2020 2272 6d69 7422  rip",.    "rmit"
-00011150: 2c0a 2020 2020 2272 6f22 2c0a 2020 2020  ,.    "ro",.    
-00011160: 2272 6f63 6865 7222 2c0a 2020 2020 2272  "rocher",.    "r
-00011170: 6f63 6b73 222c 0a20 2020 2022 726f 6465  ocks",.    "rode
-00011180: 6f22 2c0a 2020 2020 2272 6f67 6572 7322  o",.    "rogers"
-00011190: 2c0a 2020 2020 2272 6f6f 6d22 2c0a 2020  ,.    "room",.  
-000111a0: 2020 2272 7322 2c0a 2020 2020 2272 7376    "rs",.    "rsv
-000111b0: 7022 2c0a 2020 2020 2272 7522 2c0a 2020  p",.    "ru",.  
-000111c0: 2020 2272 7567 6279 222c 0a20 2020 2022    "rugby",.    "
-000111d0: 7275 6872 222c 0a20 2020 2022 7275 6e22  ruhr",.    "run"
-000111e0: 2c0a 2020 2020 2272 7722 2c0a 2020 2020  ,.    "rw",.    
-000111f0: 2272 7765 222c 0a20 2020 2022 7279 756b  "rwe",.    "ryuk
-00011200: 7975 222c 0a20 2020 2023 2073 0a20 2020  yu",.    # s.   
-00011210: 2022 7361 222c 0a20 2020 2022 7361 6172   "sa",.    "saar
-00011220: 6c61 6e64 222c 0a20 2020 2022 7361 6665  land",.    "safe
-00011230: 222c 0a20 2020 2022 7361 6665 7479 222c  ",.    "safety",
-00011240: 0a20 2020 2022 7361 6b75 7261 222c 0a20  .    "sakura",. 
-00011250: 2020 2022 7361 6c65 222c 0a20 2020 2022     "sale",.    "
-00011260: 7361 6c6f 6e22 2c0a 2020 2020 2273 616d  salon",.    "sam
-00011270: 7363 6c75 6222 2c0a 2020 2020 2273 616d  sclub",.    "sam
-00011280: 7375 6e67 222c 0a20 2020 2022 7361 6e64  sung",.    "sand
-00011290: 7669 6b22 2c0a 2020 2020 2273 616e 6476  vik",.    "sandv
-000112a0: 696b 636f 726f 6d61 6e74 222c 0a20 2020  ikcoromant",.   
-000112b0: 2022 7361 6e6f 6669 222c 0a20 2020 2022   "sanofi",.    "
-000112c0: 7361 7022 2c0a 2020 2020 2273 6170 6f22  sap",.    "sapo"
-000112d0: 2c0a 2020 2020 2273 6172 6c22 2c0a 2020  ,.    "sarl",.  
-000112e0: 2020 2273 6173 222c 0a20 2020 2022 7361    "sas",.    "sa
-000112f0: 7665 222c 0a20 2020 2022 7361 786f 222c  ve",.    "saxo",
-00011300: 0a20 2020 2022 7362 222c 0a20 2020 2022  .    "sb",.    "
-00011310: 7362 6922 2c0a 2020 2020 2273 6273 222c  sbi",.    "sbs",
-00011320: 0a20 2020 2022 7363 222c 0a20 2020 2022  .    "sc",.    "
-00011330: 7363 6122 2c0a 2020 2020 2273 6362 222c  sca",.    "scb",
-00011340: 0a20 2020 2022 7363 6861 6566 666c 6572  .    "schaeffler
-00011350: 222c 0a20 2020 2022 7363 686d 6964 7422  ",.    "schmidt"
-00011360: 2c0a 2020 2020 2273 6368 6f6c 6172 7368  ,.    "scholarsh
-00011370: 6970 7322 2c0a 2020 2020 2273 6368 6f6f  ips",.    "schoo
-00011380: 6c22 2c0a 2020 2020 2273 6368 756c 6522  l",.    "schule"
-00011390: 2c0a 2020 2020 2273 6368 7761 727a 222c  ,.    "schwarz",
-000113a0: 0a20 2020 2022 7363 6965 6e63 6522 2c0a  .    "science",.
-000113b0: 2020 2020 2273 636a 6f68 6e73 6f6e 222c      "scjohnson",
-000113c0: 0a20 2020 2022 7363 6f72 222c 0a20 2020  .    "scor",.   
-000113d0: 2022 7363 6f74 222c 0a20 2020 2022 7364   "scot",.    "sd
-000113e0: 222c 0a20 2020 2022 7365 222c 0a20 2020  ",.    "se",.   
-000113f0: 2022 7365 6172 6368 222c 0a20 2020 2022   "search",.    "
-00011400: 7365 6174 222c 0a20 2020 2022 7365 6375  seat",.    "secu
-00011410: 7265 222c 0a20 2020 2022 7365 6375 7269  re",.    "securi
-00011420: 7479 222c 0a20 2020 2022 7365 656b 222c  ty",.    "seek",
-00011430: 0a20 2020 2022 7365 6c65 6374 222c 0a20  .    "select",. 
-00011440: 2020 2022 7365 6e65 7222 2c0a 2020 2020     "sener",.    
-00011450: 2273 6572 7669 6365 7322 2c0a 2020 2020  "services",.    
-00011460: 2273 6573 222c 0a20 2020 2022 7365 7665  "ses",.    "seve
-00011470: 6e22 2c0a 2020 2020 2273 6577 222c 0a20  n",.    "sew",. 
-00011480: 2020 2022 7365 7822 2c0a 2020 2020 2273     "sex",.    "s
-00011490: 6578 7922 2c0a 2020 2020 2273 6672 222c  exy",.    "sfr",
-000114a0: 0a20 2020 2022 7367 222c 0a20 2020 2022  .    "sg",.    "
-000114b0: 7368 222c 0a20 2020 2022 7368 616e 6772  sh",.    "shangr
-000114c0: 696c 6122 2c0a 2020 2020 2273 6861 7270  ila",.    "sharp
-000114d0: 222c 0a20 2020 2022 7368 6177 222c 0a20  ",.    "shaw",. 
-000114e0: 2020 2022 7368 656c 6c22 2c0a 2020 2020     "shell",.    
-000114f0: 2273 6869 6122 2c0a 2020 2020 2273 6869  "shia",.    "shi
-00011500: 6b73 6861 222c 0a20 2020 2022 7368 6f65  ksha",.    "shoe
-00011510: 7322 2c0a 2020 2020 2273 686f 7022 2c0a  s",.    "shop",.
-00011520: 2020 2020 2273 686f 7070 696e 6722 2c0a      "shopping",.
-00011530: 2020 2020 2273 686f 756a 6922 2c0a 2020      "shouji",.  
-00011540: 2020 2273 686f 7722 2c0a 2020 2020 2273    "show",.    "s
-00011550: 686f 7774 696d 6522 2c0a 2020 2020 2273  howtime",.    "s
-00011560: 6872 6972 616d 222c 0a20 2020 2022 7369  hriram",.    "si
-00011570: 222c 0a20 2020 2022 7369 6c6b 222c 0a20  ",.    "silk",. 
-00011580: 2020 2022 7369 6e61 222c 0a20 2020 2022     "sina",.    "
-00011590: 7369 6e67 6c65 7322 2c0a 2020 2020 2273  singles",.    "s
-000115a0: 6974 6522 2c0a 2020 2020 2273 6a22 2c0a  ite",.    "sj",.
-000115b0: 2020 2020 2273 6b22 2c0a 2020 2020 2273      "sk",.    "s
-000115c0: 6b69 222c 0a20 2020 2022 736b 696e 222c  ki",.    "skin",
-000115d0: 0a20 2020 2022 736b 7922 2c0a 2020 2020  .    "sky",.    
-000115e0: 2273 6b79 7065 222c 0a20 2020 2022 736c  "skype",.    "sl
-000115f0: 222c 0a20 2020 2022 736c 696e 6722 2c0a  ",.    "sling",.
-00011600: 2020 2020 2273 6d22 2c0a 2020 2020 2273      "sm",.    "s
-00011610: 6d61 7274 222c 0a20 2020 2022 736d 696c  mart",.    "smil
-00011620: 6522 2c0a 2020 2020 2273 6e22 2c0a 2020  e",.    "sn",.  
-00011630: 2020 2273 6e63 6622 2c0a 2020 2020 2273    "sncf",.    "s
-00011640: 6f22 2c0a 2020 2020 2273 6f63 6365 7222  o",.    "soccer"
-00011650: 2c0a 2020 2020 2273 6f63 6961 6c22 2c0a  ,.    "social",.
-00011660: 2020 2020 2273 6f66 7462 616e 6b22 2c0a      "softbank",.
-00011670: 2020 2020 2273 6f66 7477 6172 6522 2c0a      "software",.
-00011680: 2020 2020 2273 6f68 7522 2c0a 2020 2020      "sohu",.    
-00011690: 2273 6f6c 6172 222c 0a20 2020 2022 736f  "solar",.    "so
-000116a0: 6c75 7469 6f6e 7322 2c0a 2020 2020 2273  lutions",.    "s
-000116b0: 6f6e 6722 2c0a 2020 2020 2273 6f6e 7922  ong",.    "sony"
-000116c0: 2c0a 2020 2020 2273 6f79 222c 0a20 2020  ,.    "soy",.   
-000116d0: 2022 7370 6163 6522 2c0a 2020 2020 2273   "space",.    "s
-000116e0: 7069 6567 656c 222c 0a20 2020 2022 7370  piegel",.    "sp
-000116f0: 6f74 222c 0a20 2020 2022 7370 7265 6164  ot",.    "spread
-00011700: 6265 7474 696e 6722 2c0a 2020 2020 2273  betting",.    "s
-00011710: 7222 2c0a 2020 2020 2273 726c 222c 0a20  r",.    "srl",. 
-00011720: 2020 2022 7372 7422 2c0a 2020 2020 2273     "srt",.    "s
-00011730: 7422 2c0a 2020 2020 2273 7461 6461 222c  t",.    "stada",
-00011740: 0a20 2020 2022 7374 6170 6c65 7322 2c0a  .    "staples",.
-00011750: 2020 2020 2273 7461 7222 2c0a 2020 2020      "star",.    
-00011760: 2273 7461 7268 7562 222c 0a20 2020 2022  "starhub",.    "
-00011770: 7374 6174 6562 616e 6b22 2c0a 2020 2020  statebank",.    
-00011780: 2273 7461 7465 6661 726d 222c 0a20 2020  "statefarm",.   
-00011790: 2022 7374 6174 6f69 6c22 2c0a 2020 2020   "statoil",.    
-000117a0: 2273 7463 222c 0a20 2020 2022 7374 6367  "stc",.    "stcg
-000117b0: 726f 7570 222c 0a20 2020 2022 7374 6f63  roup",.    "stoc
-000117c0: 6b68 6f6c 6d22 2c0a 2020 2020 2273 746f  kholm",.    "sto
-000117d0: 7261 6765 222c 0a20 2020 2022 7374 6f72  rage",.    "stor
-000117e0: 6522 2c0a 2020 2020 2273 7472 6561 6d22  e",.    "stream"
-000117f0: 2c0a 2020 2020 2273 7475 6469 6f22 2c0a  ,.    "studio",.
-00011800: 2020 2020 2273 7475 6479 222c 0a20 2020      "study",.   
-00011810: 2022 7374 796c 6522 2c0a 2020 2020 2273   "style",.    "s
-00011820: 7522 2c0a 2020 2020 2273 7563 6b73 222c  u",.    "sucks",
-00011830: 0a20 2020 2022 7375 7070 6c69 6573 222c  .    "supplies",
-00011840: 0a20 2020 2022 7375 7070 6c79 222c 0a20  .    "supply",. 
-00011850: 2020 2022 7375 7070 6f72 7422 2c0a 2020     "support",.  
-00011860: 2020 2273 7572 6622 2c0a 2020 2020 2273    "surf",.    "s
-00011870: 7572 6765 7279 222c 0a20 2020 2022 7375  urgery",.    "su
-00011880: 7a75 6b69 222c 0a20 2020 2022 7376 222c  zuki",.    "sv",
-00011890: 0a20 2020 2022 7377 6174 6368 222c 0a20  .    "swatch",. 
-000118a0: 2020 2022 7377 6966 7463 6f76 6572 222c     "swiftcover",
-000118b0: 0a20 2020 2022 7377 6973 7322 2c0a 2020  .    "swiss",.  
-000118c0: 2020 2273 7822 2c0a 2020 2020 2273 7922    "sx",.    "sy"
-000118d0: 2c0a 2020 2020 2273 7964 6e65 7922 2c0a  ,.    "sydney",.
-000118e0: 2020 2020 2273 796d 616e 7465 6322 2c0a      "symantec",.
-000118f0: 2020 2020 2273 7973 7465 6d73 222c 0a20      "systems",. 
-00011900: 2020 2022 737a 222c 0a20 2020 2023 2074     "sz",.    # t
-00011910: 0a20 2020 2022 7461 6222 2c0a 2020 2020  .    "tab",.    
-00011920: 2274 6169 7065 6922 2c0a 2020 2020 2274  "taipei",.    "t
-00011930: 616c 6b22 2c0a 2020 2020 2274 616f 6261  alk",.    "taoba
-00011940: 6f22 2c0a 2020 2020 2274 6172 6765 7422  o",.    "target"
-00011950: 2c0a 2020 2020 2274 6174 616d 6f74 6f72  ,.    "tatamotor
-00011960: 7322 2c0a 2020 2020 2274 6174 6172 222c  s",.    "tatar",
-00011970: 0a20 2020 2022 7461 7474 6f6f 222c 0a20  .    "tattoo",. 
-00011980: 2020 2022 7461 7822 2c0a 2020 2020 2274     "tax",.    "t
-00011990: 6178 6922 2c0a 2020 2020 2274 6322 2c0a  axi",.    "tc",.
-000119a0: 2020 2020 2274 6369 222c 0a20 2020 2022      "tci",.    "
-000119b0: 7464 222c 0a20 2020 2022 7464 6b22 2c0a  td",.    "tdk",.
-000119c0: 2020 2020 2274 6561 6d22 2c0a 2020 2020      "team",.    
-000119d0: 2274 6563 6822 2c0a 2020 2020 2274 6563  "tech",.    "tec
-000119e0: 686e 6f6c 6f67 7922 2c0a 2020 2020 2274  hnology",.    "t
-000119f0: 656c 222c 0a20 2020 2022 7465 6c65 6369  el",.    "teleci
-00011a00: 7479 222c 0a20 2020 2022 7465 6c65 666f  ty",.    "telefo
-00011a10: 6e69 6361 222c 0a20 2020 2022 7465 6d61  nica",.    "tema
-00011a20: 7365 6b22 2c0a 2020 2020 2274 656e 6e69  sek",.    "tenni
-00011a30: 7322 2c0a 2020 2020 2274 6576 6122 2c0a  s",.    "teva",.
-00011a40: 2020 2020 2274 6622 2c0a 2020 2020 2274      "tf",.    "t
-00011a50: 6722 2c0a 2020 2020 2274 6822 2c0a 2020  g",.    "th",.  
-00011a60: 2020 2274 6864 222c 0a20 2020 2022 7468    "thd",.    "th
-00011a70: 6561 7465 7222 2c0a 2020 2020 2274 6865  eater",.    "the
-00011a80: 6174 7265 222c 0a20 2020 2022 7469 6161  atre",.    "tiaa
-00011a90: 222c 0a20 2020 2022 7469 636b 6574 7322  ",.    "tickets"
-00011aa0: 2c0a 2020 2020 2274 6965 6e64 6122 2c0a  ,.    "tienda",.
-00011ab0: 2020 2020 2274 6966 6661 6e79 222c 0a20      "tiffany",. 
-00011ac0: 2020 2022 7469 7073 222c 0a20 2020 2022     "tips",.    "
-00011ad0: 7469 7265 7322 2c0a 2020 2020 2274 6972  tires",.    "tir
-00011ae0: 6f6c 222c 0a20 2020 2022 746a 222c 0a20  ol",.    "tj",. 
-00011af0: 2020 2022 746a 6d61 7878 222c 0a20 2020     "tjmaxx",.   
-00011b00: 2022 746a 7822 2c0a 2020 2020 2274 6b22   "tjx",.    "tk"
-00011b10: 2c0a 2020 2020 2274 6b6d 6178 7822 2c0a  ,.    "tkmaxx",.
-00011b20: 2020 2020 2274 6c22 2c0a 2020 2020 2274      "tl",.    "t
-00011b30: 6d22 2c0a 2020 2020 2274 6d61 6c6c 222c  m",.    "tmall",
-00011b40: 0a20 2020 2022 746e 222c 0a20 2020 2022  .    "tn",.    "
-00011b50: 746f 222c 0a20 2020 2022 746f 6461 7922  to",.    "today"
-00011b60: 2c0a 2020 2020 2274 6f6b 796f 222c 0a20  ,.    "tokyo",. 
-00011b70: 2020 2022 746f 6f6c 7322 2c0a 2020 2020     "tools",.    
-00011b80: 2274 6f70 222c 0a20 2020 2022 746f 7261  "top",.    "tora
-00011b90: 7922 2c0a 2020 2020 2274 6f73 6869 6261  y",.    "toshiba
-00011ba0: 222c 0a20 2020 2022 746f 7461 6c22 2c0a  ",.    "total",.
-00011bb0: 2020 2020 2274 6f75 7273 222c 0a20 2020      "tours",.   
-00011bc0: 2022 746f 776e 222c 0a20 2020 2022 746f   "town",.    "to
-00011bd0: 796f 7461 222c 0a20 2020 2022 746f 7973  yota",.    "toys
-00011be0: 222c 0a20 2020 2022 7472 222c 0a20 2020  ",.    "tr",.   
-00011bf0: 2022 7472 6164 6522 2c0a 2020 2020 2274   "trade",.    "t
-00011c00: 7261 6469 6e67 222c 0a20 2020 2022 7472  rading",.    "tr
-00011c10: 6169 6e69 6e67 222c 0a20 2020 2022 7472  aining",.    "tr
-00011c20: 6176 656c 222c 0a20 2020 2022 7472 6176  avel",.    "trav
-00011c30: 656c 6368 616e 6e65 6c22 2c0a 2020 2020  elchannel",.    
-00011c40: 2274 7261 7665 6c65 7273 222c 0a20 2020  "travelers",.   
-00011c50: 2022 7472 6176 656c 6572 7369 6e73 7572   "travelersinsur
-00011c60: 616e 6365 222c 0a20 2020 2022 7472 7573  ance",.    "trus
-00011c70: 7422 2c0a 2020 2020 2274 7276 222c 0a20  t",.    "trv",. 
-00011c80: 2020 2022 7474 222c 0a20 2020 2022 7475     "tt",.    "tu
-00011c90: 6265 222c 0a20 2020 2022 7475 6922 2c0a  be",.    "tui",.
-00011ca0: 2020 2020 2274 756e 6573 222c 0a20 2020      "tunes",.   
-00011cb0: 2022 7475 7368 7522 2c0a 2020 2020 2274   "tushu",.    "t
-00011cc0: 7622 2c0a 2020 2020 2274 7673 222c 0a20  v",.    "tvs",. 
-00011cd0: 2020 2022 7477 222c 0a20 2020 2022 747a     "tw",.    "tz
-00011ce0: 222c 0a20 2020 2023 2075 0a20 2020 2022  ",.    # u.    "
-00011cf0: 7561 222c 0a20 2020 2022 7562 616e 6b22  ua",.    "ubank"
-00011d00: 2c0a 2020 2020 2275 6273 222c 0a20 2020  ,.    "ubs",.   
-00011d10: 2022 7563 6f6e 6e65 6374 222c 0a20 2020   "uconnect",.   
-00011d20: 2022 7567 222c 0a20 2020 2022 756b 222c   "ug",.    "uk",
-00011d30: 0a20 2020 2022 756e 6963 6f6d 222c 0a20  .    "unicom",. 
-00011d40: 2020 2022 756e 6976 6572 7369 7479 222c     "university",
-00011d50: 0a20 2020 2022 756e 6f22 2c0a 2020 2020  .    "uno",.    
-00011d60: 2275 6f6c 222c 0a20 2020 2022 7570 7322  "uol",.    "ups"
-00011d70: 2c0a 2020 2020 2275 7322 2c0a 2020 2020  ,.    "us",.    
-00011d80: 2275 7922 2c0a 2020 2020 2275 7a22 2c0a  "uy",.    "uz",.
-00011d90: 2020 2020 2320 760a 2020 2020 2276 6122      # v.    "va"
-00011da0: 2c0a 2020 2020 2276 6163 6174 696f 6e73  ,.    "vacations
-00011db0: 222c 0a20 2020 2022 7661 6e61 222c 0a20  ",.    "vana",. 
-00011dc0: 2020 2022 7661 6e67 7561 7264 222c 0a20     "vanguard",. 
-00011dd0: 2020 2022 7663 222c 0a20 2020 2022 7665     "vc",.    "ve
-00011de0: 222c 0a20 2020 2022 7665 6761 7322 2c0a  ",.    "vegas",.
-00011df0: 2020 2020 2276 656e 7475 7265 7322 2c0a      "ventures",.
-00011e00: 2020 2020 2276 6572 6973 6967 6e22 2c0a      "verisign",.
-00011e10: 2020 2020 2276 6572 7369 6368 6572 756e      "versicherun
-00011e20: 6722 2c0a 2020 2020 2276 6574 222c 0a20  g",.    "vet",. 
-00011e30: 2020 2022 7667 222c 0a20 2020 2022 7669     "vg",.    "vi
-00011e40: 222c 0a20 2020 2022 7669 616a 6573 222c  ",.    "viajes",
-00011e50: 0a20 2020 2022 7669 6465 6f22 2c0a 2020  .    "video",.  
-00011e60: 2020 2276 6967 222c 0a20 2020 2022 7669    "vig",.    "vi
-00011e70: 6b69 6e67 222c 0a20 2020 2022 7669 6c6c  king",.    "vill
-00011e80: 6173 222c 0a20 2020 2022 7669 6e22 2c0a  as",.    "vin",.
-00011e90: 2020 2020 2276 6970 222c 0a20 2020 2022      "vip",.    "
-00011ea0: 7669 7267 696e 222c 0a20 2020 2022 7669  virgin",.    "vi
-00011eb0: 7361 222c 0a20 2020 2022 7669 7369 6f6e  sa",.    "vision
-00011ec0: 222c 0a20 2020 2022 7669 7374 6122 2c0a  ",.    "vista",.
-00011ed0: 2020 2020 2276 6973 7461 7072 696e 7422      "vistaprint"
-00011ee0: 2c0a 2020 2020 2276 6976 6122 2c0a 2020  ,.    "viva",.  
-00011ef0: 2020 2276 6976 6f22 2c0a 2020 2020 2276    "vivo",.    "v
-00011f00: 6c61 616e 6465 7265 6e22 2c0a 2020 2020  laanderen",.    
-00011f10: 2276 6e22 2c0a 2020 2020 2276 6f64 6b61  "vn",.    "vodka
-00011f20: 222c 0a20 2020 2022 766f 6c6b 7377 6167  ",.    "volkswag
-00011f30: 656e 222c 0a20 2020 2022 766f 6c76 6f22  en",.    "volvo"
-00011f40: 2c0a 2020 2020 2276 6f74 6522 2c0a 2020  ,.    "vote",.  
-00011f50: 2020 2276 6f74 696e 6722 2c0a 2020 2020    "voting",.    
-00011f60: 2276 6f74 6f22 2c0a 2020 2020 2276 6f79  "voto",.    "voy
-00011f70: 6167 6522 2c0a 2020 2020 2276 7522 2c0a  age",.    "vu",.
-00011f80: 2020 2020 2276 7565 6c6f 7322 2c0a 2020      "vuelos",.  
-00011f90: 2020 2320 770a 2020 2020 2277 616c 6573    # w.    "wales
-00011fa0: 222c 0a20 2020 2022 7761 6c6d 6172 7422  ",.    "walmart"
-00011fb0: 2c0a 2020 2020 2277 616c 7465 7222 2c0a  ,.    "walter",.
-00011fc0: 2020 2020 2277 616e 6722 2c0a 2020 2020      "wang",.    
-00011fd0: 2277 616e 6767 6f75 222c 0a20 2020 2022  "wanggou",.    "
-00011fe0: 7761 726d 616e 222c 0a20 2020 2022 7761  warman",.    "wa
-00011ff0: 7463 6822 2c0a 2020 2020 2277 6174 6368  tch",.    "watch
-00012000: 6573 222c 0a20 2020 2022 7765 6174 6865  es",.    "weathe
-00012010: 7222 2c0a 2020 2020 2277 6561 7468 6572  r",.    "weather
-00012020: 6368 616e 6e65 6c22 2c0a 2020 2020 2277  channel",.    "w
-00012030: 6562 6361 6d22 2c0a 2020 2020 2277 6562  ebcam",.    "web
-00012040: 6572 222c 0a20 2020 2022 7765 6273 6974  er",.    "websit
-00012050: 6522 2c0a 2020 2020 2277 6564 222c 0a20  e",.    "wed",. 
-00012060: 2020 2022 7765 6464 696e 6722 2c0a 2020     "wedding",.  
-00012070: 2020 2277 6569 626f 222c 0a20 2020 2022    "weibo",.    "
-00012080: 7765 6972 222c 0a20 2020 2022 7766 222c  weir",.    "wf",
-00012090: 0a20 2020 2022 7768 6f73 7768 6f22 2c0a  .    "whoswho",.
-000120a0: 2020 2020 2277 6965 6e22 2c0a 2020 2020      "wien",.    
-000120b0: 2277 696b 6922 2c0a 2020 2020 2277 696c  "wiki",.    "wil
-000120c0: 6c69 616d 6869 6c6c 222c 0a20 2020 2022  liamhill",.    "
-000120d0: 7769 6e22 2c0a 2020 2020 2277 696e 646f  win",.    "windo
-000120e0: 7773 222c 0a20 2020 2022 7769 6e65 222c  ws",.    "wine",
-000120f0: 0a20 2020 2022 7769 6e6e 6572 7322 2c0a  .    "winners",.
-00012100: 2020 2020 2277 6d65 222c 0a20 2020 2022      "wme",.    "
-00012110: 776f 6c74 6572 736b 6c75 7765 7222 2c0a  wolterskluwer",.
-00012120: 2020 2020 2277 6f6f 6473 6964 6522 2c0a      "woodside",.
-00012130: 2020 2020 2277 6f72 6b22 2c0a 2020 2020      "work",.    
-00012140: 2277 6f72 6b73 222c 0a20 2020 2022 776f  "works",.    "wo
-00012150: 726c 6422 2c0a 2020 2020 2277 6f77 222c  rld",.    "wow",
-00012160: 0a20 2020 2022 7773 222c 0a20 2020 2022  .    "ws",.    "
-00012170: 7774 6322 2c0a 2020 2020 2277 7466 222c  wtc",.    "wtf",
-00012180: 0a20 2020 2023 2078 0a20 2020 2022 7862  .    # x.    "xb
-00012190: 6f78 222c 0a20 2020 2022 7865 726f 7822  ox",.    "xerox"
-000121a0: 2c0a 2020 2020 2278 6669 6e69 7479 222c  ,.    "xfinity",
-000121b0: 0a20 2020 2022 7869 6875 616e 222c 0a20  .    "xihuan",. 
-000121c0: 2020 2022 7869 6e22 2c0a 2020 2020 2278     "xin",.    "x
-000121d0: 6e2d 2d31 3162 3463 3364 222c 0a20 2020  n--11b4c3d",.   
-000121e0: 2022 786e 2d2d 3163 6b32 6531 6222 2c0a   "xn--1ck2e1b",.
-000121f0: 2020 2020 2278 6e2d 2d31 7171 7732 3361      "xn--1qqw23a
-00012200: 222c 0a20 2020 2022 786e 2d2d 3273 6372  ",.    "xn--2scr
-00012210: 6a39 6322 2c0a 2020 2020 2278 6e2d 2d33  j9c",.    "xn--3
-00012220: 3072 7237 7922 2c0a 2020 2020 2278 6e2d  0rr7y",.    "xn-
-00012230: 2d33 6273 7430 306d 222c 0a20 2020 2022  -3bst00m",.    "
-00012240: 786e 2d2d 3364 7334 3433 6722 2c0a 2020  xn--3ds443g",.  
-00012250: 2020 2278 6e2d 2d33 6530 6237 3037 6522    "xn--3e0b707e"
-00012260: 2c0a 2020 2020 2278 6e2d 2d33 6863 726a  ,.    "xn--3hcrj
-00012270: 3963 222c 0a20 2020 2022 786e 2d2d 336f  9c",.    "xn--3o
-00012280: 7131 3876 6c38 706e 3336 6122 2c0a 2020  q18vl8pn36a",.  
-00012290: 2020 2278 6e2d 2d33 7078 7538 6b22 2c0a    "xn--3pxu8k",.
-000122a0: 2020 2020 2278 6e2d 2d34 3263 3264 3961      "xn--42c2d9a
-000122b0: 222c 0a20 2020 2022 786e 2d2d 3435 6272  ",.    "xn--45br
-000122c0: 3563 796c 222c 0a20 2020 2022 786e 2d2d  5cyl",.    "xn--
-000122d0: 3435 6272 6a39 6322 2c0a 2020 2020 2278  45brj9c",.    "x
-000122e0: 6e2d 2d34 3571 3131 6322 2c0a 2020 2020  n--45q11c",.    
-000122f0: 2278 6e2d 2d34 6762 7269 6d22 2c0a 2020  "xn--4gbrim",.  
-00012300: 2020 2278 6e2d 2d35 3462 3766 7461 3063    "xn--54b7fta0c
-00012310: 6322 2c0a 2020 2020 2278 6e2d 2d35 3571  c",.    "xn--55q
-00012320: 7734 3267 222c 0a20 2020 2022 786e 2d2d  w42g",.    "xn--
-00012330: 3535 7178 3564 222c 0a20 2020 2022 786e  55qx5d",.    "xn
-00012340: 2d2d 3573 7533 346a 3933 3662 6773 6722  --5su34j936bgsg"
-00012350: 2c0a 2020 2020 2278 6e2d 2d35 747a 6d35  ,.    "xn--5tzm5
-00012360: 6722 2c0a 2020 2020 2278 6e2d 2d36 6672  g",.    "xn--6fr
-00012370: 7a38 3267 222c 0a20 2020 2022 786e 2d2d  z82g",.    "xn--
-00012380: 3671 7139 3836 6233 786c 222c 0a20 2020  6qq986b3xl",.   
-00012390: 2022 786e 2d2d 3830 6164 7868 6b73 222c   "xn--80adxhks",
-000123a0: 0a20 2020 2022 786e 2d2d 3830 616f 3231  .    "xn--80ao21
-000123b0: 6122 2c0a 2020 2020 2278 6e2d 2d38 3061  a",.    "xn--80a
-000123c0: 7165 6364 7231 6122 2c0a 2020 2020 2278  qecdr1a",.    "x
-000123d0: 6e2d 2d38 3061 7365 6864 6222 2c0a 2020  n--80asehdb",.  
-000123e0: 2020 2278 6e2d 2d38 3061 7377 6722 2c0a    "xn--80aswg",.
-000123f0: 2020 2020 2278 6e2d 2d38 7930 6130 3633      "xn--8y0a063
-00012400: 6122 2c0a 2020 2020 2278 6e2d 2d39 3061  a",.    "xn--90a
-00012410: 3361 6322 2c0a 2020 2020 2278 6e2d 2d39  3ac",.    "xn--9
-00012420: 3061 6522 2c0a 2020 2020 2278 6e2d 2d39  0ae",.    "xn--9
-00012430: 3061 6973 222c 0a20 2020 2022 786e 2d2d  0ais",.    "xn--
-00012440: 3964 6271 3261 222c 0a20 2020 2022 786e  9dbq2a",.    "xn
-00012450: 2d2d 3965 7435 3275 222c 0a20 2020 2022  --9et52u",.    "
-00012460: 786e 2d2d 396b 7274 3030 6122 2c0a 2020  xn--9krt00a",.  
-00012470: 2020 2278 6e2d 2d62 3477 3630 3566 6572    "xn--b4w605fer
-00012480: 6422 2c0a 2020 2020 2278 6e2d 2d62 636b  d",.    "xn--bck
-00012490: 3162 3961 3564 7265 3463 222c 0a20 2020  1b9a5dre4c",.   
-000124a0: 2022 786e 2d2d 6331 6176 6722 2c0a 2020   "xn--c1avg",.  
-000124b0: 2020 2278 6e2d 2d63 3262 7237 6722 2c0a    "xn--c2br7g",.
-000124c0: 2020 2020 2278 6e2d 2d63 636b 3262 3362      "xn--cck2b3b
-000124d0: 222c 0a20 2020 2022 786e 2d2d 6367 3462  ",.    "xn--cg4b
-000124e0: 6b69 222c 0a20 2020 2022 786e 2d2d 636c  ki",.    "xn--cl
-000124f0: 6368 6330 6561 3062 3267 3261 3967 6364  chc0ea0b2g2a9gcd
-00012500: 222c 0a20 2020 2022 786e 2d2d 637a 7236  ",.    "xn--czr6
-00012510: 3934 6222 2c0a 2020 2020 2278 6e2d 2d63  94b",.    "xn--c
-00012520: 7a72 7330 7422 2c0a 2020 2020 2278 6e2d  zrs0t",.    "xn-
-00012530: 2d63 7a72 7532 6422 2c0a 2020 2020 2278  -czru2d",.    "x
-00012540: 6e2d 2d64 3161 636a 3362 222c 0a20 2020  n--d1acj3b",.   
-00012550: 2022 786e 2d2d 6431 616c 6622 2c0a 2020   "xn--d1alf",.  
-00012560: 2020 2278 6e2d 2d65 3161 3463 222c 0a20    "xn--e1a4c",. 
-00012570: 2020 2022 786e 2d2d 6563 6b76 6474 6339     "xn--eckvdtc9
-00012580: 6422 2c0a 2020 2020 2278 6e2d 2d65 6676  d",.    "xn--efv
-00012590: 7938 3868 222c 0a20 2020 2022 786e 2d2d  y88h",.    "xn--
-000125a0: 6573 7476 3735 6722 2c0a 2020 2020 2278  estv75g",.    "x
-000125b0: 6e2d 2d66 6374 3432 396b 222c 0a20 2020  n--fct429k",.   
-000125c0: 2022 786e 2d2d 6668 6265 6922 2c0a 2020   "xn--fhbei",.  
-000125d0: 2020 2278 6e2d 2d66 6971 3232 3863 3568    "xn--fiq228c5h
-000125e0: 7322 2c0a 2020 2020 2278 6e2d 2d66 6971  s",.    "xn--fiq
-000125f0: 3634 6222 2c0a 2020 2020 2278 6e2d 2d66  64b",.    "xn--f
-00012600: 6971 7338 7322 2c0a 2020 2020 2278 6e2d  iqs8s",.    "xn-
-00012610: 2d66 6971 7a39 7322 2c0a 2020 2020 2278  -fiqz9s",.    "x
-00012620: 6e2d 2d66 6a71 3732 3061 222c 0a20 2020  n--fjq720a",.   
-00012630: 2022 786e 2d2d 666c 7733 3531 6522 2c0a   "xn--flw351e",.
-00012640: 2020 2020 2278 6e2d 2d66 7063 726a 3963      "xn--fpcrj9c
-00012650: 3364 222c 0a20 2020 2022 786e 2d2d 667a  3d",.    "xn--fz
-00012660: 6332 6339 6532 6322 2c0a 2020 2020 2278  c2c9e2c",.    "x
-00012670: 6e2d 2d66 7a79 7338 6436 3975 7667 6d22  n--fzys8d69uvgm"
-00012680: 2c0a 2020 2020 2278 6e2d 2d67 3278 7834  ,.    "xn--g2xx4
-00012690: 3863 222c 0a20 2020 2022 786e 2d2d 6763  8c",.    "xn--gc
-000126a0: 6b72 3366 3066 222c 0a20 2020 2022 786e  kr3f0f",.    "xn
-000126b0: 2d2d 6765 6372 6a39 6322 2c0a 2020 2020  --gecrj9c",.    
-000126c0: 2278 6e2d 2d67 6b33 6174 3165 222c 0a20  "xn--gk3at1e",. 
-000126d0: 2020 2022 786e 2d2d 6832 6272 6567 3365     "xn--h2breg3e
-000126e0: 7665 222c 0a20 2020 2022 786e 2d2d 6832  ve",.    "xn--h2
-000126f0: 6272 6a39 6322 2c0a 2020 2020 2278 6e2d  brj9c",.    "xn-
-00012700: 2d68 3262 726a 3963 3863 222c 0a20 2020  -h2brj9c8c",.   
-00012710: 2022 786e 2d2d 6878 7438 3134 6522 2c0a   "xn--hxt814e",.
-00012720: 2020 2020 2278 6e2d 2d69 3162 3662 3161      "xn--i1b6b1a
-00012730: 3661 3265 222c 0a20 2020 2022 786e 2d2d  6a2e",.    "xn--
-00012740: 696d 7235 3133 6e22 2c0a 2020 2020 2278  imr513n",.    "x
-00012750: 6e2d 2d69 6f30 6137 6922 2c0a 2020 2020  n--io0a7i",.    
-00012760: 2278 6e2d 2d6a 3161 6566 222c 0a20 2020  "xn--j1aef",.   
-00012770: 2022 786e 2d2d 6a31 616d 6822 2c0a 2020   "xn--j1amh",.  
-00012780: 2020 2278 6e2d 2d6a 3677 3139 3367 222c    "xn--j6w193g",
-00012790: 0a20 2020 2022 786e 2d2d 6a6c 7136 3175  .    "xn--jlq61u
-000127a0: 3977 3762 222c 0a20 2020 2022 786e 2d2d  9w7b",.    "xn--
-000127b0: 6a76 7231 3839 6d22 2c0a 2020 2020 2278  jvr189m",.    "x
-000127c0: 6e2d 2d6b 6372 7837 3764 3178 3461 222c  n--kcrx77d1x4a",
-000127d0: 0a20 2020 2022 786e 2d2d 6b70 7277 3133  .    "xn--kprw13
-000127e0: 6422 2c0a 2020 2020 2278 6e2d 2d6b 7072  d",.    "xn--kpr
-000127f0: 7935 3764 222c 0a20 2020 2022 786e 2d2d  y57d",.    "xn--
-00012800: 6b70 7537 3136 6622 2c0a 2020 2020 2278  kpu716f",.    "x
-00012810: 6e2d 2d6b 7075 7433 6922 2c0a 2020 2020  n--kput3i",.    
-00012820: 2278 6e2d 2d6c 3161 6363 222c 0a20 2020  "xn--l1acc",.   
-00012830: 2022 786e 2d2d 6c67 6262 6174 3161 6438   "xn--lgbbat1ad8
-00012840: 6a22 2c0a 2020 2020 2278 6e2d 2d6d 6762  j",.    "xn--mgb
-00012850: 3961 7762 6622 2c0a 2020 2020 2278 6e2d  9awbf",.    "xn-
-00012860: 2d6d 6762 6133 6133 656a 7422 2c0a 2020  -mgba3a3ejt",.  
-00012870: 2020 2278 6e2d 2d6d 6762 6133 6134 6631    "xn--mgba3a4f1
-00012880: 3661 222c 0a20 2020 2022 786e 2d2d 6d67  6a",.    "xn--mg
-00012890: 6261 3763 3062 626e 3061 222c 0a20 2020  ba7c0bbn0a",.   
-000128a0: 2022 786e 2d2d 6d67 6261 616b 6337 6476   "xn--mgbaakc7dv
-000128b0: 6622 2c0a 2020 2020 2278 6e2d 2d6d 6762  f",.    "xn--mgb
-000128c0: 6161 6d37 6138 6822 2c0a 2020 2020 2278  aam7a8h",.    "x
-000128d0: 6e2d 2d6d 6762 6162 3262 6422 2c0a 2020  n--mgbab2bd",.  
-000128e0: 2020 2278 6e2d 2d6d 6762 6169 3961 7a67    "xn--mgbai9azg
-000128f0: 7170 366a 222c 0a20 2020 2022 786e 2d2d  qp6j",.    "xn--
-00012900: 6d67 6261 7968 3767 7061 222c 0a20 2020  mgbayh7gpa",.   
-00012910: 2022 786e 2d2d 6d67 6262 3966 6270 6f62   "xn--mgbb9fbpob
-00012920: 222c 0a20 2020 2022 786e 2d2d 6d67 6262  ",.    "xn--mgbb
-00012930: 6831 6122 2c0a 2020 2020 2278 6e2d 2d6d  h1a",.    "xn--m
-00012940: 6762 6268 3161 3731 6522 2c0a 2020 2020  gbbh1a71e",.    
-00012950: 2278 6e2d 2d6d 6762 6330 6139 617a 6367  "xn--mgbc0a9azcg
-00012960: 222c 0a20 2020 2022 786e 2d2d 6d67 6263  ",.    "xn--mgbc
-00012970: 6137 647a 646f 222c 0a20 2020 2022 786e  a7dzdo",.    "xn
-00012980: 2d2d 6d67 6265 7270 3461 3564 3461 7222  --mgberp4a5d4ar"
-00012990: 2c0a 2020 2020 2278 6e2d 2d6d 6762 6775  ,.    "xn--mgbgu
-000129a0: 3832 6122 2c0a 2020 2020 2278 6e2d 2d6d  82a",.    "xn--m
-000129b0: 6762 6934 6563 6578 7022 2c0a 2020 2020  gbi4ecexp",.    
-000129c0: 2278 6e2d 2d6d 6762 706c 3266 6822 2c0a  "xn--mgbpl2fh",.
-000129d0: 2020 2020 2278 6e2d 2d6d 6762 7433 6468      "xn--mgbt3dh
-000129e0: 6422 2c0a 2020 2020 2278 6e2d 2d6d 6762  d",.    "xn--mgb
-000129f0: 7478 3262 222c 0a20 2020 2022 786e 2d2d  tx2b",.    "xn--
-00012a00: 6d67 6278 3463 6430 6162 222c 0a20 2020  mgbx4cd0ab",.   
-00012a10: 2022 786e 2d2d 6d69 7838 3931 6622 2c0a   "xn--mix891f",.
-00012a20: 2020 2020 2278 6e2d 2d6d 6b31 6275 3434      "xn--mk1bu44
-00012a30: 6322 2c0a 2020 2020 2278 6e2d 2d6d 7874  c",.    "xn--mxt
-00012a40: 7131 6d22 2c0a 2020 2020 2278 6e2d 2d6e  q1m",.    "xn--n
-00012a50: 6762 6335 617a 6422 2c0a 2020 2020 2278  gbc5azd",.    "x
-00012a60: 6e2d 2d6e 6762 6539 6530 6122 2c0a 2020  n--ngbe9e0a",.  
-00012a70: 2020 2278 6e2d 2d6e 6762 7278 222c 0a20    "xn--ngbrx",. 
-00012a80: 2020 2022 786e 2d2d 6e6f 6465 222c 0a20     "xn--node",. 
-00012a90: 2020 2022 786e 2d2d 6e71 7637 6622 2c0a     "xn--nqv7f",.
-00012aa0: 2020 2020 2278 6e2d 2d6e 7176 3766 7330      "xn--nqv7fs0
-00012ab0: 3065 6d61 222c 0a20 2020 2022 786e 2d2d  0ema",.    "xn--
-00012ac0: 6e79 7179 3236 6122 2c0a 2020 2020 2278  nyqy26a",.    "x
-00012ad0: 6e2d 2d6f 3363 7734 6822 2c0a 2020 2020  n--o3cw4h",.    
-00012ae0: 2278 6e2d 2d6f 6762 7066 3866 6c22 2c0a  "xn--ogbpf8fl",.
-00012af0: 2020 2020 2278 6e2d 2d70 3161 6366 222c      "xn--p1acf",
-00012b00: 0a20 2020 2022 786e 2d2d 7031 6169 222c  .    "xn--p1ai",
-00012b10: 0a20 2020 2022 786e 2d2d 7062 7439 3737  .    "xn--pbt977
-00012b20: 6322 2c0a 2020 2020 2278 6e2d 2d70 6762  c",.    "xn--pgb
-00012b30: 7330 6468 222c 0a20 2020 2022 786e 2d2d  s0dh",.    "xn--
-00012b40: 7073 7379 3275 222c 0a20 2020 2022 786e  pssy2u",.    "xn
-00012b50: 2d2d 7139 6a79 6234 6322 2c0a 2020 2020  --q9jyb4c",.    
-00012b60: 2278 6e2d 2d71 636b 6131 706d 6322 2c0a  "xn--qcka1pmc",.
-00012b70: 2020 2020 2278 6e2d 2d71 7861 6d22 2c0a      "xn--qxam",.
-00012b80: 2020 2020 2278 6e2d 2d72 6871 7639 3667      "xn--rhqv96g
-00012b90: 222c 0a20 2020 2022 786e 2d2d 726f 7675  ",.    "xn--rovu
-00012ba0: 3838 6222 2c0a 2020 2020 2278 6e2d 2d72  88b",.    "xn--r
-00012bb0: 7663 3165 3061 6d33 6522 2c0a 2020 2020  vc1e0am3e",.    
-00012bc0: 2278 6e2d 2d73 3962 726a 3963 222c 0a20  "xn--s9brj9c",. 
-00012bd0: 2020 2022 786e 2d2d 7365 7335 3534 6722     "xn--ses554g"
-00012be0: 2c0a 2020 2020 2278 6e2d 2d74 3630 6235  ,.    "xn--t60b5
-00012bf0: 3661 222c 0a20 2020 2022 786e 2d2d 7463  6a",.    "xn--tc
-00012c00: 6b77 6522 2c0a 2020 2020 2278 6e2d 2d74  kwe",.    "xn--t
-00012c10: 6971 3439 7871 796a 222c 0a20 2020 2022  iq49xqyj",.    "
-00012c20: 786e 2d2d 756e 7570 3479 222c 0a20 2020  xn--unup4y",.   
-00012c30: 2022 786e 2d2d 7665 726d 6765 6e73 6265   "xn--vermgensbe
-00012c40: 7261 7465 722d 6374 6222 2c0a 2020 2020  rater-ctb",.    
-00012c50: 2278 6e2d 2d76 6572 6d67 656e 7362 6572  "xn--vermgensber
-00012c60: 6174 756e 672d 7077 6222 2c0a 2020 2020  atung-pwb",.    
-00012c70: 2278 6e2d 2d76 6871 7576 222c 0a20 2020  "xn--vhquv",.   
-00012c80: 2022 786e 2d2d 7675 7138 3631 6222 2c0a   "xn--vuq861b",.
-00012c90: 2020 2020 2278 6e2d 2d77 3472 3835 656c      "xn--w4r85el
-00012ca0: 3866 6875 3564 6e72 6122 2c0a 2020 2020  8fhu5dnra",.    
-00012cb0: 2278 6e2d 2d77 3472 7334 306c 222c 0a20  "xn--w4rs40l",. 
-00012cc0: 2020 2022 786e 2d2d 7767 6268 3163 222c     "xn--wgbh1c",
-00012cd0: 0a20 2020 2022 786e 2d2d 7767 626c 3661  .    "xn--wgbl6a
-00012ce0: 222c 0a20 2020 2022 786e 2d2d 7868 7135  ",.    "xn--xhq5
-00012cf0: 3231 6222 2c0a 2020 2020 2278 6e2d 2d78  21b",.    "xn--x
-00012d00: 6b63 3261 6c33 6879 6532 6122 2c0a 2020  kc2al3hye2a",.  
-00012d10: 2020 2278 6e2d 2d78 6b63 3264 6c33 6135    "xn--xkc2dl3a5
-00012d20: 6565 3068 222c 0a20 2020 2022 786e 2d2d  ee0h",.    "xn--
-00012d30: 7939 6133 6171 222c 0a20 2020 2022 786e  y9a3aq",.    "xn
-00012d40: 2d2d 7966 726f 3469 3637 6f22 2c0a 2020  --yfro4i67o",.  
-00012d50: 2020 2278 6e2d 2d79 6762 6932 616d 6d78    "xn--ygbi2ammx
-00012d60: 222c 0a20 2020 2022 786e 2d2d 7a66 7231  ",.    "xn--zfr1
-00012d70: 3634 6222 2c0a 2020 2020 2278 7065 7269  64b",.    "xperi
-00012d80: 6122 2c0a 2020 2020 2278 7878 222c 0a20  a",.    "xxx",. 
-00012d90: 2020 2022 7879 7a22 2c0a 2020 2020 2320     "xyz",.    # 
-00012da0: 790a 2020 2020 2279 6163 6874 7322 2c0a  y.    "yachts",.
-00012db0: 2020 2020 2279 6168 6f6f 222c 0a20 2020      "yahoo",.   
-00012dc0: 2022 7961 6d61 7875 6e22 2c0a 2020 2020   "yamaxun",.    
-00012dd0: 2279 616e 6465 7822 2c0a 2020 2020 2279  "yandex",.    "y
-00012de0: 6522 2c0a 2020 2020 2279 6f64 6f62 6173  e",.    "yodobas
-00012df0: 6869 222c 0a20 2020 2022 796f 6761 222c  hi",.    "yoga",
-00012e00: 0a20 2020 2022 796f 6b6f 6861 6d61 222c  .    "yokohama",
-00012e10: 0a20 2020 2022 796f 7522 2c0a 2020 2020  .    "you",.    
-00012e20: 2279 6f75 7475 6265 222c 0a20 2020 2022  "youtube",.    "
-00012e30: 7974 222c 0a20 2020 2022 7975 6e22 2c0a  yt",.    "yun",.
-00012e40: 2020 2020 2320 7a0a 2020 2020 227a 6122      # z.    "za"
-00012e50: 2c0a 2020 2020 227a 6170 706f 7322 2c0a  ,.    "zappos",.
-00012e60: 2020 2020 227a 6172 6122 2c0a 2020 2020      "zara",.    
-00012e70: 227a 6572 6f22 2c0a 2020 2020 227a 6970  "zero",.    "zip
-00012e80: 222c 0a20 2020 2022 7a69 7070 6f22 2c0a  ",.    "zippo",.
-00012e90: 2020 2020 227a 6d22 2c0a 2020 2020 227a      "zm",.    "z
-00012ea0: 6f6e 6522 2c0a 2020 2020 227a 7565 7269  one",.    "zueri
-00012eb0: 6368 222c 0a20 2020 2022 7a77 222c 0a5d  ch",.    "zw",.]
-00012ec0: 0a0a 0a63 6c61 7373 2049 535f 4854 5450  ...class IS_HTTP
-00012ed0: 5f55 524c 2856 616c 6964 6174 6f72 293a  _URL(Validator):
-00012ee0: 0a20 2020 2022 2222 0a20 2020 2052 656a  .    """.    Rej
-00012ef0: 6563 7473 2061 2055 524c 2073 7472 696e  ects a URL strin
-00012f00: 6720 6966 2061 6e79 206f 6620 7468 6520  g if any of the 
-00012f10: 666f 6c6c 6f77 696e 6720 6973 2074 7275  following is tru
-00012f20: 653a 0a20 2020 2020 2020 2a20 5468 6520  e:.       * The 
-00012f30: 7374 7269 6e67 2069 7320 656d 7074 7920  string is empty 
-00012f40: 6f72 204e 6f6e 650a 2020 2020 2020 202a  or None.       *
-00012f50: 2054 6865 2073 7472 696e 6720 7573 6573   The string uses
-00012f60: 2063 6861 7261 6374 6572 7320 7468 6174   characters that
-00012f70: 2061 7265 206e 6f74 2061 6c6c 6f77 6564   are not allowed
-00012f80: 2069 6e20 6120 5552 4c0a 2020 2020 2020   in a URL.      
-00012f90: 202a 2054 6865 2073 7472 696e 6720 6272   * The string br
-00012fa0: 6561 6b73 2061 6e79 206f 6620 7468 6520  eaks any of the 
-00012fb0: 4854 5450 2073 796e 7461 6374 6963 2072  HTTP syntactic r
-00012fc0: 756c 6573 0a20 2020 2020 2020 2a20 5468  ules.       * Th
-00012fd0: 6520 5552 4c20 7363 6865 6d65 2073 7065  e URL scheme spe
-00012fe0: 6369 6669 6564 2028 6966 206f 6e65 2069  cified (if one i
-00012ff0: 7320 7370 6563 6966 6965 6429 2069 7320  s specified) is 
-00013000: 6e6f 7420 2768 7474 7027 206f 7220 2768  not 'http' or 'h
-00013010: 7474 7073 270a 2020 2020 2020 202a 2054  ttps'.       * T
-00013020: 6865 2074 6f70 2d6c 6576 656c 2064 6f6d  he top-level dom
-00013030: 6169 6e20 2869 6620 6120 686f 7374 206e  ain (if a host n
-00013040: 616d 6520 6973 2073 7065 6369 6669 6564  ame is specified
-00013050: 2920 646f 6573 206e 6f74 2065 7869 7374  ) does not exist
-00013060: 0a0a 2020 2020 4261 7365 6420 6f6e 2052  ..    Based on R
-00013070: 4643 2032 3631 363a 2068 7474 703a 2f2f  FC 2616: http://
-00013080: 7777 772e 6661 7173 2e6f 7267 2f72 6663  www.faqs.org/rfc
-00013090: 732f 7266 6332 3631 362e 6874 6d6c 0a0a  s/rfc2616.html..
-000130a0: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
-000130b0: 6e20 6f6e 6c79 2063 6865 636b 7320 7468  n only checks th
-000130c0: 6520 5552 4c27 7320 7379 6e74 6178 2e20  e URL's syntax. 
-000130d0: 4974 2064 6f65 7320 6e6f 7420 6368 6563  It does not chec
-000130e0: 6b20 7468 6174 2074 6865 2055 524c 0a20  k that the URL. 
-000130f0: 2020 2070 6f69 6e74 7320 746f 2061 2072     points to a r
-00013100: 6561 6c20 646f 6375 6d65 6e74 2c20 666f  eal document, fo
-00013110: 7220 6578 616d 706c 652c 206f 7220 7468  r example, or th
-00013120: 6174 2069 7420 6f74 6865 7277 6973 6520  at it otherwise 
-00013130: 6d61 6b65 7320 7365 6e73 650a 2020 2020  makes sense.    
-00013140: 7365 6d61 6e74 6963 616c 6c79 2e20 5468  semantically. Th
-00013150: 6973 2066 756e 6374 696f 6e20 646f 6573  is function does
-00013160: 2061 7574 6f6d 6174 6963 616c 6c79 2070   automatically p
-00013170: 7265 7065 6e64 2027 6874 7470 3a2f 2f27  repend 'http://'
-00013180: 2069 6e20 6672 6f6e 740a 2020 2020 6f66   in front.    of
-00013190: 2061 2055 524c 2069 6e20 7468 6520 6361   a URL in the ca
-000131a0: 7365 206f 6620 616e 2061 6262 7265 7669  se of an abbrevi
-000131b0: 6174 6564 2055 524c 2028 652e 672e 2027  ated URL (e.g. '
-000131c0: 676f 6f67 6c65 2e63 6127 292e 0a0a 2020  google.ca')...  
-000131d0: 2020 5468 6520 6c69 7374 206f 6620 616c    The list of al
-000131e0: 6c6f 7765 6420 7363 6865 6d65 7320 6973  lowed schemes is
-000131f0: 2063 7573 746f 6d69 7a61 626c 6520 7769   customizable wi
-00013200: 7468 2074 6865 2061 6c6c 6f77 6564 5f73  th the allowed_s
-00013210: 6368 656d 6573 0a20 2020 2070 6172 616d  chemes.    param
-00013220: 6574 6572 2e20 4966 2079 6f75 2065 7863  eter. If you exc
-00013230: 6c75 6465 204e 6f6e 6520 6672 6f6d 2074  lude None from t
-00013240: 6865 206c 6973 742c 2074 6865 6e20 6162  he list, then ab
-00013250: 6272 6576 6961 7465 6420 5552 4c73 0a20  breviated URLs. 
-00013260: 2020 2028 6c61 636b 696e 6720 6120 7363     (lacking a sc
-00013270: 6865 6d65 2073 7563 6820 6173 2027 6874  heme such as 'ht
-00013280: 7470 2729 2077 696c 6c20 6265 2072 656a  tp') will be rej
-00013290: 6563 7465 642e 0a0a 2020 2020 5468 6520  ected...    The 
-000132a0: 6465 6661 756c 7420 7072 6570 656e 6465  default prepende
-000132b0: 6420 7363 6865 6d65 2069 7320 6375 7374  d scheme is cust
-000132c0: 6f6d 697a 6162 6c65 2077 6974 6820 7468  omizable with th
-000132d0: 6520 7072 6570 656e 645f 7363 6865 6d65  e prepend_scheme
-000132e0: 0a20 2020 2070 6172 616d 6574 6572 2e20  .    parameter. 
-000132f0: 4966 2079 6f75 2073 6574 2070 7265 7065  If you set prepe
-00013300: 6e64 5f73 6368 656d 6520 746f 204e 6f6e  nd_scheme to Non
-00013310: 6520 7468 656e 2070 7265 7065 6e64 696e  e then prependin
-00013320: 6720 7769 6c6c 2062 650a 2020 2020 6469  g will be.    di
-00013330: 7361 626c 6564 2e20 5552 4c73 2074 6861  sabled. URLs tha
-00013340: 7420 7265 7175 6972 6520 7072 6570 656e  t require prepen
-00013350: 6469 6e67 2074 6f20 7061 7273 6520 7769  ding to parse wi
-00013360: 6c6c 2073 7469 6c6c 2062 6520 6163 6365  ll still be acce
-00013370: 7074 6564 2c0a 2020 2020 6275 7420 7468  pted,.    but th
-00013380: 6520 7265 7475 726e 2076 616c 7565 2077  e return value w
-00013390: 696c 6c20 6e6f 7420 6265 206d 6f64 6966  ill not be modif
-000133a0: 6965 642e 0a0a 2020 2020 4061 7574 686f  ied...    @autho
-000133b0: 723a 204a 6f6e 6174 6861 6e20 4265 6e6e  r: Jonathan Benn
-000133c0: 0a0a 2020 2020 2020 2020 3e3e 3e20 4953  ..        >>> IS
-000133d0: 5f48 5454 505f 5552 4c28 2928 2768 7474  _HTTP_URL()('htt
-000133e0: 703a 2f2f 312e 322e 332e 3427 290a 2020  p://1.2.3.4').  
-000133f0: 2020 2020 2020 2827 6874 7470 3a2f 2f31        ('http://1
-00013400: 2e32 2e33 2e34 272c 204e 6f6e 6529 0a20  .2.3.4', None). 
-00013410: 2020 2020 2020 203e 3e3e 2049 535f 4854         >>> IS_HT
-00013420: 5450 5f55 524c 2829 2827 6874 7470 3a2f  TP_URL()('http:/
-00013430: 2f61 6263 2e63 6f6d 2729 0a20 2020 2020  /abc.com').     
-00013440: 2020 2028 2768 7474 703a 2f2f 6162 632e     ('http://abc.
-00013450: 636f 6d27 2c20 4e6f 6e65 290a 2020 2020  com', None).    
-00013460: 2020 2020 3e3e 3e20 4953 5f48 5454 505f      >>> IS_HTTP_
-00013470: 5552 4c28 2928 2768 7474 7073 3a2f 2f61  URL()('https://a
-00013480: 6263 2e63 6f6d 2729 0a20 2020 2020 2020  bc.com').       
-00013490: 2028 2768 7474 7073 3a2f 2f61 6263 2e63   ('https://abc.c
-000134a0: 6f6d 272c 204e 6f6e 6529 0a20 2020 2020  om', None).     
-000134b0: 2020 203e 3e3e 2049 535f 4854 5450 5f55     >>> IS_HTTP_U
-000134c0: 524c 2829 2827 6874 7470 783a 2f2f 6162  RL()('httpx://ab
-000134d0: 632e 636f 6d27 290a 2020 2020 2020 2020  c.com').        
-000134e0: 2827 6874 7470 783a 2f2f 6162 632e 636f  ('httpx://abc.co
-000134f0: 6d27 2c20 2765 6e74 6572 2061 2076 616c  m', 'enter a val
-00013500: 6964 2055 524c 2729 0a20 2020 2020 2020  id URL').       
-00013510: 203e 3e3e 2049 535f 4854 5450 5f55 524c   >>> IS_HTTP_URL
-00013520: 2829 2827 6874 7470 3a2f 2f61 6263 2e63  ()('http://abc.c
-00013530: 6f6d 3a38 3027 290a 2020 2020 2020 2020  om:80').        
-00013540: 2827 6874 7470 3a2f 2f61 6263 2e63 6f6d  ('http://abc.com
-00013550: 3a38 3027 2c20 4e6f 6e65 290a 2020 2020  :80', None).    
-00013560: 2020 2020 3e3e 3e20 4953 5f48 5454 505f      >>> IS_HTTP_
-00013570: 5552 4c28 2928 2768 7474 703a 2f2f 7573  URL()('http://us
-00013580: 6572 4061 6263 2e63 6f6d 2729 0a20 2020  er@abc.com').   
-00013590: 2020 2020 2028 2768 7474 703a 2f2f 7573       ('http://us
-000135a0: 6572 4061 6263 2e63 6f6d 272c 204e 6f6e  er@abc.com', Non
-000135b0: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
-000135c0: 535f 4854 5450 5f55 524c 2829 2827 6874  S_HTTP_URL()('ht
-000135d0: 7470 3a2f 2f75 7365 7240 312e 322e 332e  tp://user@1.2.3.
-000135e0: 3427 290a 2020 2020 2020 2020 2827 6874  4').        ('ht
-000135f0: 7470 3a2f 2f75 7365 7240 312e 322e 332e  tp://user@1.2.3.
-00013600: 3427 2c20 4e6f 6e65 290a 0a20 2020 2041  4', None)..    A
-00013610: 7267 733a 0a20 2020 2020 2020 2065 7272  rgs:.        err
-00013620: 6f72 5f6d 6573 7361 6765 3a20 6120 7374  or_message: a st
-00013630: 7269 6e67 2c20 7468 6520 6572 726f 7220  ring, the error 
-00013640: 6d65 7373 6167 6520 746f 2067 6976 6520  message to give 
-00013650: 7468 6520 656e 6420 7573 6572 0a20 2020  the end user.   
-00013660: 2020 2020 2020 2020 2069 6620 7468 6520           if the 
-00013670: 5552 4c20 646f 6573 206e 6f74 2076 616c  URL does not val
-00013680: 6964 6174 650a 2020 2020 2020 2020 616c  idate.        al
-00013690: 6c6f 7765 645f 7363 6865 6d65 733a 2061  lowed_schemes: a
-000136a0: 206c 6973 7420 636f 6e74 6169 6e69 6e67   list containing
-000136b0: 2073 7472 696e 6773 206f 7220 4e6f 6e65   strings or None
-000136c0: 2e20 4561 6368 2065 6c65 6d65 6e74 0a20  . Each element. 
-000136d0: 2020 2020 2020 2020 2020 2069 7320 6120             is a 
-000136e0: 7363 6865 6d65 2074 6865 2069 6e70 7574  scheme the input
-000136f0: 7465 6420 5552 4c20 6973 2061 6c6c 6f77  ted URL is allow
-00013700: 6564 2074 6f20 7573 650a 2020 2020 2020  ed to use.      
-00013710: 2020 7072 6570 656e 645f 7363 6865 6d65    prepend_scheme
-00013720: 3a20 6120 7374 7269 6e67 2c20 7468 6973  : a string, this
-00013730: 2073 6368 656d 6520 6973 2070 7265 7065   scheme is prepe
-00013740: 6e64 6564 2069 6620 6974 2773 0a20 2020  nded if it's.   
-00013750: 2020 2020 2020 2020 206e 6563 6573 7361           necessa
-00013760: 7279 2074 6f20 6d61 6b65 2074 6865 2055  ry to make the U
-00013770: 524c 2076 616c 6964 0a20 2020 2022 2222  RL valid.    """
-00013780: 0a0a 2020 2020 5245 4745 585f 4745 4e45  ..    REGEX_GENE
-00013790: 5249 435f 5641 4c49 445f 4950 203d 2072  RIC_VALID_IP = r
-000137a0: 2228 5b5c 772e 217e 2a27 7c3b 3a26 3d2b  "([\w.!~*'|;:&=+
-000137b0: 242c 2d5d 2b40 293f 5c64 2b5c 2e5c 642b  $,-]+@)?\d+\.\d+
-000137c0: 5c2e 5c64 2b5c 2e5c 642b 283a 5c64 2a29  \.\d+\.\d+(:\d*)
-000137d0: 2a24 220a 2020 2020 5245 4745 585f 4745  *$".    REGEX_GE
-000137e0: 4e45 5249 435f 5641 4c49 445f 444f 4d41  NERIC_VALID_DOMA
-000137f0: 494e 203d 2072 2228 5b5c 772e 217e 2a27  IN = r"([\w.!~*'
-00013800: 7c3b 3a26 3d2b 242c 2d5d 2b40 293f 2828  |;:&=+$,-]+@)?((
-00013810: 5b41 2d5a 612d 7a30 2d39 5d2b 5b41 2d5a  [A-Za-z0-9]+[A-Z
-00013820: 612d 7a30 2d39 5c2d 5d2a 5b41 2d5a 612d  a-z0-9\-]*[A-Za-
-00013830: 7a30 2d39 5d2b 5c2e 292a 285b 412d 5a61  z0-9]+\.)*([A-Za
-00013840: 2d7a 302d 395d 2b5c 2e29 2a29 2a28 5b41  -z0-9]+\.)*)*([A
-00013850: 2d5a 612d 7a5d 2b5b 412d 5a61 2d7a 302d  -Za-z]+[A-Za-z0-
-00013860: 395c 2d5d 2a5b 412d 5a61 2d7a 302d 395d  9\-]*[A-Za-z0-9]
-00013870: 2b29 5c2e 3f28 3a5c 642a 292a 2422 0a0a  +)\.?(:\d*)*$"..
-00013880: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00013890: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-000138a0: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-000138b0: 7373 6167 653d 2245 6e74 6572 2061 2076  ssage="Enter a v
-000138c0: 616c 6964 2055 524c 222c 0a20 2020 2020  alid URL",.     
-000138d0: 2020 2061 6c6c 6f77 6564 5f73 6368 656d     allowed_schem
-000138e0: 6573 3d4e 6f6e 652c 0a20 2020 2020 2020  es=None,.       
-000138f0: 2070 7265 7065 6e64 5f73 6368 656d 653d   prepend_scheme=
-00013900: 2268 7474 7022 2c0a 2020 2020 2020 2020  "http",.        
-00013910: 616c 6c6f 7765 645f 746c 6473 3d4e 6f6e  allowed_tlds=Non
-00013920: 652c 0a20 2020 2029 3a0a 0a20 2020 2020  e,.    ):..     
-00013930: 2020 2073 656c 662e 6572 726f 725f 6d65     self.error_me
-00013940: 7373 6167 6520 3d20 6572 726f 725f 6d65  ssage = error_me
-00013950: 7373 6167 650a 2020 2020 2020 2020 6966  ssage.        if
-00013960: 2061 6c6c 6f77 6564 5f73 6368 656d 6573   allowed_schemes
-00013970: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00013980: 2020 2020 2020 7365 6c66 2e61 6c6c 6f77        self.allow
-00013990: 6564 5f73 6368 656d 6573 203d 2068 7474  ed_schemes = htt
-000139a0: 705f 7363 6865 6d65 730a 2020 2020 2020  p_schemes.      
-000139b0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000139c0: 2020 2020 7365 6c66 2e61 6c6c 6f77 6564      self.allowed
-000139d0: 5f73 6368 656d 6573 203d 2061 6c6c 6f77  _schemes = allow
-000139e0: 6564 5f73 6368 656d 6573 0a20 2020 2020  ed_schemes.     
-000139f0: 2020 2069 6620 616c 6c6f 7765 645f 746c     if allowed_tl
-00013a00: 6473 2069 7320 4e6f 6e65 3a0a 2020 2020  ds is None:.    
-00013a10: 2020 2020 2020 2020 7365 6c66 2e61 6c6c          self.all
-00013a20: 6f77 6564 5f74 6c64 7320 3d20 6f66 6669  owed_tlds = offi
-00013a30: 6369 616c 5f74 6f70 5f6c 6576 656c 5f64  cial_top_level_d
-00013a40: 6f6d 6169 6e73 0a20 2020 2020 2020 2065  omains.        e
-00013a50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00013a60: 2073 656c 662e 616c 6c6f 7765 645f 746c   self.allowed_tl
-00013a70: 6473 203d 2061 6c6c 6f77 6564 5f74 6c64  ds = allowed_tld
-00013a80: 730a 2020 2020 2020 2020 7365 6c66 2e70  s.        self.p
-00013a90: 7265 7065 6e64 5f73 6368 656d 6520 3d20  repend_scheme = 
-00013aa0: 7072 6570 656e 645f 7363 6865 6d65 0a0a  prepend_scheme..
-00013ab0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00013ac0: 2073 656c 662e 616c 6c6f 7765 645f 7363   self.allowed_sc
-00013ad0: 6865 6d65 733a 0a20 2020 2020 2020 2020  hemes:.         
-00013ae0: 2020 2069 6620 6920 6e6f 7420 696e 2068     if i not in h
-00013af0: 7474 705f 7363 6865 6d65 733a 0a20 2020  ttp_schemes:.   
-00013b00: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00013b10: 7365 2053 796e 7461 7845 7272 6f72 280a  se SyntaxError(.
+0000b370: 595f 5350 4c49 5454 4552 203d 2022 5b5c  Y_SPLITTER = "[\
+0000b380: 7530 3032 655c 7533 3030 325c 7566 6630  u002e\u3002\uff0
+0000b390: 655c 7566 6636 315d 220a 0a0a 6465 6620  e\uff61]"...def 
+0000b3a0: 6573 6361 7065 5f75 6e69 636f 6465 2873  escape_unicode(s
+0000b3b0: 7472 696e 6729 3a0a 0a20 2020 2022 2222  tring):..    """
+0000b3c0: 0a20 2020 2043 6f6e 7665 7274 7320 6120  .    Converts a 
+0000b3d0: 756e 6963 6f64 6520 7374 7269 6e67 2069  unicode string i
+0000b3e0: 6e74 6f20 5553 2d41 5343 4949 2c20 7573  nto US-ASCII, us
+0000b3f0: 696e 6720 6120 7369 6d70 6c65 2063 6f6e  ing a simple con
+0000b400: 7665 7273 696f 6e20 7363 6865 6d65 2e0a  version scheme..
+0000b410: 2020 2020 4561 6368 2075 6e69 636f 6465      Each unicode
+0000b420: 2063 6861 7261 6374 6572 2074 6861 7420   character that 
+0000b430: 646f 6573 206e 6f74 2068 6176 6520 6120  does not have a 
+0000b440: 5553 2d41 5343 4949 2065 7175 6976 616c  US-ASCII equival
+0000b450: 656e 7420 6973 0a20 2020 2063 6f6e 7665  ent is.    conve
+0000b460: 7274 6564 2069 6e74 6f20 6120 5552 4c20  rted into a URL 
+0000b470: 6573 6361 7065 6420 666f 726d 2062 6173  escaped form bas
+0000b480: 6564 206f 6e20 6974 7320 6865 7861 6465  ed on its hexade
+0000b490: 6369 6d61 6c20 7661 6c75 652e 0a20 2020  cimal value..   
+0000b4a0: 2046 6f72 2065 7861 6d70 6c65 2c20 7468   For example, th
+0000b4b0: 6520 756e 6963 6f64 6520 6368 6172 6163  e unicode charac
+0000b4c0: 7465 7220 275c 5c75 3465 3836 2720 7769  ter '\\u4e86' wi
+0000b4d0: 6c6c 2062 6563 6f6d 6520 7468 6520 7374  ll become the st
+0000b4e0: 7269 6e67 2027 2534 6525 3836 270a 0a20  ring '%4e%86'.. 
+0000b4f0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+0000b500: 2073 7472 696e 673a 2075 6e69 636f 6465   string: unicode
+0000b510: 2073 7472 696e 672c 2074 6865 2075 6e69   string, the uni
+0000b520: 636f 6465 2073 7472 696e 6720 746f 2063  code string to c
+0000b530: 6f6e 7665 7274 2069 6e74 6f20 616e 0a20  onvert into an. 
+0000b540: 2020 2020 2020 2020 2020 2065 7363 6170             escap
+0000b550: 6564 2055 532d 4153 4349 4920 666f 726d  ed US-ASCII form
+0000b560: 0a0a 2020 2020 5265 7475 726e 733a 0a20  ..    Returns:. 
+0000b570: 2020 2020 2020 2073 7472 696e 673a 2074         string: t
+0000b580: 6865 2055 532d 4153 4349 4920 6573 6361  he US-ASCII esca
+0000b590: 7065 6420 666f 726d 206f 6620 7468 6520  ped form of the 
+0000b5a0: 696e 7075 7474 6564 2073 7472 696e 670a  inputted string.
+0000b5b0: 0a20 2020 2040 6175 7468 6f72 3a20 4a6f  .    @author: Jo
+0000b5c0: 6e61 7468 616e 2042 656e 6e0a 2020 2020  nathan Benn.    
+0000b5d0: 2222 220a 2020 2020 7265 7475 726e 5661  """.    returnVa
+0000b5e0: 6c75 6520 3d20 5374 7269 6e67 494f 2829  lue = StringIO()
+0000b5f0: 0a0a 2020 2020 666f 7220 6368 6172 6163  ..    for charac
+0000b600: 7465 7220 696e 2073 7472 696e 673a 0a20  ter in string:. 
+0000b610: 2020 2020 2020 2063 6f64 6520 3d20 6f72         code = or
+0000b620: 6428 6368 6172 6163 7465 7229 0a20 2020  d(character).   
+0000b630: 2020 2020 2069 6620 636f 6465 203e 2030       if code > 0
+0000b640: 7837 463a 0a20 2020 2020 2020 2020 2020  x7F:.           
+0000b650: 2068 6578 436f 6465 203d 2068 6578 2863   hexCode = hex(c
+0000b660: 6f64 6529 0a20 2020 2020 2020 2020 2020  ode).           
+0000b670: 2072 6574 7572 6e56 616c 7565 2e77 7269   returnValue.wri
+0000b680: 7465 2822 2522 202b 2068 6578 436f 6465  te("%" + hexCode
+0000b690: 5b32 3a34 5d20 2b20 2225 2220 2b20 6865  [2:4] + "%" + he
+0000b6a0: 7843 6f64 655b 343a 365d 290a 2020 2020  xCode[4:6]).    
+0000b6b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000b6c0: 2020 2020 2020 7265 7475 726e 5661 6c75        returnValu
+0000b6d0: 652e 7772 6974 6528 6368 6172 6163 7465  e.write(characte
+0000b6e0: 7229 0a0a 2020 2020 7265 7475 726e 2072  r)..    return r
+0000b6f0: 6574 7572 6e56 616c 7565 2e67 6574 7661  eturnValue.getva
+0000b700: 6c75 6528 290a 0a0a 6465 6620 756e 6963  lue()...def unic
+0000b710: 6f64 655f 746f 5f61 7363 6969 5f61 7574  ode_to_ascii_aut
+0000b720: 686f 7269 7479 2861 7574 686f 7269 7479  hority(authority
+0000b730: 293a 0a20 2020 2022 2222 0a20 2020 2046  ):.    """.    F
+0000b740: 6f6c 6c6f 7773 2074 6865 2073 7465 7073  ollows the steps
+0000b750: 2069 6e20 5246 4320 3334 3930 2c20 5365   in RFC 3490, Se
+0000b760: 6374 696f 6e20 3420 746f 2063 6f6e 7665  ction 4 to conve
+0000b770: 7274 2061 2075 6e69 636f 6465 2061 7574  rt a unicode aut
+0000b780: 686f 7269 7479 0a20 2020 2073 7472 696e  hority.    strin
+0000b790: 6720 696e 746f 2069 7473 2041 5343 4949  g into its ASCII
+0000b7a0: 2065 7175 6976 616c 656e 742e 0a20 2020   equivalent..   
+0000b7b0: 2046 6f72 2065 7861 6d70 6c65 2c20 7527   For example, u'
+0000b7c0: 7777 772e 416c 6c69 616e 6365 6672 616e  www.Alliancefran
+0000b7d0: 5c5c 7865 3761 6973 652e 6e75 2720 7769  \\xe7aise.nu' wi
+0000b7e0: 6c6c 2062 6520 636f 6e76 6572 7465 6420  ll be converted 
+0000b7f0: 696e 746f 0a20 2020 2027 7777 772e 786e  into.    'www.xn
+0000b800: 2d2d 616c 6c69 616e 6365 6672 616e 6169  --alliancefranai
+0000b810: 7365 2d6e 7062 2e6e 7527 0a0a 2020 2020  se-npb.nu'..    
+0000b820: 4172 6773 3a0a 2020 2020 2020 2020 6175  Args:.        au
+0000b830: 7468 6f72 6974 793a 2075 6e69 636f 6465  thority: unicode
+0000b840: 2073 7472 696e 672c 2074 6865 2055 524c   string, the URL
+0000b850: 2061 7574 686f 7269 7479 2063 6f6d 706f   authority compo
+0000b860: 6e65 6e74 2074 6f20 636f 6e76 6572 742c  nent to convert,
+0000b870: 0a20 2020 2020 2020 2020 2020 2065 2e67  .            e.g
+0000b880: 2e20 7527 7777 772e 416c 6c69 616e 6365  . u'www.Alliance
+0000b890: 6672 616e 5c5c 7865 3761 6973 652e 6e75  fran\\xe7aise.nu
+0000b8a0: 270a 0a20 2020 2052 6574 7572 6e73 3a0a  '..    Returns:.
+0000b8b0: 2020 2020 2020 2020 7374 7269 6e67 3a20          string: 
+0000b8c0: 7468 6520 5553 2d41 5343 4949 2063 6861  the US-ASCII cha
+0000b8d0: 7261 6374 6572 2065 7175 6976 616c 656e  racter equivalen
+0000b8e0: 7420 746f 2074 6865 2069 6e70 7574 7465  t to the inputte
+0000b8f0: 6420 6175 7468 6f72 6974 792c 0a20 2020  d authority,.   
+0000b900: 2020 2020 2020 2020 2020 652e 672e 2027            e.g. '
+0000b910: 7777 772e 786e 2d2d 616c 6c69 616e 6365  www.xn--alliance
+0000b920: 6672 616e 6169 7365 2d6e 7062 2e6e 7527  franaise-npb.nu'
+0000b930: 0a0a 2020 2020 5261 6973 6573 3a0a 2020  ..    Raises:.  
+0000b940: 2020 2020 2020 4578 6365 7074 696f 6e3a        Exception:
+0000b950: 2069 6620 7468 6520 6675 6e63 7469 6f6e   if the function
+0000b960: 2069 7320 6e6f 7420 6162 6c65 2074 6f20   is not able to 
+0000b970: 636f 6e76 6572 7420 7468 6520 696e 7075  convert the inpu
+0000b980: 7474 6564 0a20 2020 2020 2020 2020 2020  tted.           
+0000b990: 2061 7574 686f 7269 7479 0a0a 2020 2020   authority..    
+0000b9a0: 4061 7574 686f 723a 204a 6f6e 6174 6861  @author: Jonatha
+0000b9b0: 6e20 4265 6e6e 0a20 2020 2022 2222 0a20  n Benn.    """. 
+0000b9c0: 2020 2023 2052 4643 2033 3439 302c 2053     # RFC 3490, S
+0000b9d0: 6563 7469 6f6e 2034 2c20 5374 6570 2031  ection 4, Step 1
+0000b9e0: 0a20 2020 2023 2054 6865 2065 6e63 6f64  .    # The encod
+0000b9f0: 696e 6773 2e69 646e 6120 5079 7468 6f6e  ings.idna Python
+0000ba00: 206d 6f64 756c 6520 6173 7375 6d65 7320   module assumes 
+0000ba10: 7468 6174 2041 6c6c 6f77 556e 6173 7369  that AllowUnassi
+0000ba20: 676e 6564 203d 3d20 5472 7565 0a0a 2020  gned == True..  
+0000ba30: 2020 2320 5246 4320 3334 3930 2c20 5365    # RFC 3490, Se
+0000ba40: 6374 696f 6e20 342c 2053 7465 7020 320a  ction 4, Step 2.
+0000ba50: 2020 2020 6c61 6265 6c73 203d 2072 652e      labels = re.
+0000ba60: 7370 6c69 7428 5245 4745 585f 4155 5448  split(REGEX_AUTH
+0000ba70: 4f52 4954 595f 5350 4c49 5454 4552 2c20  ORITY_SPLITTER, 
+0000ba80: 6175 7468 6f72 6974 7929 0a0a 2020 2020  authority)..    
+0000ba90: 2320 5246 4320 3334 3930 2c20 5365 6374  # RFC 3490, Sect
+0000baa0: 696f 6e20 342c 2053 7465 7020 330a 2020  ion 4, Step 3.  
+0000bab0: 2020 2320 5468 6520 656e 636f 6469 6e67    # The encoding
+0000bac0: 732e 6964 6e61 2050 7974 686f 6e20 6d6f  s.idna Python mo
+0000bad0: 6475 6c65 2061 7373 756d 6573 2074 6861  dule assumes tha
+0000bae0: 7420 5573 6553 5444 3341 5343 4949 5275  t UseSTD3ASCIIRu
+0000baf0: 6c65 7320 3d3d 2046 616c 7365 0a0a 2020  les == False..  
+0000bb00: 2020 2320 5246 4320 3334 3930 2c20 5365    # RFC 3490, Se
+0000bb10: 6374 696f 6e20 342c 2053 7465 7020 340a  ction 4, Step 4.
+0000bb20: 2020 2020 2320 5765 2075 7365 2074 6865      # We use the
+0000bb30: 2054 6f41 5343 4949 206f 7065 7261 7469   ToASCII operati
+0000bb40: 6f6e 2062 6563 6175 7365 2077 6520 6172  on because we ar
+0000bb50: 6520 6162 6f75 7420 746f 2070 7574 2074  e about to put t
+0000bb60: 6865 2061 7574 686f 7269 7479 0a20 2020  he authority.   
+0000bb70: 2023 2069 6e74 6f20 616e 2049 444e 2d75   # into an IDN-u
+0000bb80: 6e61 7761 7265 2073 6c6f 740a 2020 2020  naware slot.    
+0000bb90: 6173 6369 694c 6162 656c 7320 3d20 5b5d  asciiLabels = []
+0000bba0: 0a20 2020 2066 6f72 206c 6162 656c 2069  .    for label i
+0000bbb0: 6e20 6c61 6265 6c73 3a0a 2020 2020 2020  n labels:.      
+0000bbc0: 2020 6966 206c 6162 656c 3a0a 2020 2020    if label:.    
+0000bbd0: 2020 2020 2020 2020 6173 6369 694c 6162          asciiLab
+0000bbe0: 656c 732e 6170 7065 6e64 2874 6f5f 6e61  els.append(to_na
+0000bbf0: 7469 7665 2865 6e63 6f64 696e 6773 2e69  tive(encodings.i
+0000bc00: 646e 612e 546f 4153 4349 4928 6c61 6265  dna.ToASCII(labe
+0000bc10: 6c29 2929 0a20 2020 2020 2020 2065 6c73  l))).        els
+0000bc20: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+0000bc30: 2065 6e63 6f64 696e 6773 2e69 646e 612e   encodings.idna.
+0000bc40: 546f 4153 4349 4920 646f 6573 206e 6f74  ToASCII does not
+0000bc50: 2061 6363 6570 7420 616e 2065 6d70 7479   accept an empty
+0000bc60: 2073 7472 696e 672c 2062 7574 0a20 2020   string, but.   
+0000bc70: 2020 2020 2020 2020 2023 2069 7420 6973           # it is
+0000bc80: 206e 6563 6573 7361 7279 2066 6f72 2075   necessary for u
+0000bc90: 7320 746f 2061 6c6c 6f77 2066 6f72 2065  s to allow for e
+0000bca0: 6d70 7479 206c 6162 656c 7320 736f 2074  mpty labels so t
+0000bcb0: 6861 7420 7765 0a20 2020 2020 2020 2020  hat we.         
+0000bcc0: 2020 2023 2064 6f6e 2774 206d 6f64 6966     # don't modif
+0000bcd0: 7920 7468 6520 5552 4c0a 2020 2020 2020  y the URL.      
+0000bce0: 2020 2020 2020 6173 6369 694c 6162 656c        asciiLabel
+0000bcf0: 732e 6170 7065 6e64 2822 2229 0a20 2020  s.append("").   
+0000bd00: 2023 2052 4643 2033 3439 302c 2053 6563   # RFC 3490, Sec
+0000bd10: 7469 6f6e 2034 2c20 5374 6570 2035 0a20  tion 4, Step 5. 
+0000bd20: 2020 2072 6574 7572 6e20 7374 7228 7265     return str(re
+0000bd30: 6475 6365 286c 616d 6264 6120 782c 2079  duce(lambda x, y
+0000bd40: 3a20 7820 2b20 756e 6963 6872 2830 7830  : x + unichr(0x0
+0000bd50: 3032 4529 202b 2079 2c20 6173 6369 694c  02E) + y, asciiL
+0000bd60: 6162 656c 7329 290a 0a0a 6465 6620 756e  abels))...def un
+0000bd70: 6963 6f64 655f 746f 5f61 7363 6969 5f75  icode_to_ascii_u
+0000bd80: 726c 2875 726c 2c20 7072 6570 656e 645f  rl(url, prepend_
+0000bd90: 7363 6865 6d65 293a 0a20 2020 2022 2222  scheme):.    """
+0000bda0: 0a20 2020 2043 6f6e 7665 7274 7320 7468  .    Converts th
+0000bdb0: 6520 696e 7075 7474 6564 2075 6e69 636f  e inputted unico
+0000bdc0: 6465 2075 726c 2069 6e74 6f20 6120 5553  de url into a US
+0000bdd0: 2d41 5343 4949 2065 7175 6976 616c 656e  -ASCII equivalen
+0000bde0: 742e 2054 6869 7320 6675 6e63 7469 6f6e  t. This function
+0000bdf0: 0a20 2020 2067 6f65 7320 6120 6c69 7474  .    goes a litt
+0000be00: 6c65 2062 6579 6f6e 6420 5246 4320 3334  le beyond RFC 34
+0000be10: 3930 2c20 7768 6963 6820 6973 206c 696d  90, which is lim
+0000be20: 6974 6564 2069 6e20 7363 6f70 6520 746f  ited in scope to
+0000be30: 2074 6865 2064 6f6d 6169 6e20 6e61 6d65   the domain name
+0000be40: 0a20 2020 2028 6175 7468 6f72 6974 7929  .    (authority)
+0000be50: 206f 6e6c 792e 2048 6572 652c 2074 6865   only. Here, the
+0000be60: 2066 756e 6374 696f 6e61 6c69 7479 2069   functionality i
+0000be70: 7320 6578 7061 6e64 6564 2074 6f20 7768  s expanded to wh
+0000be80: 6174 2077 6173 206f 6273 6572 7665 640a  at was observed.
+0000be90: 2020 2020 6f6e 2057 696b 6970 6564 6961      on Wikipedia
+0000bea0: 206f 6e20 3230 3039 2d4a 616e 2d32 323a   on 2009-Jan-22:
+0000beb0: 0a0a 2020 2020 2020 2043 6f6d 706f 6e65  ..       Compone
+0000bec0: 6e74 2020 2020 4361 6e20 5573 6520 556e  nt    Can Use Un
+0000bed0: 6963 6f64 653f 0a20 2020 2020 2020 2d2d  icode?.       --
+0000bee0: 2d2d 2d2d 2d2d 2d20 2020 202d 2d2d 2d2d  -------    -----
+0000bef0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000bf00: 2020 2073 6368 656d 6520 2020 2020 2020     scheme       
+0000bf10: 4e6f 0a20 2020 2020 2020 6175 7468 6f72  No.       author
+0000bf20: 6974 7920 2020 2059 6573 0a20 2020 2020  ity    Yes.     
+0000bf30: 2020 7061 7468 2020 2020 2020 2020 2059    path         Y
+0000bf40: 6573 0a20 2020 2020 2020 7175 6572 7920  es.       query 
+0000bf50: 2020 2020 2020 2059 6573 0a20 2020 2020         Yes.     
+0000bf60: 2020 6672 6167 6d65 6e74 2020 2020 204e    fragment     N
+0000bf70: 6f0a 0a20 2020 2054 6865 2061 7574 686f  o..    The autho
+0000bf80: 7269 7479 2063 6f6d 706f 6e65 6e74 2067  rity component g
+0000bf90: 6574 7320 636f 6e76 6572 7465 6420 746f  ets converted to
+0000bfa0: 2070 756e 7963 6f64 652c 2062 7574 206f   punycode, but o
+0000bfb0: 6363 7572 7265 6e63 6573 206f 660a 2020  ccurrences of.  
+0000bfc0: 2020 756e 6963 6f64 6520 696e 206f 7468    unicode in oth
+0000bfd0: 6572 2063 6f6d 706f 6e65 6e74 7320 6765  er components ge
+0000bfe0: 7420 636f 6e76 6572 7465 6420 696e 746f  t converted into
+0000bff0: 2061 2070 6169 7220 6f66 2055 5249 2065   a pair of URI e
+0000c000: 7363 6170 6573 2028 7765 0a20 2020 2061  scapes (we.    a
+0000c010: 7373 756d 6520 342d 6279 7465 2075 6e69  ssume 4-byte uni
+0000c020: 636f 6465 292e 2045 2e67 2e20 7468 6520  code). E.g. the 
+0000c030: 756e 6963 6f64 6520 6368 6172 6163 7465  unicode characte
+0000c040: 7220 552b 3445 3244 2077 696c 6c20 6265  r U+4E2D will be
+0000c050: 0a20 2020 2063 6f6e 7665 7274 6564 2069  .    converted i
+0000c060: 6e74 6f20 2725 3445 2532 4427 2e20 5465  nto '%4E%2D'. Te
+0000c070: 7374 696e 6720 7769 7468 2046 6972 6566  sting with Firef
+0000c080: 6f78 2076 332e 302e 3520 6861 7320 7368  ox v3.0.5 has sh
+0000c090: 6f77 6e20 7468 6174 2069 7420 6361 6e0a  own that it can.
+0000c0a0: 2020 2020 756e 6465 7273 7461 6e64 2074      understand t
+0000c0b0: 6869 7320 6b69 6e64 206f 6620 5552 4920  his kind of URI 
+0000c0c0: 656e 636f 6469 6e67 2e0a 0a20 2020 2041  encoding...    A
+0000c0d0: 7267 733a 0a20 2020 2020 2020 2075 726c  rgs:.        url
+0000c0e0: 3a20 756e 6963 6f64 6520 7374 7269 6e67  : unicode string
+0000c0f0: 2c20 7468 6520 5552 4c20 746f 2063 6f6e  , the URL to con
+0000c100: 7665 7274 2066 726f 6d20 756e 6963 6f64  vert from unicod
+0000c110: 6520 696e 746f 2055 532d 4153 4349 490a  e into US-ASCII.
+0000c120: 2020 2020 2020 2020 7072 6570 656e 645f          prepend_
+0000c130: 7363 6865 6d65 3a20 7374 7269 6e67 2c20  scheme: string, 
+0000c140: 6120 7072 6f74 6f63 6f6c 2073 6368 656d  a protocol schem
+0000c150: 6520 746f 2070 7265 7065 6e64 2074 6f20  e to prepend to 
+0000c160: 7468 6520 5552 4c20 6966 0a20 2020 2020  the URL if.     
+0000c170: 2020 2020 2020 2077 6527 7265 2068 6176         we're hav
+0000c180: 696e 6720 7472 6f75 626c 6520 7061 7273  ing trouble pars
+0000c190: 696e 6720 6974 2e0a 2020 2020 2020 2020  ing it..        
+0000c1a0: 2020 2020 652e 672e 2022 6874 7470 222e      e.g. "http".
+0000c1b0: 2049 6e70 7574 204e 6f6e 6520 746f 2064   Input None to d
+0000c1c0: 6973 6162 6c65 2074 6869 7320 6675 6e63  isable this func
+0000c1d0: 7469 6f6e 616c 6974 790a 0a20 2020 2052  tionality..    R
+0000c1e0: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+0000c1f0: 7374 7269 6e67 3a20 6120 5553 2d41 5343  string: a US-ASC
+0000c200: 4949 2065 7175 6976 616c 656e 7420 6f66  II equivalent of
+0000c210: 2074 6865 2069 6e70 7574 7465 6420 7572   the inputted ur
+0000c220: 6c0a 0a20 2020 2040 6175 7468 6f72 3a20  l..    @author: 
+0000c230: 4a6f 6e61 7468 616e 2042 656e 6e0a 2020  Jonathan Benn.  
+0000c240: 2020 2222 220a 2020 2020 2320 636f 6e76    """.    # conv
+0000c250: 6572 7420 7468 6520 6175 7468 6f72 6974  ert the authorit
+0000c260: 7920 636f 6d70 6f6e 656e 7420 6f66 2074  y component of t
+0000c270: 6865 2055 524c 2069 6e74 6f20 616e 2041  he URL into an A
+0000c280: 5343 4949 2070 756e 7963 6f64 6520 7374  SCII punycode st
+0000c290: 7269 6e67 2c0a 2020 2020 2320 6275 7420  ring,.    # but 
+0000c2a0: 656e 636f 6465 2074 6865 2072 6573 7420  encode the rest 
+0000c2b0: 7573 696e 6720 7468 6520 7265 6775 6c61  using the regula
+0000c2c0: 7220 5552 4920 6368 6172 6163 7465 7220  r URI character 
+0000c2d0: 656e 636f 6469 6e67 0a20 2020 2063 6f6d  encoding.    com
+0000c2e0: 706f 6e65 6e74 7320 3d20 7572 6c70 6172  ponents = urlpar
+0000c2f0: 7365 2e75 726c 7061 7273 6528 7572 6c29  se.urlparse(url)
+0000c300: 0a20 2020 2070 7265 7065 6e64 6564 203d  .    prepended =
+0000c310: 2046 616c 7365 0a20 2020 2023 2049 6620   False.    # If 
+0000c320: 6e6f 2061 7574 686f 7269 7479 2077 6173  no authority was
+0000c330: 2066 6f75 6e64 0a20 2020 2069 6620 6e6f   found.    if no
+0000c340: 7420 636f 6d70 6f6e 656e 7473 2e6e 6574  t components.net
+0000c350: 6c6f 633a 0a20 2020 2020 2020 2023 2054  loc:.        # T
+0000c360: 7279 2061 7070 656e 6469 6e67 2061 2073  ry appending a s
+0000c370: 6368 656d 6520 746f 2073 6565 2069 6620  cheme to see if 
+0000c380: 7468 6174 2066 6978 6573 2074 6865 2070  that fixes the p
+0000c390: 726f 626c 656d 0a20 2020 2020 2020 2073  roblem.        s
+0000c3a0: 6368 656d 655f 746f 5f70 7265 7065 6e64  cheme_to_prepend
+0000c3b0: 203d 2070 7265 7065 6e64 5f73 6368 656d   = prepend_schem
+0000c3c0: 6520 6f72 2022 6874 7470 220a 2020 2020  e or "http".    
+0000c3d0: 2020 2020 636f 6d70 6f6e 656e 7473 203d      components =
+0000c3e0: 2075 726c 7061 7273 652e 7572 6c70 6172   urlparse.urlpar
+0000c3f0: 7365 2874 6f5f 756e 6963 6f64 6528 7363  se(to_unicode(sc
+0000c400: 6865 6d65 5f74 6f5f 7072 6570 656e 6429  heme_to_prepend)
+0000c410: 202b 2022 3a2f 2f22 202b 2075 726c 290a   + "://" + url).
+0000c420: 2020 2020 2020 2020 7072 6570 656e 6465          prepende
+0000c430: 6420 3d20 5472 7565 0a0a 2020 2020 2320  d = True..    # 
+0000c440: 6966 2077 6520 7374 696c 6c20 6361 6e27  if we still can'
+0000c450: 7420 6669 6e64 2074 6865 2061 7574 686f  t find the autho
+0000c460: 7269 7479 0a20 2020 2069 6620 6e6f 7420  rity.    if not 
+0000c470: 636f 6d70 6f6e 656e 7473 2e6e 6574 6c6f  components.netlo
+0000c480: 633a 0a20 2020 2020 2020 2023 2041 6e64  c:.        # And
+0000c490: 2069 7427 7320 6e6f 7420 6265 6361 7573   it's not becaus
+0000c4a0: 6520 7468 6520 7572 6c20 6973 2061 2072  e the url is a r
+0000c4b0: 656c 6174 6976 6520 7572 6c0a 2020 2020  elative url.    
+0000c4c0: 2020 2020 6966 206e 6f74 2075 726c 2e73      if not url.s
+0000c4d0: 7461 7274 7377 6974 6828 222f 2229 3a0a  tartswith("/"):.
+0000c4e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000c4f0: 6520 4578 6365 7074 696f 6e28 0a20 2020  e Exception(.   
+0000c500: 2020 2020 2020 2020 2020 2020 2022 4e6f               "No
+0000c510: 2061 7574 686f 7269 7479 2063 6f6d 706f   authority compo
+0000c520: 6e65 6e74 2066 6f75 6e64 2c20 220a 2020  nent found, ".  
+0000c530: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+0000c540: 2263 6f75 6c64 206e 6f74 2064 6563 6f64  "could not decod
+0000c550: 6520 756e 6963 6f64 6520 746f 2055 532d  e unicode to US-
+0000c560: 4153 4349 4922 0a20 2020 2020 2020 2020  ASCII".         
+0000c570: 2020 2029 0a0a 2020 2020 2320 5765 2772     )..    # We'r
+0000c580: 6520 6865 7265 2069 6620 7765 2066 6f75  e here if we fou
+0000c590: 6e64 2061 6e20 6175 7468 6f72 6974 792c  nd an authority,
+0000c5a0: 206c 6574 2773 2072 6562 7569 6c64 2074   let's rebuild t
+0000c5b0: 6865 2055 524c 0a20 2020 2073 6368 656d  he URL.    schem
+0000c5c0: 6520 3d20 636f 6d70 6f6e 656e 7473 2e73  e = components.s
+0000c5d0: 6368 656d 650a 2020 2020 6175 7468 6f72  cheme.    author
+0000c5e0: 6974 7920 3d20 636f 6d70 6f6e 656e 7473  ity = components
+0000c5f0: 2e6e 6574 6c6f 630a 2020 2020 7061 7468  .netloc.    path
+0000c600: 203d 2063 6f6d 706f 6e65 6e74 732e 7061   = components.pa
+0000c610: 7468 0a20 2020 2071 7565 7279 203d 2063  th.    query = c
+0000c620: 6f6d 706f 6e65 6e74 732e 7175 6572 790a  omponents.query.
+0000c630: 2020 2020 6672 6167 6d65 6e74 203d 2063      fragment = c
+0000c640: 6f6d 706f 6e65 6e74 732e 6672 6167 6d65  omponents.fragme
+0000c650: 6e74 0a0a 2020 2020 6966 2070 7265 7065  nt..    if prepe
+0000c660: 6e64 6564 3a0a 2020 2020 2020 2020 7363  nded:.        sc
+0000c670: 6865 6d65 203d 2022 220a 0a20 2020 2075  heme = ""..    u
+0000c680: 6e70 6172 7365 6420 3d20 7572 6c70 6172  nparsed = urlpar
+0000c690: 7365 2e75 726c 756e 7061 7273 6528 0a20  se.urlunparse(. 
+0000c6a0: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
+0000c6b0: 2020 2020 2073 6368 656d 652c 0a20 2020       scheme,.   
+0000c6c0: 2020 2020 2020 2020 2075 6e69 636f 6465           unicode
+0000c6d0: 5f74 6f5f 6173 6369 695f 6175 7468 6f72  _to_ascii_author
+0000c6e0: 6974 7928 6175 7468 6f72 6974 7929 2c0a  ity(authority),.
+0000c6f0: 2020 2020 2020 2020 2020 2020 6573 6361              esca
+0000c700: 7065 5f75 6e69 636f 6465 2870 6174 6829  pe_unicode(path)
+0000c710: 2c0a 2020 2020 2020 2020 2020 2020 2222  ,.            ""
+0000c720: 2c0a 2020 2020 2020 2020 2020 2020 6573  ,.            es
+0000c730: 6361 7065 5f75 6e69 636f 6465 2871 7565  cape_unicode(que
+0000c740: 7279 292c 0a20 2020 2020 2020 2020 2020  ry),.           
+0000c750: 2073 7472 2866 7261 676d 656e 7429 2c0a   str(fragment),.
+0000c760: 2020 2020 2020 2020 290a 2020 2020 290a          ).    ).
+0000c770: 2020 2020 6966 2075 6e70 6172 7365 642e      if unparsed.
+0000c780: 7374 6172 7473 7769 7468 2822 2f2f 2229  startswith("//")
+0000c790: 3a0a 2020 2020 2020 2020 756e 7061 7273  :.        unpars
+0000c7a0: 6564 203d 2075 6e70 6172 7365 645b 323a  ed = unparsed[2:
+0000c7b0: 5d20 2023 2052 656d 6f76 6520 7468 6520  ]  # Remove the 
+0000c7c0: 2f2f 2075 726c 756e 7061 7273 6520 7075  // urlunparse pu
+0000c7d0: 7473 2069 6e20 7468 6520 6265 6769 6e6e  ts in the beginn
+0000c7e0: 696e 670a 2020 2020 7265 7475 726e 2075  ing.    return u
+0000c7f0: 6e70 6172 7365 640a 0a0a 636c 6173 7320  nparsed...class 
+0000c800: 4953 5f47 454e 4552 4943 5f55 524c 2856  IS_GENERIC_URL(V
+0000c810: 616c 6964 6174 6f72 293a 0a20 2020 2022  alidator):.    "
+0000c820: 2222 0a20 2020 2052 656a 6563 7473 2061  "".    Rejects a
+0000c830: 2055 524c 2073 7472 696e 6720 6966 2061   URL string if a
+0000c840: 6e79 206f 6620 7468 6520 666f 6c6c 6f77  ny of the follow
+0000c850: 696e 6720 6973 2074 7275 653a 0a20 2020  ing is true:.   
+0000c860: 2020 2020 2a20 5468 6520 7374 7269 6e67      * The string
+0000c870: 2069 7320 656d 7074 7920 6f72 204e 6f6e   is empty or Non
+0000c880: 650a 2020 2020 2020 202a 2054 6865 2073  e.       * The s
+0000c890: 7472 696e 6720 7573 6573 2063 6861 7261  tring uses chara
+0000c8a0: 6374 6572 7320 7468 6174 2061 7265 206e  cters that are n
+0000c8b0: 6f74 2061 6c6c 6f77 6564 2069 6e20 6120  ot allowed in a 
+0000c8c0: 5552 4c0a 2020 2020 2020 202a 2054 6865  URL.       * The
+0000c8d0: 2055 524c 2073 6368 656d 6520 7370 6563   URL scheme spec
+0000c8e0: 6966 6965 6420 2869 6620 6f6e 6520 6973  ified (if one is
+0000c8f0: 2073 7065 6369 6669 6564 2920 6973 206e   specified) is n
+0000c900: 6f74 2076 616c 6964 0a0a 2020 2020 4261  ot valid..    Ba
+0000c910: 7365 6420 6f6e 2052 4643 2032 3339 363a  sed on RFC 2396:
+0000c920: 2068 7474 703a 2f2f 7777 772e 6661 7173   http://www.faqs
+0000c930: 2e6f 7267 2f72 6663 732f 7266 6332 3339  .org/rfcs/rfc239
+0000c940: 362e 6874 6d6c 0a0a 2020 2020 5468 6973  6.html..    This
+0000c950: 2066 756e 6374 696f 6e20 6f6e 6c79 2063   function only c
+0000c960: 6865 636b 7320 7468 6520 5552 4c27 7320  hecks the URL's 
+0000c970: 7379 6e74 6178 2e20 4974 2064 6f65 7320  syntax. It does 
+0000c980: 6e6f 7420 6368 6563 6b20 7468 6174 2074  not check that t
+0000c990: 6865 2055 524c 0a20 2020 2070 6f69 6e74  he URL.    point
+0000c9a0: 7320 746f 2061 2072 6561 6c20 646f 6375  s to a real docu
+0000c9b0: 6d65 6e74 2c20 666f 7220 6578 616d 706c  ment, for exampl
+0000c9c0: 652c 206f 7220 7468 6174 2069 7420 6f74  e, or that it ot
+0000c9d0: 6865 7277 6973 6520 6d61 6b65 7320 7365  herwise makes se
+0000c9e0: 6e73 650a 2020 2020 7365 6d61 6e74 6963  nse.    semantic
+0000c9f0: 616c 6c79 2e20 5468 6973 2066 756e 6374  ally. This funct
+0000ca00: 696f 6e20 646f 6573 2061 7574 6f6d 6174  ion does automat
+0000ca10: 6963 616c 6c79 2070 7265 7065 6e64 2027  ically prepend '
+0000ca20: 6874 7470 3a2f 2f27 2069 6e20 6672 6f6e  http://' in fron
+0000ca30: 740a 2020 2020 6f66 2061 2055 524c 2069  t.    of a URL i
+0000ca40: 6620 616e 6420 6f6e 6c79 2069 6620 7468  f and only if th
+0000ca50: 6174 2773 206e 6563 6573 7361 7279 2074  at's necessary t
+0000ca60: 6f20 7375 6363 6573 7366 756c 6c79 2070  o successfully p
+0000ca70: 6172 7365 2074 6865 2055 524c 2e0a 2020  arse the URL..  
+0000ca80: 2020 506c 6561 7365 206e 6f74 6520 7468    Please note th
+0000ca90: 6174 2061 2073 6368 656d 6520 7769 6c6c  at a scheme will
+0000caa0: 2062 6520 7072 6570 656e 6465 6420 6f6e   be prepended on
+0000cab0: 6c79 2066 6f72 2072 6172 6520 6361 7365  ly for rare case
+0000cac0: 730a 2020 2020 2865 2e67 2e20 2767 6f6f  s.    (e.g. 'goo
+0000cad0: 676c 652e 6361 3a38 3027 290a 0a20 2020  gle.ca:80')..   
+0000cae0: 2054 6865 206c 6973 7420 6f66 2061 6c6c   The list of all
+0000caf0: 6f77 6564 2073 6368 656d 6573 2069 7320  owed schemes is 
+0000cb00: 6375 7374 6f6d 697a 6162 6c65 2077 6974  customizable wit
+0000cb10: 6820 7468 6520 616c 6c6f 7765 645f 7363  h the allowed_sc
+0000cb20: 6865 6d65 730a 2020 2020 7061 7261 6d65  hemes.    parame
+0000cb30: 7465 722e 2049 6620 796f 7520 6578 636c  ter. If you excl
+0000cb40: 7564 6520 4e6f 6e65 2066 726f 6d20 7468  ude None from th
+0000cb50: 6520 6c69 7374 2c20 7468 656e 2061 6262  e list, then abb
+0000cb60: 7265 7669 6174 6564 2055 524c 730a 2020  reviated URLs.  
+0000cb70: 2020 286c 6163 6b69 6e67 2061 2073 6368    (lacking a sch
+0000cb80: 656d 6520 7375 6368 2061 7320 2768 7474  eme such as 'htt
+0000cb90: 7027 2920 7769 6c6c 2062 6520 7265 6a65  p') will be reje
+0000cba0: 6374 6564 2e0a 0a20 2020 2054 6865 2064  cted...    The d
+0000cbb0: 6566 6175 6c74 2070 7265 7065 6e64 6564  efault prepended
+0000cbc0: 2073 6368 656d 6520 6973 2063 7573 746f   scheme is custo
+0000cbd0: 6d69 7a61 626c 6520 7769 7468 2074 6865  mizable with the
+0000cbe0: 2070 7265 7065 6e64 5f73 6368 656d 650a   prepend_scheme.
+0000cbf0: 2020 2020 7061 7261 6d65 7465 722e 2049      parameter. I
+0000cc00: 6620 796f 7520 7365 7420 7072 6570 656e  f you set prepen
+0000cc10: 645f 7363 6865 6d65 2074 6f20 4e6f 6e65  d_scheme to None
+0000cc20: 2074 6865 6e20 7072 6570 656e 6469 6e67   then prepending
+0000cc30: 2077 696c 6c20 6265 0a20 2020 2064 6973   will be.    dis
+0000cc40: 6162 6c65 642e 2055 524c 7320 7468 6174  abled. URLs that
+0000cc50: 2072 6571 7569 7265 2070 7265 7065 6e64   require prepend
+0000cc60: 696e 6720 746f 2070 6172 7365 2077 696c  ing to parse wil
+0000cc70: 6c20 7374 696c 6c20 6265 2061 6363 6570  l still be accep
+0000cc80: 7465 642c 0a20 2020 2062 7574 2074 6865  ted,.    but the
+0000cc90: 2072 6574 7572 6e20 7661 6c75 6520 7769   return value wi
+0000cca0: 6c6c 206e 6f74 2062 6520 6d6f 6469 6669  ll not be modifi
+0000ccb0: 6564 2e0a 0a20 2020 2040 6175 7468 6f72  ed...    @author
+0000ccc0: 3a20 4a6f 6e61 7468 616e 2042 656e 6e0a  : Jonathan Benn.
+0000ccd0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+0000cce0: 4745 4e45 5249 435f 5552 4c28 2928 2768  GENERIC_URL()('h
+0000ccf0: 7474 703a 2f2f 7573 6572 4061 6263 2e63  ttp://user@abc.c
+0000cd00: 6f6d 2729 0a20 2020 2020 2020 2028 2768  om').        ('h
+0000cd10: 7474 703a 2f2f 7573 6572 4061 6263 2e63  ttp://user@abc.c
+0000cd20: 6f6d 272c 204e 6f6e 6529 0a0a 2020 2020  om', None)..    
+0000cd30: 4172 6773 3a0a 2020 2020 2020 2020 6572  Args:.        er
+0000cd40: 726f 725f 6d65 7373 6167 653a 2061 2073  ror_message: a s
+0000cd50: 7472 696e 672c 2074 6865 2065 7272 6f72  tring, the error
+0000cd60: 206d 6573 7361 6765 2074 6f20 6769 7665   message to give
+0000cd70: 2074 6865 2065 6e64 2075 7365 720a 2020   the end user.  
+0000cd80: 2020 2020 2020 2020 2020 6966 2074 6865            if the
+0000cd90: 2055 524c 2064 6f65 7320 6e6f 7420 7661   URL does not va
+0000cda0: 6c69 6461 7465 0a20 2020 2020 2020 2061  lidate.        a
+0000cdb0: 6c6c 6f77 6564 5f73 6368 656d 6573 3a20  llowed_schemes: 
+0000cdc0: 6120 6c69 7374 2063 6f6e 7461 696e 696e  a list containin
+0000cdd0: 6720 7374 7269 6e67 7320 6f72 204e 6f6e  g strings or Non
+0000cde0: 652e 2045 6163 6820 656c 656d 656e 740a  e. Each element.
+0000cdf0: 2020 2020 2020 2020 2020 2020 6973 2061              is a
+0000ce00: 2073 6368 656d 6520 7468 6520 696e 7075   scheme the inpu
+0000ce10: 7474 6564 2055 524c 2069 7320 616c 6c6f  tted URL is allo
+0000ce20: 7765 6420 746f 2075 7365 0a20 2020 2020  wed to use.     
+0000ce30: 2020 2070 7265 7065 6e64 5f73 6368 656d     prepend_schem
+0000ce40: 653a 2061 2073 7472 696e 672c 2074 6869  e: a string, thi
+0000ce50: 7320 7363 6865 6d65 2069 7320 7072 6570  s scheme is prep
+0000ce60: 656e 6465 6420 6966 2069 7427 730a 2020  ended if it's.  
+0000ce70: 2020 2020 2020 2020 2020 6e65 6365 7373            necess
+0000ce80: 6172 7920 746f 206d 616b 6520 7468 6520  ary to make the 
+0000ce90: 5552 4c20 7661 6c69 640a 0a20 2020 2022  URL valid..    "
+0000cea0: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
+0000ceb0: 6974 5f5f 280a 2020 2020 2020 2020 7365  it__(.        se
+0000cec0: 6c66 2c0a 2020 2020 2020 2020 6572 726f  lf,.        erro
+0000ced0: 725f 6d65 7373 6167 653d 2245 6e74 6572  r_message="Enter
+0000cee0: 2061 2076 616c 6964 2055 524c 222c 0a20   a valid URL",. 
+0000cef0: 2020 2020 2020 2061 6c6c 6f77 6564 5f73         allowed_s
+0000cf00: 6368 656d 6573 3d4e 6f6e 652c 0a20 2020  chemes=None,.   
+0000cf10: 2020 2020 2070 7265 7065 6e64 5f73 6368       prepend_sch
+0000cf20: 656d 653d 4e6f 6e65 2c0a 2020 2020 293a  eme=None,.    ):
+0000cf30: 0a0a 2020 2020 2020 2020 7365 6c66 2e65  ..        self.e
+0000cf40: 7272 6f72 5f6d 6573 7361 6765 203d 2065  rror_message = e
+0000cf50: 7272 6f72 5f6d 6573 7361 6765 0a20 2020  rror_message.   
+0000cf60: 2020 2020 2069 6620 616c 6c6f 7765 645f       if allowed_
+0000cf70: 7363 6865 6d65 7320 6973 204e 6f6e 653a  schemes is None:
+0000cf80: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000cf90: 662e 616c 6c6f 7765 645f 7363 6865 6d65  f.allowed_scheme
+0000cfa0: 7320 3d20 616c 6c5f 7572 6c5f 7363 6865  s = all_url_sche
+0000cfb0: 6d65 730a 2020 2020 2020 2020 656c 7365  mes.        else
+0000cfc0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0000cfd0: 6c66 2e61 6c6c 6f77 6564 5f73 6368 656d  lf.allowed_schem
+0000cfe0: 6573 203d 2061 6c6c 6f77 6564 5f73 6368  es = allowed_sch
+0000cff0: 656d 6573 0a20 2020 2020 2020 2073 656c  emes.        sel
+0000d000: 662e 7072 6570 656e 645f 7363 6865 6d65  f.prepend_scheme
+0000d010: 203d 2070 7265 7065 6e64 5f73 6368 656d   = prepend_schem
+0000d020: 650a 2020 2020 2020 2020 6966 2073 656c  e.        if sel
+0000d030: 662e 7072 6570 656e 645f 7363 6865 6d65  f.prepend_scheme
+0000d040: 206e 6f74 2069 6e20 7365 6c66 2e61 6c6c   not in self.all
+0000d050: 6f77 6564 5f73 6368 656d 6573 3a0a 2020  owed_schemes:.  
+0000d060: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000d070: 5379 6e74 6178 4572 726f 7228 0a20 2020  SyntaxError(.   
+0000d080: 2020 2020 2020 2020 2020 2020 2022 7072               "pr
+0000d090: 6570 656e 645f 7363 6865 6d65 3d27 2573  epend_scheme='%s
+0000d0a0: 2720 6973 206e 6f74 2069 6e20 616c 6c6f  ' is not in allo
+0000d0b0: 7765 645f 7363 6865 6d65 733d 2573 220a  wed_schemes=%s".
+0000d0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d0d0: 2520 2873 656c 662e 7072 6570 656e 645f  % (self.prepend_
+0000d0e0: 7363 6865 6d65 2c20 7365 6c66 2e61 6c6c  scheme, self.all
+0000d0f0: 6f77 6564 5f73 6368 656d 6573 290a 2020  owed_schemes).  
+0000d100: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000d110: 2052 4547 4558 5f47 454e 4552 4943 5f55   REGEX_GENERIC_U
+0000d120: 524c 203d 2072 2225 5b5e 302d 3941 2d46  RL = r"%[^0-9A-F
+0000d130: 612d 665d 7b32 7d7c 255b 5e30 2d39 412d  a-f]{2}|%[^0-9A-
+0000d140: 4661 2d66 5d5b 302d 3941 2d46 612d 665d  Fa-f][0-9A-Fa-f]
+0000d150: 7c25 5b30 2d39 412d 4661 2d66 5d5b 5e30  |%[0-9A-Fa-f][^0
+0000d160: 2d39 412d 4661 2d66 5d7c 2524 7c25 5b30  -9A-Fa-f]|%$|%[0
+0000d170: 2d39 412d 4661 2d66 5d24 7c25 5b5e 302d  -9A-Fa-f]$|%[^0-
+0000d180: 3941 2d46 612d 665d 2422 0a20 2020 2052  9A-Fa-f]$".    R
+0000d190: 4547 4558 5f47 454e 4552 4943 5f55 524c  EGEX_GENERIC_URL
+0000d1a0: 5f56 414c 4944 203d 2072 225b 412d 5a61  _VALID = r"[A-Za
+0000d1b0: 2d7a 302d 393b 2f3f 3a40 263d 2b24 2c5c  -z0-9;/?:@&=+$,\
+0000d1c0: 2d5f 5c2e 217e 2a27 5c28 5c29 255d 2b24  -_\.!~*'\(\)%]+$
+0000d1d0: 220a 2020 2020 5245 4745 585f 5552 4c5f  ".    REGEX_URL_
+0000d1e0: 4652 4147 4d45 4e54 5f56 414c 4944 203d  FRAGMENT_VALID =
+0000d1f0: 2072 225b 7c41 2d5a 612d 7a30 2d39 3b2f   r"[|A-Za-z0-9;/
+0000d200: 3f3a 4026 3d2b 242c 5c2d 5f5c 2e21 7e2a  ?:@&=+$,\-_\.!~*
+0000d210: 275c 285c 2925 5d2b 2422 0a0a 2020 2020  '\(\)%]+$"..    
+0000d220: 6465 6620 7661 6c69 6461 7465 2873 656c  def validate(sel
+0000d230: 662c 2076 616c 7565 2c20 7265 636f 7264  f, value, record
+0000d240: 5f69 643d 4e6f 6e65 293a 0a20 2020 2020  _id=None):.     
+0000d250: 2020 2022 2222 0a20 2020 2020 2020 2041     """.        A
+0000d260: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+0000d270: 2076 616c 7565 3a20 6120 7374 7269 6e67   value: a string
+0000d280: 2c20 7468 6520 5552 4c20 746f 2076 616c  , the URL to val
+0000d290: 6964 6174 650a 0a20 2020 2020 2020 2052  idate..        R
+0000d2a0: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+0000d2b0: 2020 2020 6120 7475 706c 652c 2077 6865      a tuple, whe
+0000d2c0: 7265 2074 7570 6c65 5b30 5d20 6973 2074  re tuple[0] is t
+0000d2d0: 6865 2069 6e70 7574 7465 6420 7661 6c75  he inputted valu
+0000d2e0: 6520 2870 6f73 7369 626c 650a 2020 2020  e (possible.    
+0000d2f0: 2020 2020 2020 2020 7072 6570 656e 6465          prepende
+0000d300: 6420 7769 7468 2070 7265 7065 6e64 5f73  d with prepend_s
+0000d310: 6368 656d 6529 2c20 616e 6420 7475 706c  cheme), and tupl
+0000d320: 655b 315d 2069 7320 6569 7468 6572 0a20  e[1] is either. 
+0000d330: 2020 2020 2020 2020 2020 204e 6f6e 6520             None 
+0000d340: 2873 7563 6365 7373 2129 206f 7220 7468  (success!) or th
+0000d350: 6520 7374 7269 6e67 2065 7272 6f72 5f6d  e string error_m
+0000d360: 6573 7361 6765 0a20 2020 2020 2020 2022  essage.        "
+0000d370: 2222 0a0a 2020 2020 2020 2020 2320 6966  ""..        # if
+0000d380: 2077 6520 646f 6e74 2068 6176 6520 616e   we dont have an
+0000d390: 7974 6869 6e67 206f 7220 7468 6520 5552  ything or the UR
+0000d3a0: 4c20 6d69 7375 7365 7320 7468 6520 2725  L misuses the '%
+0000d3b0: 2720 6368 6172 6163 7465 720a 0a20 2020  ' character..   
+0000d3c0: 2020 2020 2069 6620 6e6f 7420 7661 6c75       if not valu
+0000d3d0: 6520 6f72 2072 652e 7365 6172 6368 2873  e or re.search(s
+0000d3e0: 656c 662e 5245 4745 585f 4745 4e45 5249  elf.REGEX_GENERI
+0000d3f0: 435f 5552 4c2c 2076 616c 7565 293a 0a20  C_URL, value):. 
+0000d400: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000d410: 2056 616c 6964 6174 696f 6e45 7272 6f72   ValidationError
+0000d420: 2873 656c 662e 7472 616e 736c 6174 6f72  (self.translator
+0000d430: 2873 656c 662e 6572 726f 725f 6d65 7373  (self.error_mess
+0000d440: 6167 6529 290a 0a20 2020 2020 2020 2069  age))..        i
+0000d450: 6620 2223 2220 696e 2076 616c 7565 3a0a  f "#" in value:.
+0000d460: 2020 2020 2020 2020 2020 2020 7572 6c2c              url,
+0000d470: 2066 7261 676d 656e 745f 7061 7274 203d   fragment_part =
+0000d480: 2076 616c 7565 2e73 706c 6974 2822 2322   value.split("#"
+0000d490: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+0000d4a0: 2020 2020 2020 2020 2020 2020 7572 6c2c              url,
+0000d4b0: 2066 7261 676d 656e 745f 7061 7274 203d   fragment_part =
+0000d4c0: 2076 616c 7565 2c20 2222 0a20 2020 2020   value, "".     
+0000d4d0: 2020 2023 2069 6620 7468 6520 5552 4c20     # if the URL 
+0000d4e0: 6973 206f 6e6c 7920 636f 6d70 6f73 6564  is only composed
+0000d4f0: 206f 6620 7661 6c69 6420 6368 6172 6163   of valid charac
+0000d500: 7465 7273 0a20 2020 2020 2020 2069 6620  ters.        if 
+0000d510: 6e6f 7420 7265 2e6d 6174 6368 2873 656c  not re.match(sel
+0000d520: 662e 5245 4745 585f 4745 4e45 5249 435f  f.REGEX_GENERIC_
+0000d530: 5552 4c5f 5641 4c49 442c 2075 726c 2920  URL_VALID, url) 
+0000d540: 6f72 2028 0a20 2020 2020 2020 2020 2020  or (.           
+0000d550: 2066 7261 676d 656e 745f 7061 7274 2061   fragment_part a
+0000d560: 6e64 206e 6f74 2072 652e 6d61 7463 6828  nd not re.match(
+0000d570: 7365 6c66 2e52 4547 4558 5f55 524c 5f46  self.REGEX_URL_F
+0000d580: 5241 474d 454e 545f 5641 4c49 442c 2066  RAGMENT_VALID, f
+0000d590: 7261 676d 656e 745f 7061 7274 290a 2020  ragment_part).  
+0000d5a0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+0000d5b0: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
+0000d5c0: 6174 696f 6e45 7272 6f72 2873 656c 662e  ationError(self.
+0000d5d0: 7472 616e 736c 6174 6f72 2873 656c 662e  translator(self.
+0000d5e0: 6572 726f 725f 6d65 7373 6167 6529 290a  error_message)).
+0000d5f0: 2020 2020 2020 2020 2320 5468 656e 2070          # Then p
+0000d600: 6172 7365 2074 6865 2055 524c 2069 6e74  arse the URL int
+0000d610: 6f20 6974 7320 636f 6d70 6f6e 656e 7473  o its components
+0000d620: 2061 6e64 2063 6865 636b 206f 6e0a 2020   and check on.  
+0000d630: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+0000d640: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
+0000d650: 7320 3d20 7572 6c70 6172 7365 2e75 726c  s = urlparse.url
+0000d660: 7061 7273 6528 7572 6c6c 6962 5f75 6e71  parse(urllib_unq
+0000d670: 756f 7465 2876 616c 7565 2929 2e5f 6173  uote(value))._as
+0000d680: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
+0000d690: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
+0000d6a0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000d6b0: 6973 6520 5661 6c69 6461 7469 6f6e 4572  ise ValidationEr
+0000d6c0: 726f 7228 7365 6c66 2e74 7261 6e73 6c61  ror(self.transla
+0000d6d0: 746f 7228 7365 6c66 2e65 7272 6f72 5f6d  tor(self.error_m
+0000d6e0: 6573 7361 6765 2929 0a0a 2020 2020 2020  essage))..      
+0000d6f0: 2020 2320 436c 6561 6e20 7570 2074 6865    # Clean up the
+0000d700: 2073 6368 656d 6520 6265 666f 7265 2077   scheme before w
+0000d710: 6520 6368 6563 6b20 6974 0a20 2020 2020  e check it.     
+0000d720: 2020 2073 6368 656d 6520 3d20 636f 6d70     scheme = comp
+0000d730: 6f6e 656e 7473 5b22 7363 6865 6d65 225d  onents["scheme"]
+0000d740: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0000d750: 7363 6865 6d65 2920 3d3d 2030 3a0a 2020  scheme) == 0:.  
+0000d760: 2020 2020 2020 2020 2020 7363 6865 6d65            scheme
+0000d770: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+0000d780: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000d790: 2020 7363 6865 6d65 203d 2063 6f6d 706f    scheme = compo
+0000d7a0: 6e65 6e74 735b 2273 6368 656d 6522 5d2e  nents["scheme"].
+0000d7b0: 6c6f 7765 7228 290a 2020 2020 2020 2020  lower().        
+0000d7c0: 2320 4966 2074 6865 2073 6368 656d 6520  # If the scheme 
+0000d7d0: 646f 6573 6e27 7420 7265 616c 6c79 2065  doesn't really e
+0000d7e0: 7869 7374 730a 2020 2020 2020 2020 6966  xists.        if
+0000d7f0: 2028 0a20 2020 2020 2020 2020 2020 2073   (.            s
+0000d800: 6368 656d 6520 6e6f 7420 696e 2073 656c  cheme not in sel
+0000d810: 662e 616c 6c6f 7765 645f 7363 6865 6d65  f.allowed_scheme
+0000d820: 730a 2020 2020 2020 2020 2020 2020 6f72  s.            or
+0000d830: 206e 6f74 2073 6368 656d 650a 2020 2020   not scheme.    
+0000d840: 2020 2020 2020 2020 616e 6420 223a 2220          and ":" 
+0000d850: 696e 2063 6f6d 706f 6e65 6e74 735b 2270  in components["p
+0000d860: 6174 6822 5d0a 2020 2020 2020 2020 293a  ath"].        ):
+0000d870: 0a20 2020 2020 2020 2020 2020 2023 2066  .            # f
+0000d880: 6f72 2074 6865 2070 6f73 7369 626c 6520  or the possible 
+0000d890: 6361 7365 206f 6620 6162 6272 6576 6961  case of abbrevia
+0000d8a0: 7465 6420 5552 4c73 2077 6974 680a 2020  ted URLs with.  
+0000d8b0: 2020 2020 2020 2020 2020 2320 706f 7274            # port
+0000d8c0: 732c 2063 6865 636b 2074 6f20 7365 6520  s, check to see 
+0000d8d0: 6966 2061 6464 696e 6720 6120 7661 6c69  if adding a vali
+0000d8e0: 6420 7363 6865 6d65 2066 6978 6573 0a20  d scheme fixes. 
+0000d8f0: 2020 2020 2020 2020 2020 2023 2074 6865             # the
+0000d900: 2070 726f 626c 656d 2028 6275 7420 6f6e   problem (but on
+0000d910: 6c79 2064 6f20 7468 6973 2069 6620 6974  ly do this if it
+0000d920: 2064 6f65 736e 2774 2068 6176 650a 2020   doesn't have.  
+0000d930: 2020 2020 2020 2020 2020 2320 6f6e 6520            # one 
+0000d940: 616c 7265 6164 7921 290a 2020 2020 2020  already!).      
+0000d950: 2020 2020 2020 6966 2022 3a2f 2f22 206e        if "://" n
+0000d960: 6f74 2069 6e20 7661 6c75 6520 616e 6420  ot in value and 
+0000d970: 4e6f 6e65 2069 6e20 7365 6c66 2e61 6c6c  None in self.all
+0000d980: 6f77 6564 5f73 6368 656d 6573 3a0a 2020  owed_schemes:.  
+0000d990: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+0000d9a0: 6865 6d65 546f 5573 6520 3d20 7365 6c66  hemeToUse = self
+0000d9b0: 2e70 7265 7065 6e64 5f73 6368 656d 6520  .prepend_scheme 
+0000d9c0: 6f72 2022 6874 7470 220a 2020 2020 2020  or "http".      
+0000d9d0: 2020 2020 2020 2020 2020 6e65 775f 7661            new_va
+0000d9e0: 6c75 6520 3d20 7365 6c66 2e76 616c 6964  lue = self.valid
+0000d9f0: 6174 6528 7363 6865 6d65 546f 5573 6520  ate(schemeToUse 
+0000da00: 2b20 223a 2f2f 2220 2b20 7661 6c75 6529  + "://" + value)
+0000da10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000da20: 2072 6574 7572 6e20 6e65 775f 7661 6c75   return new_valu
+0000da30: 6520 6966 2073 656c 662e 7072 6570 656e  e if self.prepen
+0000da40: 645f 7363 6865 6d65 2065 6c73 6520 7661  d_scheme else va
+0000da50: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
+0000da60: 7261 6973 6520 5661 6c69 6461 7469 6f6e  raise Validation
+0000da70: 4572 726f 7228 7365 6c66 2e74 7261 6e73  Error(self.trans
+0000da80: 6c61 746f 7228 7365 6c66 2e65 7272 6f72  lator(self.error
+0000da90: 5f6d 6573 7361 6765 2929 0a20 2020 2020  _message)).     
+0000daa0: 2020 2072 6574 7572 6e20 7661 6c75 650a     return value.
+0000dab0: 0a0a 2320 536f 7572 6365 7320 286f 6274  ..# Sources (obt
+0000dac0: 6169 6e65 6420 3230 3137 2d4e 6f76 2d31  ained 2017-Nov-1
+0000dad0: 3129 3a0a 2320 2020 2068 7474 703a 2f2f  1):.#    http://
+0000dae0: 6461 7461 2e69 616e 612e 6f72 672f 544c  data.iana.org/TL
+0000daf0: 442f 746c 6473 2d61 6c70 6861 2d62 792d  D/tlds-alpha-by-
+0000db00: 646f 6d61 696e 2e74 7874 0a23 2073 6565  domain.txt.# see
+0000db10: 2073 6372 6970 7473 2f70 6172 7365 5f74   scripts/parse_t
+0000db20: 6f70 5f6c 6576 656c 5f64 6f6d 6169 6e73  op_level_domains
+0000db30: 2e70 7920 666f 7220 616e 2065 6173 7920  .py for an easy 
+0000db40: 7570 6461 7465 0a0a 6f66 6669 6369 616c  update..official
+0000db50: 5f74 6f70 5f6c 6576 656c 5f64 6f6d 6169  _top_level_domai
+0000db60: 6e73 203d 205b 0a20 2020 2023 2061 0a20  ns = [.    # a. 
+0000db70: 2020 2022 6161 6122 2c0a 2020 2020 2261     "aaa",.    "a
+0000db80: 6172 7022 2c0a 2020 2020 2261 6261 7274  arp",.    "abart
+0000db90: 6822 2c0a 2020 2020 2261 6262 222c 0a20  h",.    "abb",. 
+0000dba0: 2020 2022 6162 626f 7474 222c 0a20 2020     "abbott",.   
+0000dbb0: 2022 6162 6276 6965 222c 0a20 2020 2022   "abbvie",.    "
+0000dbc0: 6162 6322 2c0a 2020 2020 2261 626c 6522  abc",.    "able"
+0000dbd0: 2c0a 2020 2020 2261 626f 6761 646f 222c  ,.    "abogado",
+0000dbe0: 0a20 2020 2022 6162 7564 6861 6269 222c  .    "abudhabi",
+0000dbf0: 0a20 2020 2022 6163 222c 0a20 2020 2022  .    "ac",.    "
+0000dc00: 6163 6164 656d 7922 2c0a 2020 2020 2261  academy",.    "a
+0000dc10: 6363 656e 7475 7265 222c 0a20 2020 2022  ccenture",.    "
+0000dc20: 6163 636f 756e 7461 6e74 222c 0a20 2020  accountant",.   
+0000dc30: 2022 6163 636f 756e 7461 6e74 7322 2c0a   "accountants",.
+0000dc40: 2020 2020 2261 636f 222c 0a20 2020 2022      "aco",.    "
+0000dc50: 6163 7469 7665 222c 0a20 2020 2022 6163  active",.    "ac
+0000dc60: 746f 7222 2c0a 2020 2020 2261 6422 2c0a  tor",.    "ad",.
+0000dc70: 2020 2020 2261 6461 6322 2c0a 2020 2020      "adac",.    
+0000dc80: 2261 6473 222c 0a20 2020 2022 6164 756c  "ads",.    "adul
+0000dc90: 7422 2c0a 2020 2020 2261 6522 2c0a 2020  t",.    "ae",.  
+0000dca0: 2020 2261 6567 222c 0a20 2020 2022 6165    "aeg",.    "ae
+0000dcb0: 726f 222c 0a20 2020 2022 6165 746e 6122  ro",.    "aetna"
+0000dcc0: 2c0a 2020 2020 2261 6622 2c0a 2020 2020  ,.    "af",.    
+0000dcd0: 2261 6661 6d69 6c79 636f 6d70 616e 7922  "afamilycompany"
+0000dce0: 2c0a 2020 2020 2261 666c 222c 0a20 2020  ,.    "afl",.   
+0000dcf0: 2022 6166 7269 6361 222c 0a20 2020 2022   "africa",.    "
+0000dd00: 6167 222c 0a20 2020 2022 6167 616b 6861  ag",.    "agakha
+0000dd10: 6e22 2c0a 2020 2020 2261 6765 6e63 7922  n",.    "agency"
+0000dd20: 2c0a 2020 2020 2261 6922 2c0a 2020 2020  ,.    "ai",.    
+0000dd30: 2261 6967 222c 0a20 2020 2022 6169 676f  "aig",.    "aigo
+0000dd40: 222c 0a20 2020 2022 6169 7262 7573 222c  ",.    "airbus",
+0000dd50: 0a20 2020 2022 6169 7266 6f72 6365 222c  .    "airforce",
+0000dd60: 0a20 2020 2022 6169 7274 656c 222c 0a20  .    "airtel",. 
+0000dd70: 2020 2022 616b 646e 222c 0a20 2020 2022     "akdn",.    "
+0000dd80: 616c 222c 0a20 2020 2022 616c 6661 726f  al",.    "alfaro
+0000dd90: 6d65 6f22 2c0a 2020 2020 2261 6c69 6261  meo",.    "aliba
+0000dda0: 6261 222c 0a20 2020 2022 616c 6970 6179  ba",.    "alipay
+0000ddb0: 222c 0a20 2020 2022 616c 6c66 696e 616e  ",.    "allfinan
+0000ddc0: 7a22 2c0a 2020 2020 2261 6c6c 7374 6174  z",.    "allstat
+0000ddd0: 6522 2c0a 2020 2020 2261 6c6c 7922 2c0a  e",.    "ally",.
+0000dde0: 2020 2020 2261 6c73 6163 6522 2c0a 2020      "alsace",.  
+0000ddf0: 2020 2261 6c73 746f 6d22 2c0a 2020 2020    "alstom",.    
+0000de00: 2261 6d22 2c0a 2020 2020 2261 6d65 7269  "am",.    "ameri
+0000de10: 6361 6e65 7870 7265 7373 222c 0a20 2020  canexpress",.   
+0000de20: 2022 616d 6572 6963 616e 6661 6d69 6c79   "americanfamily
+0000de30: 222c 0a20 2020 2022 616d 6578 222c 0a20  ",.    "amex",. 
+0000de40: 2020 2022 616d 6661 6d22 2c0a 2020 2020     "amfam",.    
+0000de50: 2261 6d69 6361 222c 0a20 2020 2022 616d  "amica",.    "am
+0000de60: 7374 6572 6461 6d22 2c0a 2020 2020 2261  sterdam",.    "a
+0000de70: 6e61 6c79 7469 6373 222c 0a20 2020 2022  nalytics",.    "
+0000de80: 616e 6472 6f69 6422 2c0a 2020 2020 2261  android",.    "a
+0000de90: 6e71 7561 6e22 2c0a 2020 2020 2261 6e7a  nquan",.    "anz
+0000dea0: 222c 0a20 2020 2022 616f 222c 0a20 2020  ",.    "ao",.   
+0000deb0: 2022 616f 6c22 2c0a 2020 2020 2261 7061   "aol",.    "apa
+0000dec0: 7274 6d65 6e74 7322 2c0a 2020 2020 2261  rtments",.    "a
+0000ded0: 7070 222c 0a20 2020 2022 6170 706c 6522  pp",.    "apple"
+0000dee0: 2c0a 2020 2020 2261 7122 2c0a 2020 2020  ,.    "aq",.    
+0000def0: 2261 7175 6172 656c 6c65 222c 0a20 2020  "aquarelle",.   
+0000df00: 2022 6172 222c 0a20 2020 2022 6172 6162   "ar",.    "arab
+0000df10: 222c 0a20 2020 2022 6172 616d 636f 222c  ",.    "aramco",
+0000df20: 0a20 2020 2022 6172 6368 6922 2c0a 2020  .    "archi",.  
+0000df30: 2020 2261 726d 7922 2c0a 2020 2020 2261    "army",.    "a
+0000df40: 7270 6122 2c0a 2020 2020 2261 7274 222c  rpa",.    "art",
+0000df50: 0a20 2020 2022 6172 7465 222c 0a20 2020  .    "arte",.   
+0000df60: 2022 6173 222c 0a20 2020 2022 6173 6461   "as",.    "asda
+0000df70: 222c 0a20 2020 2022 6173 6961 222c 0a20  ",.    "asia",. 
+0000df80: 2020 2022 6173 736f 6369 6174 6573 222c     "associates",
+0000df90: 0a20 2020 2022 6174 222c 0a20 2020 2022  .    "at",.    "
+0000dfa0: 6174 686c 6574 6122 2c0a 2020 2020 2261  athleta",.    "a
+0000dfb0: 7474 6f72 6e65 7922 2c0a 2020 2020 2261  ttorney",.    "a
+0000dfc0: 7522 2c0a 2020 2020 2261 7563 7469 6f6e  u",.    "auction
+0000dfd0: 222c 0a20 2020 2022 6175 6469 222c 0a20  ",.    "audi",. 
+0000dfe0: 2020 2022 6175 6469 626c 6522 2c0a 2020     "audible",.  
+0000dff0: 2020 2261 7564 696f 222c 0a20 2020 2022    "audio",.    "
+0000e000: 6175 7370 6f73 7422 2c0a 2020 2020 2261  auspost",.    "a
+0000e010: 7574 686f 7222 2c0a 2020 2020 2261 7574  uthor",.    "aut
+0000e020: 6f22 2c0a 2020 2020 2261 7574 6f73 222c  o",.    "autos",
+0000e030: 0a20 2020 2022 6176 6961 6e63 6122 2c0a  .    "avianca",.
+0000e040: 2020 2020 2261 7722 2c0a 2020 2020 2261      "aw",.    "a
+0000e050: 7773 222c 0a20 2020 2022 6178 222c 0a20  ws",.    "ax",. 
+0000e060: 2020 2022 6178 6122 2c0a 2020 2020 2261     "axa",.    "a
+0000e070: 7a22 2c0a 2020 2020 2261 7a75 7265 222c  z",.    "azure",
+0000e080: 0a20 2020 2023 2062 0a20 2020 2022 6261  .    # b.    "ba
+0000e090: 222c 0a20 2020 2022 6261 6279 222c 0a20  ",.    "baby",. 
+0000e0a0: 2020 2022 6261 6964 7522 2c0a 2020 2020     "baidu",.    
+0000e0b0: 2262 616e 616d 6578 222c 0a20 2020 2022  "banamex",.    "
+0000e0c0: 6261 6e61 6e61 7265 7075 626c 6963 222c  bananarepublic",
+0000e0d0: 0a20 2020 2022 6261 6e64 222c 0a20 2020  .    "band",.   
+0000e0e0: 2022 6261 6e6b 222c 0a20 2020 2022 6261   "bank",.    "ba
+0000e0f0: 7222 2c0a 2020 2020 2262 6172 6365 6c6f  r",.    "barcelo
+0000e100: 6e61 222c 0a20 2020 2022 6261 7263 6c61  na",.    "barcla
+0000e110: 7963 6172 6422 2c0a 2020 2020 2262 6172  ycard",.    "bar
+0000e120: 636c 6179 7322 2c0a 2020 2020 2262 6172  clays",.    "bar
+0000e130: 6566 6f6f 7422 2c0a 2020 2020 2262 6172  efoot",.    "bar
+0000e140: 6761 696e 7322 2c0a 2020 2020 2262 6173  gains",.    "bas
+0000e150: 6562 616c 6c22 2c0a 2020 2020 2262 6173  eball",.    "bas
+0000e160: 6b65 7462 616c 6c22 2c0a 2020 2020 2262  ketball",.    "b
+0000e170: 6175 6861 7573 222c 0a20 2020 2022 6261  auhaus",.    "ba
+0000e180: 7965 726e 222c 0a20 2020 2022 6262 222c  yern",.    "bb",
+0000e190: 0a20 2020 2022 6262 6322 2c0a 2020 2020  .    "bbc",.    
+0000e1a0: 2262 6274 222c 0a20 2020 2022 6262 7661  "bbt",.    "bbva
+0000e1b0: 222c 0a20 2020 2022 6263 6722 2c0a 2020  ",.    "bcg",.  
+0000e1c0: 2020 2262 636e 222c 0a20 2020 2022 6264    "bcn",.    "bd
+0000e1d0: 222c 0a20 2020 2022 6265 222c 0a20 2020  ",.    "be",.   
+0000e1e0: 2022 6265 6174 7322 2c0a 2020 2020 2262   "beats",.    "b
+0000e1f0: 6561 7574 7922 2c0a 2020 2020 2262 6565  eauty",.    "bee
+0000e200: 7222 2c0a 2020 2020 2262 656e 746c 6579  r",.    "bentley
+0000e210: 222c 0a20 2020 2022 6265 726c 696e 222c  ",.    "berlin",
+0000e220: 0a20 2020 2022 6265 7374 222c 0a20 2020  .    "best",.   
+0000e230: 2022 6265 7374 6275 7922 2c0a 2020 2020   "bestbuy",.    
+0000e240: 2262 6574 222c 0a20 2020 2022 6266 222c  "bet",.    "bf",
+0000e250: 0a20 2020 2022 6267 222c 0a20 2020 2022  .    "bg",.    "
+0000e260: 6268 222c 0a20 2020 2022 6268 6172 7469  bh",.    "bharti
+0000e270: 222c 0a20 2020 2022 6269 222c 0a20 2020  ",.    "bi",.   
+0000e280: 2022 6269 626c 6522 2c0a 2020 2020 2262   "bible",.    "b
+0000e290: 6964 222c 0a20 2020 2022 6269 6b65 222c  id",.    "bike",
+0000e2a0: 0a20 2020 2022 6269 6e67 222c 0a20 2020  .    "bing",.   
+0000e2b0: 2022 6269 6e67 6f22 2c0a 2020 2020 2262   "bingo",.    "b
+0000e2c0: 696f 222c 0a20 2020 2022 6269 7a22 2c0a  io",.    "biz",.
+0000e2d0: 2020 2020 2262 6a22 2c0a 2020 2020 2262      "bj",.    "b
+0000e2e0: 6c61 636b 222c 0a20 2020 2022 626c 6163  lack",.    "blac
+0000e2f0: 6b66 7269 6461 7922 2c0a 2020 2020 2262  kfriday",.    "b
+0000e300: 6c61 6e63 6f22 2c0a 2020 2020 2262 6c6f  lanco",.    "blo
+0000e310: 636b 6275 7374 6572 222c 0a20 2020 2022  ckbuster",.    "
+0000e320: 626c 6f67 222c 0a20 2020 2022 626c 6f6f  blog",.    "bloo
+0000e330: 6d62 6572 6722 2c0a 2020 2020 2262 6c75  mberg",.    "blu
+0000e340: 6522 2c0a 2020 2020 2262 6d22 2c0a 2020  e",.    "bm",.  
+0000e350: 2020 2262 6d73 222c 0a20 2020 2022 626d    "bms",.    "bm
+0000e360: 7722 2c0a 2020 2020 2262 6e22 2c0a 2020  w",.    "bn",.  
+0000e370: 2020 2262 6e6c 222c 0a20 2020 2022 626e    "bnl",.    "bn
+0000e380: 7070 6172 6962 6173 222c 0a20 2020 2022  pparibas",.    "
+0000e390: 626f 222c 0a20 2020 2022 626f 6174 7322  bo",.    "boats"
+0000e3a0: 2c0a 2020 2020 2262 6f65 6872 696e 6765  ,.    "boehringe
+0000e3b0: 7222 2c0a 2020 2020 2262 6f66 6122 2c0a  r",.    "bofa",.
+0000e3c0: 2020 2020 2262 6f6d 222c 0a20 2020 2022      "bom",.    "
+0000e3d0: 626f 6e64 222c 0a20 2020 2022 626f 6f22  bond",.    "boo"
+0000e3e0: 2c0a 2020 2020 2262 6f6f 6b22 2c0a 2020  ,.    "book",.  
+0000e3f0: 2020 2262 6f6f 6b69 6e67 222c 0a20 2020    "booking",.   
+0000e400: 2022 626f 6f74 7322 2c0a 2020 2020 2262   "boots",.    "b
+0000e410: 6f73 6368 222c 0a20 2020 2022 626f 7374  osch",.    "bost
+0000e420: 696b 222c 0a20 2020 2022 626f 7374 6f6e  ik",.    "boston
+0000e430: 222c 0a20 2020 2022 626f 7422 2c0a 2020  ",.    "bot",.  
+0000e440: 2020 2262 6f75 7469 7175 6522 2c0a 2020    "boutique",.  
+0000e450: 2020 2262 6f78 222c 0a20 2020 2022 6272    "box",.    "br
+0000e460: 222c 0a20 2020 2022 6272 6164 6573 636f  ",.    "bradesco
+0000e470: 222c 0a20 2020 2022 6272 6964 6765 7374  ",.    "bridgest
+0000e480: 6f6e 6522 2c0a 2020 2020 2262 726f 6164  one",.    "broad
+0000e490: 7761 7922 2c0a 2020 2020 2262 726f 6b65  way",.    "broke
+0000e4a0: 7222 2c0a 2020 2020 2262 726f 7468 6572  r",.    "brother
+0000e4b0: 222c 0a20 2020 2022 6272 7573 7365 6c73  ",.    "brussels
+0000e4c0: 222c 0a20 2020 2022 6273 222c 0a20 2020  ",.    "bs",.   
+0000e4d0: 2022 6274 222c 0a20 2020 2022 6275 6461   "bt",.    "buda
+0000e4e0: 7065 7374 222c 0a20 2020 2022 6275 6761  pest",.    "buga
+0000e4f0: 7474 6922 2c0a 2020 2020 2262 7569 6c64  tti",.    "build
+0000e500: 222c 0a20 2020 2022 6275 696c 6465 7273  ",.    "builders
+0000e510: 222c 0a20 2020 2022 6275 7369 6e65 7373  ",.    "business
+0000e520: 222c 0a20 2020 2022 6275 7922 2c0a 2020  ",.    "buy",.  
+0000e530: 2020 2262 757a 7a22 2c0a 2020 2020 2262    "buzz",.    "b
+0000e540: 7622 2c0a 2020 2020 2262 7722 2c0a 2020  v",.    "bw",.  
+0000e550: 2020 2262 7922 2c0a 2020 2020 2262 7a22    "by",.    "bz"
+0000e560: 2c0a 2020 2020 2262 7a68 222c 0a20 2020  ,.    "bzh",.   
+0000e570: 2023 2063 0a20 2020 2022 6361 222c 0a20   # c.    "ca",. 
+0000e580: 2020 2022 6361 6222 2c0a 2020 2020 2263     "cab",.    "c
+0000e590: 6166 6522 2c0a 2020 2020 2263 616c 222c  afe",.    "cal",
+0000e5a0: 0a20 2020 2022 6361 6c6c 222c 0a20 2020  .    "call",.   
+0000e5b0: 2022 6361 6c76 696e 6b6c 6569 6e22 2c0a   "calvinklein",.
+0000e5c0: 2020 2020 2263 616d 222c 0a20 2020 2022      "cam",.    "
+0000e5d0: 6361 6d65 7261 222c 0a20 2020 2022 6361  camera",.    "ca
+0000e5e0: 6d70 222c 0a20 2020 2022 6361 6e63 6572  mp",.    "cancer
+0000e5f0: 7265 7365 6172 6368 222c 0a20 2020 2022  research",.    "
+0000e600: 6361 6e6f 6e22 2c0a 2020 2020 2263 6170  canon",.    "cap
+0000e610: 6574 6f77 6e22 2c0a 2020 2020 2263 6170  etown",.    "cap
+0000e620: 6974 616c 222c 0a20 2020 2022 6361 7069  ital",.    "capi
+0000e630: 7461 6c6f 6e65 222c 0a20 2020 2022 6361  talone",.    "ca
+0000e640: 7222 2c0a 2020 2020 2263 6172 6176 616e  r",.    "caravan
+0000e650: 222c 0a20 2020 2022 6361 7264 7322 2c0a  ",.    "cards",.
+0000e660: 2020 2020 2263 6172 6522 2c0a 2020 2020      "care",.    
+0000e670: 2263 6172 6565 7222 2c0a 2020 2020 2263  "career",.    "c
+0000e680: 6172 6565 7273 222c 0a20 2020 2022 6361  areers",.    "ca
+0000e690: 7273 222c 0a20 2020 2022 6361 7274 6965  rs",.    "cartie
+0000e6a0: 7222 2c0a 2020 2020 2263 6173 6122 2c0a  r",.    "casa",.
+0000e6b0: 2020 2020 2263 6173 6522 2c0a 2020 2020      "case",.    
+0000e6c0: 2263 6173 6569 6822 2c0a 2020 2020 2263  "caseih",.    "c
+0000e6d0: 6173 6822 2c0a 2020 2020 2263 6173 696e  ash",.    "casin
+0000e6e0: 6f22 2c0a 2020 2020 2263 6174 222c 0a20  o",.    "cat",. 
+0000e6f0: 2020 2022 6361 7465 7269 6e67 222c 0a20     "catering",. 
+0000e700: 2020 2022 6361 7468 6f6c 6963 222c 0a20     "catholic",. 
+0000e710: 2020 2022 6362 6122 2c0a 2020 2020 2263     "cba",.    "c
+0000e720: 626e 222c 0a20 2020 2022 6362 7265 222c  bn",.    "cbre",
+0000e730: 0a20 2020 2022 6362 7322 2c0a 2020 2020  .    "cbs",.    
+0000e740: 2263 6322 2c0a 2020 2020 2263 6422 2c0a  "cc",.    "cd",.
+0000e750: 2020 2020 2263 6562 222c 0a20 2020 2022      "ceb",.    "
+0000e760: 6365 6e74 6572 222c 0a20 2020 2022 6365  center",.    "ce
+0000e770: 6f22 2c0a 2020 2020 2263 6572 6e22 2c0a  o",.    "cern",.
+0000e780: 2020 2020 2263 6622 2c0a 2020 2020 2263      "cf",.    "c
+0000e790: 6661 222c 0a20 2020 2022 6366 6422 2c0a  fa",.    "cfd",.
+0000e7a0: 2020 2020 2263 6722 2c0a 2020 2020 2263      "cg",.    "c
+0000e7b0: 6822 2c0a 2020 2020 2263 6861 6e65 6c22  h",.    "chanel"
+0000e7c0: 2c0a 2020 2020 2263 6861 6e6e 656c 222c  ,.    "channel",
+0000e7d0: 0a20 2020 2022 6368 6173 6522 2c0a 2020  .    "chase",.  
+0000e7e0: 2020 2263 6861 7422 2c0a 2020 2020 2263    "chat",.    "c
+0000e7f0: 6865 6170 222c 0a20 2020 2022 6368 696e  heap",.    "chin
+0000e800: 7461 6922 2c0a 2020 2020 2263 6872 6973  tai",.    "chris
+0000e810: 746d 6173 222c 0a20 2020 2022 6368 726f  tmas",.    "chro
+0000e820: 6d65 222c 0a20 2020 2022 6368 7279 736c  me",.    "chrysl
+0000e830: 6572 222c 0a20 2020 2022 6368 7572 6368  er",.    "church
+0000e840: 222c 0a20 2020 2022 6369 222c 0a20 2020  ",.    "ci",.   
+0000e850: 2022 6369 7072 6961 6e69 222c 0a20 2020   "cipriani",.   
+0000e860: 2022 6369 7263 6c65 222c 0a20 2020 2022   "circle",.    "
+0000e870: 6369 7363 6f22 2c0a 2020 2020 2263 6974  cisco",.    "cit
+0000e880: 6164 656c 222c 0a20 2020 2022 6369 7469  adel",.    "citi
+0000e890: 222c 0a20 2020 2022 6369 7469 6322 2c0a  ",.    "citic",.
+0000e8a0: 2020 2020 2263 6974 7922 2c0a 2020 2020      "city",.    
+0000e8b0: 2263 6974 7965 6174 7322 2c0a 2020 2020  "cityeats",.    
+0000e8c0: 2263 6b22 2c0a 2020 2020 2263 6c22 2c0a  "ck",.    "cl",.
+0000e8d0: 2020 2020 2263 6c61 696d 7322 2c0a 2020      "claims",.  
+0000e8e0: 2020 2263 6c65 616e 696e 6722 2c0a 2020    "cleaning",.  
+0000e8f0: 2020 2263 6c69 636b 222c 0a20 2020 2022    "click",.    "
+0000e900: 636c 696e 6963 222c 0a20 2020 2022 636c  clinic",.    "cl
+0000e910: 696e 6971 7565 222c 0a20 2020 2022 636c  inique",.    "cl
+0000e920: 6f74 6869 6e67 222c 0a20 2020 2022 636c  othing",.    "cl
+0000e930: 6f75 6422 2c0a 2020 2020 2263 6c75 6222  oud",.    "club"
+0000e940: 2c0a 2020 2020 2263 6c75 626d 6564 222c  ,.    "clubmed",
+0000e950: 0a20 2020 2022 636d 222c 0a20 2020 2022  .    "cm",.    "
+0000e960: 636e 222c 0a20 2020 2022 636f 222c 0a20  cn",.    "co",. 
+0000e970: 2020 2022 636f 6163 6822 2c0a 2020 2020     "coach",.    
+0000e980: 2263 6f64 6573 222c 0a20 2020 2022 636f  "codes",.    "co
+0000e990: 6666 6565 222c 0a20 2020 2022 636f 6c6c  ffee",.    "coll
+0000e9a0: 6567 6522 2c0a 2020 2020 2263 6f6c 6f67  ege",.    "colog
+0000e9b0: 6e65 222c 0a20 2020 2022 636f 6d22 2c0a  ne",.    "com",.
+0000e9c0: 2020 2020 2263 6f6d 6361 7374 222c 0a20      "comcast",. 
+0000e9d0: 2020 2022 636f 6d6d 6261 6e6b 222c 0a20     "commbank",. 
+0000e9e0: 2020 2022 636f 6d6d 756e 6974 7922 2c0a     "community",.
+0000e9f0: 2020 2020 2263 6f6d 7061 6e79 222c 0a20      "company",. 
+0000ea00: 2020 2022 636f 6d70 6172 6522 2c0a 2020     "compare",.  
+0000ea10: 2020 2263 6f6d 7075 7465 7222 2c0a 2020    "computer",.  
+0000ea20: 2020 2263 6f6d 7365 6322 2c0a 2020 2020    "comsec",.    
+0000ea30: 2263 6f6e 646f 7322 2c0a 2020 2020 2263  "condos",.    "c
+0000ea40: 6f6e 7374 7275 6374 696f 6e22 2c0a 2020  onstruction",.  
+0000ea50: 2020 2263 6f6e 7375 6c74 696e 6722 2c0a    "consulting",.
+0000ea60: 2020 2020 2263 6f6e 7461 6374 222c 0a20      "contact",. 
+0000ea70: 2020 2022 636f 6e74 7261 6374 6f72 7322     "contractors"
+0000ea80: 2c0a 2020 2020 2263 6f6f 6b69 6e67 222c  ,.    "cooking",
+0000ea90: 0a20 2020 2022 636f 6f6b 696e 6763 6861  .    "cookingcha
+0000eaa0: 6e6e 656c 222c 0a20 2020 2022 636f 6f6c  nnel",.    "cool
+0000eab0: 222c 0a20 2020 2022 636f 6f70 222c 0a20  ",.    "coop",. 
+0000eac0: 2020 2022 636f 7273 6963 6122 2c0a 2020     "corsica",.  
+0000ead0: 2020 2263 6f75 6e74 7279 222c 0a20 2020    "country",.   
+0000eae0: 2022 636f 7570 6f6e 222c 0a20 2020 2022   "coupon",.    "
+0000eaf0: 636f 7570 6f6e 7322 2c0a 2020 2020 2263  coupons",.    "c
+0000eb00: 6f75 7273 6573 222c 0a20 2020 2022 6372  ourses",.    "cr
+0000eb10: 222c 0a20 2020 2022 6372 6564 6974 222c  ",.    "credit",
+0000eb20: 0a20 2020 2022 6372 6564 6974 6361 7264  .    "creditcard
+0000eb30: 222c 0a20 2020 2022 6372 6564 6974 756e  ",.    "creditun
+0000eb40: 696f 6e22 2c0a 2020 2020 2263 7269 636b  ion",.    "crick
+0000eb50: 6574 222c 0a20 2020 2022 6372 6f77 6e22  et",.    "crown"
+0000eb60: 2c0a 2020 2020 2263 7273 222c 0a20 2020  ,.    "crs",.   
+0000eb70: 2022 6372 7569 7365 222c 0a20 2020 2022   "cruise",.    "
+0000eb80: 6372 7569 7365 7322 2c0a 2020 2020 2263  cruises",.    "c
+0000eb90: 7363 222c 0a20 2020 2022 6375 222c 0a20  sc",.    "cu",. 
+0000eba0: 2020 2022 6375 6973 696e 656c 6c61 222c     "cuisinella",
+0000ebb0: 0a20 2020 2022 6376 222c 0a20 2020 2022  .    "cv",.    "
+0000ebc0: 6377 222c 0a20 2020 2022 6378 222c 0a20  cw",.    "cx",. 
+0000ebd0: 2020 2022 6379 222c 0a20 2020 2022 6379     "cy",.    "cy
+0000ebe0: 6d72 7522 2c0a 2020 2020 2263 796f 7522  mru",.    "cyou"
+0000ebf0: 2c0a 2020 2020 2263 7a22 2c0a 2020 2020  ,.    "cz",.    
+0000ec00: 2320 640a 2020 2020 2264 6162 7572 222c  # d.    "dabur",
+0000ec10: 0a20 2020 2022 6461 6422 2c0a 2020 2020  .    "dad",.    
+0000ec20: 2264 616e 6365 222c 0a20 2020 2022 6461  "dance",.    "da
+0000ec30: 7461 222c 0a20 2020 2022 6461 7465 222c  ta",.    "date",
+0000ec40: 0a20 2020 2022 6461 7469 6e67 222c 0a20  .    "dating",. 
+0000ec50: 2020 2022 6461 7473 756e 222c 0a20 2020     "datsun",.   
+0000ec60: 2022 6461 7922 2c0a 2020 2020 2264 636c   "day",.    "dcl
+0000ec70: 6b22 2c0a 2020 2020 2264 6473 222c 0a20  k",.    "dds",. 
+0000ec80: 2020 2022 6465 222c 0a20 2020 2022 6465     "de",.    "de
+0000ec90: 616c 222c 0a20 2020 2022 6465 616c 6572  al",.    "dealer
+0000eca0: 222c 0a20 2020 2022 6465 616c 7322 2c0a  ",.    "deals",.
+0000ecb0: 2020 2020 2264 6567 7265 6522 2c0a 2020      "degree",.  
+0000ecc0: 2020 2264 656c 6976 6572 7922 2c0a 2020    "delivery",.  
+0000ecd0: 2020 2264 656c 6c22 2c0a 2020 2020 2264    "dell",.    "d
+0000ece0: 656c 6f69 7474 6522 2c0a 2020 2020 2264  eloitte",.    "d
+0000ecf0: 656c 7461 222c 0a20 2020 2022 6465 6d6f  elta",.    "demo
+0000ed00: 6372 6174 222c 0a20 2020 2022 6465 6e74  crat",.    "dent
+0000ed10: 616c 222c 0a20 2020 2022 6465 6e74 6973  al",.    "dentis
+0000ed20: 7422 2c0a 2020 2020 2264 6573 6922 2c0a  t",.    "desi",.
+0000ed30: 2020 2020 2264 6573 6967 6e22 2c0a 2020      "design",.  
+0000ed40: 2020 2264 6576 222c 0a20 2020 2022 6468    "dev",.    "dh
+0000ed50: 6c22 2c0a 2020 2020 2264 6961 6d6f 6e64  l",.    "diamond
+0000ed60: 7322 2c0a 2020 2020 2264 6965 7422 2c0a  s",.    "diet",.
+0000ed70: 2020 2020 2264 6967 6974 616c 222c 0a20      "digital",. 
+0000ed80: 2020 2022 6469 7265 6374 222c 0a20 2020     "direct",.   
+0000ed90: 2022 6469 7265 6374 6f72 7922 2c0a 2020   "directory",.  
+0000eda0: 2020 2264 6973 636f 756e 7422 2c0a 2020    "discount",.  
+0000edb0: 2020 2264 6973 636f 7665 7222 2c0a 2020    "discover",.  
+0000edc0: 2020 2264 6973 6822 2c0a 2020 2020 2264    "dish",.    "d
+0000edd0: 6979 222c 0a20 2020 2022 646a 222c 0a20  iy",.    "dj",. 
+0000ede0: 2020 2022 646b 222c 0a20 2020 2022 646d     "dk",.    "dm
+0000edf0: 222c 0a20 2020 2022 646e 7022 2c0a 2020  ",.    "dnp",.  
+0000ee00: 2020 2264 6f22 2c0a 2020 2020 2264 6f63    "do",.    "doc
+0000ee10: 7322 2c0a 2020 2020 2264 6f63 746f 7222  s",.    "doctor"
+0000ee20: 2c0a 2020 2020 2264 6f64 6765 222c 0a20  ,.    "dodge",. 
+0000ee30: 2020 2022 646f 6722 2c0a 2020 2020 2264     "dog",.    "d
+0000ee40: 6f68 6122 2c0a 2020 2020 2264 6f6d 6169  oha",.    "domai
+0000ee50: 6e73 222c 0a20 2020 2022 646f 7422 2c0a  ns",.    "dot",.
+0000ee60: 2020 2020 2264 6f77 6e6c 6f61 6422 2c0a      "download",.
+0000ee70: 2020 2020 2264 7269 7665 222c 0a20 2020      "drive",.   
+0000ee80: 2022 6474 7622 2c0a 2020 2020 2264 7562   "dtv",.    "dub
+0000ee90: 6169 222c 0a20 2020 2022 6475 636b 222c  ai",.    "duck",
+0000eea0: 0a20 2020 2022 6475 6e6c 6f70 222c 0a20  .    "dunlop",. 
+0000eeb0: 2020 2022 6475 6e73 222c 0a20 2020 2022     "duns",.    "
+0000eec0: 6475 706f 6e74 222c 0a20 2020 2022 6475  dupont",.    "du
+0000eed0: 7262 616e 222c 0a20 2020 2022 6476 6167  rban",.    "dvag
+0000eee0: 222c 0a20 2020 2022 6476 7222 2c0a 2020  ",.    "dvr",.  
+0000eef0: 2020 2264 7a22 2c0a 2020 2020 2320 650a    "dz",.    # e.
+0000ef00: 2020 2020 2265 6172 7468 222c 0a20 2020      "earth",.   
+0000ef10: 2022 6561 7422 2c0a 2020 2020 2265 6322   "eat",.    "ec"
+0000ef20: 2c0a 2020 2020 2265 636f 222c 0a20 2020  ,.    "eco",.   
+0000ef30: 2022 6564 656b 6122 2c0a 2020 2020 2265   "edeka",.    "e
+0000ef40: 6475 222c 0a20 2020 2022 6564 7563 6174  du",.    "educat
+0000ef50: 696f 6e22 2c0a 2020 2020 2265 6522 2c0a  ion",.    "ee",.
+0000ef60: 2020 2020 2265 6722 2c0a 2020 2020 2265      "eg",.    "e
+0000ef70: 6d61 696c 222c 0a20 2020 2022 656d 6572  mail",.    "emer
+0000ef80: 636b 222c 0a20 2020 2022 656e 6572 6779  ck",.    "energy
+0000ef90: 222c 0a20 2020 2022 656e 6769 6e65 6572  ",.    "engineer
+0000efa0: 222c 0a20 2020 2022 656e 6769 6e65 6572  ",.    "engineer
+0000efb0: 696e 6722 2c0a 2020 2020 2265 6e74 6572  ing",.    "enter
+0000efc0: 7072 6973 6573 222c 0a20 2020 2022 6570  prises",.    "ep
+0000efd0: 6f73 7422 2c0a 2020 2020 2265 7073 6f6e  ost",.    "epson
+0000efe0: 222c 0a20 2020 2022 6571 7569 706d 656e  ",.    "equipmen
+0000eff0: 7422 2c0a 2020 2020 2265 7222 2c0a 2020  t",.    "er",.  
+0000f000: 2020 2265 7269 6373 736f 6e22 2c0a 2020    "ericsson",.  
+0000f010: 2020 2265 726e 6922 2c0a 2020 2020 2265    "erni",.    "e
+0000f020: 7322 2c0a 2020 2020 2265 7371 222c 0a20  s",.    "esq",. 
+0000f030: 2020 2022 6573 7461 7465 222c 0a20 2020     "estate",.   
+0000f040: 2022 6573 7572 616e 6365 222c 0a20 2020   "esurance",.   
+0000f050: 2022 6574 222c 0a20 2020 2022 6574 6973   "et",.    "etis
+0000f060: 616c 6174 222c 0a20 2020 2022 6575 222c  alat",.    "eu",
+0000f070: 0a20 2020 2022 6575 726f 7669 7369 6f6e  .    "eurovision
+0000f080: 222c 0a20 2020 2022 6575 7322 2c0a 2020  ",.    "eus",.  
+0000f090: 2020 2265 7665 6e74 7322 2c0a 2020 2020    "events",.    
+0000f0a0: 2265 7665 7262 616e 6b22 2c0a 2020 2020  "everbank",.    
+0000f0b0: 2265 7863 6861 6e67 6522 2c0a 2020 2020  "exchange",.    
+0000f0c0: 2265 7870 6572 7422 2c0a 2020 2020 2265  "expert",.    "e
+0000f0d0: 7870 6f73 6564 222c 0a20 2020 2022 6578  xposed",.    "ex
+0000f0e0: 7072 6573 7322 2c0a 2020 2020 2265 7874  press",.    "ext
+0000f0f0: 7261 7370 6163 6522 2c0a 2020 2020 2320  raspace",.    # 
+0000f100: 660a 2020 2020 2266 6167 6522 2c0a 2020  f.    "fage",.  
+0000f110: 2020 2266 6169 6c22 2c0a 2020 2020 2266    "fail",.    "f
+0000f120: 6169 7277 696e 6473 222c 0a20 2020 2022  airwinds",.    "
+0000f130: 6661 6974 6822 2c0a 2020 2020 2266 616d  faith",.    "fam
+0000f140: 696c 7922 2c0a 2020 2020 2266 616e 222c  ily",.    "fan",
+0000f150: 0a20 2020 2022 6661 6e73 222c 0a20 2020  .    "fans",.   
+0000f160: 2022 6661 726d 222c 0a20 2020 2022 6661   "farm",.    "fa
+0000f170: 726d 6572 7322 2c0a 2020 2020 2266 6173  rmers",.    "fas
+0000f180: 6869 6f6e 222c 0a20 2020 2022 6661 7374  hion",.    "fast
+0000f190: 222c 0a20 2020 2022 6665 6465 7822 2c0a  ",.    "fedex",.
+0000f1a0: 2020 2020 2266 6565 6462 6163 6b22 2c0a      "feedback",.
+0000f1b0: 2020 2020 2266 6572 7261 7269 222c 0a20      "ferrari",. 
+0000f1c0: 2020 2022 6665 7272 6572 6f22 2c0a 2020     "ferrero",.  
+0000f1d0: 2020 2266 6922 2c0a 2020 2020 2266 6961    "fi",.    "fia
+0000f1e0: 7422 2c0a 2020 2020 2266 6964 656c 6974  t",.    "fidelit
+0000f1f0: 7922 2c0a 2020 2020 2266 6964 6f22 2c0a  y",.    "fido",.
+0000f200: 2020 2020 2266 696c 6d22 2c0a 2020 2020      "film",.    
+0000f210: 2266 696e 616c 222c 0a20 2020 2022 6669  "final",.    "fi
+0000f220: 6e61 6e63 6522 2c0a 2020 2020 2266 696e  nance",.    "fin
+0000f230: 616e 6369 616c 222c 0a20 2020 2022 6669  ancial",.    "fi
+0000f240: 7265 222c 0a20 2020 2022 6669 7265 7374  re",.    "firest
+0000f250: 6f6e 6522 2c0a 2020 2020 2266 6972 6d64  one",.    "firmd
+0000f260: 616c 6522 2c0a 2020 2020 2266 6973 6822  ale",.    "fish"
+0000f270: 2c0a 2020 2020 2266 6973 6869 6e67 222c  ,.    "fishing",
+0000f280: 0a20 2020 2022 6669 7422 2c0a 2020 2020  .    "fit",.    
+0000f290: 2266 6974 6e65 7373 222c 0a20 2020 2022  "fitness",.    "
+0000f2a0: 666a 222c 0a20 2020 2022 666b 222c 0a20  fj",.    "fk",. 
+0000f2b0: 2020 2022 666c 6963 6b72 222c 0a20 2020     "flickr",.   
+0000f2c0: 2022 666c 6967 6874 7322 2c0a 2020 2020   "flights",.    
+0000f2d0: 2266 6c69 7222 2c0a 2020 2020 2266 6c6f  "flir",.    "flo
+0000f2e0: 7269 7374 222c 0a20 2020 2022 666c 6f77  rist",.    "flow
+0000f2f0: 6572 7322 2c0a 2020 2020 2266 6c79 222c  ers",.    "fly",
+0000f300: 0a20 2020 2022 666d 222c 0a20 2020 2022  .    "fm",.    "
+0000f310: 666f 222c 0a20 2020 2022 666f 6f22 2c0a  fo",.    "foo",.
+0000f320: 2020 2020 2266 6f6f 6422 2c0a 2020 2020      "food",.    
+0000f330: 2266 6f6f 646e 6574 776f 726b 222c 0a20  "foodnetwork",. 
+0000f340: 2020 2022 666f 6f74 6261 6c6c 222c 0a20     "football",. 
+0000f350: 2020 2022 666f 7264 222c 0a20 2020 2022     "ford",.    "
+0000f360: 666f 7265 7822 2c0a 2020 2020 2266 6f72  forex",.    "for
+0000f370: 7361 6c65 222c 0a20 2020 2022 666f 7275  sale",.    "foru
+0000f380: 6d22 2c0a 2020 2020 2266 6f75 6e64 6174  m",.    "foundat
+0000f390: 696f 6e22 2c0a 2020 2020 2266 6f78 222c  ion",.    "fox",
+0000f3a0: 0a20 2020 2022 6672 222c 0a20 2020 2022  .    "fr",.    "
+0000f3b0: 6672 6565 222c 0a20 2020 2022 6672 6573  free",.    "fres
+0000f3c0: 656e 6975 7322 2c0a 2020 2020 2266 726c  enius",.    "frl
+0000f3d0: 222c 0a20 2020 2022 6672 6f67 616e 7322  ",.    "frogans"
+0000f3e0: 2c0a 2020 2020 2266 726f 6e74 646f 6f72  ,.    "frontdoor
+0000f3f0: 222c 0a20 2020 2022 6672 6f6e 7469 6572  ",.    "frontier
+0000f400: 222c 0a20 2020 2022 6674 7222 2c0a 2020  ",.    "ftr",.  
+0000f410: 2020 2266 756a 6974 7375 222c 0a20 2020    "fujitsu",.   
+0000f420: 2022 6675 6a69 7865 726f 7822 2c0a 2020   "fujixerox",.  
+0000f430: 2020 2266 756e 222c 0a20 2020 2022 6675    "fun",.    "fu
+0000f440: 6e64 222c 0a20 2020 2022 6675 726e 6974  nd",.    "furnit
+0000f450: 7572 6522 2c0a 2020 2020 2266 7574 626f  ure",.    "futbo
+0000f460: 6c22 2c0a 2020 2020 2266 7969 222c 0a20  l",.    "fyi",. 
+0000f470: 2020 2023 2067 0a20 2020 2022 6761 222c     # g.    "ga",
+0000f480: 0a20 2020 2022 6761 6c22 2c0a 2020 2020  .    "gal",.    
+0000f490: 2267 616c 6c65 7279 222c 0a20 2020 2022  "gallery",.    "
+0000f4a0: 6761 6c6c 6f22 2c0a 2020 2020 2267 616c  gallo",.    "gal
+0000f4b0: 6c75 7022 2c0a 2020 2020 2267 616d 6522  lup",.    "game"
+0000f4c0: 2c0a 2020 2020 2267 616d 6573 222c 0a20  ,.    "games",. 
+0000f4d0: 2020 2022 6761 7022 2c0a 2020 2020 2267     "gap",.    "g
+0000f4e0: 6172 6465 6e22 2c0a 2020 2020 2267 6222  arden",.    "gb"
+0000f4f0: 2c0a 2020 2020 2267 6269 7a22 2c0a 2020  ,.    "gbiz",.  
+0000f500: 2020 2267 6422 2c0a 2020 2020 2267 646e    "gd",.    "gdn
+0000f510: 222c 0a20 2020 2022 6765 222c 0a20 2020  ",.    "ge",.   
+0000f520: 2022 6765 6122 2c0a 2020 2020 2267 656e   "gea",.    "gen
+0000f530: 7422 2c0a 2020 2020 2267 656e 7469 6e67  t",.    "genting
+0000f540: 222c 0a20 2020 2022 6765 6f72 6765 222c  ",.    "george",
+0000f550: 0a20 2020 2022 6766 222c 0a20 2020 2022  .    "gf",.    "
+0000f560: 6767 222c 0a20 2020 2022 6767 6565 222c  gg",.    "ggee",
+0000f570: 0a20 2020 2022 6768 222c 0a20 2020 2022  .    "gh",.    "
+0000f580: 6769 222c 0a20 2020 2022 6769 6674 222c  gi",.    "gift",
+0000f590: 0a20 2020 2022 6769 6674 7322 2c0a 2020  .    "gifts",.  
+0000f5a0: 2020 2267 6976 6573 222c 0a20 2020 2022    "gives",.    "
+0000f5b0: 6769 7669 6e67 222c 0a20 2020 2022 676c  giving",.    "gl
+0000f5c0: 222c 0a20 2020 2022 676c 6164 6522 2c0a  ",.    "glade",.
+0000f5d0: 2020 2020 2267 6c61 7373 222c 0a20 2020      "glass",.   
+0000f5e0: 2022 676c 6522 2c0a 2020 2020 2267 6c6f   "gle",.    "glo
+0000f5f0: 6261 6c22 2c0a 2020 2020 2267 6c6f 626f  bal",.    "globo
+0000f600: 222c 0a20 2020 2022 676d 222c 0a20 2020  ",.    "gm",.   
+0000f610: 2022 676d 6169 6c22 2c0a 2020 2020 2267   "gmail",.    "g
+0000f620: 6d62 6822 2c0a 2020 2020 2267 6d6f 222c  mbh",.    "gmo",
+0000f630: 0a20 2020 2022 676d 7822 2c0a 2020 2020  .    "gmx",.    
+0000f640: 2267 6e22 2c0a 2020 2020 2267 6f64 6164  "gn",.    "godad
+0000f650: 6479 222c 0a20 2020 2022 676f 6c64 222c  dy",.    "gold",
+0000f660: 0a20 2020 2022 676f 6c64 706f 696e 7422  .    "goldpoint"
+0000f670: 2c0a 2020 2020 2267 6f6c 6622 2c0a 2020  ,.    "golf",.  
+0000f680: 2020 2267 6f6f 222c 0a20 2020 2022 676f    "goo",.    "go
+0000f690: 6f64 6861 6e64 7322 2c0a 2020 2020 2267  odhands",.    "g
+0000f6a0: 6f6f 6479 6561 7222 2c0a 2020 2020 2267  oodyear",.    "g
+0000f6b0: 6f6f 6722 2c0a 2020 2020 2267 6f6f 676c  oog",.    "googl
+0000f6c0: 6522 2c0a 2020 2020 2267 6f70 222c 0a20  e",.    "gop",. 
+0000f6d0: 2020 2022 676f 7422 2c0a 2020 2020 2267     "got",.    "g
+0000f6e0: 6f76 222c 0a20 2020 2022 6770 222c 0a20  ov",.    "gp",. 
+0000f6f0: 2020 2022 6771 222c 0a20 2020 2022 6772     "gq",.    "gr
+0000f700: 222c 0a20 2020 2022 6772 6169 6e67 6572  ",.    "grainger
+0000f710: 222c 0a20 2020 2022 6772 6170 6869 6373  ",.    "graphics
+0000f720: 222c 0a20 2020 2022 6772 6174 6973 222c  ",.    "gratis",
+0000f730: 0a20 2020 2022 6772 6565 6e22 2c0a 2020  .    "green",.  
+0000f740: 2020 2267 7269 7065 222c 0a20 2020 2022    "gripe",.    "
+0000f750: 6772 6f63 6572 7922 2c0a 2020 2020 2267  grocery",.    "g
+0000f760: 726f 7570 222c 0a20 2020 2022 6773 222c  roup",.    "gs",
+0000f770: 0a20 2020 2022 6774 222c 0a20 2020 2022  .    "gt",.    "
+0000f780: 6775 222c 0a20 2020 2022 6775 6172 6469  gu",.    "guardi
+0000f790: 616e 222c 0a20 2020 2022 6775 6363 6922  an",.    "gucci"
+0000f7a0: 2c0a 2020 2020 2267 7567 6522 2c0a 2020  ,.    "guge",.  
+0000f7b0: 2020 2267 7569 6465 222c 0a20 2020 2022    "guide",.    "
+0000f7c0: 6775 6974 6172 7322 2c0a 2020 2020 2267  guitars",.    "g
+0000f7d0: 7572 7522 2c0a 2020 2020 2267 7722 2c0a  uru",.    "gw",.
+0000f7e0: 2020 2020 2267 7922 2c0a 2020 2020 2320      "gy",.    # 
+0000f7f0: 680a 2020 2020 2268 6169 7222 2c0a 2020  h.    "hair",.  
+0000f800: 2020 2268 616d 6275 7267 222c 0a20 2020    "hamburg",.   
+0000f810: 2022 6861 6e67 6f75 7422 2c0a 2020 2020   "hangout",.    
+0000f820: 2268 6175 7322 2c0a 2020 2020 2268 626f  "haus",.    "hbo
+0000f830: 222c 0a20 2020 2022 6864 6663 222c 0a20  ",.    "hdfc",. 
+0000f840: 2020 2022 6864 6663 6261 6e6b 222c 0a20     "hdfcbank",. 
+0000f850: 2020 2022 6865 616c 7468 222c 0a20 2020     "health",.   
+0000f860: 2022 6865 616c 7468 6361 7265 222c 0a20   "healthcare",. 
+0000f870: 2020 2022 6865 6c70 222c 0a20 2020 2022     "help",.    "
+0000f880: 6865 6c73 696e 6b69 222c 0a20 2020 2022  helsinki",.    "
+0000f890: 6865 7265 222c 0a20 2020 2022 6865 726d  here",.    "herm
+0000f8a0: 6573 222c 0a20 2020 2022 6867 7476 222c  es",.    "hgtv",
+0000f8b0: 0a20 2020 2022 6869 7068 6f70 222c 0a20  .    "hiphop",. 
+0000f8c0: 2020 2022 6869 7361 6d69 7473 7522 2c0a     "hisamitsu",.
+0000f8d0: 2020 2020 2268 6974 6163 6869 222c 0a20      "hitachi",. 
+0000f8e0: 2020 2022 6869 7622 2c0a 2020 2020 2268     "hiv",.    "h
+0000f8f0: 6b22 2c0a 2020 2020 2268 6b74 222c 0a20  k",.    "hkt",. 
+0000f900: 2020 2022 686d 222c 0a20 2020 2022 686e     "hm",.    "hn
+0000f910: 222c 0a20 2020 2022 686f 636b 6579 222c  ",.    "hockey",
+0000f920: 0a20 2020 2022 686f 6c64 696e 6773 222c  .    "holdings",
+0000f930: 0a20 2020 2022 686f 6c69 6461 7922 2c0a  .    "holiday",.
+0000f940: 2020 2020 2268 6f6d 6564 6570 6f74 222c      "homedepot",
+0000f950: 0a20 2020 2022 686f 6d65 676f 6f64 7322  .    "homegoods"
+0000f960: 2c0a 2020 2020 2268 6f6d 6573 222c 0a20  ,.    "homes",. 
+0000f970: 2020 2022 686f 6d65 7365 6e73 6522 2c0a     "homesense",.
+0000f980: 2020 2020 2268 6f6e 6461 222c 0a20 2020      "honda",.   
+0000f990: 2022 686f 6e65 7977 656c 6c22 2c0a 2020   "honeywell",.  
+0000f9a0: 2020 2268 6f72 7365 222c 0a20 2020 2022    "horse",.    "
+0000f9b0: 686f 7370 6974 616c 222c 0a20 2020 2022  hospital",.    "
+0000f9c0: 686f 7374 222c 0a20 2020 2022 686f 7374  host",.    "host
+0000f9d0: 696e 6722 2c0a 2020 2020 2268 6f74 222c  ing",.    "hot",
+0000f9e0: 0a20 2020 2022 686f 7465 6c65 7322 2c0a  .    "hoteles",.
+0000f9f0: 2020 2020 2268 6f74 656c 7322 2c0a 2020      "hotels",.  
+0000fa00: 2020 2268 6f74 6d61 696c 222c 0a20 2020    "hotmail",.   
+0000fa10: 2022 686f 7573 6522 2c0a 2020 2020 2268   "house",.    "h
+0000fa20: 6f77 222c 0a20 2020 2022 6872 222c 0a20  ow",.    "hr",. 
+0000fa30: 2020 2022 6873 6263 222c 0a20 2020 2022     "hsbc",.    "
+0000fa40: 6874 222c 0a20 2020 2022 6875 222c 0a20  ht",.    "hu",. 
+0000fa50: 2020 2022 6875 6768 6573 222c 0a20 2020     "hughes",.   
+0000fa60: 2022 6879 6174 7422 2c0a 2020 2020 2268   "hyatt",.    "h
+0000fa70: 7975 6e64 6169 222c 0a20 2020 2023 2069  yundai",.    # i
+0000fa80: 0a20 2020 2022 6962 6d22 2c0a 2020 2020  .    "ibm",.    
+0000fa90: 2269 6362 6322 2c0a 2020 2020 2269 6365  "icbc",.    "ice
+0000faa0: 222c 0a20 2020 2022 6963 7522 2c0a 2020  ",.    "icu",.  
+0000fab0: 2020 2269 6422 2c0a 2020 2020 2269 6522    "id",.    "ie"
+0000fac0: 2c0a 2020 2020 2269 6565 6522 2c0a 2020  ,.    "ieee",.  
+0000fad0: 2020 2269 666d 222c 0a20 2020 2022 696b    "ifm",.    "ik
+0000fae0: 616e 6f22 2c0a 2020 2020 2269 6c22 2c0a  ano",.    "il",.
+0000faf0: 2020 2020 2269 6d22 2c0a 2020 2020 2269      "im",.    "i
+0000fb00: 6d61 6d61 7422 2c0a 2020 2020 2269 6d64  mamat",.    "imd
+0000fb10: 6222 2c0a 2020 2020 2269 6d6d 6f22 2c0a  b",.    "immo",.
+0000fb20: 2020 2020 2269 6d6d 6f62 696c 6965 6e22      "immobilien"
+0000fb30: 2c0a 2020 2020 2269 6e22 2c0a 2020 2020  ,.    "in",.    
+0000fb40: 2269 6e64 7573 7472 6965 7322 2c0a 2020  "industries",.  
+0000fb50: 2020 2269 6e66 696e 6974 6922 2c0a 2020    "infiniti",.  
+0000fb60: 2020 2269 6e66 6f22 2c0a 2020 2020 2269    "info",.    "i
+0000fb70: 6e67 222c 0a20 2020 2022 696e 6b22 2c0a  ng",.    "ink",.
+0000fb80: 2020 2020 2269 6e73 7469 7475 7465 222c      "institute",
+0000fb90: 0a20 2020 2022 696e 7375 7261 6e63 6522  .    "insurance"
+0000fba0: 2c0a 2020 2020 2269 6e73 7572 6522 2c0a  ,.    "insure",.
+0000fbb0: 2020 2020 2269 6e74 222c 0a20 2020 2022      "int",.    "
+0000fbc0: 696e 7465 6c22 2c0a 2020 2020 2269 6e74  intel",.    "int
+0000fbd0: 6572 6e61 7469 6f6e 616c 222c 0a20 2020  ernational",.   
+0000fbe0: 2022 696e 7475 6974 222c 0a20 2020 2022   "intuit",.    "
+0000fbf0: 696e 7665 7374 6d65 6e74 7322 2c0a 2020  investments",.  
+0000fc00: 2020 2269 6f22 2c0a 2020 2020 2269 7069    "io",.    "ipi
+0000fc10: 7261 6e67 6122 2c0a 2020 2020 2269 7122  ranga",.    "iq"
+0000fc20: 2c0a 2020 2020 2269 7222 2c0a 2020 2020  ,.    "ir",.    
+0000fc30: 2269 7269 7368 222c 0a20 2020 2022 6973  "irish",.    "is
+0000fc40: 222c 0a20 2020 2022 6973 656c 6563 7422  ",.    "iselect"
+0000fc50: 2c0a 2020 2020 2269 736d 6169 6c69 222c  ,.    "ismaili",
+0000fc60: 0a20 2020 2022 6973 7422 2c0a 2020 2020  .    "ist",.    
+0000fc70: 2269 7374 616e 6275 6c22 2c0a 2020 2020  "istanbul",.    
+0000fc80: 2269 7422 2c0a 2020 2020 2269 7461 7522  "it",.    "itau"
+0000fc90: 2c0a 2020 2020 2269 7476 222c 0a20 2020  ,.    "itv",.   
+0000fca0: 2022 6976 6563 6f22 2c0a 2020 2020 2269   "iveco",.    "i
+0000fcb0: 7763 222c 0a20 2020 2023 206a 0a20 2020  wc",.    # j.   
+0000fcc0: 2022 6a61 6775 6172 222c 0a20 2020 2022   "jaguar",.    "
+0000fcd0: 6a61 7661 222c 0a20 2020 2022 6a63 6222  java",.    "jcb"
+0000fce0: 2c0a 2020 2020 226a 6370 222c 0a20 2020  ,.    "jcp",.   
+0000fcf0: 2022 6a65 222c 0a20 2020 2022 6a65 6570   "je",.    "jeep
+0000fd00: 222c 0a20 2020 2022 6a65 747a 7422 2c0a  ",.    "jetzt",.
+0000fd10: 2020 2020 226a 6577 656c 7279 222c 0a20      "jewelry",. 
+0000fd20: 2020 2022 6a69 6f22 2c0a 2020 2020 226a     "jio",.    "j
+0000fd30: 6c63 222c 0a20 2020 2022 6a6c 6c22 2c0a  lc",.    "jll",.
+0000fd40: 2020 2020 226a 6d22 2c0a 2020 2020 226a      "jm",.    "j
+0000fd50: 6d70 222c 0a20 2020 2022 6a6e 6a22 2c0a  mp",.    "jnj",.
+0000fd60: 2020 2020 226a 6f22 2c0a 2020 2020 226a      "jo",.    "j
+0000fd70: 6f62 7322 2c0a 2020 2020 226a 6f62 7572  obs",.    "jobur
+0000fd80: 6722 2c0a 2020 2020 226a 6f74 222c 0a20  g",.    "jot",. 
+0000fd90: 2020 2022 6a6f 7922 2c0a 2020 2020 226a     "joy",.    "j
+0000fda0: 7022 2c0a 2020 2020 226a 706d 6f72 6761  p",.    "jpmorga
+0000fdb0: 6e22 2c0a 2020 2020 226a 7072 7322 2c0a  n",.    "jprs",.
+0000fdc0: 2020 2020 226a 7565 676f 7322 2c0a 2020      "juegos",.  
+0000fdd0: 2020 226a 756e 6970 6572 222c 0a20 2020    "juniper",.   
+0000fde0: 2023 206b 0a20 2020 2022 6b61 7566 656e   # k.    "kaufen
+0000fdf0: 222c 0a20 2020 2022 6b64 6469 222c 0a20  ",.    "kddi",. 
+0000fe00: 2020 2022 6b65 222c 0a20 2020 2022 6b65     "ke",.    "ke
+0000fe10: 7272 7968 6f74 656c 7322 2c0a 2020 2020  rryhotels",.    
+0000fe20: 226b 6572 7279 6c6f 6769 7374 6963 7322  "kerrylogistics"
+0000fe30: 2c0a 2020 2020 226b 6572 7279 7072 6f70  ,.    "kerryprop
+0000fe40: 6572 7469 6573 222c 0a20 2020 2022 6b66  erties",.    "kf
+0000fe50: 6822 2c0a 2020 2020 226b 6722 2c0a 2020  h",.    "kg",.  
+0000fe60: 2020 226b 6822 2c0a 2020 2020 226b 6922    "kh",.    "ki"
+0000fe70: 2c0a 2020 2020 226b 6961 222c 0a20 2020  ,.    "kia",.   
+0000fe80: 2022 6b69 6d22 2c0a 2020 2020 226b 696e   "kim",.    "kin
+0000fe90: 6465 7222 2c0a 2020 2020 226b 696e 646c  der",.    "kindl
+0000fea0: 6522 2c0a 2020 2020 226b 6974 6368 656e  e",.    "kitchen
+0000feb0: 222c 0a20 2020 2022 6b69 7769 222c 0a20  ",.    "kiwi",. 
+0000fec0: 2020 2022 6b6d 222c 0a20 2020 2022 6b6e     "km",.    "kn
+0000fed0: 222c 0a20 2020 2022 6b6f 656c 6e22 2c0a  ",.    "koeln",.
+0000fee0: 2020 2020 226b 6f6d 6174 7375 222c 0a20      "komatsu",. 
+0000fef0: 2020 2022 6b6f 7368 6572 222c 0a20 2020     "kosher",.   
+0000ff00: 2022 6b70 222c 0a20 2020 2022 6b70 6d67   "kp",.    "kpmg
+0000ff10: 222c 0a20 2020 2022 6b70 6e22 2c0a 2020  ",.    "kpn",.  
+0000ff20: 2020 226b 7222 2c0a 2020 2020 226b 7264    "kr",.    "krd
+0000ff30: 222c 0a20 2020 2022 6b72 6564 222c 0a20  ",.    "kred",. 
+0000ff40: 2020 2022 6b75 6f6b 6772 6f75 7022 2c0a     "kuokgroup",.
+0000ff50: 2020 2020 226b 7722 2c0a 2020 2020 226b      "kw",.    "k
+0000ff60: 7922 2c0a 2020 2020 226b 796f 746f 222c  y",.    "kyoto",
+0000ff70: 0a20 2020 2022 6b7a 222c 0a20 2020 2023  .    "kz",.    #
+0000ff80: 206c 0a20 2020 2022 6c61 222c 0a20 2020   l.    "la",.   
+0000ff90: 2022 6c61 6361 6978 6122 2c0a 2020 2020   "lacaixa",.    
+0000ffa0: 226c 6164 6272 6f6b 6573 222c 0a20 2020  "ladbrokes",.   
+0000ffb0: 2022 6c61 6d62 6f72 6768 696e 6922 2c0a   "lamborghini",.
+0000ffc0: 2020 2020 226c 616d 6572 222c 0a20 2020      "lamer",.   
+0000ffd0: 2022 6c61 6e63 6173 7465 7222 2c0a 2020   "lancaster",.  
+0000ffe0: 2020 226c 616e 6369 6122 2c0a 2020 2020    "lancia",.    
+0000fff0: 226c 616e 636f 6d65 222c 0a20 2020 2022  "lancome",.    "
+00010000: 6c61 6e64 222c 0a20 2020 2022 6c61 6e64  land",.    "land
+00010010: 726f 7665 7222 2c0a 2020 2020 226c 616e  rover",.    "lan
+00010020: 7865 7373 222c 0a20 2020 2022 6c61 7361  xess",.    "lasa
+00010030: 6c6c 6522 2c0a 2020 2020 226c 6174 222c  lle",.    "lat",
+00010040: 0a20 2020 2022 6c61 7469 6e6f 222c 0a20  .    "latino",. 
+00010050: 2020 2022 6c61 7472 6f62 6522 2c0a 2020     "latrobe",.  
+00010060: 2020 226c 6177 222c 0a20 2020 2022 6c61    "law",.    "la
+00010070: 7779 6572 222c 0a20 2020 2022 6c62 222c  wyer",.    "lb",
+00010080: 0a20 2020 2022 6c63 222c 0a20 2020 2022  .    "lc",.    "
+00010090: 6c64 7322 2c0a 2020 2020 226c 6561 7365  lds",.    "lease
+000100a0: 222c 0a20 2020 2022 6c65 636c 6572 6322  ",.    "leclerc"
+000100b0: 2c0a 2020 2020 226c 6566 7261 6b22 2c0a  ,.    "lefrak",.
+000100c0: 2020 2020 226c 6567 616c 222c 0a20 2020      "legal",.   
+000100d0: 2022 6c65 676f 222c 0a20 2020 2022 6c65   "lego",.    "le
+000100e0: 7875 7322 2c0a 2020 2020 226c 6762 7422  xus",.    "lgbt"
+000100f0: 2c0a 2020 2020 226c 6922 2c0a 2020 2020  ,.    "li",.    
+00010100: 226c 6961 6973 6f6e 222c 0a20 2020 2022  "liaison",.    "
+00010110: 6c69 646c 222c 0a20 2020 2022 6c69 6665  lidl",.    "life
+00010120: 222c 0a20 2020 2022 6c69 6665 696e 7375  ",.    "lifeinsu
+00010130: 7261 6e63 6522 2c0a 2020 2020 226c 6966  rance",.    "lif
+00010140: 6573 7479 6c65 222c 0a20 2020 2022 6c69  estyle",.    "li
+00010150: 6768 7469 6e67 222c 0a20 2020 2022 6c69  ghting",.    "li
+00010160: 6b65 222c 0a20 2020 2022 6c69 6c6c 7922  ke",.    "lilly"
+00010170: 2c0a 2020 2020 226c 696d 6974 6564 222c  ,.    "limited",
+00010180: 0a20 2020 2022 6c69 6d6f 222c 0a20 2020  .    "limo",.   
+00010190: 2022 6c69 6e63 6f6c 6e22 2c0a 2020 2020   "lincoln",.    
+000101a0: 226c 696e 6465 222c 0a20 2020 2022 6c69  "linde",.    "li
+000101b0: 6e6b 222c 0a20 2020 2022 6c69 7073 7922  nk",.    "lipsy"
+000101c0: 2c0a 2020 2020 226c 6976 6522 2c0a 2020  ,.    "live",.  
+000101d0: 2020 226c 6976 696e 6722 2c0a 2020 2020    "living",.    
+000101e0: 226c 6978 696c 222c 0a20 2020 2022 6c6b  "lixil",.    "lk
+000101f0: 222c 0a20 2020 2022 6c6f 616e 222c 0a20  ",.    "loan",. 
+00010200: 2020 2022 6c6f 616e 7322 2c0a 2020 2020     "loans",.    
+00010210: 226c 6f63 616c 686f 7374 222c 0a20 2020  "localhost",.   
+00010220: 2022 6c6f 636b 6572 222c 0a20 2020 2022   "locker",.    "
+00010230: 6c6f 6375 7322 2c0a 2020 2020 226c 6f66  locus",.    "lof
+00010240: 7422 2c0a 2020 2020 226c 6f6c 222c 0a20  t",.    "lol",. 
+00010250: 2020 2022 6c6f 6e64 6f6e 222c 0a20 2020     "london",.   
+00010260: 2022 6c6f 7474 6522 2c0a 2020 2020 226c   "lotte",.    "l
+00010270: 6f74 746f 222c 0a20 2020 2022 6c6f 7665  otto",.    "love
+00010280: 222c 0a20 2020 2022 6c70 6c22 2c0a 2020  ",.    "lpl",.  
+00010290: 2020 226c 706c 6669 6e61 6e63 6961 6c22    "lplfinancial"
+000102a0: 2c0a 2020 2020 226c 7222 2c0a 2020 2020  ,.    "lr",.    
+000102b0: 226c 7322 2c0a 2020 2020 226c 7422 2c0a  "ls",.    "lt",.
+000102c0: 2020 2020 226c 7464 222c 0a20 2020 2022      "ltd",.    "
+000102d0: 6c74 6461 222c 0a20 2020 2022 6c75 222c  ltda",.    "lu",
+000102e0: 0a20 2020 2022 6c75 6e64 6265 636b 222c  .    "lundbeck",
+000102f0: 0a20 2020 2022 6c75 7069 6e22 2c0a 2020  .    "lupin",.  
+00010300: 2020 226c 7578 6522 2c0a 2020 2020 226c    "luxe",.    "l
+00010310: 7578 7572 7922 2c0a 2020 2020 226c 7622  uxury",.    "lv"
+00010320: 2c0a 2020 2020 226c 7922 2c0a 2020 2020  ,.    "ly",.    
+00010330: 2320 6d0a 2020 2020 226d 6122 2c0a 2020  # m.    "ma",.  
+00010340: 2020 226d 6163 7973 222c 0a20 2020 2022    "macys",.    "
+00010350: 6d61 6472 6964 222c 0a20 2020 2022 6d61  madrid",.    "ma
+00010360: 6966 222c 0a20 2020 2022 6d61 6973 6f6e  if",.    "maison
+00010370: 222c 0a20 2020 2022 6d61 6b65 7570 222c  ",.    "makeup",
+00010380: 0a20 2020 2022 6d61 6e22 2c0a 2020 2020  .    "man",.    
+00010390: 226d 616e 6167 656d 656e 7422 2c0a 2020  "management",.  
+000103a0: 2020 226d 616e 676f 222c 0a20 2020 2022    "mango",.    "
+000103b0: 6d61 7022 2c0a 2020 2020 226d 6172 6b65  map",.    "marke
+000103c0: 7422 2c0a 2020 2020 226d 6172 6b65 7469  t",.    "marketi
+000103d0: 6e67 222c 0a20 2020 2022 6d61 726b 6574  ng",.    "market
+000103e0: 7322 2c0a 2020 2020 226d 6172 7269 6f74  s",.    "marriot
+000103f0: 7422 2c0a 2020 2020 226d 6172 7368 616c  t",.    "marshal
+00010400: 6c73 222c 0a20 2020 2022 6d61 7365 7261  ls",.    "masera
+00010410: 7469 222c 0a20 2020 2022 6d61 7474 656c  ti",.    "mattel
+00010420: 222c 0a20 2020 2022 6d62 6122 2c0a 2020  ",.    "mba",.  
+00010430: 2020 226d 6322 2c0a 2020 2020 226d 636b    "mc",.    "mck
+00010440: 696e 7365 7922 2c0a 2020 2020 226d 6422  insey",.    "md"
+00010450: 2c0a 2020 2020 226d 6522 2c0a 2020 2020  ,.    "me",.    
+00010460: 226d 6564 222c 0a20 2020 2022 6d65 6469  "med",.    "medi
+00010470: 6122 2c0a 2020 2020 226d 6565 7422 2c0a  a",.    "meet",.
+00010480: 2020 2020 226d 656c 626f 7572 6e65 222c      "melbourne",
+00010490: 0a20 2020 2022 6d65 6d65 222c 0a20 2020  .    "meme",.   
+000104a0: 2022 6d65 6d6f 7269 616c 222c 0a20 2020   "memorial",.   
+000104b0: 2022 6d65 6e22 2c0a 2020 2020 226d 656e   "men",.    "men
+000104c0: 7522 2c0a 2020 2020 226d 656f 222c 0a20  u",.    "meo",. 
+000104d0: 2020 2022 6d65 7263 6b6d 7364 222c 0a20     "merckmsd",. 
+000104e0: 2020 2022 6d65 746c 6966 6522 2c0a 2020     "metlife",.  
+000104f0: 2020 226d 6722 2c0a 2020 2020 226d 6822    "mg",.    "mh"
+00010500: 2c0a 2020 2020 226d 6961 6d69 222c 0a20  ,.    "miami",. 
+00010510: 2020 2022 6d69 6372 6f73 6f66 7422 2c0a     "microsoft",.
+00010520: 2020 2020 226d 696c 222c 0a20 2020 2022      "mil",.    "
+00010530: 6d69 6e69 222c 0a20 2020 2022 6d69 6e74  mini",.    "mint
+00010540: 222c 0a20 2020 2022 6d69 7422 2c0a 2020  ",.    "mit",.  
+00010550: 2020 226d 6974 7375 6269 7368 6922 2c0a    "mitsubishi",.
+00010560: 2020 2020 226d 6b22 2c0a 2020 2020 226d      "mk",.    "m
+00010570: 6c22 2c0a 2020 2020 226d 6c62 222c 0a20  l",.    "mlb",. 
+00010580: 2020 2022 6d6c 7322 2c0a 2020 2020 226d     "mls",.    "m
+00010590: 6d22 2c0a 2020 2020 226d 6d61 222c 0a20  m",.    "mma",. 
+000105a0: 2020 2022 6d6e 222c 0a20 2020 2022 6d6f     "mn",.    "mo
+000105b0: 222c 0a20 2020 2022 6d6f 6269 222c 0a20  ",.    "mobi",. 
+000105c0: 2020 2022 6d6f 6269 6c65 222c 0a20 2020     "mobile",.   
+000105d0: 2022 6d6f 6269 6c79 222c 0a20 2020 2022   "mobily",.    "
+000105e0: 6d6f 6461 222c 0a20 2020 2022 6d6f 6522  moda",.    "moe"
+000105f0: 2c0a 2020 2020 226d 6f69 222c 0a20 2020  ,.    "moi",.   
+00010600: 2022 6d6f 6d22 2c0a 2020 2020 226d 6f6e   "mom",.    "mon
+00010610: 6173 6822 2c0a 2020 2020 226d 6f6e 6579  ash",.    "money
+00010620: 222c 0a20 2020 2022 6d6f 6e73 7465 7222  ",.    "monster"
+00010630: 2c0a 2020 2020 226d 6f70 6172 222c 0a20  ,.    "mopar",. 
+00010640: 2020 2022 6d6f 726d 6f6e 222c 0a20 2020     "mormon",.   
+00010650: 2022 6d6f 7274 6761 6765 222c 0a20 2020   "mortgage",.   
+00010660: 2022 6d6f 7363 6f77 222c 0a20 2020 2022   "moscow",.    "
+00010670: 6d6f 746f 222c 0a20 2020 2022 6d6f 746f  moto",.    "moto
+00010680: 7263 7963 6c65 7322 2c0a 2020 2020 226d  rcycles",.    "m
+00010690: 6f76 222c 0a20 2020 2022 6d6f 7669 6522  ov",.    "movie"
+000106a0: 2c0a 2020 2020 226d 6f76 6973 7461 7222  ,.    "movistar"
+000106b0: 2c0a 2020 2020 226d 7022 2c0a 2020 2020  ,.    "mp",.    
+000106c0: 226d 7122 2c0a 2020 2020 226d 7222 2c0a  "mq",.    "mr",.
+000106d0: 2020 2020 226d 7322 2c0a 2020 2020 226d      "ms",.    "m
+000106e0: 7364 222c 0a20 2020 2022 6d74 222c 0a20  sd",.    "mt",. 
+000106f0: 2020 2022 6d74 6e22 2c0a 2020 2020 226d     "mtn",.    "m
+00010700: 7472 222c 0a20 2020 2022 6d75 222c 0a20  tr",.    "mu",. 
+00010710: 2020 2022 6d75 7365 756d 222c 0a20 2020     "museum",.   
+00010720: 2022 6d75 7475 616c 222c 0a20 2020 2022   "mutual",.    "
+00010730: 6d76 222c 0a20 2020 2022 6d77 222c 0a20  mv",.    "mw",. 
+00010740: 2020 2022 6d78 222c 0a20 2020 2022 6d79     "mx",.    "my
+00010750: 222c 0a20 2020 2022 6d7a 222c 0a20 2020  ",.    "mz",.   
+00010760: 2023 206e 0a20 2020 2022 6e61 222c 0a20   # n.    "na",. 
+00010770: 2020 2022 6e61 6222 2c0a 2020 2020 226e     "nab",.    "n
+00010780: 6164 6578 222c 0a20 2020 2022 6e61 676f  adex",.    "nago
+00010790: 7961 222c 0a20 2020 2022 6e61 6d65 222c  ya",.    "name",
+000107a0: 0a20 2020 2022 6e61 7469 6f6e 7769 6465  .    "nationwide
+000107b0: 222c 0a20 2020 2022 6e61 7475 7261 222c  ",.    "natura",
+000107c0: 0a20 2020 2022 6e61 7679 222c 0a20 2020  .    "navy",.   
+000107d0: 2022 6e62 6122 2c0a 2020 2020 226e 6322   "nba",.    "nc"
+000107e0: 2c0a 2020 2020 226e 6522 2c0a 2020 2020  ,.    "ne",.    
+000107f0: 226e 6563 222c 0a20 2020 2022 6e65 7422  "nec",.    "net"
+00010800: 2c0a 2020 2020 226e 6574 6261 6e6b 222c  ,.    "netbank",
+00010810: 0a20 2020 2022 6e65 7466 6c69 7822 2c0a  .    "netflix",.
+00010820: 2020 2020 226e 6574 776f 726b 222c 0a20      "network",. 
+00010830: 2020 2022 6e65 7573 7461 7222 2c0a 2020     "neustar",.  
+00010840: 2020 226e 6577 222c 0a20 2020 2022 6e65    "new",.    "ne
+00010850: 7768 6f6c 6c61 6e64 222c 0a20 2020 2022  wholland",.    "
+00010860: 6e65 7773 222c 0a20 2020 2022 6e65 7874  news",.    "next
+00010870: 222c 0a20 2020 2022 6e65 7874 6469 7265  ",.    "nextdire
+00010880: 6374 222c 0a20 2020 2022 6e65 7875 7322  ct",.    "nexus"
+00010890: 2c0a 2020 2020 226e 6622 2c0a 2020 2020  ,.    "nf",.    
+000108a0: 226e 666c 222c 0a20 2020 2022 6e67 222c  "nfl",.    "ng",
+000108b0: 0a20 2020 2022 6e67 6f22 2c0a 2020 2020  .    "ngo",.    
+000108c0: 226e 686b 222c 0a20 2020 2022 6e69 222c  "nhk",.    "ni",
+000108d0: 0a20 2020 2022 6e69 636f 222c 0a20 2020  .    "nico",.   
+000108e0: 2022 6e69 6b65 222c 0a20 2020 2022 6e69   "nike",.    "ni
+000108f0: 6b6f 6e22 2c0a 2020 2020 226e 696e 6a61  kon",.    "ninja
+00010900: 222c 0a20 2020 2022 6e69 7373 616e 222c  ",.    "nissan",
+00010910: 0a20 2020 2022 6e69 7373 6179 222c 0a20  .    "nissay",. 
+00010920: 2020 2022 6e6c 222c 0a20 2020 2022 6e6f     "nl",.    "no
+00010930: 222c 0a20 2020 2022 6e6f 6b69 6122 2c0a  ",.    "nokia",.
+00010940: 2020 2020 226e 6f72 7468 7765 7374 6572      "northwester
+00010950: 6e6d 7574 7561 6c22 2c0a 2020 2020 226e  nmutual",.    "n
+00010960: 6f72 746f 6e22 2c0a 2020 2020 226e 6f77  orton",.    "now
+00010970: 222c 0a20 2020 2022 6e6f 7772 757a 222c  ",.    "nowruz",
+00010980: 0a20 2020 2022 6e6f 7774 7622 2c0a 2020  .    "nowtv",.  
+00010990: 2020 226e 7022 2c0a 2020 2020 226e 7222    "np",.    "nr"
+000109a0: 2c0a 2020 2020 226e 7261 222c 0a20 2020  ,.    "nra",.   
+000109b0: 2022 6e72 7722 2c0a 2020 2020 226e 7474   "nrw",.    "ntt
+000109c0: 222c 0a20 2020 2022 6e75 222c 0a20 2020  ",.    "nu",.   
+000109d0: 2022 6e79 6322 2c0a 2020 2020 226e 7a22   "nyc",.    "nz"
+000109e0: 2c0a 2020 2020 2320 6f0a 2020 2020 226f  ,.    # o.    "o
+000109f0: 6269 222c 0a20 2020 2022 6f62 7365 7276  bi",.    "observ
+00010a00: 6572 222c 0a20 2020 2022 6f66 6622 2c0a  er",.    "off",.
+00010a10: 2020 2020 226f 6666 6963 6522 2c0a 2020      "office",.  
+00010a20: 2020 226f 6b69 6e61 7761 222c 0a20 2020    "okinawa",.   
+00010a30: 2022 6f6c 6179 616e 222c 0a20 2020 2022   "olayan",.    "
+00010a40: 6f6c 6179 616e 6772 6f75 7022 2c0a 2020  olayangroup",.  
+00010a50: 2020 226f 6c64 6e61 7679 222c 0a20 2020    "oldnavy",.   
+00010a60: 2022 6f6c 6c6f 222c 0a20 2020 2022 6f6d   "ollo",.    "om
+00010a70: 222c 0a20 2020 2022 6f6d 6567 6122 2c0a  ",.    "omega",.
+00010a80: 2020 2020 226f 6e65 222c 0a20 2020 2022      "one",.    "
+00010a90: 6f6e 6722 2c0a 2020 2020 226f 6e6c 222c  ong",.    "onl",
+00010aa0: 0a20 2020 2022 6f6e 6c69 6e65 222c 0a20  .    "online",. 
+00010ab0: 2020 2022 6f6e 796f 7572 7369 6465 222c     "onyourside",
+00010ac0: 0a20 2020 2022 6f6f 6f22 2c0a 2020 2020  .    "ooo",.    
+00010ad0: 226f 7065 6e22 2c0a 2020 2020 226f 7261  "open",.    "ora
+00010ae0: 636c 6522 2c0a 2020 2020 226f 7261 6e67  cle",.    "orang
+00010af0: 6522 2c0a 2020 2020 226f 7267 222c 0a20  e",.    "org",. 
+00010b00: 2020 2022 6f72 6761 6e69 6322 2c0a 2020     "organic",.  
+00010b10: 2020 226f 7269 6769 6e73 222c 0a20 2020    "origins",.   
+00010b20: 2022 6f73 616b 6122 2c0a 2020 2020 226f   "osaka",.    "o
+00010b30: 7473 756b 6122 2c0a 2020 2020 226f 7474  tsuka",.    "ott
+00010b40: 222c 0a20 2020 2022 6f76 6822 2c0a 2020  ",.    "ovh",.  
+00010b50: 2020 2320 700a 2020 2020 2270 6122 2c0a    # p.    "pa",.
+00010b60: 2020 2020 2270 6167 6522 2c0a 2020 2020      "page",.    
+00010b70: 2270 616e 6173 6f6e 6963 222c 0a20 2020  "panasonic",.   
+00010b80: 2022 7061 6e65 7261 6922 2c0a 2020 2020   "panerai",.    
+00010b90: 2270 6172 6973 222c 0a20 2020 2022 7061  "paris",.    "pa
+00010ba0: 7273 222c 0a20 2020 2022 7061 7274 6e65  rs",.    "partne
+00010bb0: 7273 222c 0a20 2020 2022 7061 7274 7322  rs",.    "parts"
+00010bc0: 2c0a 2020 2020 2270 6172 7479 222c 0a20  ,.    "party",. 
+00010bd0: 2020 2022 7061 7373 6167 656e 7322 2c0a     "passagens",.
+00010be0: 2020 2020 2270 6179 222c 0a20 2020 2022      "pay",.    "
+00010bf0: 7063 6377 222c 0a20 2020 2022 7065 222c  pccw",.    "pe",
+00010c00: 0a20 2020 2022 7065 7422 2c0a 2020 2020  .    "pet",.    
+00010c10: 2270 6622 2c0a 2020 2020 2270 6669 7a65  "pf",.    "pfize
+00010c20: 7222 2c0a 2020 2020 2270 6722 2c0a 2020  r",.    "pg",.  
+00010c30: 2020 2270 6822 2c0a 2020 2020 2270 6861    "ph",.    "pha
+00010c40: 726d 6163 7922 2c0a 2020 2020 2270 6864  rmacy",.    "phd
+00010c50: 222c 0a20 2020 2022 7068 696c 6970 7322  ",.    "philips"
+00010c60: 2c0a 2020 2020 2270 686f 6e65 222c 0a20  ,.    "phone",. 
+00010c70: 2020 2022 7068 6f74 6f22 2c0a 2020 2020     "photo",.    
+00010c80: 2270 686f 746f 6772 6170 6879 222c 0a20  "photography",. 
+00010c90: 2020 2022 7068 6f74 6f73 222c 0a20 2020     "photos",.   
+00010ca0: 2022 7068 7973 696f 222c 0a20 2020 2022   "physio",.    "
+00010cb0: 7069 6167 6574 222c 0a20 2020 2022 7069  piaget",.    "pi
+00010cc0: 6373 222c 0a20 2020 2022 7069 6374 6574  cs",.    "pictet
+00010cd0: 222c 0a20 2020 2022 7069 6374 7572 6573  ",.    "pictures
+00010ce0: 222c 0a20 2020 2022 7069 6422 2c0a 2020  ",.    "pid",.  
+00010cf0: 2020 2270 696e 222c 0a20 2020 2022 7069    "pin",.    "pi
+00010d00: 6e67 222c 0a20 2020 2022 7069 6e6b 222c  ng",.    "pink",
+00010d10: 0a20 2020 2022 7069 6f6e 6565 7222 2c0a  .    "pioneer",.
+00010d20: 2020 2020 2270 697a 7a61 222c 0a20 2020      "pizza",.   
+00010d30: 2022 706b 222c 0a20 2020 2022 706c 222c   "pk",.    "pl",
+00010d40: 0a20 2020 2022 706c 6163 6522 2c0a 2020  .    "place",.  
+00010d50: 2020 2270 6c61 7922 2c0a 2020 2020 2270    "play",.    "p
+00010d60: 6c61 7973 7461 7469 6f6e 222c 0a20 2020  laystation",.   
+00010d70: 2022 706c 756d 6269 6e67 222c 0a20 2020   "plumbing",.   
+00010d80: 2022 706c 7573 222c 0a20 2020 2022 706d   "plus",.    "pm
+00010d90: 222c 0a20 2020 2022 706e 222c 0a20 2020  ",.    "pn",.   
+00010da0: 2022 706e 6322 2c0a 2020 2020 2270 6f68   "pnc",.    "poh
+00010db0: 6c22 2c0a 2020 2020 2270 6f6b 6572 222c  l",.    "poker",
+00010dc0: 0a20 2020 2022 706f 6c69 7469 6522 2c0a  .    "politie",.
+00010dd0: 2020 2020 2270 6f72 6e22 2c0a 2020 2020      "porn",.    
+00010de0: 2270 6f73 7422 2c0a 2020 2020 2270 7222  "post",.    "pr"
+00010df0: 2c0a 2020 2020 2270 7261 6d65 7269 6361  ,.    "pramerica
+00010e00: 222c 0a20 2020 2022 7072 6178 6922 2c0a  ",.    "praxi",.
+00010e10: 2020 2020 2270 7265 7373 222c 0a20 2020      "press",.   
+00010e20: 2022 7072 696d 6522 2c0a 2020 2020 2270   "prime",.    "p
+00010e30: 726f 222c 0a20 2020 2022 7072 6f64 222c  ro",.    "prod",
+00010e40: 0a20 2020 2022 7072 6f64 7563 7469 6f6e  .    "production
+00010e50: 7322 2c0a 2020 2020 2270 726f 6622 2c0a  s",.    "prof",.
+00010e60: 2020 2020 2270 726f 6772 6573 7369 7665      "progressive
+00010e70: 222c 0a20 2020 2022 7072 6f6d 6f22 2c0a  ",.    "promo",.
+00010e80: 2020 2020 2270 726f 7065 7274 6965 7322      "properties"
+00010e90: 2c0a 2020 2020 2270 726f 7065 7274 7922  ,.    "property"
+00010ea0: 2c0a 2020 2020 2270 726f 7465 6374 696f  ,.    "protectio
+00010eb0: 6e22 2c0a 2020 2020 2270 7275 222c 0a20  n",.    "pru",. 
+00010ec0: 2020 2022 7072 7564 656e 7469 616c 222c     "prudential",
+00010ed0: 0a20 2020 2022 7073 222c 0a20 2020 2022  .    "ps",.    "
+00010ee0: 7074 222c 0a20 2020 2022 7075 6222 2c0a  pt",.    "pub",.
+00010ef0: 2020 2020 2270 7722 2c0a 2020 2020 2270      "pw",.    "p
+00010f00: 7763 222c 0a20 2020 2022 7079 222c 0a20  wc",.    "py",. 
+00010f10: 2020 2023 2071 0a20 2020 2022 7161 222c     # q.    "qa",
+00010f20: 0a20 2020 2022 7170 6f6e 222c 0a20 2020  .    "qpon",.   
+00010f30: 2022 7175 6562 6563 222c 0a20 2020 2022   "quebec",.    "
+00010f40: 7175 6573 7422 2c0a 2020 2020 2271 7663  quest",.    "qvc
+00010f50: 222c 0a20 2020 2023 2072 0a20 2020 2022  ",.    # r.    "
+00010f60: 7261 6369 6e67 222c 0a20 2020 2022 7261  racing",.    "ra
+00010f70: 6469 6f22 2c0a 2020 2020 2272 6169 6422  dio",.    "raid"
+00010f80: 2c0a 2020 2020 2272 6522 2c0a 2020 2020  ,.    "re",.    
+00010f90: 2272 6561 6422 2c0a 2020 2020 2272 6561  "read",.    "rea
+00010fa0: 6c65 7374 6174 6522 2c0a 2020 2020 2272  lestate",.    "r
+00010fb0: 6561 6c74 6f72 222c 0a20 2020 2022 7265  ealtor",.    "re
+00010fc0: 616c 7479 222c 0a20 2020 2022 7265 6369  alty",.    "reci
+00010fd0: 7065 7322 2c0a 2020 2020 2272 6564 222c  pes",.    "red",
+00010fe0: 0a20 2020 2022 7265 6473 746f 6e65 222c  .    "redstone",
+00010ff0: 0a20 2020 2022 7265 6475 6d62 7265 6c6c  .    "redumbrell
+00011000: 6122 2c0a 2020 2020 2272 6568 6162 222c  a",.    "rehab",
+00011010: 0a20 2020 2022 7265 6973 6522 2c0a 2020  .    "reise",.  
+00011020: 2020 2272 6569 7365 6e22 2c0a 2020 2020    "reisen",.    
+00011030: 2272 6569 7422 2c0a 2020 2020 2272 656c  "reit",.    "rel
+00011040: 6961 6e63 6522 2c0a 2020 2020 2272 656e  iance",.    "ren
+00011050: 222c 0a20 2020 2022 7265 6e74 222c 0a20  ",.    "rent",. 
+00011060: 2020 2022 7265 6e74 616c 7322 2c0a 2020     "rentals",.  
+00011070: 2020 2272 6570 6169 7222 2c0a 2020 2020    "repair",.    
+00011080: 2272 6570 6f72 7422 2c0a 2020 2020 2272  "report",.    "r
+00011090: 6570 7562 6c69 6361 6e22 2c0a 2020 2020  epublican",.    
+000110a0: 2272 6573 7422 2c0a 2020 2020 2272 6573  "rest",.    "res
+000110b0: 7461 7572 616e 7422 2c0a 2020 2020 2272  taurant",.    "r
+000110c0: 6576 6965 7722 2c0a 2020 2020 2272 6576  eview",.    "rev
+000110d0: 6965 7773 222c 0a20 2020 2022 7265 7872  iews",.    "rexr
+000110e0: 6f74 6822 2c0a 2020 2020 2272 6963 6822  oth",.    "rich"
+000110f0: 2c0a 2020 2020 2272 6963 6861 7264 6c69  ,.    "richardli
+00011100: 222c 0a20 2020 2022 7269 636f 6822 2c0a  ",.    "ricoh",.
+00011110: 2020 2020 2272 6967 6874 6174 686f 6d65      "rightathome
+00011120: 222c 0a20 2020 2022 7269 6c22 2c0a 2020  ",.    "ril",.  
+00011130: 2020 2272 696f 222c 0a20 2020 2022 7269    "rio",.    "ri
+00011140: 7022 2c0a 2020 2020 2272 6d69 7422 2c0a  p",.    "rmit",.
+00011150: 2020 2020 2272 6f22 2c0a 2020 2020 2272      "ro",.    "r
+00011160: 6f63 6865 7222 2c0a 2020 2020 2272 6f63  ocher",.    "roc
+00011170: 6b73 222c 0a20 2020 2022 726f 6465 6f22  ks",.    "rodeo"
+00011180: 2c0a 2020 2020 2272 6f67 6572 7322 2c0a  ,.    "rogers",.
+00011190: 2020 2020 2272 6f6f 6d22 2c0a 2020 2020      "room",.    
+000111a0: 2272 7322 2c0a 2020 2020 2272 7376 7022  "rs",.    "rsvp"
+000111b0: 2c0a 2020 2020 2272 7522 2c0a 2020 2020  ,.    "ru",.    
+000111c0: 2272 7567 6279 222c 0a20 2020 2022 7275  "rugby",.    "ru
+000111d0: 6872 222c 0a20 2020 2022 7275 6e22 2c0a  hr",.    "run",.
+000111e0: 2020 2020 2272 7722 2c0a 2020 2020 2272      "rw",.    "r
+000111f0: 7765 222c 0a20 2020 2022 7279 756b 7975  we",.    "ryukyu
+00011200: 222c 0a20 2020 2023 2073 0a20 2020 2022  ",.    # s.    "
+00011210: 7361 222c 0a20 2020 2022 7361 6172 6c61  sa",.    "saarla
+00011220: 6e64 222c 0a20 2020 2022 7361 6665 222c  nd",.    "safe",
+00011230: 0a20 2020 2022 7361 6665 7479 222c 0a20  .    "safety",. 
+00011240: 2020 2022 7361 6b75 7261 222c 0a20 2020     "sakura",.   
+00011250: 2022 7361 6c65 222c 0a20 2020 2022 7361   "sale",.    "sa
+00011260: 6c6f 6e22 2c0a 2020 2020 2273 616d 7363  lon",.    "samsc
+00011270: 6c75 6222 2c0a 2020 2020 2273 616d 7375  lub",.    "samsu
+00011280: 6e67 222c 0a20 2020 2022 7361 6e64 7669  ng",.    "sandvi
+00011290: 6b22 2c0a 2020 2020 2273 616e 6476 696b  k",.    "sandvik
+000112a0: 636f 726f 6d61 6e74 222c 0a20 2020 2022  coromant",.    "
+000112b0: 7361 6e6f 6669 222c 0a20 2020 2022 7361  sanofi",.    "sa
+000112c0: 7022 2c0a 2020 2020 2273 6170 6f22 2c0a  p",.    "sapo",.
+000112d0: 2020 2020 2273 6172 6c22 2c0a 2020 2020      "sarl",.    
+000112e0: 2273 6173 222c 0a20 2020 2022 7361 7665  "sas",.    "save
+000112f0: 222c 0a20 2020 2022 7361 786f 222c 0a20  ",.    "saxo",. 
+00011300: 2020 2022 7362 222c 0a20 2020 2022 7362     "sb",.    "sb
+00011310: 6922 2c0a 2020 2020 2273 6273 222c 0a20  i",.    "sbs",. 
+00011320: 2020 2022 7363 222c 0a20 2020 2022 7363     "sc",.    "sc
+00011330: 6122 2c0a 2020 2020 2273 6362 222c 0a20  a",.    "scb",. 
+00011340: 2020 2022 7363 6861 6566 666c 6572 222c     "schaeffler",
+00011350: 0a20 2020 2022 7363 686d 6964 7422 2c0a  .    "schmidt",.
+00011360: 2020 2020 2273 6368 6f6c 6172 7368 6970      "scholarship
+00011370: 7322 2c0a 2020 2020 2273 6368 6f6f 6c22  s",.    "school"
+00011380: 2c0a 2020 2020 2273 6368 756c 6522 2c0a  ,.    "schule",.
+00011390: 2020 2020 2273 6368 7761 727a 222c 0a20      "schwarz",. 
+000113a0: 2020 2022 7363 6965 6e63 6522 2c0a 2020     "science",.  
+000113b0: 2020 2273 636a 6f68 6e73 6f6e 222c 0a20    "scjohnson",. 
+000113c0: 2020 2022 7363 6f72 222c 0a20 2020 2022     "scor",.    "
+000113d0: 7363 6f74 222c 0a20 2020 2022 7364 222c  scot",.    "sd",
+000113e0: 0a20 2020 2022 7365 222c 0a20 2020 2022  .    "se",.    "
+000113f0: 7365 6172 6368 222c 0a20 2020 2022 7365  search",.    "se
+00011400: 6174 222c 0a20 2020 2022 7365 6375 7265  at",.    "secure
+00011410: 222c 0a20 2020 2022 7365 6375 7269 7479  ",.    "security
+00011420: 222c 0a20 2020 2022 7365 656b 222c 0a20  ",.    "seek",. 
+00011430: 2020 2022 7365 6c65 6374 222c 0a20 2020     "select",.   
+00011440: 2022 7365 6e65 7222 2c0a 2020 2020 2273   "sener",.    "s
+00011450: 6572 7669 6365 7322 2c0a 2020 2020 2273  ervices",.    "s
+00011460: 6573 222c 0a20 2020 2022 7365 7665 6e22  es",.    "seven"
+00011470: 2c0a 2020 2020 2273 6577 222c 0a20 2020  ,.    "sew",.   
+00011480: 2022 7365 7822 2c0a 2020 2020 2273 6578   "sex",.    "sex
+00011490: 7922 2c0a 2020 2020 2273 6672 222c 0a20  y",.    "sfr",. 
+000114a0: 2020 2022 7367 222c 0a20 2020 2022 7368     "sg",.    "sh
+000114b0: 222c 0a20 2020 2022 7368 616e 6772 696c  ",.    "shangril
+000114c0: 6122 2c0a 2020 2020 2273 6861 7270 222c  a",.    "sharp",
+000114d0: 0a20 2020 2022 7368 6177 222c 0a20 2020  .    "shaw",.   
+000114e0: 2022 7368 656c 6c22 2c0a 2020 2020 2273   "shell",.    "s
+000114f0: 6869 6122 2c0a 2020 2020 2273 6869 6b73  hia",.    "shiks
+00011500: 6861 222c 0a20 2020 2022 7368 6f65 7322  ha",.    "shoes"
+00011510: 2c0a 2020 2020 2273 686f 7022 2c0a 2020  ,.    "shop",.  
+00011520: 2020 2273 686f 7070 696e 6722 2c0a 2020    "shopping",.  
+00011530: 2020 2273 686f 756a 6922 2c0a 2020 2020    "shouji",.    
+00011540: 2273 686f 7722 2c0a 2020 2020 2273 686f  "show",.    "sho
+00011550: 7774 696d 6522 2c0a 2020 2020 2273 6872  wtime",.    "shr
+00011560: 6972 616d 222c 0a20 2020 2022 7369 222c  iram",.    "si",
+00011570: 0a20 2020 2022 7369 6c6b 222c 0a20 2020  .    "silk",.   
+00011580: 2022 7369 6e61 222c 0a20 2020 2022 7369   "sina",.    "si
+00011590: 6e67 6c65 7322 2c0a 2020 2020 2273 6974  ngles",.    "sit
+000115a0: 6522 2c0a 2020 2020 2273 6a22 2c0a 2020  e",.    "sj",.  
+000115b0: 2020 2273 6b22 2c0a 2020 2020 2273 6b69    "sk",.    "ski
+000115c0: 222c 0a20 2020 2022 736b 696e 222c 0a20  ",.    "skin",. 
+000115d0: 2020 2022 736b 7922 2c0a 2020 2020 2273     "sky",.    "s
+000115e0: 6b79 7065 222c 0a20 2020 2022 736c 222c  kype",.    "sl",
+000115f0: 0a20 2020 2022 736c 696e 6722 2c0a 2020  .    "sling",.  
+00011600: 2020 2273 6d22 2c0a 2020 2020 2273 6d61    "sm",.    "sma
+00011610: 7274 222c 0a20 2020 2022 736d 696c 6522  rt",.    "smile"
+00011620: 2c0a 2020 2020 2273 6e22 2c0a 2020 2020  ,.    "sn",.    
+00011630: 2273 6e63 6622 2c0a 2020 2020 2273 6f22  "sncf",.    "so"
+00011640: 2c0a 2020 2020 2273 6f63 6365 7222 2c0a  ,.    "soccer",.
+00011650: 2020 2020 2273 6f63 6961 6c22 2c0a 2020      "social",.  
+00011660: 2020 2273 6f66 7462 616e 6b22 2c0a 2020    "softbank",.  
+00011670: 2020 2273 6f66 7477 6172 6522 2c0a 2020    "software",.  
+00011680: 2020 2273 6f68 7522 2c0a 2020 2020 2273    "sohu",.    "s
+00011690: 6f6c 6172 222c 0a20 2020 2022 736f 6c75  olar",.    "solu
+000116a0: 7469 6f6e 7322 2c0a 2020 2020 2273 6f6e  tions",.    "son
+000116b0: 6722 2c0a 2020 2020 2273 6f6e 7922 2c0a  g",.    "sony",.
+000116c0: 2020 2020 2273 6f79 222c 0a20 2020 2022      "soy",.    "
+000116d0: 7370 6163 6522 2c0a 2020 2020 2273 7069  space",.    "spi
+000116e0: 6567 656c 222c 0a20 2020 2022 7370 6f74  egel",.    "spot
+000116f0: 222c 0a20 2020 2022 7370 7265 6164 6265  ",.    "spreadbe
+00011700: 7474 696e 6722 2c0a 2020 2020 2273 7222  tting",.    "sr"
+00011710: 2c0a 2020 2020 2273 726c 222c 0a20 2020  ,.    "srl",.   
+00011720: 2022 7372 7422 2c0a 2020 2020 2273 7422   "srt",.    "st"
+00011730: 2c0a 2020 2020 2273 7461 6461 222c 0a20  ,.    "stada",. 
+00011740: 2020 2022 7374 6170 6c65 7322 2c0a 2020     "staples",.  
+00011750: 2020 2273 7461 7222 2c0a 2020 2020 2273    "star",.    "s
+00011760: 7461 7268 7562 222c 0a20 2020 2022 7374  tarhub",.    "st
+00011770: 6174 6562 616e 6b22 2c0a 2020 2020 2273  atebank",.    "s
+00011780: 7461 7465 6661 726d 222c 0a20 2020 2022  tatefarm",.    "
+00011790: 7374 6174 6f69 6c22 2c0a 2020 2020 2273  statoil",.    "s
+000117a0: 7463 222c 0a20 2020 2022 7374 6367 726f  tc",.    "stcgro
+000117b0: 7570 222c 0a20 2020 2022 7374 6f63 6b68  up",.    "stockh
+000117c0: 6f6c 6d22 2c0a 2020 2020 2273 746f 7261  olm",.    "stora
+000117d0: 6765 222c 0a20 2020 2022 7374 6f72 6522  ge",.    "store"
+000117e0: 2c0a 2020 2020 2273 7472 6561 6d22 2c0a  ,.    "stream",.
+000117f0: 2020 2020 2273 7475 6469 6f22 2c0a 2020      "studio",.  
+00011800: 2020 2273 7475 6479 222c 0a20 2020 2022    "study",.    "
+00011810: 7374 796c 6522 2c0a 2020 2020 2273 7522  style",.    "su"
+00011820: 2c0a 2020 2020 2273 7563 6b73 222c 0a20  ,.    "sucks",. 
+00011830: 2020 2022 7375 7070 6c69 6573 222c 0a20     "supplies",. 
+00011840: 2020 2022 7375 7070 6c79 222c 0a20 2020     "supply",.   
+00011850: 2022 7375 7070 6f72 7422 2c0a 2020 2020   "support",.    
+00011860: 2273 7572 6622 2c0a 2020 2020 2273 7572  "surf",.    "sur
+00011870: 6765 7279 222c 0a20 2020 2022 7375 7a75  gery",.    "suzu
+00011880: 6b69 222c 0a20 2020 2022 7376 222c 0a20  ki",.    "sv",. 
+00011890: 2020 2022 7377 6174 6368 222c 0a20 2020     "swatch",.   
+000118a0: 2022 7377 6966 7463 6f76 6572 222c 0a20   "swiftcover",. 
+000118b0: 2020 2022 7377 6973 7322 2c0a 2020 2020     "swiss",.    
+000118c0: 2273 7822 2c0a 2020 2020 2273 7922 2c0a  "sx",.    "sy",.
+000118d0: 2020 2020 2273 7964 6e65 7922 2c0a 2020      "sydney",.  
+000118e0: 2020 2273 796d 616e 7465 6322 2c0a 2020    "symantec",.  
+000118f0: 2020 2273 7973 7465 6d73 222c 0a20 2020    "systems",.   
+00011900: 2022 737a 222c 0a20 2020 2023 2074 0a20   "sz",.    # t. 
+00011910: 2020 2022 7461 6222 2c0a 2020 2020 2274     "tab",.    "t
+00011920: 6169 7065 6922 2c0a 2020 2020 2274 616c  aipei",.    "tal
+00011930: 6b22 2c0a 2020 2020 2274 616f 6261 6f22  k",.    "taobao"
+00011940: 2c0a 2020 2020 2274 6172 6765 7422 2c0a  ,.    "target",.
+00011950: 2020 2020 2274 6174 616d 6f74 6f72 7322      "tatamotors"
+00011960: 2c0a 2020 2020 2274 6174 6172 222c 0a20  ,.    "tatar",. 
+00011970: 2020 2022 7461 7474 6f6f 222c 0a20 2020     "tattoo",.   
+00011980: 2022 7461 7822 2c0a 2020 2020 2274 6178   "tax",.    "tax
+00011990: 6922 2c0a 2020 2020 2274 6322 2c0a 2020  i",.    "tc",.  
+000119a0: 2020 2274 6369 222c 0a20 2020 2022 7464    "tci",.    "td
+000119b0: 222c 0a20 2020 2022 7464 6b22 2c0a 2020  ",.    "tdk",.  
+000119c0: 2020 2274 6561 6d22 2c0a 2020 2020 2274    "team",.    "t
+000119d0: 6563 6822 2c0a 2020 2020 2274 6563 686e  ech",.    "techn
+000119e0: 6f6c 6f67 7922 2c0a 2020 2020 2274 656c  ology",.    "tel
+000119f0: 222c 0a20 2020 2022 7465 6c65 6369 7479  ",.    "telecity
+00011a00: 222c 0a20 2020 2022 7465 6c65 666f 6e69  ",.    "telefoni
+00011a10: 6361 222c 0a20 2020 2022 7465 6d61 7365  ca",.    "temase
+00011a20: 6b22 2c0a 2020 2020 2274 656e 6e69 7322  k",.    "tennis"
+00011a30: 2c0a 2020 2020 2274 6576 6122 2c0a 2020  ,.    "teva",.  
+00011a40: 2020 2274 6622 2c0a 2020 2020 2274 6722    "tf",.    "tg"
+00011a50: 2c0a 2020 2020 2274 6822 2c0a 2020 2020  ,.    "th",.    
+00011a60: 2274 6864 222c 0a20 2020 2022 7468 6561  "thd",.    "thea
+00011a70: 7465 7222 2c0a 2020 2020 2274 6865 6174  ter",.    "theat
+00011a80: 7265 222c 0a20 2020 2022 7469 6161 222c  re",.    "tiaa",
+00011a90: 0a20 2020 2022 7469 636b 6574 7322 2c0a  .    "tickets",.
+00011aa0: 2020 2020 2274 6965 6e64 6122 2c0a 2020      "tienda",.  
+00011ab0: 2020 2274 6966 6661 6e79 222c 0a20 2020    "tiffany",.   
+00011ac0: 2022 7469 7073 222c 0a20 2020 2022 7469   "tips",.    "ti
+00011ad0: 7265 7322 2c0a 2020 2020 2274 6972 6f6c  res",.    "tirol
+00011ae0: 222c 0a20 2020 2022 746a 222c 0a20 2020  ",.    "tj",.   
+00011af0: 2022 746a 6d61 7878 222c 0a20 2020 2022   "tjmaxx",.    "
+00011b00: 746a 7822 2c0a 2020 2020 2274 6b22 2c0a  tjx",.    "tk",.
+00011b10: 2020 2020 2274 6b6d 6178 7822 2c0a 2020      "tkmaxx",.  
+00011b20: 2020 2274 6c22 2c0a 2020 2020 2274 6d22    "tl",.    "tm"
+00011b30: 2c0a 2020 2020 2274 6d61 6c6c 222c 0a20  ,.    "tmall",. 
+00011b40: 2020 2022 746e 222c 0a20 2020 2022 746f     "tn",.    "to
+00011b50: 222c 0a20 2020 2022 746f 6461 7922 2c0a  ",.    "today",.
+00011b60: 2020 2020 2274 6f6b 796f 222c 0a20 2020      "tokyo",.   
+00011b70: 2022 746f 6f6c 7322 2c0a 2020 2020 2274   "tools",.    "t
+00011b80: 6f70 222c 0a20 2020 2022 746f 7261 7922  op",.    "toray"
+00011b90: 2c0a 2020 2020 2274 6f73 6869 6261 222c  ,.    "toshiba",
+00011ba0: 0a20 2020 2022 746f 7461 6c22 2c0a 2020  .    "total",.  
+00011bb0: 2020 2274 6f75 7273 222c 0a20 2020 2022    "tours",.    "
+00011bc0: 746f 776e 222c 0a20 2020 2022 746f 796f  town",.    "toyo
+00011bd0: 7461 222c 0a20 2020 2022 746f 7973 222c  ta",.    "toys",
+00011be0: 0a20 2020 2022 7472 222c 0a20 2020 2022  .    "tr",.    "
+00011bf0: 7472 6164 6522 2c0a 2020 2020 2274 7261  trade",.    "tra
+00011c00: 6469 6e67 222c 0a20 2020 2022 7472 6169  ding",.    "trai
+00011c10: 6e69 6e67 222c 0a20 2020 2022 7472 6176  ning",.    "trav
+00011c20: 656c 222c 0a20 2020 2022 7472 6176 656c  el",.    "travel
+00011c30: 6368 616e 6e65 6c22 2c0a 2020 2020 2274  channel",.    "t
+00011c40: 7261 7665 6c65 7273 222c 0a20 2020 2022  ravelers",.    "
+00011c50: 7472 6176 656c 6572 7369 6e73 7572 616e  travelersinsuran
+00011c60: 6365 222c 0a20 2020 2022 7472 7573 7422  ce",.    "trust"
+00011c70: 2c0a 2020 2020 2274 7276 222c 0a20 2020  ,.    "trv",.   
+00011c80: 2022 7474 222c 0a20 2020 2022 7475 6265   "tt",.    "tube
+00011c90: 222c 0a20 2020 2022 7475 6922 2c0a 2020  ",.    "tui",.  
+00011ca0: 2020 2274 756e 6573 222c 0a20 2020 2022    "tunes",.    "
+00011cb0: 7475 7368 7522 2c0a 2020 2020 2274 7622  tushu",.    "tv"
+00011cc0: 2c0a 2020 2020 2274 7673 222c 0a20 2020  ,.    "tvs",.   
+00011cd0: 2022 7477 222c 0a20 2020 2022 747a 222c   "tw",.    "tz",
+00011ce0: 0a20 2020 2023 2075 0a20 2020 2022 7561  .    # u.    "ua
+00011cf0: 222c 0a20 2020 2022 7562 616e 6b22 2c0a  ",.    "ubank",.
+00011d00: 2020 2020 2275 6273 222c 0a20 2020 2022      "ubs",.    "
+00011d10: 7563 6f6e 6e65 6374 222c 0a20 2020 2022  uconnect",.    "
+00011d20: 7567 222c 0a20 2020 2022 756b 222c 0a20  ug",.    "uk",. 
+00011d30: 2020 2022 756e 6963 6f6d 222c 0a20 2020     "unicom",.   
+00011d40: 2022 756e 6976 6572 7369 7479 222c 0a20   "university",. 
+00011d50: 2020 2022 756e 6f22 2c0a 2020 2020 2275     "uno",.    "u
+00011d60: 6f6c 222c 0a20 2020 2022 7570 7322 2c0a  ol",.    "ups",.
+00011d70: 2020 2020 2275 7322 2c0a 2020 2020 2275      "us",.    "u
+00011d80: 7922 2c0a 2020 2020 2275 7a22 2c0a 2020  y",.    "uz",.  
+00011d90: 2020 2320 760a 2020 2020 2276 6122 2c0a    # v.    "va",.
+00011da0: 2020 2020 2276 6163 6174 696f 6e73 222c      "vacations",
+00011db0: 0a20 2020 2022 7661 6e61 222c 0a20 2020  .    "vana",.   
+00011dc0: 2022 7661 6e67 7561 7264 222c 0a20 2020   "vanguard",.   
+00011dd0: 2022 7663 222c 0a20 2020 2022 7665 222c   "vc",.    "ve",
+00011de0: 0a20 2020 2022 7665 6761 7322 2c0a 2020  .    "vegas",.  
+00011df0: 2020 2276 656e 7475 7265 7322 2c0a 2020    "ventures",.  
+00011e00: 2020 2276 6572 6973 6967 6e22 2c0a 2020    "verisign",.  
+00011e10: 2020 2276 6572 7369 6368 6572 756e 6722    "versicherung"
+00011e20: 2c0a 2020 2020 2276 6574 222c 0a20 2020  ,.    "vet",.   
+00011e30: 2022 7667 222c 0a20 2020 2022 7669 222c   "vg",.    "vi",
+00011e40: 0a20 2020 2022 7669 616a 6573 222c 0a20  .    "viajes",. 
+00011e50: 2020 2022 7669 6465 6f22 2c0a 2020 2020     "video",.    
+00011e60: 2276 6967 222c 0a20 2020 2022 7669 6b69  "vig",.    "viki
+00011e70: 6e67 222c 0a20 2020 2022 7669 6c6c 6173  ng",.    "villas
+00011e80: 222c 0a20 2020 2022 7669 6e22 2c0a 2020  ",.    "vin",.  
+00011e90: 2020 2276 6970 222c 0a20 2020 2022 7669    "vip",.    "vi
+00011ea0: 7267 696e 222c 0a20 2020 2022 7669 7361  rgin",.    "visa
+00011eb0: 222c 0a20 2020 2022 7669 7369 6f6e 222c  ",.    "vision",
+00011ec0: 0a20 2020 2022 7669 7374 6122 2c0a 2020  .    "vista",.  
+00011ed0: 2020 2276 6973 7461 7072 696e 7422 2c0a    "vistaprint",.
+00011ee0: 2020 2020 2276 6976 6122 2c0a 2020 2020      "viva",.    
+00011ef0: 2276 6976 6f22 2c0a 2020 2020 2276 6c61  "vivo",.    "vla
+00011f00: 616e 6465 7265 6e22 2c0a 2020 2020 2276  anderen",.    "v
+00011f10: 6e22 2c0a 2020 2020 2276 6f64 6b61 222c  n",.    "vodka",
+00011f20: 0a20 2020 2022 766f 6c6b 7377 6167 656e  .    "volkswagen
+00011f30: 222c 0a20 2020 2022 766f 6c76 6f22 2c0a  ",.    "volvo",.
+00011f40: 2020 2020 2276 6f74 6522 2c0a 2020 2020      "vote",.    
+00011f50: 2276 6f74 696e 6722 2c0a 2020 2020 2276  "voting",.    "v
+00011f60: 6f74 6f22 2c0a 2020 2020 2276 6f79 6167  oto",.    "voyag
+00011f70: 6522 2c0a 2020 2020 2276 7522 2c0a 2020  e",.    "vu",.  
+00011f80: 2020 2276 7565 6c6f 7322 2c0a 2020 2020    "vuelos",.    
+00011f90: 2320 770a 2020 2020 2277 616c 6573 222c  # w.    "wales",
+00011fa0: 0a20 2020 2022 7761 6c6d 6172 7422 2c0a  .    "walmart",.
+00011fb0: 2020 2020 2277 616c 7465 7222 2c0a 2020      "walter",.  
+00011fc0: 2020 2277 616e 6722 2c0a 2020 2020 2277    "wang",.    "w
+00011fd0: 616e 6767 6f75 222c 0a20 2020 2022 7761  anggou",.    "wa
+00011fe0: 726d 616e 222c 0a20 2020 2022 7761 7463  rman",.    "watc
+00011ff0: 6822 2c0a 2020 2020 2277 6174 6368 6573  h",.    "watches
+00012000: 222c 0a20 2020 2022 7765 6174 6865 7222  ",.    "weather"
+00012010: 2c0a 2020 2020 2277 6561 7468 6572 6368  ,.    "weatherch
+00012020: 616e 6e65 6c22 2c0a 2020 2020 2277 6562  annel",.    "web
+00012030: 6361 6d22 2c0a 2020 2020 2277 6562 6572  cam",.    "weber
+00012040: 222c 0a20 2020 2022 7765 6273 6974 6522  ",.    "website"
+00012050: 2c0a 2020 2020 2277 6564 222c 0a20 2020  ,.    "wed",.   
+00012060: 2022 7765 6464 696e 6722 2c0a 2020 2020   "wedding",.    
+00012070: 2277 6569 626f 222c 0a20 2020 2022 7765  "weibo",.    "we
+00012080: 6972 222c 0a20 2020 2022 7766 222c 0a20  ir",.    "wf",. 
+00012090: 2020 2022 7768 6f73 7768 6f22 2c0a 2020     "whoswho",.  
+000120a0: 2020 2277 6965 6e22 2c0a 2020 2020 2277    "wien",.    "w
+000120b0: 696b 6922 2c0a 2020 2020 2277 696c 6c69  iki",.    "willi
+000120c0: 616d 6869 6c6c 222c 0a20 2020 2022 7769  amhill",.    "wi
+000120d0: 6e22 2c0a 2020 2020 2277 696e 646f 7773  n",.    "windows
+000120e0: 222c 0a20 2020 2022 7769 6e65 222c 0a20  ",.    "wine",. 
+000120f0: 2020 2022 7769 6e6e 6572 7322 2c0a 2020     "winners",.  
+00012100: 2020 2277 6d65 222c 0a20 2020 2022 776f    "wme",.    "wo
+00012110: 6c74 6572 736b 6c75 7765 7222 2c0a 2020  lterskluwer",.  
+00012120: 2020 2277 6f6f 6473 6964 6522 2c0a 2020    "woodside",.  
+00012130: 2020 2277 6f72 6b22 2c0a 2020 2020 2277    "work",.    "w
+00012140: 6f72 6b73 222c 0a20 2020 2022 776f 726c  orks",.    "worl
+00012150: 6422 2c0a 2020 2020 2277 6f77 222c 0a20  d",.    "wow",. 
+00012160: 2020 2022 7773 222c 0a20 2020 2022 7774     "ws",.    "wt
+00012170: 6322 2c0a 2020 2020 2277 7466 222c 0a20  c",.    "wtf",. 
+00012180: 2020 2023 2078 0a20 2020 2022 7862 6f78     # x.    "xbox
+00012190: 222c 0a20 2020 2022 7865 726f 7822 2c0a  ",.    "xerox",.
+000121a0: 2020 2020 2278 6669 6e69 7479 222c 0a20      "xfinity",. 
+000121b0: 2020 2022 7869 6875 616e 222c 0a20 2020     "xihuan",.   
+000121c0: 2022 7869 6e22 2c0a 2020 2020 2278 6e2d   "xin",.    "xn-
+000121d0: 2d31 3162 3463 3364 222c 0a20 2020 2022  -11b4c3d",.    "
+000121e0: 786e 2d2d 3163 6b32 6531 6222 2c0a 2020  xn--1ck2e1b",.  
+000121f0: 2020 2278 6e2d 2d31 7171 7732 3361 222c    "xn--1qqw23a",
+00012200: 0a20 2020 2022 786e 2d2d 3273 6372 6a39  .    "xn--2scrj9
+00012210: 6322 2c0a 2020 2020 2278 6e2d 2d33 3072  c",.    "xn--30r
+00012220: 7237 7922 2c0a 2020 2020 2278 6e2d 2d33  r7y",.    "xn--3
+00012230: 6273 7430 306d 222c 0a20 2020 2022 786e  bst00m",.    "xn
+00012240: 2d2d 3364 7334 3433 6722 2c0a 2020 2020  --3ds443g",.    
+00012250: 2278 6e2d 2d33 6530 6237 3037 6522 2c0a  "xn--3e0b707e",.
+00012260: 2020 2020 2278 6e2d 2d33 6863 726a 3963      "xn--3hcrj9c
+00012270: 222c 0a20 2020 2022 786e 2d2d 336f 7131  ",.    "xn--3oq1
+00012280: 3876 6c38 706e 3336 6122 2c0a 2020 2020  8vl8pn36a",.    
+00012290: 2278 6e2d 2d33 7078 7538 6b22 2c0a 2020  "xn--3pxu8k",.  
+000122a0: 2020 2278 6e2d 2d34 3263 3264 3961 222c    "xn--42c2d9a",
+000122b0: 0a20 2020 2022 786e 2d2d 3435 6272 3563  .    "xn--45br5c
+000122c0: 796c 222c 0a20 2020 2022 786e 2d2d 3435  yl",.    "xn--45
+000122d0: 6272 6a39 6322 2c0a 2020 2020 2278 6e2d  brj9c",.    "xn-
+000122e0: 2d34 3571 3131 6322 2c0a 2020 2020 2278  -45q11c",.    "x
+000122f0: 6e2d 2d34 6762 7269 6d22 2c0a 2020 2020  n--4gbrim",.    
+00012300: 2278 6e2d 2d35 3462 3766 7461 3063 6322  "xn--54b7fta0cc"
+00012310: 2c0a 2020 2020 2278 6e2d 2d35 3571 7734  ,.    "xn--55qw4
+00012320: 3267 222c 0a20 2020 2022 786e 2d2d 3535  2g",.    "xn--55
+00012330: 7178 3564 222c 0a20 2020 2022 786e 2d2d  qx5d",.    "xn--
+00012340: 3573 7533 346a 3933 3662 6773 6722 2c0a  5su34j936bgsg",.
+00012350: 2020 2020 2278 6e2d 2d35 747a 6d35 6722      "xn--5tzm5g"
+00012360: 2c0a 2020 2020 2278 6e2d 2d36 6672 7a38  ,.    "xn--6frz8
+00012370: 3267 222c 0a20 2020 2022 786e 2d2d 3671  2g",.    "xn--6q
+00012380: 7139 3836 6233 786c 222c 0a20 2020 2022  q986b3xl",.    "
+00012390: 786e 2d2d 3830 6164 7868 6b73 222c 0a20  xn--80adxhks",. 
+000123a0: 2020 2022 786e 2d2d 3830 616f 3231 6122     "xn--80ao21a"
+000123b0: 2c0a 2020 2020 2278 6e2d 2d38 3061 7165  ,.    "xn--80aqe
+000123c0: 6364 7231 6122 2c0a 2020 2020 2278 6e2d  cdr1a",.    "xn-
+000123d0: 2d38 3061 7365 6864 6222 2c0a 2020 2020  -80asehdb",.    
+000123e0: 2278 6e2d 2d38 3061 7377 6722 2c0a 2020  "xn--80aswg",.  
+000123f0: 2020 2278 6e2d 2d38 7930 6130 3633 6122    "xn--8y0a063a"
+00012400: 2c0a 2020 2020 2278 6e2d 2d39 3061 3361  ,.    "xn--90a3a
+00012410: 6322 2c0a 2020 2020 2278 6e2d 2d39 3061  c",.    "xn--90a
+00012420: 6522 2c0a 2020 2020 2278 6e2d 2d39 3061  e",.    "xn--90a
+00012430: 6973 222c 0a20 2020 2022 786e 2d2d 3964  is",.    "xn--9d
+00012440: 6271 3261 222c 0a20 2020 2022 786e 2d2d  bq2a",.    "xn--
+00012450: 3965 7435 3275 222c 0a20 2020 2022 786e  9et52u",.    "xn
+00012460: 2d2d 396b 7274 3030 6122 2c0a 2020 2020  --9krt00a",.    
+00012470: 2278 6e2d 2d62 3477 3630 3566 6572 6422  "xn--b4w605ferd"
+00012480: 2c0a 2020 2020 2278 6e2d 2d62 636b 3162  ,.    "xn--bck1b
+00012490: 3961 3564 7265 3463 222c 0a20 2020 2022  9a5dre4c",.    "
+000124a0: 786e 2d2d 6331 6176 6722 2c0a 2020 2020  xn--c1avg",.    
+000124b0: 2278 6e2d 2d63 3262 7237 6722 2c0a 2020  "xn--c2br7g",.  
+000124c0: 2020 2278 6e2d 2d63 636b 3262 3362 222c    "xn--cck2b3b",
+000124d0: 0a20 2020 2022 786e 2d2d 6367 3462 6b69  .    "xn--cg4bki
+000124e0: 222c 0a20 2020 2022 786e 2d2d 636c 6368  ",.    "xn--clch
+000124f0: 6330 6561 3062 3267 3261 3967 6364 222c  c0ea0b2g2a9gcd",
+00012500: 0a20 2020 2022 786e 2d2d 637a 7236 3934  .    "xn--czr694
+00012510: 6222 2c0a 2020 2020 2278 6e2d 2d63 7a72  b",.    "xn--czr
+00012520: 7330 7422 2c0a 2020 2020 2278 6e2d 2d63  s0t",.    "xn--c
+00012530: 7a72 7532 6422 2c0a 2020 2020 2278 6e2d  zru2d",.    "xn-
+00012540: 2d64 3161 636a 3362 222c 0a20 2020 2022  -d1acj3b",.    "
+00012550: 786e 2d2d 6431 616c 6622 2c0a 2020 2020  xn--d1alf",.    
+00012560: 2278 6e2d 2d65 3161 3463 222c 0a20 2020  "xn--e1a4c",.   
+00012570: 2022 786e 2d2d 6563 6b76 6474 6339 6422   "xn--eckvdtc9d"
+00012580: 2c0a 2020 2020 2278 6e2d 2d65 6676 7938  ,.    "xn--efvy8
+00012590: 3868 222c 0a20 2020 2022 786e 2d2d 6573  8h",.    "xn--es
+000125a0: 7476 3735 6722 2c0a 2020 2020 2278 6e2d  tv75g",.    "xn-
+000125b0: 2d66 6374 3432 396b 222c 0a20 2020 2022  -fct429k",.    "
+000125c0: 786e 2d2d 6668 6265 6922 2c0a 2020 2020  xn--fhbei",.    
+000125d0: 2278 6e2d 2d66 6971 3232 3863 3568 7322  "xn--fiq228c5hs"
+000125e0: 2c0a 2020 2020 2278 6e2d 2d66 6971 3634  ,.    "xn--fiq64
+000125f0: 6222 2c0a 2020 2020 2278 6e2d 2d66 6971  b",.    "xn--fiq
+00012600: 7338 7322 2c0a 2020 2020 2278 6e2d 2d66  s8s",.    "xn--f
+00012610: 6971 7a39 7322 2c0a 2020 2020 2278 6e2d  iqz9s",.    "xn-
+00012620: 2d66 6a71 3732 3061 222c 0a20 2020 2022  -fjq720a",.    "
+00012630: 786e 2d2d 666c 7733 3531 6522 2c0a 2020  xn--flw351e",.  
+00012640: 2020 2278 6e2d 2d66 7063 726a 3963 3364    "xn--fpcrj9c3d
+00012650: 222c 0a20 2020 2022 786e 2d2d 667a 6332  ",.    "xn--fzc2
+00012660: 6339 6532 6322 2c0a 2020 2020 2278 6e2d  c9e2c",.    "xn-
+00012670: 2d66 7a79 7338 6436 3975 7667 6d22 2c0a  -fzys8d69uvgm",.
+00012680: 2020 2020 2278 6e2d 2d67 3278 7834 3863      "xn--g2xx48c
+00012690: 222c 0a20 2020 2022 786e 2d2d 6763 6b72  ",.    "xn--gckr
+000126a0: 3366 3066 222c 0a20 2020 2022 786e 2d2d  3f0f",.    "xn--
+000126b0: 6765 6372 6a39 6322 2c0a 2020 2020 2278  gecrj9c",.    "x
+000126c0: 6e2d 2d67 6b33 6174 3165 222c 0a20 2020  n--gk3at1e",.   
+000126d0: 2022 786e 2d2d 6832 6272 6567 3365 7665   "xn--h2breg3eve
+000126e0: 222c 0a20 2020 2022 786e 2d2d 6832 6272  ",.    "xn--h2br
+000126f0: 6a39 6322 2c0a 2020 2020 2278 6e2d 2d68  j9c",.    "xn--h
+00012700: 3262 726a 3963 3863 222c 0a20 2020 2022  2brj9c8c",.    "
+00012710: 786e 2d2d 6878 7438 3134 6522 2c0a 2020  xn--hxt814e",.  
+00012720: 2020 2278 6e2d 2d69 3162 3662 3161 3661    "xn--i1b6b1a6a
+00012730: 3265 222c 0a20 2020 2022 786e 2d2d 696d  2e",.    "xn--im
+00012740: 7235 3133 6e22 2c0a 2020 2020 2278 6e2d  r513n",.    "xn-
+00012750: 2d69 6f30 6137 6922 2c0a 2020 2020 2278  -io0a7i",.    "x
+00012760: 6e2d 2d6a 3161 6566 222c 0a20 2020 2022  n--j1aef",.    "
+00012770: 786e 2d2d 6a31 616d 6822 2c0a 2020 2020  xn--j1amh",.    
+00012780: 2278 6e2d 2d6a 3677 3139 3367 222c 0a20  "xn--j6w193g",. 
+00012790: 2020 2022 786e 2d2d 6a6c 7136 3175 3977     "xn--jlq61u9w
+000127a0: 3762 222c 0a20 2020 2022 786e 2d2d 6a76  7b",.    "xn--jv
+000127b0: 7231 3839 6d22 2c0a 2020 2020 2278 6e2d  r189m",.    "xn-
+000127c0: 2d6b 6372 7837 3764 3178 3461 222c 0a20  -kcrx77d1x4a",. 
+000127d0: 2020 2022 786e 2d2d 6b70 7277 3133 6422     "xn--kprw13d"
+000127e0: 2c0a 2020 2020 2278 6e2d 2d6b 7072 7935  ,.    "xn--kpry5
+000127f0: 3764 222c 0a20 2020 2022 786e 2d2d 6b70  7d",.    "xn--kp
+00012800: 7537 3136 6622 2c0a 2020 2020 2278 6e2d  u716f",.    "xn-
+00012810: 2d6b 7075 7433 6922 2c0a 2020 2020 2278  -kput3i",.    "x
+00012820: 6e2d 2d6c 3161 6363 222c 0a20 2020 2022  n--l1acc",.    "
+00012830: 786e 2d2d 6c67 6262 6174 3161 6438 6a22  xn--lgbbat1ad8j"
+00012840: 2c0a 2020 2020 2278 6e2d 2d6d 6762 3961  ,.    "xn--mgb9a
+00012850: 7762 6622 2c0a 2020 2020 2278 6e2d 2d6d  wbf",.    "xn--m
+00012860: 6762 6133 6133 656a 7422 2c0a 2020 2020  gba3a3ejt",.    
+00012870: 2278 6e2d 2d6d 6762 6133 6134 6631 3661  "xn--mgba3a4f16a
+00012880: 222c 0a20 2020 2022 786e 2d2d 6d67 6261  ",.    "xn--mgba
+00012890: 3763 3062 626e 3061 222c 0a20 2020 2022  7c0bbn0a",.    "
+000128a0: 786e 2d2d 6d67 6261 616b 6337 6476 6622  xn--mgbaakc7dvf"
+000128b0: 2c0a 2020 2020 2278 6e2d 2d6d 6762 6161  ,.    "xn--mgbaa
+000128c0: 6d37 6138 6822 2c0a 2020 2020 2278 6e2d  m7a8h",.    "xn-
+000128d0: 2d6d 6762 6162 3262 6422 2c0a 2020 2020  -mgbab2bd",.    
+000128e0: 2278 6e2d 2d6d 6762 6169 3961 7a67 7170  "xn--mgbai9azgqp
+000128f0: 366a 222c 0a20 2020 2022 786e 2d2d 6d67  6j",.    "xn--mg
+00012900: 6261 7968 3767 7061 222c 0a20 2020 2022  bayh7gpa",.    "
+00012910: 786e 2d2d 6d67 6262 3966 6270 6f62 222c  xn--mgbb9fbpob",
+00012920: 0a20 2020 2022 786e 2d2d 6d67 6262 6831  .    "xn--mgbbh1
+00012930: 6122 2c0a 2020 2020 2278 6e2d 2d6d 6762  a",.    "xn--mgb
+00012940: 6268 3161 3731 6522 2c0a 2020 2020 2278  bh1a71e",.    "x
+00012950: 6e2d 2d6d 6762 6330 6139 617a 6367 222c  n--mgbc0a9azcg",
+00012960: 0a20 2020 2022 786e 2d2d 6d67 6263 6137  .    "xn--mgbca7
+00012970: 647a 646f 222c 0a20 2020 2022 786e 2d2d  dzdo",.    "xn--
+00012980: 6d67 6265 7270 3461 3564 3461 7222 2c0a  mgberp4a5d4ar",.
+00012990: 2020 2020 2278 6e2d 2d6d 6762 6775 3832      "xn--mgbgu82
+000129a0: 6122 2c0a 2020 2020 2278 6e2d 2d6d 6762  a",.    "xn--mgb
+000129b0: 6934 6563 6578 7022 2c0a 2020 2020 2278  i4ecexp",.    "x
+000129c0: 6e2d 2d6d 6762 706c 3266 6822 2c0a 2020  n--mgbpl2fh",.  
+000129d0: 2020 2278 6e2d 2d6d 6762 7433 6468 6422    "xn--mgbt3dhd"
+000129e0: 2c0a 2020 2020 2278 6e2d 2d6d 6762 7478  ,.    "xn--mgbtx
+000129f0: 3262 222c 0a20 2020 2022 786e 2d2d 6d67  2b",.    "xn--mg
+00012a00: 6278 3463 6430 6162 222c 0a20 2020 2022  bx4cd0ab",.    "
+00012a10: 786e 2d2d 6d69 7838 3931 6622 2c0a 2020  xn--mix891f",.  
+00012a20: 2020 2278 6e2d 2d6d 6b31 6275 3434 6322    "xn--mk1bu44c"
+00012a30: 2c0a 2020 2020 2278 6e2d 2d6d 7874 7131  ,.    "xn--mxtq1
+00012a40: 6d22 2c0a 2020 2020 2278 6e2d 2d6e 6762  m",.    "xn--ngb
+00012a50: 6335 617a 6422 2c0a 2020 2020 2278 6e2d  c5azd",.    "xn-
+00012a60: 2d6e 6762 6539 6530 6122 2c0a 2020 2020  -ngbe9e0a",.    
+00012a70: 2278 6e2d 2d6e 6762 7278 222c 0a20 2020  "xn--ngbrx",.   
+00012a80: 2022 786e 2d2d 6e6f 6465 222c 0a20 2020   "xn--node",.   
+00012a90: 2022 786e 2d2d 6e71 7637 6622 2c0a 2020   "xn--nqv7f",.  
+00012aa0: 2020 2278 6e2d 2d6e 7176 3766 7330 3065    "xn--nqv7fs00e
+00012ab0: 6d61 222c 0a20 2020 2022 786e 2d2d 6e79  ma",.    "xn--ny
+00012ac0: 7179 3236 6122 2c0a 2020 2020 2278 6e2d  qy26a",.    "xn-
+00012ad0: 2d6f 3363 7734 6822 2c0a 2020 2020 2278  -o3cw4h",.    "x
+00012ae0: 6e2d 2d6f 6762 7066 3866 6c22 2c0a 2020  n--ogbpf8fl",.  
+00012af0: 2020 2278 6e2d 2d70 3161 6366 222c 0a20    "xn--p1acf",. 
+00012b00: 2020 2022 786e 2d2d 7031 6169 222c 0a20     "xn--p1ai",. 
+00012b10: 2020 2022 786e 2d2d 7062 7439 3737 6322     "xn--pbt977c"
+00012b20: 2c0a 2020 2020 2278 6e2d 2d70 6762 7330  ,.    "xn--pgbs0
+00012b30: 6468 222c 0a20 2020 2022 786e 2d2d 7073  dh",.    "xn--ps
+00012b40: 7379 3275 222c 0a20 2020 2022 786e 2d2d  sy2u",.    "xn--
+00012b50: 7139 6a79 6234 6322 2c0a 2020 2020 2278  q9jyb4c",.    "x
+00012b60: 6e2d 2d71 636b 6131 706d 6322 2c0a 2020  n--qcka1pmc",.  
+00012b70: 2020 2278 6e2d 2d71 7861 6d22 2c0a 2020    "xn--qxam",.  
+00012b80: 2020 2278 6e2d 2d72 6871 7639 3667 222c    "xn--rhqv96g",
+00012b90: 0a20 2020 2022 786e 2d2d 726f 7675 3838  .    "xn--rovu88
+00012ba0: 6222 2c0a 2020 2020 2278 6e2d 2d72 7663  b",.    "xn--rvc
+00012bb0: 3165 3061 6d33 6522 2c0a 2020 2020 2278  1e0am3e",.    "x
+00012bc0: 6e2d 2d73 3962 726a 3963 222c 0a20 2020  n--s9brj9c",.   
+00012bd0: 2022 786e 2d2d 7365 7335 3534 6722 2c0a   "xn--ses554g",.
+00012be0: 2020 2020 2278 6e2d 2d74 3630 6235 3661      "xn--t60b56a
+00012bf0: 222c 0a20 2020 2022 786e 2d2d 7463 6b77  ",.    "xn--tckw
+00012c00: 6522 2c0a 2020 2020 2278 6e2d 2d74 6971  e",.    "xn--tiq
+00012c10: 3439 7871 796a 222c 0a20 2020 2022 786e  49xqyj",.    "xn
+00012c20: 2d2d 756e 7570 3479 222c 0a20 2020 2022  --unup4y",.    "
+00012c30: 786e 2d2d 7665 726d 6765 6e73 6265 7261  xn--vermgensbera
+00012c40: 7465 722d 6374 6222 2c0a 2020 2020 2278  ter-ctb",.    "x
+00012c50: 6e2d 2d76 6572 6d67 656e 7362 6572 6174  n--vermgensberat
+00012c60: 756e 672d 7077 6222 2c0a 2020 2020 2278  ung-pwb",.    "x
+00012c70: 6e2d 2d76 6871 7576 222c 0a20 2020 2022  n--vhquv",.    "
+00012c80: 786e 2d2d 7675 7138 3631 6222 2c0a 2020  xn--vuq861b",.  
+00012c90: 2020 2278 6e2d 2d77 3472 3835 656c 3866    "xn--w4r85el8f
+00012ca0: 6875 3564 6e72 6122 2c0a 2020 2020 2278  hu5dnra",.    "x
+00012cb0: 6e2d 2d77 3472 7334 306c 222c 0a20 2020  n--w4rs40l",.   
+00012cc0: 2022 786e 2d2d 7767 6268 3163 222c 0a20   "xn--wgbh1c",. 
+00012cd0: 2020 2022 786e 2d2d 7767 626c 3661 222c     "xn--wgbl6a",
+00012ce0: 0a20 2020 2022 786e 2d2d 7868 7135 3231  .    "xn--xhq521
+00012cf0: 6222 2c0a 2020 2020 2278 6e2d 2d78 6b63  b",.    "xn--xkc
+00012d00: 3261 6c33 6879 6532 6122 2c0a 2020 2020  2al3hye2a",.    
+00012d10: 2278 6e2d 2d78 6b63 3264 6c33 6135 6565  "xn--xkc2dl3a5ee
+00012d20: 3068 222c 0a20 2020 2022 786e 2d2d 7939  0h",.    "xn--y9
+00012d30: 6133 6171 222c 0a20 2020 2022 786e 2d2d  a3aq",.    "xn--
+00012d40: 7966 726f 3469 3637 6f22 2c0a 2020 2020  yfro4i67o",.    
+00012d50: 2278 6e2d 2d79 6762 6932 616d 6d78 222c  "xn--ygbi2ammx",
+00012d60: 0a20 2020 2022 786e 2d2d 7a66 7231 3634  .    "xn--zfr164
+00012d70: 6222 2c0a 2020 2020 2278 7065 7269 6122  b",.    "xperia"
+00012d80: 2c0a 2020 2020 2278 7878 222c 0a20 2020  ,.    "xxx",.   
+00012d90: 2022 7879 7a22 2c0a 2020 2020 2320 790a   "xyz",.    # y.
+00012da0: 2020 2020 2279 6163 6874 7322 2c0a 2020      "yachts",.  
+00012db0: 2020 2279 6168 6f6f 222c 0a20 2020 2022    "yahoo",.    "
+00012dc0: 7961 6d61 7875 6e22 2c0a 2020 2020 2279  yamaxun",.    "y
+00012dd0: 616e 6465 7822 2c0a 2020 2020 2279 6522  andex",.    "ye"
+00012de0: 2c0a 2020 2020 2279 6f64 6f62 6173 6869  ,.    "yodobashi
+00012df0: 222c 0a20 2020 2022 796f 6761 222c 0a20  ",.    "yoga",. 
+00012e00: 2020 2022 796f 6b6f 6861 6d61 222c 0a20     "yokohama",. 
+00012e10: 2020 2022 796f 7522 2c0a 2020 2020 2279     "you",.    "y
+00012e20: 6f75 7475 6265 222c 0a20 2020 2022 7974  outube",.    "yt
+00012e30: 222c 0a20 2020 2022 7975 6e22 2c0a 2020  ",.    "yun",.  
+00012e40: 2020 2320 7a0a 2020 2020 227a 6122 2c0a    # z.    "za",.
+00012e50: 2020 2020 227a 6170 706f 7322 2c0a 2020      "zappos",.  
+00012e60: 2020 227a 6172 6122 2c0a 2020 2020 227a    "zara",.    "z
+00012e70: 6572 6f22 2c0a 2020 2020 227a 6970 222c  ero",.    "zip",
+00012e80: 0a20 2020 2022 7a69 7070 6f22 2c0a 2020  .    "zippo",.  
+00012e90: 2020 227a 6d22 2c0a 2020 2020 227a 6f6e    "zm",.    "zon
+00012ea0: 6522 2c0a 2020 2020 227a 7565 7269 6368  e",.    "zuerich
+00012eb0: 222c 0a20 2020 2022 7a77 222c 0a5d 0a0a  ",.    "zw",.]..
+00012ec0: 0a63 6c61 7373 2049 535f 4854 5450 5f55  .class IS_HTTP_U
+00012ed0: 524c 2856 616c 6964 6174 6f72 293a 0a20  RL(Validator):. 
+00012ee0: 2020 2022 2222 0a20 2020 2052 656a 6563     """.    Rejec
+00012ef0: 7473 2061 2055 524c 2073 7472 696e 6720  ts a URL string 
+00012f00: 6966 2061 6e79 206f 6620 7468 6520 666f  if any of the fo
+00012f10: 6c6c 6f77 696e 6720 6973 2074 7275 653a  llowing is true:
+00012f20: 0a20 2020 2020 2020 2a20 5468 6520 7374  .       * The st
+00012f30: 7269 6e67 2069 7320 656d 7074 7920 6f72  ring is empty or
+00012f40: 204e 6f6e 650a 2020 2020 2020 202a 2054   None.       * T
+00012f50: 6865 2073 7472 696e 6720 7573 6573 2063  he string uses c
+00012f60: 6861 7261 6374 6572 7320 7468 6174 2061  haracters that a
+00012f70: 7265 206e 6f74 2061 6c6c 6f77 6564 2069  re not allowed i
+00012f80: 6e20 6120 5552 4c0a 2020 2020 2020 202a  n a URL.       *
+00012f90: 2054 6865 2073 7472 696e 6720 6272 6561   The string brea
+00012fa0: 6b73 2061 6e79 206f 6620 7468 6520 4854  ks any of the HT
+00012fb0: 5450 2073 796e 7461 6374 6963 2072 756c  TP syntactic rul
+00012fc0: 6573 0a20 2020 2020 2020 2a20 5468 6520  es.       * The 
+00012fd0: 5552 4c20 7363 6865 6d65 2073 7065 6369  URL scheme speci
+00012fe0: 6669 6564 2028 6966 206f 6e65 2069 7320  fied (if one is 
+00012ff0: 7370 6563 6966 6965 6429 2069 7320 6e6f  specified) is no
+00013000: 7420 2768 7474 7027 206f 7220 2768 7474  t 'http' or 'htt
+00013010: 7073 270a 2020 2020 2020 202a 2054 6865  ps'.       * The
+00013020: 2074 6f70 2d6c 6576 656c 2064 6f6d 6169   top-level domai
+00013030: 6e20 2869 6620 6120 686f 7374 206e 616d  n (if a host nam
+00013040: 6520 6973 2073 7065 6369 6669 6564 2920  e is specified) 
+00013050: 646f 6573 206e 6f74 2065 7869 7374 0a0a  does not exist..
+00013060: 2020 2020 4261 7365 6420 6f6e 2052 4643      Based on RFC
+00013070: 2032 3631 363a 2068 7474 703a 2f2f 7777   2616: http://ww
+00013080: 772e 6661 7173 2e6f 7267 2f72 6663 732f  w.faqs.org/rfcs/
+00013090: 7266 6332 3631 362e 6874 6d6c 0a0a 2020  rfc2616.html..  
+000130a0: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
+000130b0: 6f6e 6c79 2063 6865 636b 7320 7468 6520  only checks the 
+000130c0: 5552 4c27 7320 7379 6e74 6178 2e20 4974  URL's syntax. It
+000130d0: 2064 6f65 7320 6e6f 7420 6368 6563 6b20   does not check 
+000130e0: 7468 6174 2074 6865 2055 524c 0a20 2020  that the URL.   
+000130f0: 2070 6f69 6e74 7320 746f 2061 2072 6561   points to a rea
+00013100: 6c20 646f 6375 6d65 6e74 2c20 666f 7220  l document, for 
+00013110: 6578 616d 706c 652c 206f 7220 7468 6174  example, or that
+00013120: 2069 7420 6f74 6865 7277 6973 6520 6d61   it otherwise ma
+00013130: 6b65 7320 7365 6e73 650a 2020 2020 7365  kes sense.    se
+00013140: 6d61 6e74 6963 616c 6c79 2e20 5468 6973  mantically. This
+00013150: 2066 756e 6374 696f 6e20 646f 6573 2061   function does a
+00013160: 7574 6f6d 6174 6963 616c 6c79 2070 7265  utomatically pre
+00013170: 7065 6e64 2027 6874 7470 3a2f 2f27 2069  pend 'http://' i
+00013180: 6e20 6672 6f6e 740a 2020 2020 6f66 2061  n front.    of a
+00013190: 2055 524c 2069 6e20 7468 6520 6361 7365   URL in the case
+000131a0: 206f 6620 616e 2061 6262 7265 7669 6174   of an abbreviat
+000131b0: 6564 2055 524c 2028 652e 672e 2027 676f  ed URL (e.g. 'go
+000131c0: 6f67 6c65 2e63 6127 292e 0a0a 2020 2020  ogle.ca')...    
+000131d0: 5468 6520 6c69 7374 206f 6620 616c 6c6f  The list of allo
+000131e0: 7765 6420 7363 6865 6d65 7320 6973 2063  wed schemes is c
+000131f0: 7573 746f 6d69 7a61 626c 6520 7769 7468  ustomizable with
+00013200: 2074 6865 2061 6c6c 6f77 6564 5f73 6368   the allowed_sch
+00013210: 656d 6573 0a20 2020 2070 6172 616d 6574  emes.    paramet
+00013220: 6572 2e20 4966 2079 6f75 2065 7863 6c75  er. If you exclu
+00013230: 6465 204e 6f6e 6520 6672 6f6d 2074 6865  de None from the
+00013240: 206c 6973 742c 2074 6865 6e20 6162 6272   list, then abbr
+00013250: 6576 6961 7465 6420 5552 4c73 0a20 2020  eviated URLs.   
+00013260: 2028 6c61 636b 696e 6720 6120 7363 6865   (lacking a sche
+00013270: 6d65 2073 7563 6820 6173 2027 6874 7470  me such as 'http
+00013280: 2729 2077 696c 6c20 6265 2072 656a 6563  ') will be rejec
+00013290: 7465 642e 0a0a 2020 2020 5468 6520 6465  ted...    The de
+000132a0: 6661 756c 7420 7072 6570 656e 6465 6420  fault prepended 
+000132b0: 7363 6865 6d65 2069 7320 6375 7374 6f6d  scheme is custom
+000132c0: 697a 6162 6c65 2077 6974 6820 7468 6520  izable with the 
+000132d0: 7072 6570 656e 645f 7363 6865 6d65 0a20  prepend_scheme. 
+000132e0: 2020 2070 6172 616d 6574 6572 2e20 4966     parameter. If
+000132f0: 2079 6f75 2073 6574 2070 7265 7065 6e64   you set prepend
+00013300: 5f73 6368 656d 6520 746f 204e 6f6e 6520  _scheme to None 
+00013310: 7468 656e 2070 7265 7065 6e64 696e 6720  then prepending 
+00013320: 7769 6c6c 2062 650a 2020 2020 6469 7361  will be.    disa
+00013330: 626c 6564 2e20 5552 4c73 2074 6861 7420  bled. URLs that 
+00013340: 7265 7175 6972 6520 7072 6570 656e 6469  require prependi
+00013350: 6e67 2074 6f20 7061 7273 6520 7769 6c6c  ng to parse will
+00013360: 2073 7469 6c6c 2062 6520 6163 6365 7074   still be accept
+00013370: 6564 2c0a 2020 2020 6275 7420 7468 6520  ed,.    but the 
+00013380: 7265 7475 726e 2076 616c 7565 2077 696c  return value wil
+00013390: 6c20 6e6f 7420 6265 206d 6f64 6966 6965  l not be modifie
+000133a0: 642e 0a0a 2020 2020 4061 7574 686f 723a  d...    @author:
+000133b0: 204a 6f6e 6174 6861 6e20 4265 6e6e 0a0a   Jonathan Benn..
+000133c0: 2020 2020 2020 2020 3e3e 3e20 4953 5f48          >>> IS_H
+000133d0: 5454 505f 5552 4c28 2928 2768 7474 703a  TTP_URL()('http:
+000133e0: 2f2f 312e 322e 332e 3427 290a 2020 2020  //1.2.3.4').    
+000133f0: 2020 2020 2827 6874 7470 3a2f 2f31 2e32      ('http://1.2
+00013400: 2e33 2e34 272c 204e 6f6e 6529 0a20 2020  .3.4', None).   
+00013410: 2020 2020 203e 3e3e 2049 535f 4854 5450       >>> IS_HTTP
+00013420: 5f55 524c 2829 2827 6874 7470 3a2f 2f61  _URL()('http://a
+00013430: 6263 2e63 6f6d 2729 0a20 2020 2020 2020  bc.com').       
+00013440: 2028 2768 7474 703a 2f2f 6162 632e 636f   ('http://abc.co
+00013450: 6d27 2c20 4e6f 6e65 290a 2020 2020 2020  m', None).      
+00013460: 2020 3e3e 3e20 4953 5f48 5454 505f 5552    >>> IS_HTTP_UR
+00013470: 4c28 2928 2768 7474 7073 3a2f 2f61 6263  L()('https://abc
+00013480: 2e63 6f6d 2729 0a20 2020 2020 2020 2028  .com').        (
+00013490: 2768 7474 7073 3a2f 2f61 6263 2e63 6f6d  'https://abc.com
+000134a0: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
+000134b0: 203e 3e3e 2049 535f 4854 5450 5f55 524c   >>> IS_HTTP_URL
+000134c0: 2829 2827 6874 7470 783a 2f2f 6162 632e  ()('httpx://abc.
+000134d0: 636f 6d27 290a 2020 2020 2020 2020 2827  com').        ('
+000134e0: 6874 7470 783a 2f2f 6162 632e 636f 6d27  httpx://abc.com'
+000134f0: 2c20 2765 6e74 6572 2061 2076 616c 6964  , 'enter a valid
+00013500: 2055 524c 2729 0a20 2020 2020 2020 203e   URL').        >
+00013510: 3e3e 2049 535f 4854 5450 5f55 524c 2829  >> IS_HTTP_URL()
+00013520: 2827 6874 7470 3a2f 2f61 6263 2e63 6f6d  ('http://abc.com
+00013530: 3a38 3027 290a 2020 2020 2020 2020 2827  :80').        ('
+00013540: 6874 7470 3a2f 2f61 6263 2e63 6f6d 3a38  http://abc.com:8
+00013550: 3027 2c20 4e6f 6e65 290a 2020 2020 2020  0', None).      
+00013560: 2020 3e3e 3e20 4953 5f48 5454 505f 5552    >>> IS_HTTP_UR
+00013570: 4c28 2928 2768 7474 703a 2f2f 7573 6572  L()('http://user
+00013580: 4061 6263 2e63 6f6d 2729 0a20 2020 2020  @abc.com').     
+00013590: 2020 2028 2768 7474 703a 2f2f 7573 6572     ('http://user
+000135a0: 4061 6263 2e63 6f6d 272c 204e 6f6e 6529  @abc.com', None)
+000135b0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+000135c0: 4854 5450 5f55 524c 2829 2827 6874 7470  HTTP_URL()('http
+000135d0: 3a2f 2f75 7365 7240 312e 322e 332e 3427  ://user@1.2.3.4'
+000135e0: 290a 2020 2020 2020 2020 2827 6874 7470  ).        ('http
+000135f0: 3a2f 2f75 7365 7240 312e 322e 332e 3427  ://user@1.2.3.4'
+00013600: 2c20 4e6f 6e65 290a 0a20 2020 2041 7267  , None)..    Arg
+00013610: 733a 0a20 2020 2020 2020 2065 7272 6f72  s:.        error
+00013620: 5f6d 6573 7361 6765 3a20 6120 7374 7269  _message: a stri
+00013630: 6e67 2c20 7468 6520 6572 726f 7220 6d65  ng, the error me
+00013640: 7373 6167 6520 746f 2067 6976 6520 7468  ssage to give th
+00013650: 6520 656e 6420 7573 6572 0a20 2020 2020  e end user.     
+00013660: 2020 2020 2020 2069 6620 7468 6520 5552         if the UR
+00013670: 4c20 646f 6573 206e 6f74 2076 616c 6964  L does not valid
+00013680: 6174 650a 2020 2020 2020 2020 616c 6c6f  ate.        allo
+00013690: 7765 645f 7363 6865 6d65 733a 2061 206c  wed_schemes: a l
+000136a0: 6973 7420 636f 6e74 6169 6e69 6e67 2073  ist containing s
+000136b0: 7472 696e 6773 206f 7220 4e6f 6e65 2e20  trings or None. 
+000136c0: 4561 6368 2065 6c65 6d65 6e74 0a20 2020  Each element.   
+000136d0: 2020 2020 2020 2020 2069 7320 6120 7363           is a sc
+000136e0: 6865 6d65 2074 6865 2069 6e70 7574 7465  heme the inputte
+000136f0: 6420 5552 4c20 6973 2061 6c6c 6f77 6564  d URL is allowed
+00013700: 2074 6f20 7573 650a 2020 2020 2020 2020   to use.        
+00013710: 7072 6570 656e 645f 7363 6865 6d65 3a20  prepend_scheme: 
+00013720: 6120 7374 7269 6e67 2c20 7468 6973 2073  a string, this s
+00013730: 6368 656d 6520 6973 2070 7265 7065 6e64  cheme is prepend
+00013740: 6564 2069 6620 6974 2773 0a20 2020 2020  ed if it's.     
+00013750: 2020 2020 2020 206e 6563 6573 7361 7279         necessary
+00013760: 2074 6f20 6d61 6b65 2074 6865 2055 524c   to make the URL
+00013770: 2076 616c 6964 0a20 2020 2022 2222 0a0a   valid.    """..
+00013780: 2020 2020 5245 4745 585f 4745 4e45 5249      REGEX_GENERI
+00013790: 435f 5641 4c49 445f 4950 203d 2072 2228  C_VALID_IP = r"(
+000137a0: 5b5c 772e 217e 2a27 7c3b 3a26 3d2b 242c  [\w.!~*'|;:&=+$,
+000137b0: 2d5d 2b40 293f 5c64 2b5c 2e5c 642b 5c2e  -]+@)?\d+\.\d+\.
+000137c0: 5c64 2b5c 2e5c 642b 283a 5c64 2a29 2a24  \d+\.\d+(:\d*)*$
+000137d0: 220a 2020 2020 5245 4745 585f 4745 4e45  ".    REGEX_GENE
+000137e0: 5249 435f 5641 4c49 445f 444f 4d41 494e  RIC_VALID_DOMAIN
+000137f0: 203d 2072 2228 5b5c 772e 217e 2a27 7c3b   = r"([\w.!~*'|;
+00013800: 3a26 3d2b 242c 2d5d 2b40 293f 2828 5b41  :&=+$,-]+@)?(([A
+00013810: 2d5a 612d 7a30 2d39 5d2b 5b41 2d5a 612d  -Za-z0-9]+[A-Za-
+00013820: 7a30 2d39 5c2d 5d2a 5b41 2d5a 612d 7a30  z0-9\-]*[A-Za-z0
+00013830: 2d39 5d2b 5c2e 292a 285b 412d 5a61 2d7a  -9]+\.)*([A-Za-z
+00013840: 302d 395d 2b5c 2e29 2a29 2a28 5b41 2d5a  0-9]+\.)*)*([A-Z
+00013850: 612d 7a5d 2b5b 412d 5a61 2d7a 302d 395c  a-z]+[A-Za-z0-9\
+00013860: 2d5d 2a5b 412d 5a61 2d7a 302d 395d 2b29  -]*[A-Za-z0-9]+)
+00013870: 5c2e 3f28 3a5c 642a 292a 2422 0a0a 2020  \.?(:\d*)*$"..  
+00013880: 2020 6465 6620 5f5f 696e 6974 5f5f 280a    def __init__(.
+00013890: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000138a0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+000138b0: 6167 653d 2245 6e74 6572 2061 2076 616c  age="Enter a val
+000138c0: 6964 2055 524c 222c 0a20 2020 2020 2020  id URL",.       
+000138d0: 2061 6c6c 6f77 6564 5f73 6368 656d 6573   allowed_schemes
+000138e0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
+000138f0: 7265 7065 6e64 5f73 6368 656d 653d 2268  repend_scheme="h
+00013900: 7474 7022 2c0a 2020 2020 2020 2020 616c  ttp",.        al
+00013910: 6c6f 7765 645f 746c 6473 3d4e 6f6e 652c  lowed_tlds=None,
+00013920: 0a20 2020 2029 3a0a 0a20 2020 2020 2020  .    ):..       
+00013930: 2073 656c 662e 6572 726f 725f 6d65 7373   self.error_mess
+00013940: 6167 6520 3d20 6572 726f 725f 6d65 7373  age = error_mess
+00013950: 6167 650a 2020 2020 2020 2020 6966 2061  age.        if a
+00013960: 6c6c 6f77 6564 5f73 6368 656d 6573 2069  llowed_schemes i
+00013970: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00013980: 2020 2020 7365 6c66 2e61 6c6c 6f77 6564      self.allowed
+00013990: 5f73 6368 656d 6573 203d 2068 7474 705f  _schemes = http_
+000139a0: 7363 6865 6d65 730a 2020 2020 2020 2020  schemes.        
+000139b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000139c0: 2020 7365 6c66 2e61 6c6c 6f77 6564 5f73    self.allowed_s
+000139d0: 6368 656d 6573 203d 2061 6c6c 6f77 6564  chemes = allowed
+000139e0: 5f73 6368 656d 6573 0a20 2020 2020 2020  _schemes.       
+000139f0: 2069 6620 616c 6c6f 7765 645f 746c 6473   if allowed_tlds
+00013a00: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00013a10: 2020 2020 2020 7365 6c66 2e61 6c6c 6f77        self.allow
+00013a20: 6564 5f74 6c64 7320 3d20 6f66 6669 6369  ed_tlds = offici
+00013a30: 616c 5f74 6f70 5f6c 6576 656c 5f64 6f6d  al_top_level_dom
+00013a40: 6169 6e73 0a20 2020 2020 2020 2065 6c73  ains.        els
+00013a50: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00013a60: 656c 662e 616c 6c6f 7765 645f 746c 6473  elf.allowed_tlds
+00013a70: 203d 2061 6c6c 6f77 6564 5f74 6c64 730a   = allowed_tlds.
+00013a80: 2020 2020 2020 2020 7365 6c66 2e70 7265          self.pre
+00013a90: 7065 6e64 5f73 6368 656d 6520 3d20 7072  pend_scheme = pr
+00013aa0: 6570 656e 645f 7363 6865 6d65 0a0a 2020  epend_scheme..  
+00013ab0: 2020 2020 2020 666f 7220 6920 696e 2073        for i in s
+00013ac0: 656c 662e 616c 6c6f 7765 645f 7363 6865  elf.allowed_sche
+00013ad0: 6d65 733a 0a20 2020 2020 2020 2020 2020  mes:.           
+00013ae0: 2069 6620 6920 6e6f 7420 696e 2068 7474   if i not in htt
+00013af0: 705f 7363 6865 6d65 733a 0a20 2020 2020  p_schemes:.     
+00013b00: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00013b10: 2053 796e 7461 7845 7272 6f72 280a 2020   SyntaxError(.  
 00013b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b30: 2020 2020 2261 6c6c 6f77 6564 5f73 6368      "allowed_sch
-00013b40: 656d 6520 7661 6c75 6520 2725 7327 2069  eme value '%s' i
-00013b50: 7320 6e6f 7420 696e 2025 7322 2025 2028  s not in %s" % (
-00013b60: 692c 2068 7474 705f 7363 6865 6d65 7329  i, http_schemes)
-00013b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013b80: 2029 0a0a 2020 2020 2020 2020 6966 2073   )..        if s
-00013b90: 656c 662e 7072 6570 656e 645f 7363 6865  elf.prepend_sche
-00013ba0: 6d65 206e 6f74 2069 6e20 7365 6c66 2e61  me not in self.a
-00013bb0: 6c6c 6f77 6564 5f73 6368 656d 6573 3a0a  llowed_schemes:.
-00013bc0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00013bd0: 6520 5379 6e74 6178 4572 726f 7228 0a20  e SyntaxError(. 
-00013be0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00013bf0: 7072 6570 656e 645f 7363 6865 6d65 3d27  prepend_scheme='
-00013c00: 2573 2720 6973 206e 6f74 2069 6e20 616c  %s' is not in al
-00013c10: 6c6f 7765 645f 7363 6865 6d65 733d 2573  lowed_schemes=%s
-00013c20: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00013c30: 2020 2520 2873 656c 662e 7072 6570 656e    % (self.prepen
-00013c40: 645f 7363 6865 6d65 2c20 7365 6c66 2e61  d_scheme, self.a
-00013c50: 6c6c 6f77 6564 5f73 6368 656d 6573 290a  llowed_schemes).
-00013c60: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00013c70: 2020 2064 6566 2076 616c 6964 6174 6528     def validate(
-00013c80: 7365 6c66 2c20 7661 6c75 652c 2072 6563  self, value, rec
-00013c90: 6f72 645f 6964 3d4e 6f6e 6529 3a0a 2020  ord_id=None):.  
-00013ca0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00013cb0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-00013cc0: 2020 2020 7661 6c75 653a 2061 2073 7472      value: a str
-00013cd0: 696e 672c 2074 6865 2055 524c 2074 6f20  ing, the URL to 
-00013ce0: 7661 6c69 6461 7465 0a0a 2020 2020 2020  validate..      
-00013cf0: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-00013d00: 2020 2020 2020 2061 2074 7570 6c65 2c20         a tuple, 
-00013d10: 7768 6572 6520 7475 706c 655b 305d 2069  where tuple[0] i
-00013d20: 7320 7468 6520 696e 7075 7474 6564 2076  s the inputted v
-00013d30: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
-00013d40: 2028 706f 7373 6962 6c65 2070 7265 7065   (possible prepe
-00013d50: 6e64 6564 2077 6974 6820 7072 6570 656e  nded with prepen
-00013d60: 645f 7363 6865 6d65 292c 2061 6e64 2074  d_scheme), and t
-00013d70: 7570 6c65 5b31 5d20 6973 2065 6974 6865  uple[1] is eithe
-00013d80: 720a 2020 2020 2020 2020 2020 2020 4e6f  r.            No
-00013d90: 6e65 2028 7375 6363 6573 7321 2920 6f72  ne (success!) or
-00013da0: 2074 6865 2073 7472 696e 6720 6572 726f   the string erro
-00013db0: 725f 6d65 7373 6167 650a 2020 2020 2020  r_message.      
-00013dc0: 2020 2222 220a 2020 2020 2020 2020 7472    """.        tr
-00013dd0: 793a 0a20 2020 2020 2020 2020 2020 2023  y:.            #
-00013de0: 2069 6620 7468 6520 5552 4c20 7061 7373   if the URL pass
-00013df0: 6573 2067 656e 6572 6963 2076 616c 6964  es generic valid
-00013e00: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
-00013e10: 2020 7820 3d20 4953 5f47 454e 4552 4943    x = IS_GENERIC
-00013e20: 5f55 524c 280a 2020 2020 2020 2020 2020  _URL(.          
-00013e30: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00013e40: 6167 653d 7365 6c66 2e65 7272 6f72 5f6d  age=self.error_m
-00013e50: 6573 7361 6765 2c0a 2020 2020 2020 2020  essage,.        
-00013e60: 2020 2020 2020 2020 616c 6c6f 7765 645f          allowed_
-00013e70: 7363 6865 6d65 733d 7365 6c66 2e61 6c6c  schemes=self.all
-00013e80: 6f77 6564 5f73 6368 656d 6573 2c0a 2020  owed_schemes,.  
-00013e90: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00013ea0: 6570 656e 645f 7363 6865 6d65 3d73 656c  epend_scheme=sel
-00013eb0: 662e 7072 6570 656e 645f 7363 6865 6d65  f.prepend_scheme
-00013ec0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00013ed0: 2020 2020 2020 2020 2020 2020 6966 2078              if x
-00013ee0: 2876 616c 7565 295b 315d 2069 7320 4e6f  (value)[1] is No
-00013ef0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00013f00: 2020 2020 636f 6d70 6f6e 656e 7473 203d      components =
-00013f10: 2075 726c 7061 7273 652e 7572 6c70 6172   urlparse.urlpar
-00013f20: 7365 2876 616c 7565 290a 2020 2020 2020  se(value).      
-00013f30: 2020 2020 2020 2020 2020 6175 7468 6f72            author
-00013f40: 6974 7920 3d20 636f 6d70 6f6e 656e 7473  ity = components
-00013f50: 2e6e 6574 6c6f 630a 2020 2020 2020 2020  .netloc.        
-00013f60: 2020 2020 2020 2020 2320 6966 2074 6865          # if the
-00013f70: 7265 2069 7320 616e 2061 7574 686f 7269  re is an authori
-00013f80: 7479 2063 6f6d 706f 6e65 6e74 0a20 2020  ty component.   
-00013f90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00013fa0: 6175 7468 6f72 6974 793a 0a20 2020 2020  authority:.     
-00013fb0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00013fc0: 2069 6620 6175 7468 6f72 6974 7920 6973   if authority is
-00013fd0: 2061 2076 616c 6964 2049 5020 6164 6472   a valid IP addr
-00013fe0: 6573 730a 2020 2020 2020 2020 2020 2020  ess.            
-00013ff0: 2020 2020 2020 2020 6966 2072 652e 6d61          if re.ma
-00014000: 7463 6828 7365 6c66 2e52 4547 4558 5f47  tch(self.REGEX_G
-00014010: 454e 4552 4943 5f56 414c 4944 5f49 502c  ENERIC_VALID_IP,
-00014020: 2061 7574 686f 7269 7479 293a 0a20 2020   authority):.   
+00013b30: 2020 2261 6c6c 6f77 6564 5f73 6368 656d    "allowed_schem
+00013b40: 6520 7661 6c75 6520 2725 7327 2069 7320  e value '%s' is 
+00013b50: 6e6f 7420 696e 2025 7322 2025 2028 692c  not in %s" % (i,
+00013b60: 2068 7474 705f 7363 6865 6d65 7329 0a20   http_schemes). 
+00013b70: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00013b80: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00013b90: 662e 7072 6570 656e 645f 7363 6865 6d65  f.prepend_scheme
+00013ba0: 206e 6f74 2069 6e20 7365 6c66 2e61 6c6c   not in self.all
+00013bb0: 6f77 6564 5f73 6368 656d 6573 3a0a 2020  owed_schemes:.  
+00013bc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00013bd0: 5379 6e74 6178 4572 726f 7228 0a20 2020  SyntaxError(.   
+00013be0: 2020 2020 2020 2020 2020 2020 2022 7072               "pr
+00013bf0: 6570 656e 645f 7363 6865 6d65 3d27 2573  epend_scheme='%s
+00013c00: 2720 6973 206e 6f74 2069 6e20 616c 6c6f  ' is not in allo
+00013c10: 7765 645f 7363 6865 6d65 733d 2573 220a  wed_schemes=%s".
+00013c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c30: 2520 2873 656c 662e 7072 6570 656e 645f  % (self.prepend_
+00013c40: 7363 6865 6d65 2c20 7365 6c66 2e61 6c6c  scheme, self.all
+00013c50: 6f77 6564 5f73 6368 656d 6573 290a 2020  owed_schemes).  
+00013c60: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00013c70: 2064 6566 2076 616c 6964 6174 6528 7365   def validate(se
+00013c80: 6c66 2c20 7661 6c75 652c 2072 6563 6f72  lf, value, recor
+00013c90: 645f 6964 3d4e 6f6e 6529 3a0a 2020 2020  d_id=None):.    
+00013ca0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00013cb0: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+00013cc0: 2020 7661 6c75 653a 2061 2073 7472 696e    value: a strin
+00013cd0: 672c 2074 6865 2055 524c 2074 6f20 7661  g, the URL to va
+00013ce0: 6c69 6461 7465 0a0a 2020 2020 2020 2020  lidate..        
+00013cf0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+00013d00: 2020 2020 2061 2074 7570 6c65 2c20 7768       a tuple, wh
+00013d10: 6572 6520 7475 706c 655b 305d 2069 7320  ere tuple[0] is 
+00013d20: 7468 6520 696e 7075 7474 6564 2076 616c  the inputted val
+00013d30: 7565 0a20 2020 2020 2020 2020 2020 2028  ue.            (
+00013d40: 706f 7373 6962 6c65 2070 7265 7065 6e64  possible prepend
+00013d50: 6564 2077 6974 6820 7072 6570 656e 645f  ed with prepend_
+00013d60: 7363 6865 6d65 292c 2061 6e64 2074 7570  scheme), and tup
+00013d70: 6c65 5b31 5d20 6973 2065 6974 6865 720a  le[1] is either.
+00013d80: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
+00013d90: 2028 7375 6363 6573 7321 2920 6f72 2074   (success!) or t
+00013da0: 6865 2073 7472 696e 6720 6572 726f 725f  he string error_
+00013db0: 6d65 7373 6167 650a 2020 2020 2020 2020  message.        
+00013dc0: 2222 220a 2020 2020 2020 2020 7472 793a  """.        try:
+00013dd0: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
+00013de0: 6620 7468 6520 5552 4c20 7061 7373 6573  f the URL passes
+00013df0: 2067 656e 6572 6963 2076 616c 6964 6174   generic validat
+00013e00: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+00013e10: 7820 3d20 4953 5f47 454e 4552 4943 5f55  x = IS_GENERIC_U
+00013e20: 524c 280a 2020 2020 2020 2020 2020 2020  RL(.            
+00013e30: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00013e40: 653d 7365 6c66 2e65 7272 6f72 5f6d 6573  e=self.error_mes
+00013e50: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
+00013e60: 2020 2020 2020 616c 6c6f 7765 645f 7363        allowed_sc
+00013e70: 6865 6d65 733d 7365 6c66 2e61 6c6c 6f77  hemes=self.allow
+00013e80: 6564 5f73 6368 656d 6573 2c0a 2020 2020  ed_schemes,.    
+00013e90: 2020 2020 2020 2020 2020 2020 7072 6570              prep
+00013ea0: 656e 645f 7363 6865 6d65 3d73 656c 662e  end_scheme=self.
+00013eb0: 7072 6570 656e 645f 7363 6865 6d65 2c0a  prepend_scheme,.
+00013ec0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00013ed0: 2020 2020 2020 2020 2020 6966 2078 2876            if x(v
+00013ee0: 616c 7565 295b 315d 2069 7320 4e6f 6e65  alue)[1] is None
+00013ef0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00013f00: 2020 636f 6d70 6f6e 656e 7473 203d 2075    components = u
+00013f10: 726c 7061 7273 652e 7572 6c70 6172 7365  rlparse.urlparse
+00013f20: 2876 616c 7565 290a 2020 2020 2020 2020  (value).        
+00013f30: 2020 2020 2020 2020 6175 7468 6f72 6974          authorit
+00013f40: 7920 3d20 636f 6d70 6f6e 656e 7473 2e6e  y = components.n
+00013f50: 6574 6c6f 630a 2020 2020 2020 2020 2020  etloc.          
+00013f60: 2020 2020 2020 2320 6966 2074 6865 7265        # if there
+00013f70: 2069 7320 616e 2061 7574 686f 7269 7479   is an authority
+00013f80: 2063 6f6d 706f 6e65 6e74 0a20 2020 2020   component.     
+00013f90: 2020 2020 2020 2020 2020 2069 6620 6175             if au
+00013fa0: 7468 6f72 6974 793a 0a20 2020 2020 2020  thority:.       
+00013fb0: 2020 2020 2020 2020 2020 2020 2023 2069               # i
+00013fc0: 6620 6175 7468 6f72 6974 7920 6973 2061  f authority is a
+00013fd0: 2076 616c 6964 2049 5020 6164 6472 6573   valid IP addres
+00013fe0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00013ff0: 2020 2020 2020 6966 2072 652e 6d61 7463        if re.matc
+00014000: 6828 7365 6c66 2e52 4547 4558 5f47 454e  h(self.REGEX_GEN
+00014010: 4552 4943 5f56 414c 4944 5f49 502c 2061  ERIC_VALID_IP, a
+00014020: 7574 686f 7269 7479 293a 0a20 2020 2020  uthority):.     
 00014030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014040: 2020 2020 2023 2054 6865 6e20 7468 6973       # Then this
-00014050: 2048 5454 5020 5552 4c20 6973 2076 616c   HTTP URL is val
-00014060: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
-00014070: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00014080: 6e20 7661 6c75 650a 2020 2020 2020 2020  n value.        
-00014090: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000140a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000140b0: 2020 2020 2020 2020 2020 2320 656c 7365            # else
-000140c0: 2069 6620 6175 7468 6f72 6974 7920 6973   if authority is
-000140d0: 2061 2076 616c 6964 2064 6f6d 6169 6e20   a valid domain 
-000140e0: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
-000140f0: 2020 2020 2020 2020 2020 2020 2064 6f6d               dom
-00014100: 6169 6e4d 6174 6368 203d 2072 652e 6d61  ainMatch = re.ma
-00014110: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
-00014120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014130: 2073 656c 662e 5245 4745 585f 4745 4e45   self.REGEX_GENE
-00014140: 5249 435f 5641 4c49 445f 444f 4d41 494e  RIC_VALID_DOMAIN
-00014150: 2c20 6175 7468 6f72 6974 790a 2020 2020  , authority.    
+00014040: 2020 2023 2054 6865 6e20 7468 6973 2048     # Then this H
+00014050: 5454 5020 5552 4c20 6973 2076 616c 6964  TTP URL is valid
+00014060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014070: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00014080: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
+00014090: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000140a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000140b0: 2020 2020 2020 2020 2320 656c 7365 2069          # else i
+000140c0: 6620 6175 7468 6f72 6974 7920 6973 2061  f authority is a
+000140d0: 2076 616c 6964 2064 6f6d 6169 6e20 6e61   valid domain na
+000140e0: 6d65 0a20 2020 2020 2020 2020 2020 2020  me.             
+000140f0: 2020 2020 2020 2020 2020 2064 6f6d 6169             domai
+00014100: 6e4d 6174 6368 203d 2072 652e 6d61 7463  nMatch = re.matc
+00014110: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
+00014120: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00014130: 656c 662e 5245 4745 585f 4745 4e45 5249  elf.REGEX_GENERI
+00014140: 435f 5641 4c49 445f 444f 4d41 494e 2c20  C_VALID_DOMAIN, 
+00014150: 6175 7468 6f72 6974 790a 2020 2020 2020  authority.      
 00014160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014170: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00014180: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00014190: 2064 6f6d 6169 6e4d 6174 6368 3a0a 2020   domainMatch:.  
+00014170: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00014180: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+00014190: 6f6d 6169 6e4d 6174 6368 3a0a 2020 2020  omainMatch:.    
 000141a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141b0: 2020 2020 2020 2020 2020 2320 6966 2074            # if t
-000141c0: 6865 2074 6f70 2d6c 6576 656c 2064 6f6d  he top-level dom
-000141d0: 6169 6e20 7265 616c 6c79 2065 7869 7374  ain really exist
-000141e0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-000141f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00014200: 2064 6f6d 6169 6e4d 6174 6368 2e67 726f   domainMatch.gro
-00014210: 7570 2835 292e 6c6f 7765 7228 2920 696e  up(5).lower() in
-00014220: 2073 656c 662e 616c 6c6f 7765 645f 746c   self.allowed_tl
-00014230: 6473 3a0a 2020 2020 2020 2020 2020 2020  ds:.            
+000141b0: 2020 2020 2020 2020 2320 6966 2074 6865          # if the
+000141c0: 2074 6f70 2d6c 6576 656c 2064 6f6d 6169   top-level domai
+000141d0: 6e20 7265 616c 6c79 2065 7869 7374 730a  n really exists.
+000141e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000141f0: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+00014200: 6f6d 6169 6e4d 6174 6368 2e67 726f 7570  omainMatch.group
+00014210: 2835 292e 6c6f 7765 7228 2920 696e 2073  (5).lower() in s
+00014220: 656c 662e 616c 6c6f 7765 645f 746c 6473  elf.allowed_tlds
+00014230: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
 00014240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014250: 2020 2020 2320 5468 656e 2074 6869 7320      # Then this 
-00014260: 4854 5450 2055 524c 2069 7320 7661 6c69  HTTP URL is vali
-00014270: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+00014250: 2020 2320 5468 656e 2074 6869 7320 4854    # Then this HT
+00014260: 5450 2055 524c 2069 7320 7661 6c69 640a  TP URL is valid.
+00014270: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00014280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014290: 2020 7265 7475 726e 2076 616c 7565 0a20    return value. 
-000142a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000142b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000142c0: 2020 2020 2020 2020 2023 2065 6c73 6520           # else 
-000142d0: 7468 6973 2069 7320 6120 7265 6c61 7469  this is a relati
-000142e0: 7665 2f61 6262 7265 7669 6174 6564 2055  ve/abbreviated U
-000142f0: 524c 2c20 7768 6963 6820 7769 6c6c 2070  RL, which will p
-00014300: 6172 7365 0a20 2020 2020 2020 2020 2020  arse.           
-00014310: 2020 2020 2020 2020 2023 2069 6e74 6f20           # into 
-00014320: 7468 6520 5552 4c27 7320 7061 7468 2063  the URL's path c
-00014330: 6f6d 706f 6e65 6e74 0a20 2020 2020 2020  omponent.       
-00014340: 2020 2020 2020 2020 2020 2020 2070 6174               pat
-00014350: 6820 3d20 636f 6d70 6f6e 656e 7473 2e70  h = components.p
-00014360: 6174 680a 2020 2020 2020 2020 2020 2020  ath.            
-00014370: 2020 2020 2020 2020 2320 7265 6c61 7469          # relati
-00014380: 7665 2063 6173 653a 2069 6620 7468 6973  ve case: if this
-00014390: 2069 7320 6120 7661 6c69 6420 7061 7468   is a valid path
-000143a0: 2028 6966 2069 7420 7374 6172 7473 2077   (if it starts w
-000143b0: 6974 680a 2020 2020 2020 2020 2020 2020  ith.            
-000143c0: 2020 2020 2020 2020 2320 6120 736c 6173          # a slas
-000143d0: 6829 0a20 2020 2020 2020 2020 2020 2020  h).             
-000143e0: 2020 2020 2020 2069 6620 6e6f 7420 7061         if not pa
-000143f0: 7468 2e73 7461 7274 7377 6974 6828 222f  th.startswith("/
-00014400: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
-00014410: 2020 2020 2020 2020 2020 2020 2320 6162              # ab
-00014420: 6272 6576 6961 7465 6420 6361 7365 3a20  breviated case: 
-00014430: 6966 2077 6520 6861 7665 6e27 7420 616c  if we haven't al
-00014440: 7265 6164 792c 2070 7265 7065 6e64 2061  ready, prepend a
-00014450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014460: 2020 2020 2020 2020 2023 2073 6368 656d           # schem
-00014470: 6520 616e 6420 7365 6520 6966 2069 7420  e and see if it 
-00014480: 6669 7865 7320 7468 6520 7072 6f62 6c65  fixes the proble
-00014490: 6d0a 2020 2020 2020 2020 2020 2020 2020  m.              
-000144a0: 2020 2020 2020 2020 2020 6966 2022 3a2f            if ":/
-000144b0: 2f22 206e 6f74 2069 6e20 7661 6c75 6520  /" not in value 
-000144c0: 616e 6420 4e6f 6e65 2069 6e20 7365 6c66  and None in self
-000144d0: 2e61 6c6c 6f77 6564 5f73 6368 656d 6573  .allowed_schemes
-000144e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000144f0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-00014500: 6865 6d65 546f 5573 6520 3d20 7365 6c66  hemeToUse = self
-00014510: 2e70 7265 7065 6e64 5f73 6368 656d 6520  .prepend_scheme 
-00014520: 6f72 2022 6874 7470 220a 2020 2020 2020  or "http".      
+00014290: 7265 7475 726e 2076 616c 7565 0a20 2020  return value.   
+000142a0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+000142b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000142c0: 2020 2020 2020 2023 2065 6c73 6520 7468         # else th
+000142d0: 6973 2069 7320 6120 7265 6c61 7469 7665  is is a relative
+000142e0: 2f61 6262 7265 7669 6174 6564 2055 524c  /abbreviated URL
+000142f0: 2c20 7768 6963 6820 7769 6c6c 2070 6172  , which will par
+00014300: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
+00014310: 2020 2020 2020 2023 2069 6e74 6f20 7468         # into th
+00014320: 6520 5552 4c27 7320 7061 7468 2063 6f6d  e URL's path com
+00014330: 706f 6e65 6e74 0a20 2020 2020 2020 2020  ponent.         
+00014340: 2020 2020 2020 2020 2020 2070 6174 6820             path 
+00014350: 3d20 636f 6d70 6f6e 656e 7473 2e70 6174  = components.pat
+00014360: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
+00014370: 2020 2020 2020 2320 7265 6c61 7469 7665        # relative
+00014380: 2063 6173 653a 2069 6620 7468 6973 2069   case: if this i
+00014390: 7320 6120 7661 6c69 6420 7061 7468 2028  s a valid path (
+000143a0: 6966 2069 7420 7374 6172 7473 2077 6974  if it starts wit
+000143b0: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
+000143c0: 2020 2020 2020 2320 6120 736c 6173 6829        # a slash)
+000143d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000143e0: 2020 2020 2069 6620 6e6f 7420 7061 7468       if not path
+000143f0: 2e73 7461 7274 7377 6974 6828 222f 2229  .startswith("/")
+00014400: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014410: 2020 2020 2020 2020 2020 2320 6162 6272            # abbr
+00014420: 6576 6961 7465 6420 6361 7365 3a20 6966  eviated case: if
+00014430: 2077 6520 6861 7665 6e27 7420 616c 7265   we haven't alre
+00014440: 6164 792c 2070 7265 7065 6e64 2061 0a20  ady, prepend a. 
+00014450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014460: 2020 2020 2020 2023 2073 6368 656d 6520         # scheme 
+00014470: 616e 6420 7365 6520 6966 2069 7420 6669  and see if it fi
+00014480: 7865 7320 7468 6520 7072 6f62 6c65 6d0a  xes the problem.
+00014490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000144a0: 2020 2020 2020 2020 6966 2022 3a2f 2f22          if "://"
+000144b0: 206e 6f74 2069 6e20 7661 6c75 6520 616e   not in value an
+000144c0: 6420 4e6f 6e65 2069 6e20 7365 6c66 2e61  d None in self.a
+000144d0: 6c6c 6f77 6564 5f73 6368 656d 6573 3a0a  llowed_schemes:.
+000144e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000144f0: 2020 2020 2020 2020 2020 2020 7363 6865              sche
+00014500: 6d65 546f 5573 6520 3d20 7365 6c66 2e70  meToUse = self.p
+00014510: 7265 7065 6e64 5f73 6368 656d 6520 6f72  repend_scheme or
+00014520: 2022 6874 7470 220a 2020 2020 2020 2020   "http".        
 00014530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014540: 2020 2020 2020 6e65 775f 7661 6c75 6520        new_value 
-00014550: 3d20 7365 6c66 2e76 616c 6964 6174 6528  = self.validate(
-00014560: 7363 6865 6d65 546f 5573 6520 2b20 223a  schemeToUse + ":
-00014570: 2f2f 2220 2b20 7661 6c75 6529 0a20 2020  //" + value).   
+00014540: 2020 2020 6e65 775f 7661 6c75 6520 3d20      new_value = 
+00014550: 7365 6c66 2e76 616c 6964 6174 6528 7363  self.validate(sc
+00014560: 6865 6d65 546f 5573 6520 2b20 223a 2f2f  hemeToUse + "://
+00014570: 2220 2b20 7661 6c75 6529 0a20 2020 2020  " + value).     
 00014580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014590: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000145a0: 6e65 775f 7661 6c75 6520 6966 2073 656c  new_value if sel
-000145b0: 662e 7072 6570 656e 645f 7363 6865 6d65  f.prepend_scheme
-000145c0: 2065 6c73 6520 7661 6c75 650a 2020 2020   else value.    
-000145d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000145e0: 7265 7475 726e 2076 616c 7565 0a20 2020  return value.   
-000145f0: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
-00014600: 2020 2020 2020 2020 2070 6173 730a 2020           pass.  
-00014610: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
-00014620: 6461 7469 6f6e 4572 726f 7228 7365 6c66  dationError(self
-00014630: 2e74 7261 6e73 6c61 746f 7228 7365 6c66  .translator(self
-00014640: 2e65 7272 6f72 5f6d 6573 7361 6765 2929  .error_message))
-00014650: 0a0a 0a63 6c61 7373 2049 535f 5552 4c28  ...class IS_URL(
-00014660: 5661 6c69 6461 746f 7229 3a0a 2020 2020  Validator):.    
-00014670: 2222 220a 2020 2020 5265 6a65 6374 7320  """.    Rejects 
-00014680: 6120 5552 4c20 7374 7269 6e67 2069 6620  a URL string if 
-00014690: 616e 7920 6f66 2074 6865 2066 6f6c 6c6f  any of the follo
-000146a0: 7769 6e67 2069 7320 7472 7565 3a0a 0a20  wing is true:.. 
-000146b0: 2020 2020 2020 2a20 5468 6520 7374 7269        * The stri
-000146c0: 6e67 2069 7320 656d 7074 7920 6f72 204e  ng is empty or N
-000146d0: 6f6e 650a 2020 2020 2020 202a 2054 6865  one.       * The
-000146e0: 2073 7472 696e 6720 7573 6573 2063 6861   string uses cha
-000146f0: 7261 6374 6572 7320 7468 6174 2061 7265  racters that are
-00014700: 206e 6f74 2061 6c6c 6f77 6564 2069 6e20   not allowed in 
-00014710: 6120 5552 4c0a 2020 2020 2020 202a 2054  a URL.       * T
-00014720: 6865 2073 7472 696e 6720 6272 6561 6b73  he string breaks
-00014730: 2061 6e79 206f 6620 7468 6520 4854 5450   any of the HTTP
-00014740: 2073 796e 7461 6374 6963 2072 756c 6573   syntactic rules
-00014750: 0a20 2020 2020 2020 2a20 5468 6520 5552  .       * The UR
-00014760: 4c20 7363 6865 6d65 2073 7065 6369 6669  L scheme specifi
-00014770: 6564 2028 6966 206f 6e65 2069 7320 7370  ed (if one is sp
-00014780: 6563 6966 6965 6429 2069 7320 6e6f 7420  ecified) is not 
-00014790: 2768 7474 7027 206f 7220 2768 7474 7073  'http' or 'https
-000147a0: 270a 2020 2020 2020 202a 2054 6865 2074  '.       * The t
-000147b0: 6f70 2d6c 6576 656c 2064 6f6d 6169 6e20  op-level domain 
-000147c0: 2869 6620 6120 686f 7374 206e 616d 6520  (if a host name 
-000147d0: 6973 2073 7065 6369 6669 6564 2920 646f  is specified) do
-000147e0: 6573 206e 6f74 2065 7869 7374 0a0a 2020  es not exist..  
-000147f0: 2020 2854 6865 7365 2072 756c 6573 2061    (These rules a
-00014800: 7265 2062 6173 6564 206f 6e20 5246 4320  re based on RFC 
-00014810: 3236 3136 3a20 6874 7470 3a2f 2f77 7777  2616: http://www
-00014820: 2e66 6171 732e 6f72 672f 7266 6373 2f72  .faqs.org/rfcs/r
-00014830: 6663 3236 3136 2e68 746d 6c29 0a0a 2020  fc2616.html)..  
-00014840: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
-00014850: 6f6e 6c79 2063 6865 636b 7320 7468 6520  only checks the 
-00014860: 5552 4c27 7320 7379 6e74 6178 2e20 4974  URL's syntax. It
-00014870: 2064 6f65 7320 6e6f 7420 6368 6563 6b20   does not check 
-00014880: 7468 6174 2074 6865 2055 524c 0a20 2020  that the URL.   
-00014890: 2070 6f69 6e74 7320 746f 2061 2072 6561   points to a rea
-000148a0: 6c20 646f 6375 6d65 6e74 2c20 666f 7220  l document, for 
-000148b0: 6578 616d 706c 652c 206f 7220 7468 6174  example, or that
-000148c0: 2069 7420 6f74 6865 7277 6973 6520 6d61   it otherwise ma
-000148d0: 6b65 7320 7365 6e73 650a 2020 2020 7365  kes sense.    se
-000148e0: 6d61 6e74 6963 616c 6c79 2e20 5468 6973  mantically. This
-000148f0: 2066 756e 6374 696f 6e20 646f 6573 2061   function does a
-00014900: 7574 6f6d 6174 6963 616c 6c79 2070 7265  utomatically pre
-00014910: 7065 6e64 2027 6874 7470 3a2f 2f27 2069  pend 'http://' i
-00014920: 6e20 6672 6f6e 740a 2020 2020 6f66 2061  n front.    of a
-00014930: 2055 524c 2069 6e20 7468 6520 6361 7365   URL in the case
-00014940: 206f 6620 616e 2061 6262 7265 7669 6174   of an abbreviat
-00014950: 6564 2055 524c 2028 652e 672e 2027 676f  ed URL (e.g. 'go
-00014960: 6f67 6c65 2e63 6127 292e 0a0a 2020 2020  ogle.ca')...    
-00014970: 4966 2074 6865 2070 6172 616d 6574 6572  If the parameter
-00014980: 206d 6f64 653d 2767 656e 6572 6963 2720   mode='generic' 
-00014990: 6973 2075 7365 642c 2074 6865 6e20 7468  is used, then th
-000149a0: 6973 2066 756e 6374 696f 6e27 7320 6265  is function's be
-000149b0: 6861 7669 6f72 0a20 2020 2063 6861 6e67  havior.    chang
-000149c0: 6573 2e20 4974 2074 6865 6e20 7265 6a65  es. It then reje
-000149d0: 6374 7320 6120 5552 4c20 7374 7269 6e67  cts a URL string
-000149e0: 2069 6620 616e 7920 6f66 2074 6865 2066   if any of the f
-000149f0: 6f6c 6c6f 7769 6e67 2069 7320 7472 7565  ollowing is true
-00014a00: 3a0a 0a20 2020 2020 2020 2a20 5468 6520  :..       * The 
-00014a10: 7374 7269 6e67 2069 7320 656d 7074 7920  string is empty 
-00014a20: 6f72 204e 6f6e 650a 2020 2020 2020 202a  or None.       *
-00014a30: 2054 6865 2073 7472 696e 6720 7573 6573   The string uses
-00014a40: 2063 6861 7261 6374 6572 7320 7468 6174   characters that
-00014a50: 2061 7265 206e 6f74 2061 6c6c 6f77 6564   are not allowed
-00014a60: 2069 6e20 6120 5552 4c0a 2020 2020 2020   in a URL.      
-00014a70: 202a 2054 6865 2055 524c 2073 6368 656d   * The URL schem
-00014a80: 6520 7370 6563 6966 6965 6420 2869 6620  e specified (if 
-00014a90: 6f6e 6520 6973 2073 7065 6369 6669 6564  one is specified
-00014aa0: 2920 6973 206e 6f74 2076 616c 6964 0a0a  ) is not valid..
-00014ab0: 2020 2020 2854 6865 7365 2072 756c 6573      (These rules
-00014ac0: 2061 7265 2062 6173 6564 206f 6e20 5246   are based on RF
-00014ad0: 4320 3233 3936 3a20 6874 7470 3a2f 2f77  C 2396: http://w
-00014ae0: 7777 2e66 6171 732e 6f72 672f 7266 6373  ww.faqs.org/rfcs
-00014af0: 2f72 6663 3233 3936 2e68 746d 6c29 0a0a  /rfc2396.html)..
-00014b00: 2020 2020 5468 6520 6c69 7374 206f 6620      The list of 
-00014b10: 616c 6c6f 7765 6420 7363 6865 6d65 7320  allowed schemes 
-00014b20: 6973 2063 7573 746f 6d69 7a61 626c 6520  is customizable 
-00014b30: 7769 7468 2074 6865 2061 6c6c 6f77 6564  with the allowed
-00014b40: 5f73 6368 656d 6573 0a20 2020 2070 6172  _schemes.    par
-00014b50: 616d 6574 6572 2e20 4966 2079 6f75 2065  ameter. If you e
-00014b60: 7863 6c75 6465 204e 6f6e 6520 6672 6f6d  xclude None from
-00014b70: 2074 6865 206c 6973 742c 2074 6865 6e20   the list, then 
-00014b80: 6162 6272 6576 6961 7465 6420 5552 4c73  abbreviated URLs
-00014b90: 0a20 2020 2028 6c61 636b 696e 6720 6120  .    (lacking a 
-00014ba0: 7363 6865 6d65 2073 7563 6820 6173 2027  scheme such as '
-00014bb0: 6874 7470 2729 2077 696c 6c20 6265 2072  http') will be r
-00014bc0: 656a 6563 7465 642e 0a0a 2020 2020 5468  ejected...    Th
-00014bd0: 6520 6465 6661 756c 7420 7072 6570 656e  e default prepen
-00014be0: 6465 6420 7363 6865 6d65 2069 7320 6375  ded scheme is cu
-00014bf0: 7374 6f6d 697a 6162 6c65 2077 6974 6820  stomizable with 
-00014c00: 7468 6520 7072 6570 656e 645f 7363 6865  the prepend_sche
-00014c10: 6d65 0a20 2020 2070 6172 616d 6574 6572  me.    parameter
-00014c20: 2e20 4966 2079 6f75 2073 6574 2070 7265  . If you set pre
-00014c30: 7065 6e64 5f73 6368 656d 6520 746f 204e  pend_scheme to N
-00014c40: 6f6e 6520 7468 656e 2070 7265 7065 6e64  one then prepend
-00014c50: 696e 6720 7769 6c6c 2062 650a 2020 2020  ing will be.    
-00014c60: 6469 7361 626c 6564 2e20 5552 4c73 2074  disabled. URLs t
-00014c70: 6861 7420 7265 7175 6972 6520 7072 6570  hat require prep
-00014c80: 656e 6469 6e67 2074 6f20 7061 7273 6520  ending to parse 
-00014c90: 7769 6c6c 2073 7469 6c6c 2062 6520 6163  will still be ac
-00014ca0: 6365 7074 6564 2c0a 2020 2020 6275 7420  cepted,.    but 
-00014cb0: 7468 6520 7265 7475 726e 2076 616c 7565  the return value
-00014cc0: 2077 696c 6c20 6e6f 7420 6265 206d 6f64   will not be mod
-00014cd0: 6966 6965 642e 0a0a 2020 2020 4953 5f55  ified...    IS_U
-00014ce0: 524c 2069 7320 636f 6d70 6174 6962 6c65  RL is compatible
-00014cf0: 2077 6974 6820 7468 6520 496e 7465 726e   with the Intern
-00014d00: 6174 696f 6e61 6c69 7a65 6420 446f 6d61  ationalized Doma
-00014d10: 696e 204e 616d 6520 2849 444e 2920 7374  in Name (IDN) st
-00014d20: 616e 6461 7264 0a20 2020 2073 7065 6369  andard.    speci
-00014d30: 6669 6564 2069 6e20 5246 4320 3334 3930  fied in RFC 3490
-00014d40: 2028 6874 7470 3a2f 2f74 6f6f 6c73 2e69   (http://tools.i
-00014d50: 6574 662e 6f72 672f 6874 6d6c 2f72 6663  etf.org/html/rfc
-00014d60: 3334 3930 292e 2041 7320 6120 7265 7375  3490). As a resu
-00014d70: 6c74 2c0a 2020 2020 5552 4c73 2063 616e  lt,.    URLs can
-00014d80: 2062 6520 7265 6775 6c61 7220 7374 7269   be regular stri
-00014d90: 6e67 7320 6f72 2075 6e69 636f 6465 2073  ngs or unicode s
-00014da0: 7472 696e 6773 2e0a 2020 2020 4966 2074  trings..    If t
-00014db0: 6865 2055 524c 2773 2064 6f6d 6169 6e20  he URL's domain 
-00014dc0: 636f 6d70 6f6e 656e 7420 2865 2e67 2e20  component (e.g. 
-00014dd0: 676f 6f67 6c65 2e63 6129 2063 6f6e 7461  google.ca) conta
-00014de0: 696e 7320 6e6f 6e2d 5553 2d41 5343 4949  ins non-US-ASCII
-00014df0: 0a20 2020 206c 6574 7465 7273 2c20 7468  .    letters, th
-00014e00: 656e 2074 6865 2064 6f6d 6169 6e20 7769  en the domain wi
-00014e10: 6c6c 2062 6520 636f 6e76 6572 7465 6420  ll be converted 
-00014e20: 696e 746f 2050 756e 7963 6f64 6520 2864  into Punycode (d
-00014e30: 6566 696e 6564 2069 6e0a 2020 2020 5246  efined in.    RF
-00014e40: 4320 3334 3932 2c20 6874 7470 3a2f 2f74  C 3492, http://t
-00014e50: 6f6f 6c73 2e69 6574 662e 6f72 672f 6874  ools.ietf.org/ht
-00014e60: 6d6c 2f72 6663 3334 3932 292e 2049 535f  ml/rfc3492). IS_
-00014e70: 5552 4c20 676f 6573 2061 2062 6974 2062  URL goes a bit b
-00014e80: 6579 6f6e 640a 2020 2020 7468 6520 7374  eyond.    the st
-00014e90: 616e 6461 7264 732c 2061 6e64 2061 6c6c  andards, and all
-00014ea0: 6f77 7320 6e6f 6e2d 5553 2d41 5343 4949  ows non-US-ASCII
-00014eb0: 2063 6861 7261 6374 6572 7320 746f 2062   characters to b
-00014ec0: 6520 7072 6573 656e 7420 696e 2074 6865  e present in the
-00014ed0: 2070 6174 680a 2020 2020 616e 6420 7175   path.    and qu
-00014ee0: 6572 7920 636f 6d70 6f6e 656e 7473 206f  ery components o
-00014ef0: 6620 7468 6520 5552 4c20 6173 2077 656c  f the URL as wel
-00014f00: 6c2e 2054 6865 7365 206e 6f6e 2d55 532d  l. These non-US-
-00014f10: 4153 4349 4920 6368 6172 6163 7465 7273  ASCII characters
-00014f20: 2077 696c 6c0a 2020 2020 6265 2065 7363   will.    be esc
-00014f30: 6170 6564 2075 7369 6e67 2074 6865 2073  aped using the s
-00014f40: 7461 6e64 6172 6420 2725 3230 2720 7479  tandard '%20' ty
-00014f50: 7065 2073 796e 7461 782e 2065 2e67 2e20  pe syntax. e.g. 
-00014f60: 7468 6520 756e 6963 6f64 650a 2020 2020  the unicode.    
-00014f70: 6368 6172 6163 7465 7220 7769 7468 2068  character with h
-00014f80: 6578 2063 6f64 6520 3078 3465 3836 2077  ex code 0x4e86 w
-00014f90: 696c 6c20 6265 636f 6d65 2027 2534 6525  ill become '%4e%
-00014fa0: 3836 270a 0a20 2020 2041 7267 733a 0a20  86'..    Args:. 
-00014fb0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00014fc0: 7361 6765 3a20 6120 7374 7269 6e67 2c20  sage: a string, 
-00014fd0: 7468 6520 6572 726f 7220 6d65 7373 6167  the error messag
-00014fe0: 6520 746f 2067 6976 6520 7468 6520 656e  e to give the en
-00014ff0: 6420 7573 6572 0a20 2020 2020 2020 2020  d user.         
-00015000: 2020 2069 6620 7468 6520 5552 4c20 646f     if the URL do
-00015010: 6573 206e 6f74 2076 616c 6964 6174 650a  es not validate.
-00015020: 2020 2020 2020 2020 616c 6c6f 7765 645f          allowed_
-00015030: 7363 6865 6d65 733a 2061 206c 6973 7420  schemes: a list 
-00015040: 636f 6e74 6169 6e69 6e67 2073 7472 696e  containing strin
-00015050: 6773 206f 7220 4e6f 6e65 2e20 4561 6368  gs or None. Each
-00015060: 2065 6c65 6d65 6e74 0a20 2020 2020 2020   element.       
-00015070: 2020 2020 2069 7320 6120 7363 6865 6d65       is a scheme
-00015080: 2074 6865 2069 6e70 7574 7465 6420 5552   the inputted UR
-00015090: 4c20 6973 2061 6c6c 6f77 6564 2074 6f20  L is allowed to 
-000150a0: 7573 650a 2020 2020 2020 2020 7072 6570  use.        prep
-000150b0: 656e 645f 7363 6865 6d65 3a20 6120 7374  end_scheme: a st
-000150c0: 7269 6e67 2c20 7468 6973 2073 6368 656d  ring, this schem
-000150d0: 6520 6973 2070 7265 7065 6e64 6564 2069  e is prepended i
-000150e0: 6620 6974 2773 0a20 2020 2020 2020 2020  f it's.         
-000150f0: 2020 206e 6563 6573 7361 7279 2074 6f20     necessary to 
-00015100: 6d61 6b65 2074 6865 2055 524c 2076 616c  make the URL val
-00015110: 6964 0a0a 2020 2020 436f 6465 2045 7861  id..    Code Exa
-00015120: 6d70 6c65 733a 3a0a 0a20 2020 2020 2020  mples::..       
-00015130: 2049 4e50 5554 285f 7479 7065 3d27 7465   INPUT(_type='te
-00015140: 7874 272c 205f 6e61 6d65 3d27 6e61 6d65  xt', _name='name
-00015150: 272c 2072 6571 7569 7265 733d 4953 5f55  ', requires=IS_U
-00015160: 524c 2829 290a 2020 2020 2020 2020 3e3e  RL()).        >>
-00015170: 3e20 4953 5f55 524c 2829 2827 6162 632e  > IS_URL()('abc.
-00015180: 636f 6d27 290a 2020 2020 2020 2020 2827  com').        ('
-00015190: 6874 7470 3a2f 2f61 6263 2e63 6f6d 272c  http://abc.com',
-000151a0: 204e 6f6e 6529 0a0a 2020 2020 2020 2020   None)..        
-000151b0: 494e 5055 5428 5f74 7970 653d 2774 6578  INPUT(_type='tex
-000151c0: 7427 2c20 5f6e 616d 653d 276e 616d 6527  t', _name='name'
-000151d0: 2c20 7265 7175 6972 6573 3d49 535f 5552  , requires=IS_UR
-000151e0: 4c28 6d6f 6465 3d27 6765 6e65 7269 6327  L(mode='generic'
-000151f0: 2929 0a20 2020 2020 2020 203e 3e3e 2049  )).        >>> I
-00015200: 535f 5552 4c28 6d6f 6465 3d27 6765 6e65  S_URL(mode='gene
-00015210: 7269 6327 2928 2761 6263 2e63 6f6d 2729  ric')('abc.com')
-00015220: 0a20 2020 2020 2020 2028 2761 6263 2e63  .        ('abc.c
-00015230: 6f6d 272c 204e 6f6e 6529 0a0a 2020 2020  om', None)..    
-00015240: 2020 2020 494e 5055 5428 5f74 7970 653d      INPUT(_type=
-00015250: 2774 6578 7427 2c20 5f6e 616d 653d 276e  'text', _name='n
-00015260: 616d 6527 2c0a 2020 2020 2020 2020 2020  ame',.          
-00015270: 2020 7265 7175 6972 6573 3d49 535f 5552    requires=IS_UR
-00015280: 4c28 616c 6c6f 7765 645f 7363 6865 6d65  L(allowed_scheme
-00015290: 733d 5b27 6874 7470 7327 5d2c 2070 7265  s=['https'], pre
-000152a0: 7065 6e64 5f73 6368 656d 653d 2768 7474  pend_scheme='htt
-000152b0: 7073 2729 290a 2020 2020 2020 2020 3e3e  ps')).        >>
-000152c0: 3e20 4953 5f55 524c 2861 6c6c 6f77 6564  > IS_URL(allowed
-000152d0: 5f73 6368 656d 6573 3d5b 2768 7474 7073  _schemes=['https
-000152e0: 275d 2c20 7072 6570 656e 645f 7363 6865  '], prepend_sche
-000152f0: 6d65 3d27 6874 7470 7327 2928 2768 7474  me='https')('htt
-00015300: 7073 3a2f 2f61 6263 2e63 6f6d 2729 0a20  ps://abc.com'). 
-00015310: 2020 2020 2020 2028 2768 7474 7073 3a2f         ('https:/
-00015320: 2f61 6263 2e63 6f6d 272c 204e 6f6e 6529  /abc.com', None)
-00015330: 0a0a 2020 2020 2020 2020 494e 5055 5428  ..        INPUT(
-00015340: 5f74 7970 653d 2774 6578 7427 2c20 5f6e  _type='text', _n
-00015350: 616d 653d 276e 616d 6527 2c0a 2020 2020  ame='name',.    
-00015360: 2020 2020 2020 2020 7265 7175 6972 6573          requires
-00015370: 3d49 535f 5552 4c28 7072 6570 656e 645f  =IS_URL(prepend_
-00015380: 7363 6865 6d65 3d27 6874 7470 7327 2929  scheme='https'))
-00015390: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
-000153a0: 5552 4c28 7072 6570 656e 645f 7363 6865  URL(prepend_sche
-000153b0: 6d65 3d27 6874 7470 7327 2928 2761 6263  me='https')('abc
-000153c0: 2e63 6f6d 2729 0a20 2020 2020 2020 2028  .com').        (
-000153d0: 2768 7474 7073 3a2f 2f61 6263 2e63 6f6d  'https://abc.com
-000153e0: 272c 204e 6f6e 6529 0a0a 2020 2020 2020  ', None)..      
-000153f0: 2020 494e 5055 5428 5f74 7970 653d 2774    INPUT(_type='t
-00015400: 6578 7427 2c20 5f6e 616d 653d 276e 616d  ext', _name='nam
-00015410: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
-00015420: 7265 7175 6972 6573 3d49 535f 5552 4c28  requires=IS_URL(
-00015430: 6d6f 6465 3d27 6765 6e65 7269 6327 2c20  mode='generic', 
-00015440: 616c 6c6f 7765 645f 7363 6865 6d65 733d  allowed_schemes=
-00015450: 5b27 6674 7073 272c 2027 6874 7470 7327  ['ftps', 'https'
-00015460: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00015470: 2020 2070 7265 7065 6e64 5f73 6368 656d     prepend_schem
-00015480: 653d 2768 7474 7073 2729 290a 2020 2020  e='https')).    
-00015490: 2020 2020 3e3e 3e20 4953 5f55 524c 286d      >>> IS_URL(m
-000154a0: 6f64 653d 2767 656e 6572 6963 272c 2061  ode='generic', a
-000154b0: 6c6c 6f77 6564 5f73 6368 656d 6573 3d5b  llowed_schemes=[
-000154c0: 2766 7470 7327 2c20 2768 7474 7073 275d  'ftps', 'https']
-000154d0: 2c20 7072 6570 656e 645f 7363 6865 6d65  , prepend_scheme
-000154e0: 3d27 6874 7470 7327 2928 2768 7474 7073  ='https')('https
-000154f0: 3a2f 2f61 6263 2e63 6f6d 2729 0a20 2020  ://abc.com').   
-00015500: 2020 2020 2028 2768 7474 7073 3a2f 2f61       ('https://a
-00015510: 6263 2e63 6f6d 272c 204e 6f6e 6529 0a20  bc.com', None). 
-00015520: 2020 2020 2020 203e 3e3e 2049 535f 5552         >>> IS_UR
-00015530: 4c28 6d6f 6465 3d27 6765 6e65 7269 6327  L(mode='generic'
-00015540: 2c20 616c 6c6f 7765 645f 7363 6865 6d65  , allowed_scheme
-00015550: 733d 5b27 6674 7073 272c 2027 6874 7470  s=['ftps', 'http
-00015560: 7327 2c20 4e6f 6e65 5d2c 2070 7265 7065  s', None], prepe
-00015570: 6e64 5f73 6368 656d 653d 2768 7474 7073  nd_scheme='https
-00015580: 2729 2827 6162 632e 636f 6d27 290a 2020  ')('abc.com').  
-00015590: 2020 2020 2020 2827 6162 632e 636f 6d27        ('abc.com'
-000155a0: 2c20 4e6f 6e65 290a 0a20 2020 2040 6175  , None)..    @au
-000155b0: 7468 6f72 3a20 4a6f 6e61 7468 616e 2042  thor: Jonathan B
-000155c0: 656e 6e0a 2020 2020 2222 220a 0a20 2020  enn.    """..   
-000155d0: 2064 6566 205f 5f69 6e69 745f 5f28 0a20   def __init__(. 
-000155e0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000155f0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00015600: 6765 3d22 456e 7465 7220 6120 7661 6c69  ge="Enter a vali
-00015610: 6420 5552 4c22 2c0a 2020 2020 2020 2020  d URL",.        
-00015620: 6d6f 6465 3d22 6874 7470 222c 0a20 2020  mode="http",.   
-00015630: 2020 2020 2061 6c6c 6f77 6564 5f73 6368       allowed_sch
-00015640: 656d 6573 3d4e 6f6e 652c 0a20 2020 2020  emes=None,.     
-00015650: 2020 2070 7265 7065 6e64 5f73 6368 656d     prepend_schem
-00015660: 653d 2268 7474 7022 2c0a 2020 2020 2020  e="http",.      
-00015670: 2020 616c 6c6f 7765 645f 746c 6473 3d4e    allowed_tlds=N
-00015680: 6f6e 652c 0a20 2020 2029 3a0a 0a20 2020  one,.    ):..   
-00015690: 2020 2020 2073 656c 662e 6572 726f 725f       self.error_
-000156a0: 6d65 7373 6167 6520 3d20 6572 726f 725f  message = error_
-000156b0: 6d65 7373 6167 650a 2020 2020 2020 2020  message.        
-000156c0: 7365 6c66 2e6d 6f64 6520 3d20 6d6f 6465  self.mode = mode
-000156d0: 2e6c 6f77 6572 2829 0a20 2020 2020 2020  .lower().       
-000156e0: 2069 6620 7365 6c66 2e6d 6f64 6520 6e6f   if self.mode no
-000156f0: 7420 696e 205b 2267 656e 6572 6963 222c  t in ["generic",
-00015700: 2022 6874 7470 225d 3a0a 2020 2020 2020   "http"]:.      
-00015710: 2020 2020 2020 7261 6973 6520 5379 6e74        raise Synt
-00015720: 6178 4572 726f 7228 2269 6e76 616c 6964  axError("invalid
-00015730: 206d 6f64 6520 2725 7327 2069 6e20 4953   mode '%s' in IS
-00015740: 5f55 524c 2220 2520 7365 6c66 2e6d 6f64  _URL" % self.mod
-00015750: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
-00015760: 616c 6c6f 7765 645f 7363 6865 6d65 7320  allowed_schemes 
-00015770: 3d20 616c 6c6f 7765 645f 7363 6865 6d65  = allowed_scheme
-00015780: 730a 2020 2020 2020 2020 6966 2061 6c6c  s.        if all
-00015790: 6f77 6564 5f74 6c64 7320 6973 204e 6f6e  owed_tlds is Non
-000157a0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-000157b0: 656c 662e 616c 6c6f 7765 645f 746c 6473  elf.allowed_tlds
-000157c0: 203d 206f 6666 6963 6961 6c5f 746f 705f   = official_top_
-000157d0: 6c65 7665 6c5f 646f 6d61 696e 730a 2020  level_domains.  
-000157e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000157f0: 2020 2020 2020 2020 7365 6c66 2e61 6c6c          self.all
-00015800: 6f77 6564 5f74 6c64 7320 3d20 616c 6c6f  owed_tlds = allo
-00015810: 7765 645f 746c 6473 0a0a 2020 2020 2020  wed_tlds..      
-00015820: 2020 6966 2073 656c 662e 616c 6c6f 7765    if self.allowe
-00015830: 645f 7363 6865 6d65 733a 0a20 2020 2020  d_schemes:.     
-00015840: 2020 2020 2020 2069 6620 7072 6570 656e         if prepen
-00015850: 645f 7363 6865 6d65 206e 6f74 2069 6e20  d_scheme not in 
-00015860: 7365 6c66 2e61 6c6c 6f77 6564 5f73 6368  self.allowed_sch
-00015870: 656d 6573 3a0a 2020 2020 2020 2020 2020  emes:.          
-00015880: 2020 2020 2020 7261 6973 6520 5379 6e74        raise Synt
-00015890: 6178 4572 726f 7228 0a20 2020 2020 2020  axError(.       
-000158a0: 2020 2020 2020 2020 2020 2020 2022 7072               "pr
-000158b0: 6570 656e 645f 7363 6865 6d65 3d27 2573  epend_scheme='%s
-000158c0: 2720 6973 206e 6f74 2069 6e20 616c 6c6f  ' is not in allo
-000158d0: 7765 645f 7363 6865 6d65 733d 2573 220a  wed_schemes=%s".
+00014590: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+000145a0: 775f 7661 6c75 6520 6966 2073 656c 662e  w_value if self.
+000145b0: 7072 6570 656e 645f 7363 6865 6d65 2065  prepend_scheme e
+000145c0: 6c73 6520 7661 6c75 650a 2020 2020 2020  lse value.      
+000145d0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000145e0: 7475 726e 2076 616c 7565 0a20 2020 2020  turn value.     
+000145f0: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
+00014600: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
+00014610: 2020 2020 7261 6973 6520 5661 6c69 6461      raise Valida
+00014620: 7469 6f6e 4572 726f 7228 7365 6c66 2e74  tionError(self.t
+00014630: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
+00014640: 7272 6f72 5f6d 6573 7361 6765 2929 0a0a  rror_message))..
+00014650: 0a63 6c61 7373 2049 535f 5552 4c28 5661  .class IS_URL(Va
+00014660: 6c69 6461 746f 7229 3a0a 2020 2020 2222  lidator):.    ""
+00014670: 220a 2020 2020 5265 6a65 6374 7320 6120  ".    Rejects a 
+00014680: 5552 4c20 7374 7269 6e67 2069 6620 616e  URL string if an
+00014690: 7920 6f66 2074 6865 2066 6f6c 6c6f 7769  y of the followi
+000146a0: 6e67 2069 7320 7472 7565 3a0a 0a20 2020  ng is true:..   
+000146b0: 2020 2020 2a20 5468 6520 7374 7269 6e67      * The string
+000146c0: 2069 7320 656d 7074 7920 6f72 204e 6f6e   is empty or Non
+000146d0: 650a 2020 2020 2020 202a 2054 6865 2073  e.       * The s
+000146e0: 7472 696e 6720 7573 6573 2063 6861 7261  tring uses chara
+000146f0: 6374 6572 7320 7468 6174 2061 7265 206e  cters that are n
+00014700: 6f74 2061 6c6c 6f77 6564 2069 6e20 6120  ot allowed in a 
+00014710: 5552 4c0a 2020 2020 2020 202a 2054 6865  URL.       * The
+00014720: 2073 7472 696e 6720 6272 6561 6b73 2061   string breaks a
+00014730: 6e79 206f 6620 7468 6520 4854 5450 2073  ny of the HTTP s
+00014740: 796e 7461 6374 6963 2072 756c 6573 0a20  yntactic rules. 
+00014750: 2020 2020 2020 2a20 5468 6520 5552 4c20        * The URL 
+00014760: 7363 6865 6d65 2073 7065 6369 6669 6564  scheme specified
+00014770: 2028 6966 206f 6e65 2069 7320 7370 6563   (if one is spec
+00014780: 6966 6965 6429 2069 7320 6e6f 7420 2768  ified) is not 'h
+00014790: 7474 7027 206f 7220 2768 7474 7073 270a  ttp' or 'https'.
+000147a0: 2020 2020 2020 202a 2054 6865 2074 6f70         * The top
+000147b0: 2d6c 6576 656c 2064 6f6d 6169 6e20 2869  -level domain (i
+000147c0: 6620 6120 686f 7374 206e 616d 6520 6973  f a host name is
+000147d0: 2073 7065 6369 6669 6564 2920 646f 6573   specified) does
+000147e0: 206e 6f74 2065 7869 7374 0a0a 2020 2020   not exist..    
+000147f0: 2854 6865 7365 2072 756c 6573 2061 7265  (These rules are
+00014800: 2062 6173 6564 206f 6e20 5246 4320 3236   based on RFC 26
+00014810: 3136 3a20 6874 7470 3a2f 2f77 7777 2e66  16: http://www.f
+00014820: 6171 732e 6f72 672f 7266 6373 2f72 6663  aqs.org/rfcs/rfc
+00014830: 3236 3136 2e68 746d 6c29 0a0a 2020 2020  2616.html)..    
+00014840: 5468 6973 2066 756e 6374 696f 6e20 6f6e  This function on
+00014850: 6c79 2063 6865 636b 7320 7468 6520 5552  ly checks the UR
+00014860: 4c27 7320 7379 6e74 6178 2e20 4974 2064  L's syntax. It d
+00014870: 6f65 7320 6e6f 7420 6368 6563 6b20 7468  oes not check th
+00014880: 6174 2074 6865 2055 524c 0a20 2020 2070  at the URL.    p
+00014890: 6f69 6e74 7320 746f 2061 2072 6561 6c20  oints to a real 
+000148a0: 646f 6375 6d65 6e74 2c20 666f 7220 6578  document, for ex
+000148b0: 616d 706c 652c 206f 7220 7468 6174 2069  ample, or that i
+000148c0: 7420 6f74 6865 7277 6973 6520 6d61 6b65  t otherwise make
+000148d0: 7320 7365 6e73 650a 2020 2020 7365 6d61  s sense.    sema
+000148e0: 6e74 6963 616c 6c79 2e20 5468 6973 2066  ntically. This f
+000148f0: 756e 6374 696f 6e20 646f 6573 2061 7574  unction does aut
+00014900: 6f6d 6174 6963 616c 6c79 2070 7265 7065  omatically prepe
+00014910: 6e64 2027 6874 7470 3a2f 2f27 2069 6e20  nd 'http://' in 
+00014920: 6672 6f6e 740a 2020 2020 6f66 2061 2055  front.    of a U
+00014930: 524c 2069 6e20 7468 6520 6361 7365 206f  RL in the case o
+00014940: 6620 616e 2061 6262 7265 7669 6174 6564  f an abbreviated
+00014950: 2055 524c 2028 652e 672e 2027 676f 6f67   URL (e.g. 'goog
+00014960: 6c65 2e63 6127 292e 0a0a 2020 2020 4966  le.ca')...    If
+00014970: 2074 6865 2070 6172 616d 6574 6572 206d   the parameter m
+00014980: 6f64 653d 2767 656e 6572 6963 2720 6973  ode='generic' is
+00014990: 2075 7365 642c 2074 6865 6e20 7468 6973   used, then this
+000149a0: 2066 756e 6374 696f 6e27 7320 6265 6861   function's beha
+000149b0: 7669 6f72 0a20 2020 2063 6861 6e67 6573  vior.    changes
+000149c0: 2e20 4974 2074 6865 6e20 7265 6a65 6374  . It then reject
+000149d0: 7320 6120 5552 4c20 7374 7269 6e67 2069  s a URL string i
+000149e0: 6620 616e 7920 6f66 2074 6865 2066 6f6c  f any of the fol
+000149f0: 6c6f 7769 6e67 2069 7320 7472 7565 3a0a  lowing is true:.
+00014a00: 0a20 2020 2020 2020 2a20 5468 6520 7374  .       * The st
+00014a10: 7269 6e67 2069 7320 656d 7074 7920 6f72  ring is empty or
+00014a20: 204e 6f6e 650a 2020 2020 2020 202a 2054   None.       * T
+00014a30: 6865 2073 7472 696e 6720 7573 6573 2063  he string uses c
+00014a40: 6861 7261 6374 6572 7320 7468 6174 2061  haracters that a
+00014a50: 7265 206e 6f74 2061 6c6c 6f77 6564 2069  re not allowed i
+00014a60: 6e20 6120 5552 4c0a 2020 2020 2020 202a  n a URL.       *
+00014a70: 2054 6865 2055 524c 2073 6368 656d 6520   The URL scheme 
+00014a80: 7370 6563 6966 6965 6420 2869 6620 6f6e  specified (if on
+00014a90: 6520 6973 2073 7065 6369 6669 6564 2920  e is specified) 
+00014aa0: 6973 206e 6f74 2076 616c 6964 0a0a 2020  is not valid..  
+00014ab0: 2020 2854 6865 7365 2072 756c 6573 2061    (These rules a
+00014ac0: 7265 2062 6173 6564 206f 6e20 5246 4320  re based on RFC 
+00014ad0: 3233 3936 3a20 6874 7470 3a2f 2f77 7777  2396: http://www
+00014ae0: 2e66 6171 732e 6f72 672f 7266 6373 2f72  .faqs.org/rfcs/r
+00014af0: 6663 3233 3936 2e68 746d 6c29 0a0a 2020  fc2396.html)..  
+00014b00: 2020 5468 6520 6c69 7374 206f 6620 616c    The list of al
+00014b10: 6c6f 7765 6420 7363 6865 6d65 7320 6973  lowed schemes is
+00014b20: 2063 7573 746f 6d69 7a61 626c 6520 7769   customizable wi
+00014b30: 7468 2074 6865 2061 6c6c 6f77 6564 5f73  th the allowed_s
+00014b40: 6368 656d 6573 0a20 2020 2070 6172 616d  chemes.    param
+00014b50: 6574 6572 2e20 4966 2079 6f75 2065 7863  eter. If you exc
+00014b60: 6c75 6465 204e 6f6e 6520 6672 6f6d 2074  lude None from t
+00014b70: 6865 206c 6973 742c 2074 6865 6e20 6162  he list, then ab
+00014b80: 6272 6576 6961 7465 6420 5552 4c73 0a20  breviated URLs. 
+00014b90: 2020 2028 6c61 636b 696e 6720 6120 7363     (lacking a sc
+00014ba0: 6865 6d65 2073 7563 6820 6173 2027 6874  heme such as 'ht
+00014bb0: 7470 2729 2077 696c 6c20 6265 2072 656a  tp') will be rej
+00014bc0: 6563 7465 642e 0a0a 2020 2020 5468 6520  ected...    The 
+00014bd0: 6465 6661 756c 7420 7072 6570 656e 6465  default prepende
+00014be0: 6420 7363 6865 6d65 2069 7320 6375 7374  d scheme is cust
+00014bf0: 6f6d 697a 6162 6c65 2077 6974 6820 7468  omizable with th
+00014c00: 6520 7072 6570 656e 645f 7363 6865 6d65  e prepend_scheme
+00014c10: 0a20 2020 2070 6172 616d 6574 6572 2e20  .    parameter. 
+00014c20: 4966 2079 6f75 2073 6574 2070 7265 7065  If you set prepe
+00014c30: 6e64 5f73 6368 656d 6520 746f 204e 6f6e  nd_scheme to Non
+00014c40: 6520 7468 656e 2070 7265 7065 6e64 696e  e then prependin
+00014c50: 6720 7769 6c6c 2062 650a 2020 2020 6469  g will be.    di
+00014c60: 7361 626c 6564 2e20 5552 4c73 2074 6861  sabled. URLs tha
+00014c70: 7420 7265 7175 6972 6520 7072 6570 656e  t require prepen
+00014c80: 6469 6e67 2074 6f20 7061 7273 6520 7769  ding to parse wi
+00014c90: 6c6c 2073 7469 6c6c 2062 6520 6163 6365  ll still be acce
+00014ca0: 7074 6564 2c0a 2020 2020 6275 7420 7468  pted,.    but th
+00014cb0: 6520 7265 7475 726e 2076 616c 7565 2077  e return value w
+00014cc0: 696c 6c20 6e6f 7420 6265 206d 6f64 6966  ill not be modif
+00014cd0: 6965 642e 0a0a 2020 2020 4953 5f55 524c  ied...    IS_URL
+00014ce0: 2069 7320 636f 6d70 6174 6962 6c65 2077   is compatible w
+00014cf0: 6974 6820 7468 6520 496e 7465 726e 6174  ith the Internat
+00014d00: 696f 6e61 6c69 7a65 6420 446f 6d61 696e  ionalized Domain
+00014d10: 204e 616d 6520 2849 444e 2920 7374 616e   Name (IDN) stan
+00014d20: 6461 7264 0a20 2020 2073 7065 6369 6669  dard.    specifi
+00014d30: 6564 2069 6e20 5246 4320 3334 3930 2028  ed in RFC 3490 (
+00014d40: 6874 7470 3a2f 2f74 6f6f 6c73 2e69 6574  http://tools.iet
+00014d50: 662e 6f72 672f 6874 6d6c 2f72 6663 3334  f.org/html/rfc34
+00014d60: 3930 292e 2041 7320 6120 7265 7375 6c74  90). As a result
+00014d70: 2c0a 2020 2020 5552 4c73 2063 616e 2062  ,.    URLs can b
+00014d80: 6520 7265 6775 6c61 7220 7374 7269 6e67  e regular string
+00014d90: 7320 6f72 2075 6e69 636f 6465 2073 7472  s or unicode str
+00014da0: 696e 6773 2e0a 2020 2020 4966 2074 6865  ings..    If the
+00014db0: 2055 524c 2773 2064 6f6d 6169 6e20 636f   URL's domain co
+00014dc0: 6d70 6f6e 656e 7420 2865 2e67 2e20 676f  mponent (e.g. go
+00014dd0: 6f67 6c65 2e63 6129 2063 6f6e 7461 696e  ogle.ca) contain
+00014de0: 7320 6e6f 6e2d 5553 2d41 5343 4949 0a20  s non-US-ASCII. 
+00014df0: 2020 206c 6574 7465 7273 2c20 7468 656e     letters, then
+00014e00: 2074 6865 2064 6f6d 6169 6e20 7769 6c6c   the domain will
+00014e10: 2062 6520 636f 6e76 6572 7465 6420 696e   be converted in
+00014e20: 746f 2050 756e 7963 6f64 6520 2864 6566  to Punycode (def
+00014e30: 696e 6564 2069 6e0a 2020 2020 5246 4320  ined in.    RFC 
+00014e40: 3334 3932 2c20 6874 7470 3a2f 2f74 6f6f  3492, http://too
+00014e50: 6c73 2e69 6574 662e 6f72 672f 6874 6d6c  ls.ietf.org/html
+00014e60: 2f72 6663 3334 3932 292e 2049 535f 5552  /rfc3492). IS_UR
+00014e70: 4c20 676f 6573 2061 2062 6974 2062 6579  L goes a bit bey
+00014e80: 6f6e 640a 2020 2020 7468 6520 7374 616e  ond.    the stan
+00014e90: 6461 7264 732c 2061 6e64 2061 6c6c 6f77  dards, and allow
+00014ea0: 7320 6e6f 6e2d 5553 2d41 5343 4949 2063  s non-US-ASCII c
+00014eb0: 6861 7261 6374 6572 7320 746f 2062 6520  haracters to be 
+00014ec0: 7072 6573 656e 7420 696e 2074 6865 2070  present in the p
+00014ed0: 6174 680a 2020 2020 616e 6420 7175 6572  ath.    and quer
+00014ee0: 7920 636f 6d70 6f6e 656e 7473 206f 6620  y components of 
+00014ef0: 7468 6520 5552 4c20 6173 2077 656c 6c2e  the URL as well.
+00014f00: 2054 6865 7365 206e 6f6e 2d55 532d 4153   These non-US-AS
+00014f10: 4349 4920 6368 6172 6163 7465 7273 2077  CII characters w
+00014f20: 696c 6c0a 2020 2020 6265 2065 7363 6170  ill.    be escap
+00014f30: 6564 2075 7369 6e67 2074 6865 2073 7461  ed using the sta
+00014f40: 6e64 6172 6420 2725 3230 2720 7479 7065  ndard '%20' type
+00014f50: 2073 796e 7461 782e 2065 2e67 2e20 7468   syntax. e.g. th
+00014f60: 6520 756e 6963 6f64 650a 2020 2020 6368  e unicode.    ch
+00014f70: 6172 6163 7465 7220 7769 7468 2068 6578  aracter with hex
+00014f80: 2063 6f64 6520 3078 3465 3836 2077 696c   code 0x4e86 wil
+00014f90: 6c20 6265 636f 6d65 2027 2534 6525 3836  l become '%4e%86
+00014fa0: 270a 0a20 2020 2041 7267 733a 0a20 2020  '..    Args:.   
+00014fb0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00014fc0: 6765 3a20 6120 7374 7269 6e67 2c20 7468  ge: a string, th
+00014fd0: 6520 6572 726f 7220 6d65 7373 6167 6520  e error message 
+00014fe0: 746f 2067 6976 6520 7468 6520 656e 6420  to give the end 
+00014ff0: 7573 6572 0a20 2020 2020 2020 2020 2020  user.           
+00015000: 2069 6620 7468 6520 5552 4c20 646f 6573   if the URL does
+00015010: 206e 6f74 2076 616c 6964 6174 650a 2020   not validate.  
+00015020: 2020 2020 2020 616c 6c6f 7765 645f 7363        allowed_sc
+00015030: 6865 6d65 733a 2061 206c 6973 7420 636f  hemes: a list co
+00015040: 6e74 6169 6e69 6e67 2073 7472 696e 6773  ntaining strings
+00015050: 206f 7220 4e6f 6e65 2e20 4561 6368 2065   or None. Each e
+00015060: 6c65 6d65 6e74 0a20 2020 2020 2020 2020  lement.         
+00015070: 2020 2069 7320 6120 7363 6865 6d65 2074     is a scheme t
+00015080: 6865 2069 6e70 7574 7465 6420 5552 4c20  he inputted URL 
+00015090: 6973 2061 6c6c 6f77 6564 2074 6f20 7573  is allowed to us
+000150a0: 650a 2020 2020 2020 2020 7072 6570 656e  e.        prepen
+000150b0: 645f 7363 6865 6d65 3a20 6120 7374 7269  d_scheme: a stri
+000150c0: 6e67 2c20 7468 6973 2073 6368 656d 6520  ng, this scheme 
+000150d0: 6973 2070 7265 7065 6e64 6564 2069 6620  is prepended if 
+000150e0: 6974 2773 0a20 2020 2020 2020 2020 2020  it's.           
+000150f0: 206e 6563 6573 7361 7279 2074 6f20 6d61   necessary to ma
+00015100: 6b65 2074 6865 2055 524c 2076 616c 6964  ke the URL valid
+00015110: 0a0a 2020 2020 436f 6465 2045 7861 6d70  ..    Code Examp
+00015120: 6c65 733a 3a0a 0a20 2020 2020 2020 2049  les::..        I
+00015130: 4e50 5554 285f 7479 7065 3d27 7465 7874  NPUT(_type='text
+00015140: 272c 205f 6e61 6d65 3d27 6e61 6d65 272c  ', _name='name',
+00015150: 2072 6571 7569 7265 733d 4953 5f55 524c   requires=IS_URL
+00015160: 2829 290a 2020 2020 2020 2020 3e3e 3e20  ()).        >>> 
+00015170: 4953 5f55 524c 2829 2827 6162 632e 636f  IS_URL()('abc.co
+00015180: 6d27 290a 2020 2020 2020 2020 2827 6874  m').        ('ht
+00015190: 7470 3a2f 2f61 6263 2e63 6f6d 272c 204e  tp://abc.com', N
+000151a0: 6f6e 6529 0a0a 2020 2020 2020 2020 494e  one)..        IN
+000151b0: 5055 5428 5f74 7970 653d 2774 6578 7427  PUT(_type='text'
+000151c0: 2c20 5f6e 616d 653d 276e 616d 6527 2c20  , _name='name', 
+000151d0: 7265 7175 6972 6573 3d49 535f 5552 4c28  requires=IS_URL(
+000151e0: 6d6f 6465 3d27 6765 6e65 7269 6327 2929  mode='generic'))
+000151f0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+00015200: 5552 4c28 6d6f 6465 3d27 6765 6e65 7269  URL(mode='generi
+00015210: 6327 2928 2761 6263 2e63 6f6d 2729 0a20  c')('abc.com'). 
+00015220: 2020 2020 2020 2028 2761 6263 2e63 6f6d         ('abc.com
+00015230: 272c 204e 6f6e 6529 0a0a 2020 2020 2020  ', None)..      
+00015240: 2020 494e 5055 5428 5f74 7970 653d 2774    INPUT(_type='t
+00015250: 6578 7427 2c20 5f6e 616d 653d 276e 616d  ext', _name='nam
+00015260: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
+00015270: 7265 7175 6972 6573 3d49 535f 5552 4c28  requires=IS_URL(
+00015280: 616c 6c6f 7765 645f 7363 6865 6d65 733d  allowed_schemes=
+00015290: 5b27 6874 7470 7327 5d2c 2070 7265 7065  ['https'], prepe
+000152a0: 6e64 5f73 6368 656d 653d 2768 7474 7073  nd_scheme='https
+000152b0: 2729 290a 2020 2020 2020 2020 3e3e 3e20  ')).        >>> 
+000152c0: 4953 5f55 524c 2861 6c6c 6f77 6564 5f73  IS_URL(allowed_s
+000152d0: 6368 656d 6573 3d5b 2768 7474 7073 275d  chemes=['https']
+000152e0: 2c20 7072 6570 656e 645f 7363 6865 6d65  , prepend_scheme
+000152f0: 3d27 6874 7470 7327 2928 2768 7474 7073  ='https')('https
+00015300: 3a2f 2f61 6263 2e63 6f6d 2729 0a20 2020  ://abc.com').   
+00015310: 2020 2020 2028 2768 7474 7073 3a2f 2f61       ('https://a
+00015320: 6263 2e63 6f6d 272c 204e 6f6e 6529 0a0a  bc.com', None)..
+00015330: 2020 2020 2020 2020 494e 5055 5428 5f74          INPUT(_t
+00015340: 7970 653d 2774 6578 7427 2c20 5f6e 616d  ype='text', _nam
+00015350: 653d 276e 616d 6527 2c0a 2020 2020 2020  e='name',.      
+00015360: 2020 2020 2020 7265 7175 6972 6573 3d49        requires=I
+00015370: 535f 5552 4c28 7072 6570 656e 645f 7363  S_URL(prepend_sc
+00015380: 6865 6d65 3d27 6874 7470 7327 2929 0a20  heme='https')). 
+00015390: 2020 2020 2020 203e 3e3e 2049 535f 5552         >>> IS_UR
+000153a0: 4c28 7072 6570 656e 645f 7363 6865 6d65  L(prepend_scheme
+000153b0: 3d27 6874 7470 7327 2928 2761 6263 2e63  ='https')('abc.c
+000153c0: 6f6d 2729 0a20 2020 2020 2020 2028 2768  om').        ('h
+000153d0: 7474 7073 3a2f 2f61 6263 2e63 6f6d 272c  ttps://abc.com',
+000153e0: 204e 6f6e 6529 0a0a 2020 2020 2020 2020   None)..        
+000153f0: 494e 5055 5428 5f74 7970 653d 2774 6578  INPUT(_type='tex
+00015400: 7427 2c20 5f6e 616d 653d 276e 616d 6527  t', _name='name'
+00015410: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
+00015420: 7175 6972 6573 3d49 535f 5552 4c28 6d6f  quires=IS_URL(mo
+00015430: 6465 3d27 6765 6e65 7269 6327 2c20 616c  de='generic', al
+00015440: 6c6f 7765 645f 7363 6865 6d65 733d 5b27  lowed_schemes=['
+00015450: 6674 7073 272c 2027 6874 7470 7327 5d2c  ftps', 'https'],
+00015460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015470: 2070 7265 7065 6e64 5f73 6368 656d 653d   prepend_scheme=
+00015480: 2768 7474 7073 2729 290a 2020 2020 2020  'https')).      
+00015490: 2020 3e3e 3e20 4953 5f55 524c 286d 6f64    >>> IS_URL(mod
+000154a0: 653d 2767 656e 6572 6963 272c 2061 6c6c  e='generic', all
+000154b0: 6f77 6564 5f73 6368 656d 6573 3d5b 2766  owed_schemes=['f
+000154c0: 7470 7327 2c20 2768 7474 7073 275d 2c20  tps', 'https'], 
+000154d0: 7072 6570 656e 645f 7363 6865 6d65 3d27  prepend_scheme='
+000154e0: 6874 7470 7327 2928 2768 7474 7073 3a2f  https')('https:/
+000154f0: 2f61 6263 2e63 6f6d 2729 0a20 2020 2020  /abc.com').     
+00015500: 2020 2028 2768 7474 7073 3a2f 2f61 6263     ('https://abc
+00015510: 2e63 6f6d 272c 204e 6f6e 6529 0a20 2020  .com', None).   
+00015520: 2020 2020 203e 3e3e 2049 535f 5552 4c28       >>> IS_URL(
+00015530: 6d6f 6465 3d27 6765 6e65 7269 6327 2c20  mode='generic', 
+00015540: 616c 6c6f 7765 645f 7363 6865 6d65 733d  allowed_schemes=
+00015550: 5b27 6674 7073 272c 2027 6874 7470 7327  ['ftps', 'https'
+00015560: 2c20 4e6f 6e65 5d2c 2070 7265 7065 6e64  , None], prepend
+00015570: 5f73 6368 656d 653d 2768 7474 7073 2729  _scheme='https')
+00015580: 2827 6162 632e 636f 6d27 290a 2020 2020  ('abc.com').    
+00015590: 2020 2020 2827 6162 632e 636f 6d27 2c20      ('abc.com', 
+000155a0: 4e6f 6e65 290a 0a20 2020 2040 6175 7468  None)..    @auth
+000155b0: 6f72 3a20 4a6f 6e61 7468 616e 2042 656e  or: Jonathan Ben
+000155c0: 6e0a 2020 2020 2222 220a 0a20 2020 2064  n.    """..    d
+000155d0: 6566 205f 5f69 6e69 745f 5f28 0a20 2020  ef __init__(.   
+000155e0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000155f0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00015600: 3d22 456e 7465 7220 6120 7661 6c69 6420  ="Enter a valid 
+00015610: 5552 4c22 2c0a 2020 2020 2020 2020 6d6f  URL",.        mo
+00015620: 6465 3d22 6874 7470 222c 0a20 2020 2020  de="http",.     
+00015630: 2020 2061 6c6c 6f77 6564 5f73 6368 656d     allowed_schem
+00015640: 6573 3d4e 6f6e 652c 0a20 2020 2020 2020  es=None,.       
+00015650: 2070 7265 7065 6e64 5f73 6368 656d 653d   prepend_scheme=
+00015660: 2268 7474 7022 2c0a 2020 2020 2020 2020  "http",.        
+00015670: 616c 6c6f 7765 645f 746c 6473 3d4e 6f6e  allowed_tlds=Non
+00015680: 652c 0a20 2020 2029 3a0a 0a20 2020 2020  e,.    ):..     
+00015690: 2020 2073 656c 662e 6572 726f 725f 6d65     self.error_me
+000156a0: 7373 6167 6520 3d20 6572 726f 725f 6d65  ssage = error_me
+000156b0: 7373 6167 650a 2020 2020 2020 2020 7365  ssage.        se
+000156c0: 6c66 2e6d 6f64 6520 3d20 6d6f 6465 2e6c  lf.mode = mode.l
+000156d0: 6f77 6572 2829 0a20 2020 2020 2020 2069  ower().        i
+000156e0: 6620 7365 6c66 2e6d 6f64 6520 6e6f 7420  f self.mode not 
+000156f0: 696e 205b 2267 656e 6572 6963 222c 2022  in ["generic", "
+00015700: 6874 7470 225d 3a0a 2020 2020 2020 2020  http"]:.        
+00015710: 2020 2020 7261 6973 6520 5379 6e74 6178      raise Syntax
+00015720: 4572 726f 7228 2269 6e76 616c 6964 206d  Error("invalid m
+00015730: 6f64 6520 2725 7327 2069 6e20 4953 5f55  ode '%s' in IS_U
+00015740: 524c 2220 2520 7365 6c66 2e6d 6f64 6529  RL" % self.mode)
+00015750: 0a20 2020 2020 2020 2073 656c 662e 616c  .        self.al
+00015760: 6c6f 7765 645f 7363 6865 6d65 7320 3d20  lowed_schemes = 
+00015770: 616c 6c6f 7765 645f 7363 6865 6d65 730a  allowed_schemes.
+00015780: 2020 2020 2020 2020 6966 2061 6c6c 6f77          if allow
+00015790: 6564 5f74 6c64 7320 6973 204e 6f6e 653a  ed_tlds is None:
+000157a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000157b0: 662e 616c 6c6f 7765 645f 746c 6473 203d  f.allowed_tlds =
+000157c0: 206f 6666 6963 6961 6c5f 746f 705f 6c65   official_top_le
+000157d0: 7665 6c5f 646f 6d61 696e 730a 2020 2020  vel_domains.    
+000157e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000157f0: 2020 2020 2020 7365 6c66 2e61 6c6c 6f77        self.allow
+00015800: 6564 5f74 6c64 7320 3d20 616c 6c6f 7765  ed_tlds = allowe
+00015810: 645f 746c 6473 0a0a 2020 2020 2020 2020  d_tlds..        
+00015820: 6966 2073 656c 662e 616c 6c6f 7765 645f  if self.allowed_
+00015830: 7363 6865 6d65 733a 0a20 2020 2020 2020  schemes:.       
+00015840: 2020 2020 2069 6620 7072 6570 656e 645f       if prepend_
+00015850: 7363 6865 6d65 206e 6f74 2069 6e20 7365  scheme not in se
+00015860: 6c66 2e61 6c6c 6f77 6564 5f73 6368 656d  lf.allowed_schem
+00015870: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00015880: 2020 2020 7261 6973 6520 5379 6e74 6178      raise Syntax
+00015890: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000158a0: 2020 2020 2020 2020 2020 2022 7072 6570             "prep
+000158b0: 656e 645f 7363 6865 6d65 3d27 2573 2720  end_scheme='%s' 
+000158c0: 6973 206e 6f74 2069 6e20 616c 6c6f 7765  is not in allowe
+000158d0: 645f 7363 6865 6d65 733d 2573 220a 2020  d_schemes=%s".  
 000158e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000158f0: 2020 2020 2520 2870 7265 7065 6e64 5f73      % (prepend_s
-00015900: 6368 656d 652c 2073 656c 662e 616c 6c6f  cheme, self.allo
-00015910: 7765 645f 7363 6865 6d65 7329 0a20 2020  wed_schemes).   
-00015920: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-00015930: 2020 2020 2020 2020 2320 6966 2061 6c6c          # if all
-00015940: 6f77 6564 5f73 6368 656d 6573 2069 7320  owed_schemes is 
-00015950: 4e6f 6e65 2c20 7468 656e 2077 6520 7769  None, then we wi
-00015960: 6c6c 2064 6566 6572 2074 6573 7469 6e67  ll defer testing
-00015970: 0a20 2020 2020 2020 2023 2070 7265 7065  .        # prepe
-00015980: 6e64 5f73 6368 656d 6527 7320 7661 6c69  nd_scheme's vali
-00015990: 6469 7479 2074 6f20 6120 7375 622d 6d65  dity to a sub-me
-000159a0: 7468 6f64 0a0a 2020 2020 2020 2020 7365  thod..        se
-000159b0: 6c66 2e70 7265 7065 6e64 5f73 6368 656d  lf.prepend_schem
-000159c0: 6520 3d20 7072 6570 656e 645f 7363 6865  e = prepend_sche
-000159d0: 6d65 0a0a 2020 2020 6465 6620 7661 6c69  me..    def vali
-000159e0: 6461 7465 2873 656c 662c 2076 616c 7565  date(self, value
-000159f0: 2c20 7265 636f 7264 5f69 643d 4e6f 6e65  , record_id=None
-00015a00: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00015a10: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
-00015a20: 2020 2020 2020 2020 2076 616c 7565 3a20           value: 
-00015a30: 6120 756e 6963 6f64 6520 6f72 2072 6567  a unicode or reg
-00015a40: 756c 6172 2073 7472 696e 672c 2074 6865  ular string, the
-00015a50: 2055 524c 2074 6f20 7661 6c69 6461 7465   URL to validate
-00015a60: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00015a70: 733a 0a20 2020 2020 2020 2020 2020 2061  s:.            a
-00015a80: 2028 7374 7269 6e67 2c20 7374 7269 6e67   (string, string
-00015a90: 2920 7475 706c 652c 2077 6865 7265 2074  ) tuple, where t
-00015aa0: 7570 6c65 5b30 5d20 6973 2074 6865 206d  uple[0] is the m
-00015ab0: 6f64 6966 6965 640a 2020 2020 2020 2020  odified.        
-00015ac0: 2020 2020 696e 7075 7420 7661 6c75 6520      input value 
-00015ad0: 616e 6420 7475 706c 655b 315d 2069 7320  and tuple[1] is 
-00015ae0: 6569 7468 6572 204e 6f6e 6520 2873 7563  either None (suc
-00015af0: 6365 7373 2129 206f 7220 7468 650a 2020  cess!) or the.  
-00015b00: 2020 2020 2020 2020 2020 7374 7269 6e67            string
-00015b10: 2065 7272 6f72 5f6d 6573 7361 6765 2e20   error_message. 
-00015b20: 5468 6520 696e 7075 7420 7661 6c75 6520  The input value 
-00015b30: 7769 6c6c 206e 6576 6572 2062 6520 6d6f  will never be mo
-00015b40: 6469 6669 6564 2069 6e20 7468 650a 2020  dified in the.  
-00015b50: 2020 2020 2020 2020 2020 6361 7365 206f            case o
-00015b60: 6620 616e 2065 7272 6f72 2e20 486f 7765  f an error. Howe
-00015b70: 7665 722c 2069 6620 7468 6572 6520 6973  ver, if there is
-00015b80: 2073 7563 6365 7373 2074 6865 6e20 7468   success then th
-00015b90: 6520 696e 7075 7420 5552 4c0a 2020 2020  e input URL.    
-00015ba0: 2020 2020 2020 2020 6d61 7920 6265 206d          may be m
-00015bb0: 6f64 6966 6965 6420 746f 2028 3129 2070  odified to (1) p
-00015bc0: 7265 7065 6e64 2061 2073 6368 656d 652c  repend a scheme,
-00015bd0: 2061 6e64 2f6f 7220 2832 2920 636f 6e76   and/or (2) conv
-00015be0: 6572 7420 610a 2020 2020 2020 2020 2020  ert a.          
-00015bf0: 2020 6e6f 6e2d 636f 6d70 6c69 616e 7420    non-compliant 
-00015c00: 756e 6963 6f64 6520 5552 4c20 696e 746f  unicode URL into
-00015c10: 2061 2063 6f6d 706c 6961 6e74 2055 532d   a compliant US-
-00015c20: 4153 4349 4920 7665 7273 696f 6e2e 0a20  ASCII version.. 
-00015c30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00015c40: 2020 2069 6620 7365 6c66 2e6d 6f64 6520     if self.mode 
-00015c50: 3d3d 2022 6765 6e65 7269 6322 3a0a 2020  == "generic":.  
-00015c60: 2020 2020 2020 2020 2020 7375 624d 6574            subMet
-00015c70: 686f 6420 3d20 4953 5f47 454e 4552 4943  hod = IS_GENERIC
-00015c80: 5f55 524c 280a 2020 2020 2020 2020 2020  _URL(.          
-00015c90: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00015ca0: 6167 653d 7365 6c66 2e65 7272 6f72 5f6d  age=self.error_m
-00015cb0: 6573 7361 6765 2c0a 2020 2020 2020 2020  essage,.        
-00015cc0: 2020 2020 2020 2020 616c 6c6f 7765 645f          allowed_
-00015cd0: 7363 6865 6d65 733d 7365 6c66 2e61 6c6c  schemes=self.all
-00015ce0: 6f77 6564 5f73 6368 656d 6573 2c0a 2020  owed_schemes,.  
-00015cf0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00015d00: 6570 656e 645f 7363 6865 6d65 3d73 656c  epend_scheme=sel
-00015d10: 662e 7072 6570 656e 645f 7363 6865 6d65  f.prepend_scheme
-00015d20: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00015d30: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00015d40: 662e 6d6f 6465 203d 3d20 2268 7474 7022  f.mode == "http"
-00015d50: 3a0a 2020 2020 2020 2020 2020 2020 7375  :.            su
-00015d60: 624d 6574 686f 6420 3d20 4953 5f48 5454  bMethod = IS_HTT
-00015d70: 505f 5552 4c28 0a20 2020 2020 2020 2020  P_URL(.         
-00015d80: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00015d90: 7361 6765 3d73 656c 662e 6572 726f 725f  sage=self.error_
-00015da0: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
-00015db0: 2020 2020 2020 2020 2061 6c6c 6f77 6564           allowed
-00015dc0: 5f73 6368 656d 6573 3d73 656c 662e 616c  _schemes=self.al
-00015dd0: 6c6f 7765 645f 7363 6865 6d65 732c 0a20  lowed_schemes,. 
-00015de0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00015df0: 7265 7065 6e64 5f73 6368 656d 653d 7365  repend_scheme=se
-00015e00: 6c66 2e70 7265 7065 6e64 5f73 6368 656d  lf.prepend_schem
-00015e10: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00015e20: 2020 2061 6c6c 6f77 6564 5f74 6c64 733d     allowed_tlds=
-00015e30: 7365 6c66 2e61 6c6c 6f77 6564 5f74 6c64  self.allowed_tld
-00015e40: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-00015e50: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00015e60: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00015e70: 2053 796e 7461 7845 7272 6f72 2822 696e   SyntaxError("in
-00015e80: 7661 6c69 6420 6d6f 6465 2027 2573 2720  valid mode '%s' 
-00015e90: 696e 2049 535f 5552 4c22 2025 2073 656c  in IS_URL" % sel
-00015ea0: 662e 6d6f 6465 290a 0a20 2020 2020 2020  f.mode)..       
-00015eb0: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
-00015ec0: 616c 7565 2c20 756e 6963 6f64 6554 293a  alue, unicodeT):
-00015ed0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-00015ee0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015ef0: 2020 7661 6c75 6520 3d20 756e 6963 6f64    value = unicod
-00015f00: 655f 746f 5f61 7363 6969 5f75 726c 2876  e_to_ascii_url(v
-00015f10: 616c 7565 2c20 7365 6c66 2e70 7265 7065  alue, self.prepe
-00015f20: 6e64 5f73 6368 656d 6529 0a20 2020 2020  nd_scheme).     
-00015f30: 2020 2020 2020 2065 7863 6570 7420 4578         except Ex
-00015f40: 6365 7074 696f 6e20 6173 2065 3a0a 2020  ception as e:.  
-00015f50: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00015f60: 4966 2077 6520 6172 6520 6e6f 7420 6162  If we are not ab
-00015f70: 6c65 2074 6f20 636f 6e76 6572 7420 7468  le to convert th
-00015f80: 6520 756e 6963 6f64 6520 7572 6c20 696e  e unicode url in
-00015f90: 746f 2061 0a20 2020 2020 2020 2020 2020  to a.           
-00015fa0: 2020 2020 2023 2055 532d 4153 4349 4920       # US-ASCII 
-00015fb0: 5552 4c2c 2074 6865 6e20 7468 6520 5552  URL, then the UR
-00015fc0: 4c20 6973 206e 6f74 2076 616c 6964 0a20  L is not valid. 
-00015fd0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00015fe0: 6169 7365 2056 616c 6964 6174 696f 6e45  aise ValidationE
-00015ff0: 7272 6f72 2873 656c 662e 7472 616e 736c  rror(self.transl
-00016000: 6174 6f72 2873 656c 662e 6572 726f 725f  ator(self.error_
-00016010: 6d65 7373 6167 6529 290a 2020 2020 2020  message)).      
-00016020: 2020 7265 7475 726e 2073 7562 4d65 7468    return subMeth
-00016030: 6f64 2e76 616c 6964 6174 6528 7661 6c75  od.validate(valu
-00016040: 652c 2072 6563 6f72 645f 6964 290a 0a0a  e, record_id)...
-00016050: 636c 6173 7320 4953 5f54 494d 4528 5661  class IS_TIME(Va
-00016060: 6c69 6461 746f 7229 3a0a 2020 2020 2222  lidator):.    ""
-00016070: 220a 2020 2020 4578 616d 706c 653a 0a20  ".    Example:. 
-00016080: 2020 2020 2020 2055 7365 2061 733a 3a0a         Use as::.
-00016090: 0a20 2020 2020 2020 2020 2020 2049 4e50  .            INP
-000160a0: 5554 285f 7479 7065 3d27 7465 7874 272c  UT(_type='text',
-000160b0: 205f 6e61 6d65 3d27 6e61 6d65 272c 2072   _name='name', r
-000160c0: 6571 7569 7265 733d 4953 5f54 494d 4528  equires=IS_TIME(
-000160d0: 2929 0a0a 2020 2020 756e 6465 7273 7461  ))..    understa
-000160e0: 6e64 7320 7468 6520 666f 6c6c 6f77 696e  nds the followin
-000160f0: 6720 666f 726d 6174 730a 2020 2020 6868  g formats.    hh
-00016100: 3a6d 6d3a 7373 205b 616d 2f70 6d5d 0a20  :mm:ss [am/pm]. 
-00016110: 2020 2068 683a 6d6d 205b 616d 2f70 6d5d     hh:mm [am/pm]
-00016120: 0a20 2020 2068 6820 5b61 6d2f 706d 5d0a  .    hh [am/pm].
-00016130: 0a20 2020 205b 616d 2f70 6d5d 2069 7320  .    [am/pm] is 
-00016140: 6f70 7469 6f6e 616c 2c20 273a 2720 6361  optional, ':' ca
-00016150: 6e20 6265 2072 6570 6c61 6365 6420 6279  n be replaced by
-00016160: 2061 6e79 206f 7468 6572 206e 6f6e 2d73   any other non-s
-00016170: 7061 6365 206e 6f6e 2d64 6967 6974 3a3a  pace non-digit::
-00016180: 0a0a 2020 2020 2020 2020 3e3e 3e20 4953  ..        >>> IS
-00016190: 5f54 494d 4528 2928 2732 313a 3330 2729  _TIME()('21:30')
-000161a0: 0a20 2020 2020 2020 2028 6461 7465 7469  .        (dateti
-000161b0: 6d65 2e74 696d 6528 3231 2c20 3330 292c  me.time(21, 30),
-000161c0: 204e 6f6e 6529 0a20 2020 2020 2020 203e   None).        >
-000161d0: 3e3e 2049 535f 5449 4d45 2829 2827 3231  >> IS_TIME()('21
-000161e0: 2d33 3027 290a 2020 2020 2020 2020 2864  -30').        (d
-000161f0: 6174 6574 696d 652e 7469 6d65 2832 312c  atetime.time(21,
-00016200: 2033 3029 2c20 4e6f 6e65 290a 2020 2020   30), None).    
-00016210: 2020 2020 3e3e 3e20 4953 5f54 494d 4528      >>> IS_TIME(
-00016220: 2928 2732 312e 3330 2729 0a20 2020 2020  )('21.30').     
-00016230: 2020 2028 6461 7465 7469 6d65 2e74 696d     (datetime.tim
-00016240: 6528 3231 2c20 3330 292c 204e 6f6e 6529  e(21, 30), None)
-00016250: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
-00016260: 5449 4d45 2829 2827 3231 3a33 303a 3539  TIME()('21:30:59
-00016270: 2729 0a20 2020 2020 2020 2028 6461 7465  ').        (date
-00016280: 7469 6d65 2e74 696d 6528 3231 2c20 3330  time.time(21, 30
-00016290: 2c20 3539 292c 204e 6f6e 6529 0a20 2020  , 59), None).   
-000162a0: 2020 2020 203e 3e3e 2049 535f 5449 4d45       >>> IS_TIME
-000162b0: 2829 2827 353a 3330 2729 0a20 2020 2020  ()('5:30').     
-000162c0: 2020 2028 6461 7465 7469 6d65 2e74 696d     (datetime.tim
-000162d0: 6528 352c 2033 3029 2c20 4e6f 6e65 290a  e(5, 30), None).
-000162e0: 2020 2020 2020 2020 3e3e 3e20 4953 5f54          >>> IS_T
-000162f0: 494d 4528 2928 2735 3a33 3020 616d 2729  IME()('5:30 am')
-00016300: 0a20 2020 2020 2020 2028 6461 7465 7469  .        (dateti
-00016310: 6d65 2e74 696d 6528 352c 2033 3029 2c20  me.time(5, 30), 
-00016320: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
-00016330: 3e20 4953 5f54 494d 4528 2928 2735 3a33  > IS_TIME()('5:3
-00016340: 3020 706d 2729 0a20 2020 2020 2020 2028  0 pm').        (
-00016350: 6461 7465 7469 6d65 2e74 696d 6528 3137  datetime.time(17
-00016360: 2c20 3330 292c 204e 6f6e 6529 0a20 2020  , 30), None).   
-00016370: 2020 2020 203e 3e3e 2049 535f 5449 4d45       >>> IS_TIME
-00016380: 2829 2827 353a 3330 2077 6861 7465 7665  ()('5:30 whateve
-00016390: 7227 290a 2020 2020 2020 2020 2827 353a  r').        ('5:
-000163a0: 3330 2077 6861 7465 7665 7227 2c20 2765  30 whatever', 'e
-000163b0: 6e74 6572 2074 696d 6520 6173 2068 683a  nter time as hh:
-000163c0: 6d6d 3a73 7320 2873 6563 6f6e 6473 2c20  mm:ss (seconds, 
-000163d0: 616d 2c20 706d 206f 7074 696f 6e61 6c29  am, pm optional)
-000163e0: 2729 0a20 2020 2020 2020 203e 3e3e 2049  ').        >>> I
-000163f0: 535f 5449 4d45 2829 2827 353a 3330 2032  S_TIME()('5:30 2
-00016400: 3027 290a 2020 2020 2020 2020 2827 353a  0').        ('5:
-00016410: 3330 2032 3027 2c20 2765 6e74 6572 2074  30 20', 'enter t
-00016420: 696d 6520 6173 2068 683a 6d6d 3a73 7320  ime as hh:mm:ss 
-00016430: 2873 6563 6f6e 6473 2c20 616d 2c20 706d  (seconds, am, pm
-00016440: 206f 7074 696f 6e61 6c29 2729 0a20 2020   optional)').   
-00016450: 2020 2020 203e 3e3e 2049 535f 5449 4d45       >>> IS_TIME
-00016460: 2829 2827 3234 3a33 3027 290a 2020 2020  ()('24:30').    
-00016470: 2020 2020 2827 3234 3a33 3027 2c20 2765      ('24:30', 'e
-00016480: 6e74 6572 2074 696d 6520 6173 2068 683a  nter time as hh:
-00016490: 6d6d 3a73 7320 2873 6563 6f6e 6473 2c20  mm:ss (seconds, 
-000164a0: 616d 2c20 706d 206f 7074 696f 6e61 6c29  am, pm optional)
-000164b0: 2729 0a20 2020 2020 2020 203e 3e3e 2049  ').        >>> I
-000164c0: 535f 5449 4d45 2829 2827 3231 3a36 3027  S_TIME()('21:60'
-000164d0: 290a 2020 2020 2020 2020 2827 3231 3a36  ).        ('21:6
-000164e0: 3027 2c20 2765 6e74 6572 2074 696d 6520  0', 'enter time 
-000164f0: 6173 2068 683a 6d6d 3a73 7320 2873 6563  as hh:mm:ss (sec
-00016500: 6f6e 6473 2c20 616d 2c20 706d 206f 7074  onds, am, pm opt
-00016510: 696f 6e61 6c29 2729 0a20 2020 2020 2020  ional)').       
-00016520: 203e 3e3e 2049 535f 5449 4d45 2829 2827   >>> IS_TIME()('
-00016530: 3231 3a33 303a 3a27 290a 2020 2020 2020  21:30::').      
-00016540: 2020 2827 3231 3a33 303a 3a27 2c20 2765    ('21:30::', 'e
-00016550: 6e74 6572 2074 696d 6520 6173 2068 683a  nter time as hh:
-00016560: 6d6d 3a73 7320 2873 6563 6f6e 6473 2c20  mm:ss (seconds, 
-00016570: 616d 2c20 706d 206f 7074 696f 6e61 6c29  am, pm optional)
-00016580: 2729 0a20 2020 2020 2020 203e 3e3e 2049  ').        >>> I
-00016590: 535f 5449 4d45 2829 2827 2729 0a20 2020  S_TIME()('').   
-000165a0: 2020 2020 2028 2727 2c20 2765 6e74 6572       ('', 'enter
-000165b0: 2074 696d 6520 6173 2068 683a 6d6d 3a73   time as hh:mm:s
-000165c0: 7320 2873 6563 6f6e 6473 2c20 616d 2c20  s (seconds, am, 
-000165d0: 706d 206f 7074 696f 6e61 6c29 2729 c3b9  pm optional)')..
-000165e0: 0a0a 2020 2020 2222 220a 0a20 2020 2052  ..    """..    R
-000165f0: 4547 4558 5f54 494d 4520 3d20 2228 283f  EGEX_TIME = "((?
-00016600: 503c 683e 5b30 2d39 5d2b 2929 285b 5e30  P<h>[0-9]+))([^0
-00016610: 2d39 205d 2b28 3f50 3c6d 3e5b 302d 3920  -9 ]+(?P<m>[0-9 
-00016620: 5d2b 2929 3f28 5b5e 302d 3961 7020 5d2b  ]+))?([^0-9ap ]+
-00016630: 283f 503c 733e 5b30 2d39 5d2a 2929 3f28  (?P<s>[0-9]*))?(
-00016640: 283f 503c 643e 5b61 705d 6d29 293f 220a  (?P<d>[ap]m))?".
-00016650: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00016660: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
-00016670: 2065 7272 6f72 5f6d 6573 7361 6765 3d22   error_message="
-00016680: 456e 7465 7220 7469 6d65 2061 7320 6868  Enter time as hh
-00016690: 3a6d 6d3a 7373 2028 7365 636f 6e64 732c  :mm:ss (seconds,
-000166a0: 2061 6d2c 2070 6d20 6f70 7469 6f6e 616c   am, pm optional
-000166b0: 2922 0a20 2020 2029 3a0a 2020 2020 2020  )".    ):.      
-000166c0: 2020 7365 6c66 2e65 7272 6f72 5f6d 6573    self.error_mes
-000166d0: 7361 6765 203d 2065 7272 6f72 5f6d 6573  sage = error_mes
-000166e0: 7361 6765 0a0a 2020 2020 6465 6620 7661  sage..    def va
-000166f0: 6c69 6461 7465 2873 656c 662c 2076 616c  lidate(self, val
-00016700: 7565 2c20 7265 636f 7264 5f69 643d 4e6f  ue, record_id=No
-00016710: 6e65 293a 0a20 2020 2020 2020 2074 7279  ne):.        try
-00016720: 3a0a 2020 2020 2020 2020 2020 2020 6976  :.            iv
-00016730: 616c 7565 203d 2076 616c 7565 0a20 2020  alue = value.   
-00016740: 2020 2020 2020 2020 2076 616c 7565 203d           value =
-00016750: 2072 652e 6d61 7463 6828 7365 6c66 2e52   re.match(self.R
-00016760: 4547 4558 5f54 494d 452c 2076 616c 7565  EGEX_TIME, value
-00016770: 2e6c 6f77 6572 2829 290a 2020 2020 2020  .lower()).      
-00016780: 2020 2020 2020 2868 2c20 6d2c 2073 2920        (h, m, s) 
-00016790: 3d20 2869 6e74 2876 616c 7565 2e67 726f  = (int(value.gro
-000167a0: 7570 2822 6822 2929 2c20 302c 2030 290a  up("h")), 0, 0).
-000167b0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-000167c0: 6f74 2076 616c 7565 2e67 726f 7570 2822  ot value.group("
-000167d0: 6d22 2920 6973 204e 6f6e 653a 0a20 2020  m") is None:.   
-000167e0: 2020 2020 2020 2020 2020 2020 206d 203d               m =
-000167f0: 2069 6e74 2876 616c 7565 2e67 726f 7570   int(value.group
-00016800: 2822 6d22 2929 0a20 2020 2020 2020 2020  ("m")).         
-00016810: 2020 2069 6620 6e6f 7420 7661 6c75 652e     if not value.
-00016820: 6772 6f75 7028 2273 2229 2069 7320 4e6f  group("s") is No
-00016830: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00016840: 2020 2020 7320 3d20 696e 7428 7661 6c75      s = int(valu
-00016850: 652e 6772 6f75 7028 2273 2229 290a 2020  e.group("s")).  
-00016860: 2020 2020 2020 2020 2020 6966 2076 616c            if val
-00016870: 7565 2e67 726f 7570 2822 6422 2920 3d3d  ue.group("d") ==
-00016880: 2022 706d 2220 616e 6420 3020 3c20 6820   "pm" and 0 < h 
-00016890: 3c20 3132 3a0a 2020 2020 2020 2020 2020  < 12:.          
-000168a0: 2020 2020 2020 6820 2b3d 2031 320a 2020        h += 12.  
-000168b0: 2020 2020 2020 2020 2020 6966 2076 616c            if val
-000168c0: 7565 2e67 726f 7570 2822 6422 2920 3d3d  ue.group("d") ==
-000168d0: 2022 616d 2220 616e 6420 6820 3d3d 2031   "am" and h == 1
-000168e0: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-000168f0: 2020 2068 203d 2030 0a20 2020 2020 2020     h = 0.       
-00016900: 2020 2020 2069 6620 6e6f 7420 2868 2069       if not (h i
-00016910: 6e20 7261 6e67 6528 3234 2920 616e 6420  n range(24) and 
-00016920: 6d20 696e 2072 616e 6765 2836 3029 2061  m in range(60) a
-00016930: 6e64 2073 2069 6e20 7261 6e67 6528 3630  nd s in range(60
-00016940: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00016950: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00016960: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00016970: 2020 2020 2020 2020 2020 2248 6f75 7273            "Hours
-00016980: 206f 7220 6d69 6e75 7465 7320 6f72 2073   or minutes or s
-00016990: 6563 6f6e 6473 2061 7265 206f 7574 7369  econds are outsi
-000169a0: 6465 206f 6620 616c 6c6f 7765 6420 7261  de of allowed ra
-000169b0: 6e67 6522 0a20 2020 2020 2020 2020 2020  nge".           
-000169c0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-000169d0: 2020 2076 616c 7565 203d 2064 6174 6574     value = datet
-000169e0: 696d 652e 7469 6d65 2868 2c20 6d2c 2073  ime.time(h, m, s
-000169f0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00016a00: 7475 726e 2076 616c 7565 0a20 2020 2020  turn value.     
-00016a10: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-00016a20: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
-00016a30: 2072 6169 7365 2056 616c 6964 6174 696f   raise Validatio
-00016a40: 6e45 7272 6f72 2873 656c 662e 7472 616e  nError(self.tran
-00016a50: 736c 6174 6f72 2873 656c 662e 6572 726f  slator(self.erro
-00016a60: 725f 6d65 7373 6167 6529 290a 0a0a 2320  r_message))...# 
-00016a70: 4120 5554 4320 636c 6173 732e 0a63 6c61  A UTC class..cla
-00016a80: 7373 2055 5443 2864 6174 6574 696d 652e  ss UTC(datetime.
-00016a90: 747a 696e 666f 293a 0a20 2020 2022 2222  tzinfo):.    """
-00016aa0: 5554 4322 2222 0a0a 2020 2020 5a45 524f  UTC"""..    ZERO
-00016ab0: 203d 2064 6174 6574 696d 652e 7469 6d65   = datetime.time
-00016ac0: 6465 6c74 6128 3029 0a0a 2020 2020 6465  delta(0)..    de
-00016ad0: 6620 7574 636f 6666 7365 7428 7365 6c66  f utcoffset(self
-00016ae0: 2c20 6474 293a 0a20 2020 2020 2020 2072  , dt):.        r
-00016af0: 6574 7572 6e20 5554 432e 5a45 524f 0a0a  eturn UTC.ZERO..
-00016b00: 2020 2020 6465 6620 747a 6e61 6d65 2873      def tzname(s
-00016b10: 656c 662c 2064 7429 3a0a 2020 2020 2020  elf, dt):.      
-00016b20: 2020 7265 7475 726e 2022 5554 4322 0a0a    return "UTC"..
-00016b30: 2020 2020 6465 6620 6473 7428 7365 6c66      def dst(self
-00016b40: 2c20 6474 293a 0a20 2020 2020 2020 2072  , dt):.        r
-00016b50: 6574 7572 6e20 5554 432e 5a45 524f 0a0a  eturn UTC.ZERO..
-00016b60: 0a75 7463 203d 2055 5443 2829 0a0a 0a63  .utc = UTC()...c
-00016b70: 6c61 7373 2049 535f 4441 5445 2856 616c  lass IS_DATE(Val
-00016b80: 6964 6174 6f72 293a 0a20 2020 2022 2222  idator):.    """
-00016b90: 0a20 2020 2045 7861 6d70 6c65 733a 0a20  .    Examples:. 
-00016ba0: 2020 2020 2020 2055 7365 2061 733a 3a0a         Use as::.
-00016bb0: 0a20 2020 2020 2020 2020 2020 2049 4e50  .            INP
-00016bc0: 5554 285f 7479 7065 3d27 7465 7874 272c  UT(_type='text',
-00016bd0: 205f 6e61 6d65 3d27 6e61 6d65 272c 2072   _name='name', r
-00016be0: 6571 7569 7265 733d 4953 5f44 4154 4528  equires=IS_DATE(
-00016bf0: 2929 0a0a 2020 2020 6461 7465 2068 6173  ))..    date has
-00016c00: 2074 6f20 6265 2069 6e20 7468 6520 4953   to be in the IS
-00016c10: 4f38 3936 3020 666f 726d 6174 2059 5959  O8960 format YYY
-00016c20: 592d 4d4d 2d44 440a 2020 2020 2222 220a  Y-MM-DD.    """.
-00016c30: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00016c40: 5f28 7365 6c66 2c20 666f 726d 6174 3d22  _(self, format="
-00016c50: 2559 2d25 6d2d 2564 222c 2065 7272 6f72  %Y-%m-%d", error
-00016c60: 5f6d 6573 7361 6765 3d22 456e 7465 7220  _message="Enter 
-00016c70: 6461 7465 2061 7320 2528 666f 726d 6174  date as %(format
-00016c80: 2973 2229 3a0a 2020 2020 2020 2020 7365  )s"):.        se
-00016c90: 6c66 2e66 6f72 6d61 7420 3d20 7365 6c66  lf.format = self
-00016ca0: 2e74 7261 6e73 6c61 746f 7228 666f 726d  .translator(form
-00016cb0: 6174 290a 2020 2020 2020 2020 7365 6c66  at).        self
-00016cc0: 2e65 7272 6f72 5f6d 6573 7361 6765 203d  .error_message =
-00016cd0: 2073 7472 2865 7272 6f72 5f6d 6573 7361   str(error_messa
-00016ce0: 6765 290a 2020 2020 2020 2020 7365 6c66  ge).        self
-00016cf0: 2e65 7874 7265 6d65 7320 3d20 7b7d 0a0a  .extremes = {}..
-00016d00: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
-00016d10: 2873 656c 662c 2076 616c 7565 2c20 7265  (self, value, re
-00016d20: 636f 7264 5f69 643d 4e6f 6e65 293a 0a20  cord_id=None):. 
-00016d30: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00016d40: 616e 6365 2876 616c 7565 2c20 6461 7465  ance(value, date
-00016d50: 7469 6d65 2e64 6174 6529 3a0a 2020 2020  time.date):.    
-00016d60: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-00016d70: 616c 7565 0a20 2020 2020 2020 2074 7279  alue.        try
-00016d80: 3a0a 2020 2020 2020 2020 2020 2020 2879  :.            (y
-00016d90: 2c20 6d2c 2064 2c20 6868 2c20 6d6d 2c20  , m, d, hh, mm, 
-00016da0: 7373 2c20 7430 2c20 7431 2c20 7432 2920  ss, t0, t1, t2) 
-00016db0: 3d20 7469 6d65 2e73 7472 7074 696d 6528  = time.strptime(
-00016dc0: 7661 6c75 652c 2073 7472 2873 656c 662e  value, str(self.
-00016dd0: 666f 726d 6174 2929 0a20 2020 2020 2020  format)).       
-00016de0: 2020 2020 2076 616c 7565 203d 2064 6174       value = dat
-00016df0: 6574 696d 652e 6461 7465 2879 2c20 6d2c  etime.date(y, m,
-00016e00: 2064 290a 2020 2020 2020 2020 2020 2020   d).            
-00016e10: 7265 7475 726e 2076 616c 7565 0a20 2020  return value.   
-00016e20: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
-00016e30: 2020 2020 2020 2020 2073 656c 662e 6578           self.ex
-00016e40: 7472 656d 6573 2e75 7064 6174 6528 4953  tremes.update(IS
-00016e50: 5f44 4154 4554 494d 452e 6e69 6365 2873  _DATETIME.nice(s
-00016e60: 656c 662e 666f 726d 6174 2929 0a20 2020  elf.format)).   
-00016e70: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00016e80: 616c 6964 6174 696f 6e45 7272 6f72 2873  alidationError(s
-00016e90: 656c 662e 7472 616e 736c 6174 6f72 2873  elf.translator(s
-00016ea0: 656c 662e 6572 726f 725f 6d65 7373 6167  elf.error_messag
-00016eb0: 6529 2025 2073 656c 662e 6578 7472 656d  e) % self.extrem
-00016ec0: 6573 290a 0a20 2020 2064 6566 2066 6f72  es)..    def for
-00016ed0: 6d61 7474 6572 2873 656c 662c 2076 616c  matter(self, val
-00016ee0: 7565 293a 0a20 2020 2020 2020 2069 6620  ue):.        if 
-00016ef0: 7661 6c75 6520 6973 204e 6f6e 6520 6f72  value is None or
-00016f00: 2076 616c 7565 203d 3d20 2222 3a0a 2020   value == "":.  
-00016f10: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00016f20: 204e 6f6e 650a 2020 2020 2020 2020 666f   None.        fo
-00016f30: 726d 6174 203d 2073 656c 662e 666f 726d  rmat = self.form
-00016f40: 6174 0a20 2020 2020 2020 2079 6561 7220  at.        year 
-00016f50: 3d20 7661 6c75 652e 7965 6172 0a20 2020  = value.year.   
-00016f60: 2020 2020 2079 203d 2022 252e 3469 2220       y = "%.4i" 
-00016f70: 2520 7965 6172 0a20 2020 2020 2020 2066  % year.        f
-00016f80: 6f72 6d61 7420 3d20 666f 726d 6174 2e72  ormat = format.r
-00016f90: 6570 6c61 6365 2822 2579 222c 2079 5b2d  eplace("%y", y[-
-00016fa0: 323a 5d29 0a20 2020 2020 2020 2066 6f72  2:]).        for
-00016fb0: 6d61 7420 3d20 666f 726d 6174 2e72 6570  mat = format.rep
-00016fc0: 6c61 6365 2822 2559 222c 2079 290a 2020  lace("%Y", y).  
-00016fd0: 2020 2020 2020 6966 2079 6561 7220 3c20        if year < 
-00016fe0: 3139 3030 3a0a 2020 2020 2020 2020 2020  1900:.          
-00016ff0: 2020 7965 6172 203d 2032 3030 300a 2020    year = 2000.  
-00017000: 2020 2020 2020 6420 3d20 6461 7465 7469        d = dateti
-00017010: 6d65 2e64 6174 6528 7965 6172 2c20 7661  me.date(year, va
-00017020: 6c75 652e 6d6f 6e74 682c 2076 616c 7565  lue.month, value
-00017030: 2e64 6179 290a 2020 2020 2020 2020 7265  .day).        re
-00017040: 7475 726e 2064 2e73 7472 6674 696d 6528  turn d.strftime(
-00017050: 666f 726d 6174 290a 0a0a 636c 6173 7320  format)...class 
-00017060: 4953 5f44 4154 4554 494d 4528 5661 6c69  IS_DATETIME(Vali
-00017070: 6461 746f 7229 3a0a 2020 2020 2222 220a  dator):.    """.
-00017080: 2020 2020 4578 616d 706c 6573 3a0a 2020      Examples:.  
-00017090: 2020 2020 2020 5573 6520 6173 3a3a 0a0a        Use as::..
-000170a0: 2020 2020 2020 2020 2020 2020 494e 5055              INPU
-000170b0: 5428 5f74 7970 653d 2774 6578 7427 2c20  T(_type='text', 
-000170c0: 5f6e 616d 653d 276e 616d 6527 2c20 7265  _name='name', re
-000170d0: 7175 6972 6573 3d49 535f 4441 5445 5449  quires=IS_DATETI
-000170e0: 4d45 2829 290a 0a20 2020 2064 6174 6574  ME())..    datet
-000170f0: 696d 6520 6861 7320 746f 2062 6520 696e  ime has to be in
-00017100: 2074 6865 2049 534f 3839 3630 2066 6f72   the ISO8960 for
-00017110: 6d61 7420 5959 5959 2d4d 4d2d 4444 2068  mat YYYY-MM-DD h
-00017120: 683a 6d6d 3a73 730a 2020 2020 7469 6d65  h:mm:ss.    time
-00017130: 7a6f 6d65 206d 7573 7420 6265 204e 6f6e  zome must be Non
-00017140: 6520 6f72 2061 2070 7974 7a2e 7469 6d65  e or a pytz.time
-00017150: 7a6f 6e65 2822 416d 6572 6963 612f 4368  zone("America/Ch
-00017160: 6963 6167 6f22 2920 6f62 6a65 6374 0a20  icago") object. 
-00017170: 2020 2022 2222 0a0a 2020 2020 6973 6f64     """..    isod
-00017180: 6174 6574 696d 6520 3d20 2225 592d 256d  atetime = "%Y-%m
-00017190: 2d25 6420 2548 3a25 4d3a 2553 220a 0a20  -%d %H:%M:%S".. 
-000171a0: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
-000171b0: 0a20 2020 2064 6566 206e 6963 6528 666f  .    def nice(fo
-000171c0: 726d 6174 293a 0a20 2020 2020 2020 2063  rmat):.        c
-000171d0: 6f64 6520 3d20 280a 2020 2020 2020 2020  ode = (.        
-000171e0: 2020 2020 2822 2559 222c 2022 3139 3633      ("%Y", "1963
-000171f0: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-00017200: 2822 2579 222c 2022 3633 2229 2c0a 2020  ("%y", "63"),.  
-00017210: 2020 2020 2020 2020 2020 2822 2564 222c            ("%d",
-00017220: 2022 3238 2229 2c0a 2020 2020 2020 2020   "28"),.        
-00017230: 2020 2020 2822 256d 222c 2022 3038 2229      ("%m", "08")
-00017240: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
-00017250: 2562 222c 2022 4175 6722 292c 0a20 2020  %b", "Aug"),.   
-00017260: 2020 2020 2020 2020 2028 2225 4222 2c20           ("%B", 
-00017270: 2241 7567 7573 7422 292c 0a20 2020 2020  "August"),.     
-00017280: 2020 2020 2020 2028 2225 4822 2c20 2231         ("%H", "1
-00017290: 3422 292c 0a20 2020 2020 2020 2020 2020  4"),.           
-000172a0: 2028 2225 4922 2c20 2230 3222 292c 0a20   ("%I", "02"),. 
-000172b0: 2020 2020 2020 2020 2020 2028 2225 7022             ("%p"
-000172c0: 2c20 2250 4d22 292c 0a20 2020 2020 2020  , "PM"),.       
-000172d0: 2020 2020 2028 2225 4d22 2c20 2233 3022       ("%M", "30"
-000172e0: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
-000172f0: 2225 5322 2c20 2235 3922 292c 0a20 2020  "%S", "59"),.   
-00017300: 2020 2020 2029 0a20 2020 2020 2020 2066       ).        f
-00017310: 6f72 2028 612c 2062 2920 696e 2063 6f64  or (a, b) in cod
-00017320: 653a 0a20 2020 2020 2020 2020 2020 2066  e:.            f
-00017330: 6f72 6d61 7420 3d20 666f 726d 6174 2e72  ormat = format.r
-00017340: 6570 6c61 6365 2861 2c20 6229 0a20 2020  eplace(a, b).   
-00017350: 2020 2020 2072 6574 7572 6e20 6469 6374       return dict
-00017360: 2866 6f72 6d61 743d 666f 726d 6174 290a  (format=format).
-00017370: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00017380: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
-00017390: 0a20 2020 2020 2020 2066 6f72 6d61 743d  .        format=
-000173a0: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
-000173b0: 2553 222c 0a20 2020 2020 2020 2065 7272  %S",.        err
-000173c0: 6f72 5f6d 6573 7361 6765 3d22 456e 7465  or_message="Ente
-000173d0: 7220 6461 7465 2061 6e64 2074 696d 6520  r date and time 
-000173e0: 6173 2025 2866 6f72 6d61 7429 7322 2c0a  as %(format)s",.
-000173f0: 2020 2020 2020 2020 7469 6d65 7a6f 6e65          timezone
-00017400: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
-00017410: 2020 2020 2020 7365 6c66 2e66 6f72 6d61        self.forma
-00017420: 7420 3d20 7365 6c66 2e74 7261 6e73 6c61  t = self.transla
-00017430: 746f 7228 666f 726d 6174 290a 2020 2020  tor(format).    
-00017440: 2020 2020 7365 6c66 2e65 7272 6f72 5f6d      self.error_m
-00017450: 6573 7361 6765 203d 2073 7472 2865 7272  essage = str(err
-00017460: 6f72 5f6d 6573 7361 6765 290a 2020 2020  or_message).    
-00017470: 2020 2020 7365 6c66 2e65 7874 7265 6d65      self.extreme
-00017480: 7320 3d20 7b7d 0a20 2020 2020 2020 2073  s = {}.        s
-00017490: 656c 662e 7469 6d65 7a6f 6e65 203d 2074  elf.timezone = t
-000174a0: 696d 657a 6f6e 650a 0a20 2020 2064 6566  imezone..    def
-000174b0: 2076 616c 6964 6174 6528 7365 6c66 2c20   validate(self, 
-000174c0: 7661 6c75 652c 2072 6563 6f72 645f 6964  value, record_id
-000174d0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-000174e0: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
-000174f0: 6c75 652c 2064 6174 6574 696d 652e 6461  lue, datetime.da
-00017500: 7465 7469 6d65 293a 0a20 2020 2020 2020  tetime):.       
-00017510: 2020 2020 2072 6574 7572 6e20 7661 6c75       return valu
-00017520: 650a 2020 2020 2020 2020 7472 793a 0a20  e.        try:. 
-00017530: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00017540: 6c66 2e66 6f72 6d61 7420 3d3d 2073 656c  lf.format == sel
-00017550: 662e 6973 6f64 6174 6574 696d 653a 0a20  f.isodatetime:. 
-00017560: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00017570: 616c 7565 203d 2076 616c 7565 2e72 6570  alue = value.rep
-00017580: 6c61 6365 2822 5422 2c20 2220 2229 0a20  lace("T", " "). 
-00017590: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000175a0: 6620 6c65 6e28 7661 6c75 6529 203d 3d20  f len(value) == 
-000175b0: 3136 3a0a 2020 2020 2020 2020 2020 2020  16:.            
-000175c0: 2020 2020 2020 2020 7661 6c75 6520 2b3d          value +=
-000175d0: 2022 3a30 3022 0a20 2020 2020 2020 2020   ":00".         
-000175e0: 2020 2028 792c 206d 2c20 642c 2068 682c     (y, m, d, hh,
-000175f0: 206d 6d2c 2073 732c 2074 302c 2074 312c   mm, ss, t0, t1,
-00017600: 2074 3229 203d 2074 696d 652e 7374 7270   t2) = time.strp
-00017610: 7469 6d65 2876 616c 7565 2c20 7374 7228  time(value, str(
-00017620: 7365 6c66 2e66 6f72 6d61 7429 290a 2020  self.format)).  
-00017630: 2020 2020 2020 2020 2020 7661 6c75 6520            value 
-00017640: 3d20 6461 7465 7469 6d65 2e64 6174 6574  = datetime.datet
-00017650: 696d 6528 792c 206d 2c20 642c 2068 682c  ime(y, m, d, hh,
-00017660: 206d 6d2c 2073 7329 0a20 2020 2020 2020   mm, ss).       
-00017670: 2020 2020 2069 6620 7365 6c66 2e74 696d       if self.tim
-00017680: 657a 6f6e 6520 6973 206e 6f74 204e 6f6e  ezone is not Non
-00017690: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000176a0: 2020 2023 2054 4f44 4f3a 2068 7474 7073     # TODO: https
-000176b0: 3a2f 2f67 6974 6875 622e 636f 6d2f 7765  ://github.com/we
-000176c0: 6232 7079 2f77 6562 3270 792f 6973 7375  b2py/web2py/issu
-000176d0: 6573 2f31 3039 3420 2874 656d 706f 7261  es/1094 (tempora
-000176e0: 7279 2073 6f6c 7574 696f 6e29 0a20 2020  ry solution).   
-000176f0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00017700: 7565 203d 2028 0a20 2020 2020 2020 2020  ue = (.         
-00017710: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00017720: 7469 6d65 7a6f 6e65 2e6c 6f63 616c 697a  timezone.localiz
-00017730: 6528 7661 6c75 6529 2e61 7374 696d 657a  e(value).astimez
-00017740: 6f6e 6528 7574 6329 2e72 6570 6c61 6365  one(utc).replace
-00017750: 2874 7a69 6e66 6f3d 4e6f 6e65 290a 2020  (tzinfo=None).  
-00017760: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00017770: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00017780: 726e 2076 616c 7565 0a20 2020 2020 2020  rn value.       
-00017790: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
-000177a0: 2020 2020 2073 656c 662e 6578 7472 656d       self.extrem
-000177b0: 6573 2e75 7064 6174 6528 4953 5f44 4154  es.update(IS_DAT
-000177c0: 4554 494d 452e 6e69 6365 2873 656c 662e  ETIME.nice(self.
-000177d0: 666f 726d 6174 2929 0a20 2020 2020 2020  format)).       
-000177e0: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
-000177f0: 6174 696f 6e45 7272 6f72 2873 656c 662e  ationError(self.
-00017800: 7472 616e 736c 6174 6f72 2873 656c 662e  translator(self.
-00017810: 6572 726f 725f 6d65 7373 6167 6529 2025  error_message) %
-00017820: 2073 656c 662e 6578 7472 656d 6573 290a   self.extremes).
-00017830: 0a20 2020 2064 6566 2066 6f72 6d61 7474  .    def formatt
-00017840: 6572 2873 656c 662c 2076 616c 7565 293a  er(self, value):
-00017850: 0a20 2020 2020 2020 2069 6620 7661 6c75  .        if valu
-00017860: 6520 6973 204e 6f6e 6520 6f72 2076 616c  e is None or val
-00017870: 7565 203d 3d20 2222 3a0a 2020 2020 2020  ue == "":.      
-00017880: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-00017890: 650a 2020 2020 2020 2020 666f 726d 6174  e.        format
-000178a0: 203d 2073 656c 662e 666f 726d 6174 0a20   = self.format. 
-000178b0: 2020 2020 2020 2079 6561 7220 3d20 7661         year = va
-000178c0: 6c75 652e 7965 6172 0a20 2020 2020 2020  lue.year.       
-000178d0: 2079 203d 2022 252e 3469 2220 2520 7965   y = "%.4i" % ye
-000178e0: 6172 0a20 2020 2020 2020 2066 6f72 6d61  ar.        forma
-000178f0: 7420 3d20 666f 726d 6174 2e72 6570 6c61  t = format.repla
-00017900: 6365 2822 2579 222c 2079 5b2d 323a 5d29  ce("%y", y[-2:])
-00017910: 0a20 2020 2020 2020 2066 6f72 6d61 7420  .        format 
-00017920: 3d20 666f 726d 6174 2e72 6570 6c61 6365  = format.replace
-00017930: 2822 2559 222c 2079 290a 2020 2020 2020  ("%Y", y).      
-00017940: 2020 6966 2079 6561 7220 3c20 3139 3030    if year < 1900
-00017950: 3a0a 2020 2020 2020 2020 2020 2020 7965  :.            ye
-00017960: 6172 203d 2032 3030 300a 2020 2020 2020  ar = 2000.      
-00017970: 2020 6420 3d20 6461 7465 7469 6d65 2e64    d = datetime.d
-00017980: 6174 6574 696d 6528 0a20 2020 2020 2020  atetime(.       
-00017990: 2020 2020 2079 6561 722c 2076 616c 7565       year, value
-000179a0: 2e6d 6f6e 7468 2c20 7661 6c75 652e 6461  .month, value.da
-000179b0: 792c 2076 616c 7565 2e68 6f75 722c 2076  y, value.hour, v
-000179c0: 616c 7565 2e6d 696e 7574 652c 2076 616c  alue.minute, val
-000179d0: 7565 2e73 6563 6f6e 640a 2020 2020 2020  ue.second.      
-000179e0: 2020 290a 2020 2020 2020 2020 6966 2073    ).        if s
-000179f0: 656c 662e 7469 6d65 7a6f 6e65 2069 7320  elf.timezone is 
-00017a00: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00017a10: 2020 2020 2020 6420 3d20 642e 7265 706c        d = d.repl
-00017a20: 6163 6528 747a 696e 666f 3d75 7463 292e  ace(tzinfo=utc).
-00017a30: 6173 7469 6d65 7a6f 6e65 2873 656c 662e  astimezone(self.
-00017a40: 7469 6d65 7a6f 6e65 290a 2020 2020 2020  timezone).      
-00017a50: 2020 7265 7475 726e 2064 2e73 7472 6674    return d.strft
-00017a60: 696d 6528 666f 726d 6174 290a 0a0a 636c  ime(format)...cl
-00017a70: 6173 7320 4953 5f44 4154 455f 494e 5f52  ass IS_DATE_IN_R
-00017a80: 414e 4745 2849 535f 4441 5445 293a 0a20  ANGE(IS_DATE):. 
-00017a90: 2020 2022 2222 0a20 2020 2045 7861 6d70     """.    Examp
-00017aa0: 6c65 733a 0a20 2020 2020 2020 2055 7365  les:.        Use
-00017ab0: 2061 733a 3a0a 0a20 2020 2020 2020 2020   as::..         
-00017ac0: 2020 203e 3e3e 2076 203d 2049 535f 4441     >>> v = IS_DA
-00017ad0: 5445 5f49 4e5f 5241 4e47 4528 6d69 6e69  TE_IN_RANGE(mini
-00017ae0: 6d75 6d3d 6461 7465 7469 6d65 2e64 6174  mum=datetime.dat
-00017af0: 6528 3230 3038 2c31 2c31 292c 205c 0a20  e(2008,1,1), \. 
+000158f0: 2020 2520 2870 7265 7065 6e64 5f73 6368    % (prepend_sch
+00015900: 656d 652c 2073 656c 662e 616c 6c6f 7765  eme, self.allowe
+00015910: 645f 7363 6865 6d65 7329 0a20 2020 2020  d_schemes).     
+00015920: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00015930: 2020 2020 2020 2320 6966 2061 6c6c 6f77        # if allow
+00015940: 6564 5f73 6368 656d 6573 2069 7320 4e6f  ed_schemes is No
+00015950: 6e65 2c20 7468 656e 2077 6520 7769 6c6c  ne, then we will
+00015960: 2064 6566 6572 2074 6573 7469 6e67 0a20   defer testing. 
+00015970: 2020 2020 2020 2023 2070 7265 7065 6e64         # prepend
+00015980: 5f73 6368 656d 6527 7320 7661 6c69 6469  _scheme's validi
+00015990: 7479 2074 6f20 6120 7375 622d 6d65 7468  ty to a sub-meth
+000159a0: 6f64 0a0a 2020 2020 2020 2020 7365 6c66  od..        self
+000159b0: 2e70 7265 7065 6e64 5f73 6368 656d 6520  .prepend_scheme 
+000159c0: 3d20 7072 6570 656e 645f 7363 6865 6d65  = prepend_scheme
+000159d0: 0a0a 2020 2020 6465 6620 7661 6c69 6461  ..    def valida
+000159e0: 7465 2873 656c 662c 2076 616c 7565 2c20  te(self, value, 
+000159f0: 7265 636f 7264 5f69 643d 4e6f 6e65 293a  record_id=None):
+00015a00: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00015a10: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
+00015a20: 2020 2020 2020 2076 616c 7565 3a20 6120         value: a 
+00015a30: 756e 6963 6f64 6520 6f72 2072 6567 756c  unicode or regul
+00015a40: 6172 2073 7472 696e 672c 2074 6865 2055  ar string, the U
+00015a50: 524c 2074 6f20 7661 6c69 6461 7465 0a0a  RL to validate..
+00015a60: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
+00015a70: 0a20 2020 2020 2020 2020 2020 2061 2028  .            a (
+00015a80: 7374 7269 6e67 2c20 7374 7269 6e67 2920  string, string) 
+00015a90: 7475 706c 652c 2077 6865 7265 2074 7570  tuple, where tup
+00015aa0: 6c65 5b30 5d20 6973 2074 6865 206d 6f64  le[0] is the mod
+00015ab0: 6966 6965 640a 2020 2020 2020 2020 2020  ified.          
+00015ac0: 2020 696e 7075 7420 7661 6c75 6520 616e    input value an
+00015ad0: 6420 7475 706c 655b 315d 2069 7320 6569  d tuple[1] is ei
+00015ae0: 7468 6572 204e 6f6e 6520 2873 7563 6365  ther None (succe
+00015af0: 7373 2129 206f 7220 7468 650a 2020 2020  ss!) or the.    
+00015b00: 2020 2020 2020 2020 7374 7269 6e67 2065          string e
+00015b10: 7272 6f72 5f6d 6573 7361 6765 2e20 5468  rror_message. Th
+00015b20: 6520 696e 7075 7420 7661 6c75 6520 7769  e input value wi
+00015b30: 6c6c 206e 6576 6572 2062 6520 6d6f 6469  ll never be modi
+00015b40: 6669 6564 2069 6e20 7468 650a 2020 2020  fied in the.    
+00015b50: 2020 2020 2020 2020 6361 7365 206f 6620          case of 
+00015b60: 616e 2065 7272 6f72 2e20 486f 7765 7665  an error. Howeve
+00015b70: 722c 2069 6620 7468 6572 6520 6973 2073  r, if there is s
+00015b80: 7563 6365 7373 2074 6865 6e20 7468 6520  uccess then the 
+00015b90: 696e 7075 7420 5552 4c0a 2020 2020 2020  input URL.      
+00015ba0: 2020 2020 2020 6d61 7920 6265 206d 6f64        may be mod
+00015bb0: 6966 6965 6420 746f 2028 3129 2070 7265  ified to (1) pre
+00015bc0: 7065 6e64 2061 2073 6368 656d 652c 2061  pend a scheme, a
+00015bd0: 6e64 2f6f 7220 2832 2920 636f 6e76 6572  nd/or (2) conver
+00015be0: 7420 610a 2020 2020 2020 2020 2020 2020  t a.            
+00015bf0: 6e6f 6e2d 636f 6d70 6c69 616e 7420 756e  non-compliant un
+00015c00: 6963 6f64 6520 5552 4c20 696e 746f 2061  icode URL into a
+00015c10: 2063 6f6d 706c 6961 6e74 2055 532d 4153   compliant US-AS
+00015c20: 4349 4920 7665 7273 696f 6e2e 0a20 2020  CII version..   
+00015c30: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00015c40: 2069 6620 7365 6c66 2e6d 6f64 6520 3d3d   if self.mode ==
+00015c50: 2022 6765 6e65 7269 6322 3a0a 2020 2020   "generic":.    
+00015c60: 2020 2020 2020 2020 7375 624d 6574 686f          subMetho
+00015c70: 6420 3d20 4953 5f47 454e 4552 4943 5f55  d = IS_GENERIC_U
+00015c80: 524c 280a 2020 2020 2020 2020 2020 2020  RL(.            
+00015c90: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00015ca0: 653d 7365 6c66 2e65 7272 6f72 5f6d 6573  e=self.error_mes
+00015cb0: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
+00015cc0: 2020 2020 2020 616c 6c6f 7765 645f 7363        allowed_sc
+00015cd0: 6865 6d65 733d 7365 6c66 2e61 6c6c 6f77  hemes=self.allow
+00015ce0: 6564 5f73 6368 656d 6573 2c0a 2020 2020  ed_schemes,.    
+00015cf0: 2020 2020 2020 2020 2020 2020 7072 6570              prep
+00015d00: 656e 645f 7363 6865 6d65 3d73 656c 662e  end_scheme=self.
+00015d10: 7072 6570 656e 645f 7363 6865 6d65 2c0a  prepend_scheme,.
+00015d20: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00015d30: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+00015d40: 6d6f 6465 203d 3d20 2268 7474 7022 3a0a  mode == "http":.
+00015d50: 2020 2020 2020 2020 2020 2020 7375 624d              subM
+00015d60: 6574 686f 6420 3d20 4953 5f48 5454 505f  ethod = IS_HTTP_
+00015d70: 5552 4c28 0a20 2020 2020 2020 2020 2020  URL(.           
+00015d80: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00015d90: 6765 3d73 656c 662e 6572 726f 725f 6d65  ge=self.error_me
+00015da0: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
+00015db0: 2020 2020 2020 2061 6c6c 6f77 6564 5f73         allowed_s
+00015dc0: 6368 656d 6573 3d73 656c 662e 616c 6c6f  chemes=self.allo
+00015dd0: 7765 645f 7363 6865 6d65 732c 0a20 2020  wed_schemes,.   
+00015de0: 2020 2020 2020 2020 2020 2020 2070 7265               pre
+00015df0: 7065 6e64 5f73 6368 656d 653d 7365 6c66  pend_scheme=self
+00015e00: 2e70 7265 7065 6e64 5f73 6368 656d 652c  .prepend_scheme,
+00015e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015e20: 2061 6c6c 6f77 6564 5f74 6c64 733d 7365   allowed_tlds=se
+00015e30: 6c66 2e61 6c6c 6f77 6564 5f74 6c64 732c  lf.allowed_tlds,
+00015e40: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00015e50: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00015e60: 2020 2020 2020 2020 2072 6169 7365 2053           raise S
+00015e70: 796e 7461 7845 7272 6f72 2822 696e 7661  yntaxError("inva
+00015e80: 6c69 6420 6d6f 6465 2027 2573 2720 696e  lid mode '%s' in
+00015e90: 2049 535f 5552 4c22 2025 2073 656c 662e   IS_URL" % self.
+00015ea0: 6d6f 6465 290a 0a20 2020 2020 2020 2069  mode)..        i
+00015eb0: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
+00015ec0: 7565 2c20 756e 6963 6f64 6554 293a 0a20  ue, unicodeT):. 
+00015ed0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+00015ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ef0: 7661 6c75 6520 3d20 756e 6963 6f64 655f  value = unicode_
+00015f00: 746f 5f61 7363 6969 5f75 726c 2876 616c  to_ascii_url(val
+00015f10: 7565 2c20 7365 6c66 2e70 7265 7065 6e64  ue, self.prepend
+00015f20: 5f73 6368 656d 6529 0a20 2020 2020 2020  _scheme).       
+00015f30: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
+00015f40: 7074 696f 6e20 6173 2065 3a0a 2020 2020  ption as e:.    
+00015f50: 2020 2020 2020 2020 2020 2020 2320 4966              # If
+00015f60: 2077 6520 6172 6520 6e6f 7420 6162 6c65   we are not able
+00015f70: 2074 6f20 636f 6e76 6572 7420 7468 6520   to convert the 
+00015f80: 756e 6963 6f64 6520 7572 6c20 696e 746f  unicode url into
+00015f90: 2061 0a20 2020 2020 2020 2020 2020 2020   a.             
+00015fa0: 2020 2023 2055 532d 4153 4349 4920 5552     # US-ASCII UR
+00015fb0: 4c2c 2074 6865 6e20 7468 6520 5552 4c20  L, then the URL 
+00015fc0: 6973 206e 6f74 2076 616c 6964 0a20 2020  is not valid.   
+00015fd0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00015fe0: 7365 2056 616c 6964 6174 696f 6e45 7272  se ValidationErr
+00015ff0: 6f72 2873 656c 662e 7472 616e 736c 6174  or(self.translat
+00016000: 6f72 2873 656c 662e 6572 726f 725f 6d65  or(self.error_me
+00016010: 7373 6167 6529 290a 2020 2020 2020 2020  ssage)).        
+00016020: 7265 7475 726e 2073 7562 4d65 7468 6f64  return subMethod
+00016030: 2e76 616c 6964 6174 6528 7661 6c75 652c  .validate(value,
+00016040: 2072 6563 6f72 645f 6964 290a 0a0a 636c   record_id)...cl
+00016050: 6173 7320 4953 5f54 494d 4528 5661 6c69  ass IS_TIME(Vali
+00016060: 6461 746f 7229 3a0a 2020 2020 2222 220a  dator):.    """.
+00016070: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+00016080: 2020 2020 2055 7365 2061 733a 3a0a 0a20       Use as::.. 
+00016090: 2020 2020 2020 2020 2020 2049 4e50 5554             INPUT
+000160a0: 285f 7479 7065 3d27 7465 7874 272c 205f  (_type='text', _
+000160b0: 6e61 6d65 3d27 6e61 6d65 272c 2072 6571  name='name', req
+000160c0: 7569 7265 733d 4953 5f54 494d 4528 2929  uires=IS_TIME())
+000160d0: 0a0a 2020 2020 756e 6465 7273 7461 6e64  ..    understand
+000160e0: 7320 7468 6520 666f 6c6c 6f77 696e 6720  s the following 
+000160f0: 666f 726d 6174 730a 2020 2020 6868 3a6d  formats.    hh:m
+00016100: 6d3a 7373 205b 616d 2f70 6d5d 0a20 2020  m:ss [am/pm].   
+00016110: 2068 683a 6d6d 205b 616d 2f70 6d5d 0a20   hh:mm [am/pm]. 
+00016120: 2020 2068 6820 5b61 6d2f 706d 5d0a 0a20     hh [am/pm].. 
+00016130: 2020 205b 616d 2f70 6d5d 2069 7320 6f70     [am/pm] is op
+00016140: 7469 6f6e 616c 2c20 273a 2720 6361 6e20  tional, ':' can 
+00016150: 6265 2072 6570 6c61 6365 6420 6279 2061  be replaced by a
+00016160: 6e79 206f 7468 6572 206e 6f6e 2d73 7061  ny other non-spa
+00016170: 6365 206e 6f6e 2d64 6967 6974 3a3a 0a0a  ce non-digit::..
+00016180: 2020 2020 2020 2020 3e3e 3e20 4953 5f54          >>> IS_T
+00016190: 494d 4528 2928 2732 313a 3330 2729 0a20  IME()('21:30'). 
+000161a0: 2020 2020 2020 2028 6461 7465 7469 6d65         (datetime
+000161b0: 2e74 696d 6528 3231 2c20 3330 292c 204e  .time(21, 30), N
+000161c0: 6f6e 6529 0a20 2020 2020 2020 203e 3e3e  one).        >>>
+000161d0: 2049 535f 5449 4d45 2829 2827 3231 2d33   IS_TIME()('21-3
+000161e0: 3027 290a 2020 2020 2020 2020 2864 6174  0').        (dat
+000161f0: 6574 696d 652e 7469 6d65 2832 312c 2033  etime.time(21, 3
+00016200: 3029 2c20 4e6f 6e65 290a 2020 2020 2020  0), None).      
+00016210: 2020 3e3e 3e20 4953 5f54 494d 4528 2928    >>> IS_TIME()(
+00016220: 2732 312e 3330 2729 0a20 2020 2020 2020  '21.30').       
+00016230: 2028 6461 7465 7469 6d65 2e74 696d 6528   (datetime.time(
+00016240: 3231 2c20 3330 292c 204e 6f6e 6529 0a20  21, 30), None). 
+00016250: 2020 2020 2020 203e 3e3e 2049 535f 5449         >>> IS_TI
+00016260: 4d45 2829 2827 3231 3a33 303a 3539 2729  ME()('21:30:59')
+00016270: 0a20 2020 2020 2020 2028 6461 7465 7469  .        (dateti
+00016280: 6d65 2e74 696d 6528 3231 2c20 3330 2c20  me.time(21, 30, 
+00016290: 3539 292c 204e 6f6e 6529 0a20 2020 2020  59), None).     
+000162a0: 2020 203e 3e3e 2049 535f 5449 4d45 2829     >>> IS_TIME()
+000162b0: 2827 353a 3330 2729 0a20 2020 2020 2020  ('5:30').       
+000162c0: 2028 6461 7465 7469 6d65 2e74 696d 6528   (datetime.time(
+000162d0: 352c 2033 3029 2c20 4e6f 6e65 290a 2020  5, 30), None).  
+000162e0: 2020 2020 2020 3e3e 3e20 4953 5f54 494d        >>> IS_TIM
+000162f0: 4528 2928 2735 3a33 3020 616d 2729 0a20  E()('5:30 am'). 
+00016300: 2020 2020 2020 2028 6461 7465 7469 6d65         (datetime
+00016310: 2e74 696d 6528 352c 2033 3029 2c20 4e6f  .time(5, 30), No
+00016320: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
+00016330: 4953 5f54 494d 4528 2928 2735 3a33 3020  IS_TIME()('5:30 
+00016340: 706d 2729 0a20 2020 2020 2020 2028 6461  pm').        (da
+00016350: 7465 7469 6d65 2e74 696d 6528 3137 2c20  tetime.time(17, 
+00016360: 3330 292c 204e 6f6e 6529 0a20 2020 2020  30), None).     
+00016370: 2020 203e 3e3e 2049 535f 5449 4d45 2829     >>> IS_TIME()
+00016380: 2827 353a 3330 2077 6861 7465 7665 7227  ('5:30 whatever'
+00016390: 290a 2020 2020 2020 2020 2827 353a 3330  ).        ('5:30
+000163a0: 2077 6861 7465 7665 7227 2c20 2765 6e74   whatever', 'ent
+000163b0: 6572 2074 696d 6520 6173 2068 683a 6d6d  er time as hh:mm
+000163c0: 3a73 7320 2873 6563 6f6e 6473 2c20 616d  :ss (seconds, am
+000163d0: 2c20 706d 206f 7074 696f 6e61 6c29 2729  , pm optional)')
+000163e0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+000163f0: 5449 4d45 2829 2827 353a 3330 2032 3027  TIME()('5:30 20'
+00016400: 290a 2020 2020 2020 2020 2827 353a 3330  ).        ('5:30
+00016410: 2032 3027 2c20 2765 6e74 6572 2074 696d   20', 'enter tim
+00016420: 6520 6173 2068 683a 6d6d 3a73 7320 2873  e as hh:mm:ss (s
+00016430: 6563 6f6e 6473 2c20 616d 2c20 706d 206f  econds, am, pm o
+00016440: 7074 696f 6e61 6c29 2729 0a20 2020 2020  ptional)').     
+00016450: 2020 203e 3e3e 2049 535f 5449 4d45 2829     >>> IS_TIME()
+00016460: 2827 3234 3a33 3027 290a 2020 2020 2020  ('24:30').      
+00016470: 2020 2827 3234 3a33 3027 2c20 2765 6e74    ('24:30', 'ent
+00016480: 6572 2074 696d 6520 6173 2068 683a 6d6d  er time as hh:mm
+00016490: 3a73 7320 2873 6563 6f6e 6473 2c20 616d  :ss (seconds, am
+000164a0: 2c20 706d 206f 7074 696f 6e61 6c29 2729  , pm optional)')
+000164b0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+000164c0: 5449 4d45 2829 2827 3231 3a36 3027 290a  TIME()('21:60').
+000164d0: 2020 2020 2020 2020 2827 3231 3a36 3027          ('21:60'
+000164e0: 2c20 2765 6e74 6572 2074 696d 6520 6173  , 'enter time as
+000164f0: 2068 683a 6d6d 3a73 7320 2873 6563 6f6e   hh:mm:ss (secon
+00016500: 6473 2c20 616d 2c20 706d 206f 7074 696f  ds, am, pm optio
+00016510: 6e61 6c29 2729 0a20 2020 2020 2020 203e  nal)').        >
+00016520: 3e3e 2049 535f 5449 4d45 2829 2827 3231  >> IS_TIME()('21
+00016530: 3a33 303a 3a27 290a 2020 2020 2020 2020  :30::').        
+00016540: 2827 3231 3a33 303a 3a27 2c20 2765 6e74  ('21:30::', 'ent
+00016550: 6572 2074 696d 6520 6173 2068 683a 6d6d  er time as hh:mm
+00016560: 3a73 7320 2873 6563 6f6e 6473 2c20 616d  :ss (seconds, am
+00016570: 2c20 706d 206f 7074 696f 6e61 6c29 2729  , pm optional)')
+00016580: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+00016590: 5449 4d45 2829 2827 2729 0a20 2020 2020  TIME()('').     
+000165a0: 2020 2028 2727 2c20 2765 6e74 6572 2074     ('', 'enter t
+000165b0: 696d 6520 6173 2068 683a 6d6d 3a73 7320  ime as hh:mm:ss 
+000165c0: 2873 6563 6f6e 6473 2c20 616d 2c20 706d  (seconds, am, pm
+000165d0: 206f 7074 696f 6e61 6c29 2729 c3b9 0a0a   optional)')....
+000165e0: 2020 2020 2222 220a 0a20 2020 2052 4547      """..    REG
+000165f0: 4558 5f54 494d 4520 3d20 2228 283f 503c  EX_TIME = "((?P<
+00016600: 683e 5b30 2d39 5d2b 2929 285b 5e30 2d39  h>[0-9]+))([^0-9
+00016610: 205d 2b28 3f50 3c6d 3e5b 302d 3920 5d2b   ]+(?P<m>[0-9 ]+
+00016620: 2929 3f28 5b5e 302d 3961 7020 5d2b 283f  ))?([^0-9ap ]+(?
+00016630: 503c 733e 5b30 2d39 5d2a 2929 3f28 283f  P<s>[0-9]*))?((?
+00016640: 503c 643e 5b61 705d 6d29 293f 220a 0a20  P<d>[ap]m))?".. 
+00016650: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00016660: 0a20 2020 2020 2020 2073 656c 662c 2065  .        self, e
+00016670: 7272 6f72 5f6d 6573 7361 6765 3d22 456e  rror_message="En
+00016680: 7465 7220 7469 6d65 2061 7320 6868 3a6d  ter time as hh:m
+00016690: 6d3a 7373 2028 7365 636f 6e64 732c 2061  m:ss (seconds, a
+000166a0: 6d2c 2070 6d20 6f70 7469 6f6e 616c 2922  m, pm optional)"
+000166b0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000166c0: 7365 6c66 2e65 7272 6f72 5f6d 6573 7361  self.error_messa
+000166d0: 6765 203d 2065 7272 6f72 5f6d 6573 7361  ge = error_messa
+000166e0: 6765 0a0a 2020 2020 6465 6620 7661 6c69  ge..    def vali
+000166f0: 6461 7465 2873 656c 662c 2076 616c 7565  date(self, value
+00016700: 2c20 7265 636f 7264 5f69 643d 4e6f 6e65  , record_id=None
+00016710: 293a 0a20 2020 2020 2020 2074 7279 3a0a  ):.        try:.
+00016720: 2020 2020 2020 2020 2020 2020 6976 616c              ival
+00016730: 7565 203d 2076 616c 7565 0a20 2020 2020  ue = value.     
+00016740: 2020 2020 2020 2076 616c 7565 203d 2072         value = r
+00016750: 652e 6d61 7463 6828 7365 6c66 2e52 4547  e.match(self.REG
+00016760: 4558 5f54 494d 452c 2076 616c 7565 2e6c  EX_TIME, value.l
+00016770: 6f77 6572 2829 290a 2020 2020 2020 2020  ower()).        
+00016780: 2020 2020 2868 2c20 6d2c 2073 2920 3d20      (h, m, s) = 
+00016790: 2869 6e74 2876 616c 7565 2e67 726f 7570  (int(value.group
+000167a0: 2822 6822 2929 2c20 302c 2030 290a 2020  ("h")), 0, 0).  
+000167b0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+000167c0: 2076 616c 7565 2e67 726f 7570 2822 6d22   value.group("m"
+000167d0: 2920 6973 204e 6f6e 653a 0a20 2020 2020  ) is None:.     
+000167e0: 2020 2020 2020 2020 2020 206d 203d 2069             m = i
+000167f0: 6e74 2876 616c 7565 2e67 726f 7570 2822  nt(value.group("
+00016800: 6d22 2929 0a20 2020 2020 2020 2020 2020  m")).           
+00016810: 2069 6620 6e6f 7420 7661 6c75 652e 6772   if not value.gr
+00016820: 6f75 7028 2273 2229 2069 7320 4e6f 6e65  oup("s") is None
+00016830: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016840: 2020 7320 3d20 696e 7428 7661 6c75 652e    s = int(value.
+00016850: 6772 6f75 7028 2273 2229 290a 2020 2020  group("s")).    
+00016860: 2020 2020 2020 2020 6966 2076 616c 7565          if value
+00016870: 2e67 726f 7570 2822 6422 2920 3d3d 2022  .group("d") == "
+00016880: 706d 2220 616e 6420 3020 3c20 6820 3c20  pm" and 0 < h < 
+00016890: 3132 3a0a 2020 2020 2020 2020 2020 2020  12:.            
+000168a0: 2020 2020 6820 2b3d 2031 320a 2020 2020      h += 12.    
+000168b0: 2020 2020 2020 2020 6966 2076 616c 7565          if value
+000168c0: 2e67 726f 7570 2822 6422 2920 3d3d 2022  .group("d") == "
+000168d0: 616d 2220 616e 6420 6820 3d3d 2031 323a  am" and h == 12:
+000168e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000168f0: 2068 203d 2030 0a20 2020 2020 2020 2020   h = 0.         
+00016900: 2020 2069 6620 6e6f 7420 2868 2069 6e20     if not (h in 
+00016910: 7261 6e67 6528 3234 2920 616e 6420 6d20  range(24) and m 
+00016920: 696e 2072 616e 6765 2836 3029 2061 6e64  in range(60) and
+00016930: 2073 2069 6e20 7261 6e67 6528 3630 2929   s in range(60))
+00016940: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016950: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00016960: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00016970: 2020 2020 2020 2020 2248 6f75 7273 206f          "Hours o
+00016980: 7220 6d69 6e75 7465 7320 6f72 2073 6563  r minutes or sec
+00016990: 6f6e 6473 2061 7265 206f 7574 7369 6465  onds are outside
+000169a0: 206f 6620 616c 6c6f 7765 6420 7261 6e67   of allowed rang
+000169b0: 6522 0a20 2020 2020 2020 2020 2020 2020  e".             
+000169c0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+000169d0: 2076 616c 7565 203d 2064 6174 6574 696d   value = datetim
+000169e0: 652e 7469 6d65 2868 2c20 6d2c 2073 290a  e.time(h, m, s).
+000169f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00016a00: 726e 2076 616c 7565 0a20 2020 2020 2020  rn value.       
+00016a10: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+00016a20: 6e3a 0a20 2020 2020 2020 2020 2020 2072  n:.            r
+00016a30: 6169 7365 2056 616c 6964 6174 696f 6e45  aise ValidationE
+00016a40: 7272 6f72 2873 656c 662e 7472 616e 736c  rror(self.transl
+00016a50: 6174 6f72 2873 656c 662e 6572 726f 725f  ator(self.error_
+00016a60: 6d65 7373 6167 6529 290a 0a0a 2320 4120  message))...# A 
+00016a70: 5554 4320 636c 6173 732e 0a63 6c61 7373  UTC class..class
+00016a80: 2055 5443 2864 6174 6574 696d 652e 747a   UTC(datetime.tz
+00016a90: 696e 666f 293a 0a20 2020 2022 2222 5554  info):.    """UT
+00016aa0: 4322 2222 0a0a 2020 2020 5a45 524f 203d  C"""..    ZERO =
+00016ab0: 2064 6174 6574 696d 652e 7469 6d65 6465   datetime.timede
+00016ac0: 6c74 6128 3029 0a0a 2020 2020 6465 6620  lta(0)..    def 
+00016ad0: 7574 636f 6666 7365 7428 7365 6c66 2c20  utcoffset(self, 
+00016ae0: 6474 293a 0a20 2020 2020 2020 2072 6574  dt):.        ret
+00016af0: 7572 6e20 5554 432e 5a45 524f 0a0a 2020  urn UTC.ZERO..  
+00016b00: 2020 6465 6620 747a 6e61 6d65 2873 656c    def tzname(sel
+00016b10: 662c 2064 7429 3a0a 2020 2020 2020 2020  f, dt):.        
+00016b20: 7265 7475 726e 2022 5554 4322 0a0a 2020  return "UTC"..  
+00016b30: 2020 6465 6620 6473 7428 7365 6c66 2c20    def dst(self, 
+00016b40: 6474 293a 0a20 2020 2020 2020 2072 6574  dt):.        ret
+00016b50: 7572 6e20 5554 432e 5a45 524f 0a0a 0a75  urn UTC.ZERO...u
+00016b60: 7463 203d 2055 5443 2829 0a0a 0a63 6c61  tc = UTC()...cla
+00016b70: 7373 2049 535f 4441 5445 2856 616c 6964  ss IS_DATE(Valid
+00016b80: 6174 6f72 293a 0a20 2020 2022 2222 0a20  ator):.    """. 
+00016b90: 2020 2045 7861 6d70 6c65 733a 0a20 2020     Examples:.   
+00016ba0: 2020 2020 2055 7365 2061 733a 3a0a 0a20       Use as::.. 
+00016bb0: 2020 2020 2020 2020 2020 2049 4e50 5554             INPUT
+00016bc0: 285f 7479 7065 3d27 7465 7874 272c 205f  (_type='text', _
+00016bd0: 6e61 6d65 3d27 6e61 6d65 272c 2072 6571  name='name', req
+00016be0: 7569 7265 733d 4953 5f44 4154 4528 2929  uires=IS_DATE())
+00016bf0: 0a0a 2020 2020 6461 7465 2068 6173 2074  ..    date has t
+00016c00: 6f20 6265 2069 6e20 7468 6520 4953 4f38  o be in the ISO8
+00016c10: 3936 3020 666f 726d 6174 2059 5959 592d  960 format YYYY-
+00016c20: 4d4d 2d44 440a 2020 2020 2222 220a 0a20  MM-DD.    """.. 
+00016c30: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00016c40: 7365 6c66 2c20 666f 726d 6174 3d22 2559  self, format="%Y
+00016c50: 2d25 6d2d 2564 222c 2065 7272 6f72 5f6d  -%m-%d", error_m
+00016c60: 6573 7361 6765 3d22 456e 7465 7220 6461  essage="Enter da
+00016c70: 7465 2061 7320 2528 666f 726d 6174 2973  te as %(format)s
+00016c80: 2229 3a0a 2020 2020 2020 2020 7365 6c66  "):.        self
+00016c90: 2e66 6f72 6d61 7420 3d20 7365 6c66 2e74  .format = self.t
+00016ca0: 7261 6e73 6c61 746f 7228 666f 726d 6174  ranslator(format
+00016cb0: 290a 2020 2020 2020 2020 7365 6c66 2e65  ).        self.e
+00016cc0: 7272 6f72 5f6d 6573 7361 6765 203d 2073  rror_message = s
+00016cd0: 7472 2865 7272 6f72 5f6d 6573 7361 6765  tr(error_message
+00016ce0: 290a 2020 2020 2020 2020 7365 6c66 2e65  ).        self.e
+00016cf0: 7874 7265 6d65 7320 3d20 7b7d 0a0a 2020  xtremes = {}..  
+00016d00: 2020 6465 6620 7661 6c69 6461 7465 2873    def validate(s
+00016d10: 656c 662c 2076 616c 7565 2c20 7265 636f  elf, value, reco
+00016d20: 7264 5f69 643d 4e6f 6e65 293a 0a20 2020  rd_id=None):.   
+00016d30: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00016d40: 6365 2876 616c 7565 2c20 6461 7465 7469  ce(value, dateti
+00016d50: 6d65 2e64 6174 6529 3a0a 2020 2020 2020  me.date):.      
+00016d60: 2020 2020 2020 7265 7475 726e 2076 616c        return val
+00016d70: 7565 0a20 2020 2020 2020 2074 7279 3a0a  ue.        try:.
+00016d80: 2020 2020 2020 2020 2020 2020 2879 2c20              (y, 
+00016d90: 6d2c 2064 2c20 6868 2c20 6d6d 2c20 7373  m, d, hh, mm, ss
+00016da0: 2c20 7430 2c20 7431 2c20 7432 2920 3d20  , t0, t1, t2) = 
+00016db0: 7469 6d65 2e73 7472 7074 696d 6528 7661  time.strptime(va
+00016dc0: 6c75 652c 2073 7472 2873 656c 662e 666f  lue, str(self.fo
+00016dd0: 726d 6174 2929 0a20 2020 2020 2020 2020  rmat)).         
+00016de0: 2020 2076 616c 7565 203d 2064 6174 6574     value = datet
+00016df0: 696d 652e 6461 7465 2879 2c20 6d2c 2064  ime.date(y, m, d
+00016e00: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00016e10: 7475 726e 2076 616c 7565 0a20 2020 2020  turn value.     
+00016e20: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
+00016e30: 2020 2020 2020 2073 656c 662e 6578 7472         self.extr
+00016e40: 656d 6573 2e75 7064 6174 6528 4953 5f44  emes.update(IS_D
+00016e50: 4154 4554 494d 452e 6e69 6365 2873 656c  ATETIME.nice(sel
+00016e60: 662e 666f 726d 6174 2929 0a20 2020 2020  f.format)).     
+00016e70: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00016e80: 6964 6174 696f 6e45 7272 6f72 2873 656c  idationError(sel
+00016e90: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
+00016ea0: 662e 6572 726f 725f 6d65 7373 6167 6529  f.error_message)
+00016eb0: 2025 2073 656c 662e 6578 7472 656d 6573   % self.extremes
+00016ec0: 290a 0a20 2020 2064 6566 2066 6f72 6d61  )..    def forma
+00016ed0: 7474 6572 2873 656c 662c 2076 616c 7565  tter(self, value
+00016ee0: 293a 0a20 2020 2020 2020 2069 6620 7661  ):.        if va
+00016ef0: 6c75 6520 6973 204e 6f6e 6520 6f72 2076  lue is None or v
+00016f00: 616c 7565 203d 3d20 2222 3a0a 2020 2020  alue == "":.    
+00016f10: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+00016f20: 6f6e 650a 2020 2020 2020 2020 666f 726d  one.        form
+00016f30: 6174 203d 2073 656c 662e 666f 726d 6174  at = self.format
+00016f40: 0a20 2020 2020 2020 2079 6561 7220 3d20  .        year = 
+00016f50: 7661 6c75 652e 7965 6172 0a20 2020 2020  value.year.     
+00016f60: 2020 2079 203d 2022 252e 3469 2220 2520     y = "%.4i" % 
+00016f70: 7965 6172 0a20 2020 2020 2020 2066 6f72  year.        for
+00016f80: 6d61 7420 3d20 666f 726d 6174 2e72 6570  mat = format.rep
+00016f90: 6c61 6365 2822 2579 222c 2079 5b2d 323a  lace("%y", y[-2:
+00016fa0: 5d29 0a20 2020 2020 2020 2066 6f72 6d61  ]).        forma
+00016fb0: 7420 3d20 666f 726d 6174 2e72 6570 6c61  t = format.repla
+00016fc0: 6365 2822 2559 222c 2079 290a 2020 2020  ce("%Y", y).    
+00016fd0: 2020 2020 6966 2079 6561 7220 3c20 3139      if year < 19
+00016fe0: 3030 3a0a 2020 2020 2020 2020 2020 2020  00:.            
+00016ff0: 7965 6172 203d 2032 3030 300a 2020 2020  year = 2000.    
+00017000: 2020 2020 6420 3d20 6461 7465 7469 6d65      d = datetime
+00017010: 2e64 6174 6528 7965 6172 2c20 7661 6c75  .date(year, valu
+00017020: 652e 6d6f 6e74 682c 2076 616c 7565 2e64  e.month, value.d
+00017030: 6179 290a 2020 2020 2020 2020 7265 7475  ay).        retu
+00017040: 726e 2064 2e73 7472 6674 696d 6528 666f  rn d.strftime(fo
+00017050: 726d 6174 290a 0a0a 636c 6173 7320 4953  rmat)...class IS
+00017060: 5f44 4154 4554 494d 4528 5661 6c69 6461  _DATETIME(Valida
+00017070: 746f 7229 3a0a 2020 2020 2222 220a 2020  tor):.    """.  
+00017080: 2020 4578 616d 706c 6573 3a0a 2020 2020    Examples:.    
+00017090: 2020 2020 5573 6520 6173 3a3a 0a0a 2020      Use as::..  
+000170a0: 2020 2020 2020 2020 2020 494e 5055 5428            INPUT(
+000170b0: 5f74 7970 653d 2774 6578 7427 2c20 5f6e  _type='text', _n
+000170c0: 616d 653d 276e 616d 6527 2c20 7265 7175  ame='name', requ
+000170d0: 6972 6573 3d49 535f 4441 5445 5449 4d45  ires=IS_DATETIME
+000170e0: 2829 290a 0a20 2020 2064 6174 6574 696d  ())..    datetim
+000170f0: 6520 6861 7320 746f 2062 6520 696e 2074  e has to be in t
+00017100: 6865 2049 534f 3839 3630 2066 6f72 6d61  he ISO8960 forma
+00017110: 7420 5959 5959 2d4d 4d2d 4444 2068 683a  t YYYY-MM-DD hh:
+00017120: 6d6d 3a73 730a 2020 2020 7469 6d65 7a6f  mm:ss.    timezo
+00017130: 6d65 206d 7573 7420 6265 204e 6f6e 6520  me must be None 
+00017140: 6f72 2061 2070 7974 7a2e 7469 6d65 7a6f  or a pytz.timezo
+00017150: 6e65 2822 416d 6572 6963 612f 4368 6963  ne("America/Chic
+00017160: 6167 6f22 2920 6f62 6a65 6374 0a20 2020  ago") object.   
+00017170: 2022 2222 0a0a 2020 2020 6973 6f64 6174   """..    isodat
+00017180: 6574 696d 6520 3d20 2225 592d 256d 2d25  etime = "%Y-%m-%
+00017190: 6420 2548 3a25 4d3a 2553 220a 0a20 2020  d %H:%M:%S"..   
+000171a0: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+000171b0: 2020 2064 6566 206e 6963 6528 666f 726d     def nice(form
+000171c0: 6174 293a 0a20 2020 2020 2020 2063 6f64  at):.        cod
+000171d0: 6520 3d20 280a 2020 2020 2020 2020 2020  e = (.          
+000171e0: 2020 2822 2559 222c 2022 3139 3633 2229    ("%Y", "1963")
+000171f0: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
+00017200: 2579 222c 2022 3633 2229 2c0a 2020 2020  %y", "63"),.    
+00017210: 2020 2020 2020 2020 2822 2564 222c 2022          ("%d", "
+00017220: 3238 2229 2c0a 2020 2020 2020 2020 2020  28"),.          
+00017230: 2020 2822 256d 222c 2022 3038 2229 2c0a    ("%m", "08"),.
+00017240: 2020 2020 2020 2020 2020 2020 2822 2562              ("%b
+00017250: 222c 2022 4175 6722 292c 0a20 2020 2020  ", "Aug"),.     
+00017260: 2020 2020 2020 2028 2225 4222 2c20 2241         ("%B", "A
+00017270: 7567 7573 7422 292c 0a20 2020 2020 2020  ugust"),.       
+00017280: 2020 2020 2028 2225 4822 2c20 2231 3422       ("%H", "14"
+00017290: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
+000172a0: 2225 4922 2c20 2230 3222 292c 0a20 2020  "%I", "02"),.   
+000172b0: 2020 2020 2020 2020 2028 2225 7022 2c20           ("%p", 
+000172c0: 2250 4d22 292c 0a20 2020 2020 2020 2020  "PM"),.         
+000172d0: 2020 2028 2225 4d22 2c20 2233 3022 292c     ("%M", "30"),
+000172e0: 0a20 2020 2020 2020 2020 2020 2028 2225  .            ("%
+000172f0: 5322 2c20 2235 3922 292c 0a20 2020 2020  S", "59"),.     
+00017300: 2020 2029 0a20 2020 2020 2020 2066 6f72     ).        for
+00017310: 2028 612c 2062 2920 696e 2063 6f64 653a   (a, b) in code:
+00017320: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00017330: 6d61 7420 3d20 666f 726d 6174 2e72 6570  mat = format.rep
+00017340: 6c61 6365 2861 2c20 6229 0a20 2020 2020  lace(a, b).     
+00017350: 2020 2072 6574 7572 6e20 6469 6374 2866     return dict(f
+00017360: 6f72 6d61 743d 666f 726d 6174 290a 0a20  ormat=format).. 
+00017370: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00017380: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00017390: 2020 2020 2020 2066 6f72 6d61 743d 2225         format="%
+000173a0: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
+000173b0: 222c 0a20 2020 2020 2020 2065 7272 6f72  ",.        error
+000173c0: 5f6d 6573 7361 6765 3d22 456e 7465 7220  _message="Enter 
+000173d0: 6461 7465 2061 6e64 2074 696d 6520 6173  date and time as
+000173e0: 2025 2866 6f72 6d61 7429 7322 2c0a 2020   %(format)s",.  
+000173f0: 2020 2020 2020 7469 6d65 7a6f 6e65 3d4e        timezone=N
+00017400: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+00017410: 2020 2020 7365 6c66 2e66 6f72 6d61 7420      self.format 
+00017420: 3d20 7365 6c66 2e74 7261 6e73 6c61 746f  = self.translato
+00017430: 7228 666f 726d 6174 290a 2020 2020 2020  r(format).      
+00017440: 2020 7365 6c66 2e65 7272 6f72 5f6d 6573    self.error_mes
+00017450: 7361 6765 203d 2073 7472 2865 7272 6f72  sage = str(error
+00017460: 5f6d 6573 7361 6765 290a 2020 2020 2020  _message).      
+00017470: 2020 7365 6c66 2e65 7874 7265 6d65 7320    self.extremes 
+00017480: 3d20 7b7d 0a20 2020 2020 2020 2073 656c  = {}.        sel
+00017490: 662e 7469 6d65 7a6f 6e65 203d 2074 696d  f.timezone = tim
+000174a0: 657a 6f6e 650a 0a20 2020 2064 6566 2076  ezone..    def v
+000174b0: 616c 6964 6174 6528 7365 6c66 2c20 7661  alidate(self, va
+000174c0: 6c75 652c 2072 6563 6f72 645f 6964 3d4e  lue, record_id=N
+000174d0: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
+000174e0: 2069 7369 6e73 7461 6e63 6528 7661 6c75   isinstance(valu
+000174f0: 652c 2064 6174 6574 696d 652e 6461 7465  e, datetime.date
+00017500: 7469 6d65 293a 0a20 2020 2020 2020 2020  time):.         
+00017510: 2020 2072 6574 7572 6e20 7661 6c75 650a     return value.
+00017520: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00017530: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00017540: 2e66 6f72 6d61 7420 3d3d 2073 656c 662e  .format == self.
+00017550: 6973 6f64 6174 6574 696d 653a 0a20 2020  isodatetime:.   
+00017560: 2020 2020 2020 2020 2020 2020 2076 616c               val
+00017570: 7565 203d 2076 616c 7565 2e72 6570 6c61  ue = value.repla
+00017580: 6365 2822 5422 2c20 2220 2229 0a20 2020  ce("T", " ").   
+00017590: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000175a0: 6c65 6e28 7661 6c75 6529 203d 3d20 3136  len(value) == 16
+000175b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000175c0: 2020 2020 2020 7661 6c75 6520 2b3d 2022        value += "
+000175d0: 3a30 3022 0a20 2020 2020 2020 2020 2020  :00".           
+000175e0: 2028 792c 206d 2c20 642c 2068 682c 206d   (y, m, d, hh, m
+000175f0: 6d2c 2073 732c 2074 302c 2074 312c 2074  m, ss, t0, t1, t
+00017600: 3229 203d 2074 696d 652e 7374 7270 7469  2) = time.strpti
+00017610: 6d65 2876 616c 7565 2c20 7374 7228 7365  me(value, str(se
+00017620: 6c66 2e66 6f72 6d61 7429 290a 2020 2020  lf.format)).    
+00017630: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
+00017640: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+00017650: 6528 792c 206d 2c20 642c 2068 682c 206d  e(y, m, d, hh, m
+00017660: 6d2c 2073 7329 0a20 2020 2020 2020 2020  m, ss).         
+00017670: 2020 2069 6620 7365 6c66 2e74 696d 657a     if self.timez
+00017680: 6f6e 6520 6973 206e 6f74 204e 6f6e 653a  one is not None:
+00017690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000176a0: 2023 2054 4f44 4f3a 2068 7474 7073 3a2f   # TODO: https:/
+000176b0: 2f67 6974 6875 622e 636f 6d2f 7765 6232  /github.com/web2
+000176c0: 7079 2f77 6562 3270 792f 6973 7375 6573  py/web2py/issues
+000176d0: 2f31 3039 3420 2874 656d 706f 7261 7279  /1094 (temporary
+000176e0: 2073 6f6c 7574 696f 6e29 0a20 2020 2020   solution).     
+000176f0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+00017700: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00017710: 2020 2020 2020 2020 2073 656c 662e 7469           self.ti
+00017720: 6d65 7a6f 6e65 2e6c 6f63 616c 697a 6528  mezone.localize(
+00017730: 7661 6c75 6529 2e61 7374 696d 657a 6f6e  value).astimezon
+00017740: 6528 7574 6329 2e72 6570 6c61 6365 2874  e(utc).replace(t
+00017750: 7a69 6e66 6f3d 4e6f 6e65 290a 2020 2020  zinfo=None).    
+00017760: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00017770: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00017780: 2076 616c 7565 0a20 2020 2020 2020 2065   value.        e
+00017790: 7863 6570 743a 0a20 2020 2020 2020 2020  xcept:.         
+000177a0: 2020 2073 656c 662e 6578 7472 656d 6573     self.extremes
+000177b0: 2e75 7064 6174 6528 4953 5f44 4154 4554  .update(IS_DATET
+000177c0: 494d 452e 6e69 6365 2873 656c 662e 666f  IME.nice(self.fo
+000177d0: 726d 6174 2929 0a20 2020 2020 2020 2020  rmat)).         
+000177e0: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
+000177f0: 696f 6e45 7272 6f72 2873 656c 662e 7472  ionError(self.tr
+00017800: 616e 736c 6174 6f72 2873 656c 662e 6572  anslator(self.er
+00017810: 726f 725f 6d65 7373 6167 6529 2025 2073  ror_message) % s
+00017820: 656c 662e 6578 7472 656d 6573 290a 0a20  elf.extremes).. 
+00017830: 2020 2064 6566 2066 6f72 6d61 7474 6572     def formatter
+00017840: 2873 656c 662c 2076 616c 7565 293a 0a20  (self, value):. 
+00017850: 2020 2020 2020 2069 6620 7661 6c75 6520         if value 
+00017860: 6973 204e 6f6e 6520 6f72 2076 616c 7565  is None or value
+00017870: 203d 3d20 2222 3a0a 2020 2020 2020 2020   == "":.        
+00017880: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+00017890: 2020 2020 2020 2020 666f 726d 6174 203d          format =
+000178a0: 2073 656c 662e 666f 726d 6174 0a20 2020   self.format.   
+000178b0: 2020 2020 2079 6561 7220 3d20 7661 6c75       year = valu
+000178c0: 652e 7965 6172 0a20 2020 2020 2020 2079  e.year.        y
+000178d0: 203d 2022 252e 3469 2220 2520 7965 6172   = "%.4i" % year
+000178e0: 0a20 2020 2020 2020 2066 6f72 6d61 7420  .        format 
+000178f0: 3d20 666f 726d 6174 2e72 6570 6c61 6365  = format.replace
+00017900: 2822 2579 222c 2079 5b2d 323a 5d29 0a20  ("%y", y[-2:]). 
+00017910: 2020 2020 2020 2066 6f72 6d61 7420 3d20         format = 
+00017920: 666f 726d 6174 2e72 6570 6c61 6365 2822  format.replace("
+00017930: 2559 222c 2079 290a 2020 2020 2020 2020  %Y", y).        
+00017940: 6966 2079 6561 7220 3c20 3139 3030 3a0a  if year < 1900:.
+00017950: 2020 2020 2020 2020 2020 2020 7965 6172              year
+00017960: 203d 2032 3030 300a 2020 2020 2020 2020   = 2000.        
+00017970: 6420 3d20 6461 7465 7469 6d65 2e64 6174  d = datetime.dat
+00017980: 6574 696d 6528 0a20 2020 2020 2020 2020  etime(.         
+00017990: 2020 2079 6561 722c 2076 616c 7565 2e6d     year, value.m
+000179a0: 6f6e 7468 2c20 7661 6c75 652e 6461 792c  onth, value.day,
+000179b0: 2076 616c 7565 2e68 6f75 722c 2076 616c   value.hour, val
+000179c0: 7565 2e6d 696e 7574 652c 2076 616c 7565  ue.minute, value
+000179d0: 2e73 6563 6f6e 640a 2020 2020 2020 2020  .second.        
+000179e0: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
+000179f0: 662e 7469 6d65 7a6f 6e65 2069 7320 6e6f  f.timezone is no
+00017a00: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00017a10: 2020 2020 6420 3d20 642e 7265 706c 6163      d = d.replac
+00017a20: 6528 747a 696e 666f 3d75 7463 292e 6173  e(tzinfo=utc).as
+00017a30: 7469 6d65 7a6f 6e65 2873 656c 662e 7469  timezone(self.ti
+00017a40: 6d65 7a6f 6e65 290a 2020 2020 2020 2020  mezone).        
+00017a50: 7265 7475 726e 2064 2e73 7472 6674 696d  return d.strftim
+00017a60: 6528 666f 726d 6174 290a 0a0a 636c 6173  e(format)...clas
+00017a70: 7320 4953 5f44 4154 455f 494e 5f52 414e  s IS_DATE_IN_RAN
+00017a80: 4745 2849 535f 4441 5445 293a 0a20 2020  GE(IS_DATE):.   
+00017a90: 2022 2222 0a20 2020 2045 7861 6d70 6c65   """.    Example
+00017aa0: 733a 0a20 2020 2020 2020 2055 7365 2061  s:.        Use a
+00017ab0: 733a 3a0a 0a20 2020 2020 2020 2020 2020  s::..           
+00017ac0: 203e 3e3e 2076 203d 2049 535f 4441 5445   >>> v = IS_DATE
+00017ad0: 5f49 4e5f 5241 4e47 4528 6d69 6e69 6d75  _IN_RANGE(minimu
+00017ae0: 6d3d 6461 7465 7469 6d65 2e64 6174 6528  m=datetime.date(
+00017af0: 3230 3038 2c31 2c31 292c 205c 0a20 2020  2008,1,1), \.   
 00017b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00017b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b20: 2020 2020 6d61 7869 6d75 6d3d 6461 7465      maximum=date
-00017b30: 7469 6d65 2e64 6174 6528 3230 3039 2c31  time.date(2009,1
-00017b40: 322c 3331 292c 205c 0a20 2020 2020 2020  2,31), \.       
+00017b20: 2020 6d61 7869 6d75 6d3d 6461 7465 7469    maximum=dateti
+00017b30: 6d65 2e64 6174 6528 3230 3039 2c31 322c  me.date(2009,12,
+00017b40: 3331 292c 205c 0a20 2020 2020 2020 2020  31), \.         
 00017b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b60: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00017b70: 726d 6174 3d22 256d 2f25 642f 2559 222c  rmat="%m/%d/%Y",
-00017b80: 6572 726f 725f 6d65 7373 6167 653d 224f  error_message="O
-00017b90: 6f70 7322 290a 0a20 2020 2020 2020 2020  ops")..         
-00017ba0: 2020 203e 3e3e 2076 2827 3033 2f30 332f     >>> v('03/03/
-00017bb0: 3230 3038 2729 0a20 2020 2020 2020 2020  2008').         
-00017bc0: 2020 2028 6461 7465 7469 6d65 2e64 6174     (datetime.dat
-00017bd0: 6528 3230 3038 2c20 332c 2033 292c 204e  e(2008, 3, 3), N
-00017be0: 6f6e 6529 0a0a 2020 2020 2020 2020 2020  one)..          
-00017bf0: 2020 3e3e 3e20 7628 2730 332f 3033 2f32    >>> v('03/03/2
-00017c00: 3031 3027 290a 2020 2020 2020 2020 2020  010').          
-00017c10: 2020 2827 3033 2f30 332f 3230 3130 272c    ('03/03/2010',
-00017c20: 2027 6f6f 7073 2729 0a0a 2020 2020 2020   'oops')..      
-00017c30: 2020 2020 2020 3e3e 3e20 7628 6461 7465        >>> v(date
-00017c40: 7469 6d65 2e64 6174 6528 3230 3038 2c33  time.date(2008,3
-00017c50: 2c33 2929 0a20 2020 2020 2020 2020 2020  ,3)).           
-00017c60: 2028 6461 7465 7469 6d65 2e64 6174 6528   (datetime.date(
-00017c70: 3230 3038 2c20 332c 2033 292c 204e 6f6e  2008, 3, 3), Non
-00017c80: 6529 0a0a 2020 2020 2020 2020 2020 2020  e)..            
-00017c90: 3e3e 3e20 7628 6461 7465 7469 6d65 2e64  >>> v(datetime.d
-00017ca0: 6174 6528 3230 3130 2c33 2c33 2929 0a20  ate(2010,3,3)). 
-00017cb0: 2020 2020 2020 2020 2020 2028 6461 7465             (date
-00017cc0: 7469 6d65 2e64 6174 6528 3230 3130 2c20  time.date(2010, 
-00017cd0: 332c 2033 292c 2027 6f6f 7073 2729 0a0a  3, 3), 'oops')..
-00017ce0: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
-00017cf0: 205f 5f69 6e69 745f 5f28 0a20 2020 2020   __init__(.     
-00017d00: 2020 2073 656c 662c 206d 696e 696d 756d     self, minimum
-00017d10: 3d4e 6f6e 652c 206d 6178 696d 756d 3d4e  =None, maximum=N
-00017d20: 6f6e 652c 2066 6f72 6d61 743d 2225 592d  one, format="%Y-
-00017d30: 256d 2d25 6422 2c20 6572 726f 725f 6d65  %m-%d", error_me
-00017d40: 7373 6167 653d 4e6f 6e65 0a20 2020 2029  ssage=None.    )
-00017d50: 3a0a 2020 2020 2020 2020 7365 6c66 2e6d  :.        self.m
-00017d60: 696e 696d 756d 203d 206d 696e 696d 756d  inimum = minimum
-00017d70: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
-00017d80: 7869 6d75 6d20 3d20 6d61 7869 6d75 6d0a  ximum = maximum.
-00017d90: 2020 2020 2020 2020 6966 2065 7272 6f72          if error
-00017da0: 5f6d 6573 7361 6765 2069 7320 4e6f 6e65  _message is None
-00017db0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00017dc0: 206d 696e 696d 756d 2069 7320 4e6f 6e65   minimum is None
-00017dd0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00017de0: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00017df0: 3d20 2245 6e74 6572 2064 6174 6520 6f6e  = "Enter date on
-00017e00: 206f 7220 6265 666f 7265 2025 286d 6178   or before %(max
-00017e10: 2973 220a 2020 2020 2020 2020 2020 2020  )s".            
-00017e20: 656c 6966 206d 6178 696d 756d 2069 7320  elif maximum is 
-00017e30: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00017e40: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00017e50: 6167 6520 3d20 2245 6e74 6572 2064 6174  age = "Enter dat
-00017e60: 6520 6f6e 206f 7220 6166 7465 7220 2528  e on or after %(
-00017e70: 6d69 6e29 7322 0a20 2020 2020 2020 2020  min)s".         
-00017e80: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00017e90: 2020 2020 2020 2020 2065 7272 6f72 5f6d           error_m
-00017ea0: 6573 7361 6765 203d 2022 456e 7465 7220  essage = "Enter 
-00017eb0: 6461 7465 2069 6e20 7261 6e67 6520 2528  date in range %(
-00017ec0: 6d69 6e29 7320 2528 6d61 7829 7322 0a20  min)s %(max)s". 
-00017ed0: 2020 2020 2020 2049 535f 4441 5445 2e5f         IS_DATE._
-00017ee0: 5f69 6e69 745f 5f28 7365 6c66 2c20 666f  _init__(self, fo
-00017ef0: 726d 6174 3d66 6f72 6d61 742c 2065 7272  rmat=format, err
-00017f00: 6f72 5f6d 6573 7361 6765 3d65 7272 6f72  or_message=error
-00017f10: 5f6d 6573 7361 6765 290a 2020 2020 2020  _message).      
-00017f20: 2020 7365 6c66 2e65 7874 7265 6d65 7320    self.extremes 
-00017f30: 3d20 6469 6374 286d 696e 3d73 656c 662e  = dict(min=self.
-00017f40: 666f 726d 6174 7465 7228 6d69 6e69 6d75  formatter(minimu
-00017f50: 6d29 2c20 6d61 783d 7365 6c66 2e66 6f72  m), max=self.for
-00017f60: 6d61 7474 6572 286d 6178 696d 756d 2929  matter(maximum))
-00017f70: 0a0a 2020 2020 6465 6620 7661 6c69 6461  ..    def valida
-00017f80: 7465 2873 656c 662c 2076 616c 7565 2c20  te(self, value, 
-00017f90: 7265 636f 7264 5f69 643d 4e6f 6e65 293a  record_id=None):
-00017fa0: 0a20 2020 2020 2020 2076 616c 7565 203d  .        value =
-00017fb0: 2049 535f 4441 5445 2e76 616c 6964 6174   IS_DATE.validat
-00017fc0: 6528 7365 6c66 2c20 7661 6c75 652c 2072  e(self, value, r
-00017fd0: 6563 6f72 645f 6964 3d4e 6f6e 6529 0a20  ecord_id=None). 
-00017fe0: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
-00017ff0: 696e 696d 756d 2061 6e64 2073 656c 662e  inimum and self.
-00018000: 6d69 6e69 6d75 6d20 3e20 7661 6c75 653a  minimum > value:
-00018010: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00018020: 7365 2056 616c 6964 6174 696f 6e45 7272  se ValidationErr
-00018030: 6f72 2873 656c 662e 7472 616e 736c 6174  or(self.translat
-00018040: 6f72 2873 656c 662e 6572 726f 725f 6d65  or(self.error_me
-00018050: 7373 6167 6529 2025 2073 656c 662e 6578  ssage) % self.ex
-00018060: 7472 656d 6573 290a 2020 2020 2020 2020  tremes).        
-00018070: 6966 2073 656c 662e 6d61 7869 6d75 6d20  if self.maximum 
-00018080: 616e 6420 7661 6c75 6520 3e20 7365 6c66  and value > self
-00018090: 2e6d 6178 696d 756d 3a0a 2020 2020 2020  .maximum:.      
-000180a0: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
-000180b0: 6461 7469 6f6e 4572 726f 7228 7365 6c66  dationError(self
-000180c0: 2e74 7261 6e73 6c61 746f 7228 7365 6c66  .translator(self
-000180d0: 2e65 7272 6f72 5f6d 6573 7361 6765 2920  .error_message) 
-000180e0: 2520 7365 6c66 2e65 7874 7265 6d65 7329  % self.extremes)
-000180f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00018100: 7661 6c75 650a 0a0a 636c 6173 7320 4953  value...class IS
-00018110: 5f44 4154 4554 494d 455f 494e 5f52 414e  _DATETIME_IN_RAN
-00018120: 4745 2849 535f 4441 5445 5449 4d45 293a  GE(IS_DATETIME):
-00018130: 0a20 2020 2022 2222 0a20 2020 2045 7861  .    """.    Exa
-00018140: 6d70 6c65 733a 0a20 2020 2020 2020 2055  mples:.        U
-00018150: 7365 2061 733a 3a0a 2020 2020 2020 2020  se as::.        
-00018160: 2020 2020 3e3e 3e20 7620 3d20 4953 5f44      >>> v = IS_D
-00018170: 4154 4554 494d 455f 494e 5f52 414e 4745  ATETIME_IN_RANGE
-00018180: 285c 0a20 2020 2020 2020 2020 2020 2020  (\.             
-00018190: 2020 2020 2020 206d 696e 696d 756d 3d64         minimum=d
-000181a0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-000181b0: 2832 3030 382c 312c 312c 3132 2c32 3029  (2008,1,1,12,20)
-000181c0: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
-000181d0: 2020 2020 2020 2020 6d61 7869 6d75 6d3d          maximum=
-000181e0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-000181f0: 6528 3230 3039 2c31 322c 3331 2c31 322c  e(2009,12,31,12,
-00018200: 3230 292c 205c 0a20 2020 2020 2020 2020  20), \.         
-00018210: 2020 2020 2020 2020 2020 2066 6f72 6d61             forma
-00018220: 743d 2225 6d2f 2564 2f25 5920 2548 3a25  t="%m/%d/%Y %H:%
-00018230: 4d22 2c65 7272 6f72 5f6d 6573 7361 6765  M",error_message
-00018240: 3d22 4f6f 7073 2229 0a20 2020 2020 2020  ="Oops").       
-00018250: 2020 2020 203e 3e3e 2076 2827 3033 2f30       >>> v('03/0
-00018260: 332f 3230 3038 2031 323a 3430 2729 0a20  3/2008 12:40'). 
-00018270: 2020 2020 2020 2020 2020 2028 6461 7465             (date
-00018280: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-00018290: 3038 2c20 332c 2033 2c20 3132 2c20 3430  08, 3, 3, 12, 40
-000182a0: 292c 204e 6f6e 6529 0a0a 2020 2020 2020  ), None)..      
-000182b0: 2020 2020 2020 3e3e 3e20 7628 2730 332f        >>> v('03/
-000182c0: 3033 2f32 3031 3020 3130 3a33 3427 290a  03/2010 10:34').
-000182d0: 2020 2020 2020 2020 2020 2020 2827 3033              ('03
-000182e0: 2f30 332f 3230 3130 2031 303a 3334 272c  /03/2010 10:34',
-000182f0: 2027 6f6f 7073 2729 0a0a 2020 2020 2020   'oops')..      
-00018300: 2020 2020 2020 3e3e 3e20 7628 6461 7465        >>> v(date
-00018310: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-00018320: 3038 2c33 2c33 2c30 2c30 2929 0a20 2020  08,3,3,0,0)).   
-00018330: 2020 2020 2020 2020 2028 6461 7465 7469           (dateti
-00018340: 6d65 2e64 6174 6574 696d 6528 3230 3038  me.datetime(2008
-00018350: 2c20 332c 2033 2c20 302c 2030 292c 204e  , 3, 3, 0, 0), N
-00018360: 6f6e 6529 0a0a 2020 2020 2020 2020 2020  one)..          
-00018370: 2020 3e3e 3e20 7628 6461 7465 7469 6d65    >>> v(datetime
-00018380: 2e64 6174 6574 696d 6528 3230 3130 2c33  .datetime(2010,3
-00018390: 2c33 2c30 2c30 2929 0a20 2020 2020 2020  ,3,0,0)).       
-000183a0: 2020 2020 2028 6461 7465 7469 6d65 2e64       (datetime.d
-000183b0: 6174 6574 696d 6528 3230 3130 2c20 332c  atetime(2010, 3,
-000183c0: 2033 2c20 302c 2030 292c 2027 6f6f 7073   3, 0, 0), 'oops
-000183d0: 2729 0a0a 2020 2020 2222 220a 0a20 2020  ')..    """..   
-000183e0: 2064 6566 205f 5f69 6e69 745f 5f28 0a20   def __init__(. 
-000183f0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00018400: 2020 2020 206d 696e 696d 756d 3d4e 6f6e       minimum=Non
-00018410: 652c 0a20 2020 2020 2020 206d 6178 696d  e,.        maxim
-00018420: 756d 3d4e 6f6e 652c 0a20 2020 2020 2020  um=None,.       
-00018430: 2066 6f72 6d61 743d 2225 592d 256d 2d25   format="%Y-%m-%
-00018440: 6420 2548 3a25 4d3a 2553 222c 0a20 2020  d %H:%M:%S",.   
-00018450: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00018460: 6765 3d4e 6f6e 652c 0a20 2020 2020 2020  ge=None,.       
-00018470: 2074 696d 657a 6f6e 653d 4e6f 6e65 2c0a   timezone=None,.
-00018480: 2020 2020 293a 0a20 2020 2020 2020 2073      ):.        s
-00018490: 656c 662e 6d69 6e69 6d75 6d20 3d20 6d69  elf.minimum = mi
-000184a0: 6e69 6d75 6d0a 2020 2020 2020 2020 7365  nimum.        se
-000184b0: 6c66 2e6d 6178 696d 756d 203d 206d 6178  lf.maximum = max
-000184c0: 696d 756d 0a20 2020 2020 2020 2069 6620  imum.        if 
-000184d0: 6572 726f 725f 6d65 7373 6167 6520 6973  error_message is
-000184e0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000184f0: 2020 2069 6620 6d69 6e69 6d75 6d20 6973     if minimum is
-00018500: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00018510: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00018520: 7361 6765 203d 2022 456e 7465 7220 6461  sage = "Enter da
-00018530: 7465 2061 6e64 2074 696d 6520 6f6e 206f  te and time on o
-00018540: 7220 6265 666f 7265 2025 286d 6178 2973  r before %(max)s
-00018550: 220a 2020 2020 2020 2020 2020 2020 656c  ".            el
-00018560: 6966 206d 6178 696d 756d 2069 7320 4e6f  if maximum is No
-00018570: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00018580: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00018590: 6520 3d20 2245 6e74 6572 2064 6174 6520  e = "Enter date 
-000185a0: 616e 6420 7469 6d65 206f 6e20 6f72 2061  and time on or a
-000185b0: 6674 6572 2025 286d 696e 2973 220a 2020  fter %(min)s".  
-000185c0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-000185d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185e0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-000185f0: 2245 6e74 6572 2064 6174 6520 616e 6420  "Enter date and 
-00018600: 7469 6d65 2069 6e20 7261 6e67 6520 2528  time in range %(
-00018610: 6d69 6e29 7320 2528 6d61 7829 7322 0a20  min)s %(max)s". 
-00018620: 2020 2020 2020 2049 535f 4441 5445 5449         IS_DATETI
-00018630: 4d45 2e5f 5f69 6e69 745f 5f28 0a20 2020  ME.__init__(.   
-00018640: 2020 2020 2020 2020 2073 656c 662c 2066           self, f
-00018650: 6f72 6d61 743d 666f 726d 6174 2c20 6572  ormat=format, er
-00018660: 726f 725f 6d65 7373 6167 653d 6572 726f  ror_message=erro
-00018670: 725f 6d65 7373 6167 652c 2074 696d 657a  r_message, timez
-00018680: 6f6e 653d 7469 6d65 7a6f 6e65 0a20 2020  one=timezone.   
-00018690: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-000186a0: 656c 662e 6578 7472 656d 6573 203d 2064  elf.extremes = d
-000186b0: 6963 7428 6d69 6e3d 7365 6c66 2e66 6f72  ict(min=self.for
-000186c0: 6d61 7474 6572 286d 696e 696d 756d 292c  matter(minimum),
-000186d0: 206d 6178 3d73 656c 662e 666f 726d 6174   max=self.format
-000186e0: 7465 7228 6d61 7869 6d75 6d29 290a 0a20  ter(maximum)).. 
-000186f0: 2020 2064 6566 2076 616c 6964 6174 6528     def validate(
-00018700: 7365 6c66 2c20 7661 6c75 652c 2072 6563  self, value, rec
-00018710: 6f72 645f 6964 3d4e 6f6e 6529 3a0a 2020  ord_id=None):.  
-00018720: 2020 2020 2020 7661 6c75 6520 3d20 4953        value = IS
-00018730: 5f44 4154 4554 494d 452e 7661 6c69 6461  _DATETIME.valida
-00018740: 7465 2873 656c 662c 2076 616c 7565 2c20  te(self, value, 
-00018750: 7265 636f 7264 5f69 643d 4e6f 6e65 290a  record_id=None).
-00018760: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00018770: 6d69 6e69 6d75 6d20 616e 6420 7365 6c66  minimum and self
-00018780: 2e6d 696e 696d 756d 203e 2076 616c 7565  .minimum > value
-00018790: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-000187a0: 6973 6520 5661 6c69 6461 7469 6f6e 4572  ise ValidationEr
-000187b0: 726f 7228 7365 6c66 2e74 7261 6e73 6c61  ror(self.transla
-000187c0: 746f 7228 7365 6c66 2e65 7272 6f72 5f6d  tor(self.error_m
-000187d0: 6573 7361 6765 2920 2520 7365 6c66 2e65  essage) % self.e
-000187e0: 7874 7265 6d65 7329 0a20 2020 2020 2020  xtremes).       
-000187f0: 2069 6620 7365 6c66 2e6d 6178 696d 756d   if self.maximum
-00018800: 2061 6e64 2076 616c 7565 203e 2073 656c   and value > sel
-00018810: 662e 6d61 7869 6d75 6d3a 0a20 2020 2020  f.maximum:.     
-00018820: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00018830: 6964 6174 696f 6e45 7272 6f72 2873 656c  idationError(sel
-00018840: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
-00018850: 662e 6572 726f 725f 6d65 7373 6167 6529  f.error_message)
-00018860: 2025 2073 656c 662e 6578 7472 656d 6573   % self.extremes
-00018870: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00018880: 2076 616c 7565 0a0a 0a63 6c61 7373 2049   value...class I
-00018890: 535f 4c49 5354 5f4f 4628 5661 6c69 6461  S_LIST_OF(Valida
-000188a0: 746f 7229 3a0a 2020 2020 6465 6620 5f5f  tor):.    def __
-000188b0: 696e 6974 5f5f 2873 656c 662c 206f 7468  init__(self, oth
-000188c0: 6572 3d4e 6f6e 652c 206d 696e 696d 756d  er=None, minimum
-000188d0: 3d4e 6f6e 652c 206d 6178 696d 756d 3d4e  =None, maximum=N
-000188e0: 6f6e 652c 2065 7272 6f72 5f6d 6573 7361  one, error_messa
-000188f0: 6765 3d4e 6f6e 6529 3a0a 2020 2020 2020  ge=None):.      
-00018900: 2020 7365 6c66 2e6f 7468 6572 203d 206f    self.other = o
-00018910: 7468 6572 0a20 2020 2020 2020 2073 656c  ther.        sel
-00018920: 662e 6d69 6e69 6d75 6d20 3d20 6d69 6e69  f.minimum = mini
-00018930: 6d75 6d0a 2020 2020 2020 2020 7365 6c66  mum.        self
-00018940: 2e6d 6178 696d 756d 203d 206d 6178 696d  .maximum = maxim
-00018950: 756d 0a20 2020 2020 2020 2073 656c 662e  um.        self.
-00018960: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00018970: 6572 726f 725f 6d65 7373 6167 650a 0a20  error_message.. 
-00018980: 2020 2064 6566 2076 616c 6964 6174 6528     def validate(
-00018990: 7365 6c66 2c20 7661 6c75 652c 2072 6563  self, value, rec
-000189a0: 6f72 645f 6964 3d4e 6f6e 6529 3a0a 2020  ord_id=None):.  
-000189b0: 2020 2020 2020 6976 616c 7565 203d 2076        ivalue = v
-000189c0: 616c 7565 0a20 2020 2020 2020 2069 6620  alue.        if 
-000189d0: 6e6f 7420 6973 696e 7374 616e 6365 2876  not isinstance(v
-000189e0: 616c 7565 2c20 6c69 7374 293a 0a20 2020  alue, list):.   
-000189f0: 2020 2020 2020 2020 2069 7661 6c75 6520           ivalue 
-00018a00: 3d20 5b69 7661 6c75 655d 0a20 2020 2020  = [ivalue].     
-00018a10: 2020 2069 7661 6c75 6520 3d20 5b69 2066     ivalue = [i f
-00018a20: 6f72 2069 2069 6e20 6976 616c 7565 2069  or i in ivalue i
-00018a30: 6620 7374 7228 6929 2e73 7472 6970 2829  f str(i).strip()
-00018a40: 5d0a 2020 2020 2020 2020 6966 2073 656c  ].        if sel
-00018a50: 662e 6d69 6e69 6d75 6d20 6973 206e 6f74  f.minimum is not
-00018a60: 204e 6f6e 6520 616e 6420 6c65 6e28 6976   None and len(iv
-00018a70: 616c 7565 2920 3c20 7365 6c66 2e6d 696e  alue) < self.min
-00018a80: 696d 756d 3a0a 2020 2020 2020 2020 2020  imum:.          
-00018a90: 2020 7261 6973 6520 5661 6c69 6461 7469    raise Validati
-00018aa0: 6f6e 4572 726f 7228 0a20 2020 2020 2020  onError(.       
-00018ab0: 2020 2020 2020 2020 2073 656c 662e 7472           self.tr
-00018ac0: 616e 736c 6174 6f72 2873 656c 662e 6572  anslator(self.er
-00018ad0: 726f 725f 6d65 7373 6167 6520 6f72 2022  ror_message or "
-00018ae0: 4d69 6e69 6d75 6d20 6c65 6e67 7468 2069  Minimum length i
-00018af0: 7320 2528 6d69 6e29 7322 290a 2020 2020  s %(min)s").    
-00018b00: 2020 2020 2020 2020 2020 2020 2520 6469              % di
-00018b10: 6374 286d 696e 3d73 656c 662e 6d69 6e69  ct(min=self.mini
-00018b20: 6d75 6d2c 206d 6178 3d73 656c 662e 6d61  mum, max=self.ma
-00018b30: 7869 6d75 6d29 0a20 2020 2020 2020 2020  ximum).         
-00018b40: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-00018b50: 7365 6c66 2e6d 6178 696d 756d 2069 7320  self.maximum is 
-00018b60: 6e6f 7420 4e6f 6e65 2061 6e64 206c 656e  not None and len
-00018b70: 2869 7661 6c75 6529 203e 2073 656c 662e  (ivalue) > self.
-00018b80: 6d61 7869 6d75 6d3a 0a20 2020 2020 2020  maximum:.       
-00018b90: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
-00018ba0: 6174 696f 6e45 7272 6f72 280a 2020 2020  ationError(.    
-00018bb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00018bc0: 2e74 7261 6e73 6c61 746f 7228 7365 6c66  .translator(self
-00018bd0: 2e65 7272 6f72 5f6d 6573 7361 6765 206f  .error_message o
-00018be0: 7220 224d 6178 696d 756d 206c 656e 6774  r "Maximum lengt
-00018bf0: 6820 6973 2025 286d 6178 2973 2229 0a20  h is %(max)s"). 
-00018c00: 2020 2020 2020 2020 2020 2020 2020 2025                 %
-00018c10: 2064 6963 7428 6d69 6e3d 7365 6c66 2e6d   dict(min=self.m
-00018c20: 696e 696d 756d 2c20 6d61 783d 7365 6c66  inimum, max=self
-00018c30: 2e6d 6178 696d 756d 290a 2020 2020 2020  .maximum).      
-00018c40: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00018c50: 6e65 775f 7661 6c75 6520 3d20 5b5d 0a20  new_value = []. 
-00018c60: 2020 2020 2020 206f 7468 6572 203d 2073         other = s
-00018c70: 656c 662e 6f74 6865 720a 2020 2020 2020  elf.other.      
-00018c80: 2020 6966 2073 656c 662e 6f74 6865 723a    if self.other:
-00018c90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00018ca0: 6e6f 7420 6973 696e 7374 616e 6365 286f  not isinstance(o
-00018cb0: 7468 6572 2c20 286c 6973 742c 2074 7570  ther, (list, tup
-00018cc0: 6c65 2929 3a0a 2020 2020 2020 2020 2020  le)):.          
-00018cd0: 2020 2020 2020 6f74 6865 7220 3d20 5b6f        other = [o
-00018ce0: 7468 6572 5d0a 2020 2020 2020 2020 2020  ther].          
-00018cf0: 2020 666f 7220 6974 656d 2069 6e20 6976    for item in iv
-00018d00: 616c 7565 3a0a 2020 2020 2020 2020 2020  alue:.          
-00018d10: 2020 2020 2020 7620 3d20 6974 656d 0a20        v = item. 
-00018d20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00018d30: 6f72 2076 616c 6964 6174 6f72 2069 6e20  or validator in 
-00018d40: 6f74 6865 723a 0a20 2020 2020 2020 2020  other:.         
-00018d50: 2020 2020 2020 2020 2020 2076 203d 2076             v = v
-00018d60: 616c 6964 6174 6f72 5f63 616c 6c65 7228  alidator_caller(
-00018d70: 7661 6c69 6461 746f 722c 2076 2c20 7265  validator, v, re
-00018d80: 636f 7264 5f69 6429 0a20 2020 2020 2020  cord_id).       
-00018d90: 2020 2020 2020 2020 206e 6577 5f76 616c           new_val
-00018da0: 7565 2e61 7070 656e 6428 7629 0a20 2020  ue.append(v).   
-00018db0: 2020 2020 2020 2020 2069 7661 6c75 6520           ivalue 
-00018dc0: 3d20 6e65 775f 7661 6c75 650a 2020 2020  = new_value.    
-00018dd0: 2020 2020 7265 7475 726e 2069 7661 6c75      return ivalu
-00018de0: 650a 0a0a 636c 6173 7320 4953 5f4c 4f57  e...class IS_LOW
-00018df0: 4552 2856 616c 6964 6174 6f72 293a 0a20  ER(Validator):. 
-00018e00: 2020 2022 2222 0a20 2020 2043 6f6e 7665     """.    Conve
-00018e10: 7274 7320 746f 206c 6f77 6572 6361 7365  rts to lowercase
-00018e20: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00018e30: 4953 5f4c 4f57 4552 2829 2827 4142 4327  IS_LOWER()('ABC'
-00018e40: 290a 2020 2020 2020 2020 2827 6162 6327  ).        ('abc'
-00018e50: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-00018e60: 3e3e 3e20 4953 5f4c 4f57 4552 2829 2827  >>> IS_LOWER()('
-00018e70: c391 2729 0a20 2020 2020 2020 2028 275c  ..').        ('\
-00018e80: 5c78 6333 5c5c 7862 3127 2c20 4e6f 6e65  \xc3\\xb1', None
-00018e90: 290a 0a20 2020 2022 2222 0a0a 2020 2020  )..    """..    
-00018ea0: 6465 6620 7661 6c69 6461 7465 2873 656c  def validate(sel
-00018eb0: 662c 2076 616c 7565 2c20 7265 636f 7264  f, value, record
-00018ec0: 5f69 643d 4e6f 6e65 293a 0a20 2020 2020  _id=None):.     
-00018ed0: 2020 2063 6173 745f 6261 636b 203d 206c     cast_back = l
-00018ee0: 616d 6264 6120 783a 2078 0a20 2020 2020  ambda x: x.     
-00018ef0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00018f00: 2876 616c 7565 2c20 7374 7229 3a0a 2020  (value, str):.  
-00018f10: 2020 2020 2020 2020 2020 6361 7374 5f62            cast_b
-00018f20: 6163 6b20 3d20 746f 5f6e 6174 6976 650a  ack = to_native.
-00018f30: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-00018f40: 6e73 7461 6e63 6528 7661 6c75 652c 2062  nstance(value, b
-00018f50: 7974 6573 293a 0a20 2020 2020 2020 2020  ytes):.         
-00018f60: 2020 2063 6173 745f 6261 636b 203d 2074     cast_back = t
-00018f70: 6f5f 6279 7465 730a 2020 2020 2020 2020  o_bytes.        
-00018f80: 7661 6c75 6520 3d20 746f 5f75 6e69 636f  value = to_unico
-00018f90: 6465 2876 616c 7565 292e 6c6f 7765 7228  de(value).lower(
-00018fa0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00018fb0: 2063 6173 745f 6261 636b 2876 616c 7565   cast_back(value
-00018fc0: 290a 0a0a 636c 6173 7320 4953 5f55 5050  )...class IS_UPP
-00018fd0: 4552 2856 616c 6964 6174 6f72 293a 0a20  ER(Validator):. 
-00018fe0: 2020 2022 2222 0a20 2020 2043 6f6e 7665     """.    Conve
-00018ff0: 7274 7320 746f 2075 7070 6572 6361 7365  rts to uppercase
-00019000: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00019010: 4953 5f55 5050 4552 2829 2827 6162 6327  IS_UPPER()('abc'
-00019020: 290a 2020 2020 2020 2020 2827 4142 4327  ).        ('ABC'
-00019030: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-00019040: 3e3e 3e20 4953 5f55 5050 4552 2829 2827  >>> IS_UPPER()('
-00019050: c3b1 2729 0a20 2020 2020 2020 2028 275c  ..').        ('\
-00019060: 5c78 6333 5c5c 7839 3127 2c20 4e6f 6e65  \xc3\\x91', None
-00019070: 290a 0a20 2020 2022 2222 0a0a 2020 2020  )..    """..    
-00019080: 6465 6620 7661 6c69 6461 7465 2873 656c  def validate(sel
-00019090: 662c 2076 616c 7565 2c20 7265 636f 7264  f, value, record
-000190a0: 5f69 643d 4e6f 6e65 293a 0a20 2020 2020  _id=None):.     
-000190b0: 2020 2063 6173 745f 6261 636b 203d 206c     cast_back = l
-000190c0: 616d 6264 6120 783a 2078 0a20 2020 2020  ambda x: x.     
-000190d0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-000190e0: 2876 616c 7565 2c20 7374 7229 3a0a 2020  (value, str):.  
-000190f0: 2020 2020 2020 2020 2020 6361 7374 5f62            cast_b
-00019100: 6163 6b20 3d20 746f 5f6e 6174 6976 650a  ack = to_native.
-00019110: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-00019120: 6e73 7461 6e63 6528 7661 6c75 652c 2062  nstance(value, b
-00019130: 7974 6573 293a 0a20 2020 2020 2020 2020  ytes):.         
-00019140: 2020 2063 6173 745f 6261 636b 203d 2074     cast_back = t
-00019150: 6f5f 6279 7465 730a 2020 2020 2020 2020  o_bytes.        
-00019160: 7661 6c75 6520 3d20 746f 5f75 6e69 636f  value = to_unico
-00019170: 6465 2876 616c 7565 292e 7570 7065 7228  de(value).upper(
-00019180: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00019190: 2063 6173 745f 6261 636b 2876 616c 7565   cast_back(value
-000191a0: 290a 0a0a 6465 6620 7572 6c69 6679 2873  )...def urlify(s
-000191b0: 2c20 6d61 786c 656e 3d38 302c 206b 6565  , maxlen=80, kee
-000191c0: 705f 756e 6465 7273 636f 7265 733d 4661  p_underscores=Fa
-000191d0: 6c73 6529 3a0a 2020 2020 2222 220a 2020  lse):.    """.  
-000191e0: 2020 436f 6e76 6572 7473 2069 6e63 6f6d    Converts incom
-000191f0: 696e 6720 7374 7269 6e67 2074 6f20 6120  ing string to a 
-00019200: 7369 6d70 6c69 6669 6564 2041 5343 4949  simplified ASCII
-00019210: 2073 7562 7365 742e 0a20 2020 2069 6620   subset..    if 
-00019220: 286b 6565 705f 756e 6465 7273 636f 7265  (keep_underscore
-00019230: 7329 3a20 756e 6465 7273 636f 7265 7320  s): underscores 
-00019240: 6172 6520 7265 7461 696e 6564 2069 6e20  are retained in 
-00019250: 7468 6520 7374 7269 6e67 0a20 2020 2065  the string.    e
-00019260: 6c73 653a 2075 6e64 6572 7363 6f72 6573  lse: underscores
-00019270: 2061 7265 2074 7261 6e73 6c61 7465 6420   are translated 
-00019280: 746f 2068 7970 6865 6e73 2028 6465 6661  to hyphens (defa
-00019290: 756c 7429 0a20 2020 2022 2222 0a20 2020  ult).    """.   
-000192a0: 2073 203d 2074 6f5f 756e 6963 6f64 6528   s = to_unicode(
-000192b0: 7329 2020 2320 746f 2075 6e69 636f 6465  s)  # to unicode
-000192c0: 0a20 2020 2073 203d 2073 2e6c 6f77 6572  .    s = s.lower
-000192d0: 2829 2020 2320 746f 206c 6f77 6572 6361  ()  # to lowerca
-000192e0: 7365 0a20 2020 2073 203d 2075 6e69 636f  se.    s = unico
-000192f0: 6465 6461 7461 2e6e 6f72 6d61 6c69 7a65  dedata.normalize
-00019300: 2822 4e46 4b44 222c 2073 2920 2023 2072  ("NFKD", s)  # r
-00019310: 6570 6c61 6365 2073 7065 6369 616c 2063  eplace special c
-00019320: 6861 7261 6374 6572 730a 2020 2020 7320  haracters.    s 
-00019330: 3d20 746f 5f6e 6174 6976 6528 732c 2063  = to_native(s, c
-00019340: 6861 7273 6574 3d22 6173 6369 6922 2c20  harset="ascii", 
-00019350: 6572 726f 7273 3d22 6967 6e6f 7265 2229  errors="ignore")
-00019360: 2020 2320 656e 636f 6465 2061 7320 4153    # encode as AS
-00019370: 4349 490a 2020 2020 7320 3d20 7265 2e73  CII.    s = re.s
-00019380: 7562 2872 2226 5c77 2b3f 3b22 2c20 2222  ub(r"&\w+?;", ""
-00019390: 2c20 7329 2020 2320 7374 7269 7020 6874  , s)  # strip ht
-000193a0: 6d6c 2065 6e74 6974 6965 730a 2020 2020  ml entities.    
-000193b0: 6966 206b 6565 705f 756e 6465 7273 636f  if keep_undersco
-000193c0: 7265 733a 0a20 2020 2020 2020 2073 203d  res:.        s =
-000193d0: 2072 652e 7375 6228 7222 5c73 2b22 2c20   re.sub(r"\s+", 
-000193e0: 222d 222c 2073 2920 2023 2077 6869 7465  "-", s)  # white
-000193f0: 7370 6163 6520 746f 2068 7970 6865 6e73  space to hyphens
-00019400: 0a20 2020 2020 2020 2073 203d 2072 652e  .        s = re.
-00019410: 7375 6228 7222 5b5e 5c77 5c2d 5d22 2c20  sub(r"[^\w\-]", 
-00019420: 2222 2c20 7329 0a20 2020 2020 2020 2023  "", s).        #
-00019430: 2073 7472 6970 2061 6c6c 2062 7574 2061   strip all but a
-00019440: 6c70 6861 6e75 6d65 7269 632f 756e 6465  lphanumeric/unde
-00019450: 7273 636f 7265 2f68 7970 6865 6e0a 2020  rscore/hyphen.  
-00019460: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00019470: 7320 3d20 7265 2e73 7562 2872 225b 5c73  s = re.sub(r"[\s
-00019480: 5f5d 2b22 2c20 222d 222c 2073 2920 2023  _]+", "-", s)  #
-00019490: 2077 6869 7465 7370 6163 6520 2620 756e   whitespace & un
-000194a0: 6465 7273 636f 7265 7320 746f 2068 7970  derscores to hyp
-000194b0: 6865 6e73 0a20 2020 2020 2020 2073 203d  hens.        s =
-000194c0: 2072 652e 7375 6228 7222 5b5e 612d 7a30   re.sub(r"[^a-z0
-000194d0: 2d39 5c2d 5d22 2c20 2222 2c20 7329 2020  -9\-]", "", s)  
-000194e0: 2320 7374 7269 7020 616c 6c20 6275 7420  # strip all but 
-000194f0: 616c 7068 616e 756d 6572 6963 2f68 7970  alphanumeric/hyp
-00019500: 6865 6e0a 2020 2020 7320 3d20 7265 2e73  hen.    s = re.s
-00019510: 7562 2872 225b 2d5f 5d5b 2d5f 5d2b 222c  ub(r"[-_][-_]+",
-00019520: 2022 2d22 2c20 7329 2020 2320 636f 6c6c   "-", s)  # coll
-00019530: 6170 7365 2073 7472 696e 6773 206f 6620  apse strings of 
-00019540: 6879 7068 656e 730a 2020 2020 7320 3d20  hyphens.    s = 
-00019550: 732e 7374 7269 7028 222d 2229 2020 2320  s.strip("-")  # 
-00019560: 7265 6d6f 7665 206c 6561 6469 6e67 2061  remove leading a
-00019570: 6e64 2074 7261 696c 696e 6720 6879 7068  nd trailing hyph
-00019580: 656e 730a 2020 2020 7265 7475 726e 2073  ens.    return s
-00019590: 5b3a 6d61 786c 656e 5d20 2023 2065 6e66  [:maxlen]  # enf
-000195a0: 6f72 6365 206d 6178 696d 756d 206c 656e  orce maximum len
-000195b0: 6774 680a 0a0a 636c 6173 7320 4953 5f53  gth...class IS_S
-000195c0: 4c55 4728 5661 6c69 6461 746f 7229 3a0a  LUG(Validator):.
-000195d0: 2020 2020 2222 220a 2020 2020 636f 6e76      """.    conv
-000195e0: 6572 7473 2061 7262 6974 7261 7279 2074  erts arbitrary t
-000195f0: 6578 7420 7374 7269 6e67 2074 6f20 6120  ext string to a 
-00019600: 736c 7567 3a3a 0a0a 2020 2020 2020 2020  slug::..        
-00019610: 3e3e 3e20 4953 5f53 4c55 4728 2928 2761  >>> IS_SLUG()('a
-00019620: 6263 3132 3327 290a 2020 2020 2020 2020  bc123').        
-00019630: 2827 6162 6331 3233 272c 204e 6f6e 6529  ('abc123', None)
-00019640: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
-00019650: 534c 5547 2829 2827 4142 4331 3233 2729  SLUG()('ABC123')
-00019660: 0a20 2020 2020 2020 2028 2761 6263 3132  .        ('abc12
-00019670: 3327 2c20 4e6f 6e65 290a 2020 2020 2020  3', None).      
-00019680: 2020 3e3e 3e20 4953 5f53 4c55 4728 2928    >>> IS_SLUG()(
-00019690: 2761 6263 2d31 3233 2729 0a20 2020 2020  'abc-123').     
-000196a0: 2020 2028 2761 6263 2d31 3233 272c 204e     ('abc-123', N
-000196b0: 6f6e 6529 0a20 2020 2020 2020 203e 3e3e  one).        >>>
-000196c0: 2049 535f 534c 5547 2829 2827 6162 632d   IS_SLUG()('abc-
-000196d0: 2d31 3233 2729 0a20 2020 2020 2020 2028  -123').        (
-000196e0: 2761 6263 2d31 3233 272c 204e 6f6e 6529  'abc-123', None)
-000196f0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
-00019700: 534c 5547 2829 2827 6162 6320 3132 3327  SLUG()('abc 123'
-00019710: 290a 2020 2020 2020 2020 2827 6162 632d  ).        ('abc-
-00019720: 3132 3327 2c20 4e6f 6e65 290a 2020 2020  123', None).    
-00019730: 2020 2020 3e3e 3e20 4953 5f53 4c55 4728      >>> IS_SLUG(
-00019740: 2928 2761 6263 5c74 5f31 3233 2729 0a20  )('abc\t_123'). 
-00019750: 2020 2020 2020 2028 2761 6263 2d31 3233         ('abc-123
-00019760: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
-00019770: 203e 3e3e 2049 535f 534c 5547 2829 2827   >>> IS_SLUG()('
-00019780: 2d61 6263 2d27 290a 2020 2020 2020 2020  -abc-').        
-00019790: 2827 6162 6327 2c20 4e6f 6e65 290a 2020  ('abc', None).  
-000197a0: 2020 2020 2020 3e3e 3e20 4953 5f53 4c55        >>> IS_SLU
-000197b0: 4728 2928 272d 2d61 2d2d 622d 2d5f 202d  G()('--a--b--_ -
-000197c0: 632d 2d27 290a 2020 2020 2020 2020 2827  c--').        ('
-000197d0: 612d 622d 6327 2c20 4e6f 6e65 290a 2020  a-b-c', None).  
-000197e0: 2020 2020 2020 3e3e 3e20 4953 5f53 4c55        >>> IS_SLU
-000197f0: 4728 2928 2761 6263 2661 6d70 3b31 3233  G()('abc&amp;123
-00019800: 2729 0a20 2020 2020 2020 2028 2761 6263  ').        ('abc
-00019810: 3132 3327 2c20 4e6f 6e65 290a 2020 2020  123', None).    
-00019820: 2020 2020 3e3e 3e20 4953 5f53 4c55 4728      >>> IS_SLUG(
-00019830: 2928 2761 6263 2661 6d70 3b31 3233 2661  )('abc&amp;123&a
-00019840: 6d70 3b64 6566 2729 0a20 2020 2020 2020  mp;def').       
-00019850: 2028 2761 6263 3132 3364 6566 272c 204e   ('abc123def', N
-00019860: 6f6e 6529 0a20 2020 2020 2020 203e 3e3e  one).        >>>
-00019870: 2049 535f 534c 5547 2829 2827 c3b1 2729   IS_SLUG()('..')
-00019880: 0a20 2020 2020 2020 2028 276e 272c 204e  .        ('n', N
-00019890: 6f6e 6529 0a20 2020 2020 2020 203e 3e3e  one).        >>>
-000198a0: 2049 535f 534c 5547 286d 6178 6c65 6e3d   IS_SLUG(maxlen=
-000198b0: 3429 2827 6162 6331 3233 2729 0a20 2020  4)('abc123').   
-000198c0: 2020 2020 2028 2761 6263 3127 2c20 4e6f       ('abc1', No
-000198d0: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
-000198e0: 4953 5f53 4c55 4728 2928 2761 6263 5f31  IS_SLUG()('abc_1
-000198f0: 3233 2729 0a20 2020 2020 2020 2028 2761  23').        ('a
-00019900: 6263 2d31 3233 272c 204e 6f6e 6529 0a20  bc-123', None). 
-00019910: 2020 2020 2020 203e 3e3e 2049 535f 534c         >>> IS_SL
-00019920: 5547 286b 6565 705f 756e 6465 7273 636f  UG(keep_undersco
-00019930: 7265 733d 4661 6c73 6529 2827 6162 635f  res=False)('abc_
-00019940: 3132 3327 290a 2020 2020 2020 2020 2827  123').        ('
-00019950: 6162 632d 3132 3327 2c20 4e6f 6e65 290a  abc-123', None).
-00019960: 2020 2020 2020 2020 3e3e 3e20 4953 5f53          >>> IS_S
-00019970: 4c55 4728 6b65 6570 5f75 6e64 6572 7363  LUG(keep_undersc
-00019980: 6f72 6573 3d54 7275 6529 2827 6162 635f  ores=True)('abc_
-00019990: 3132 3327 290a 2020 2020 2020 2020 2827  123').        ('
-000199a0: 6162 635f 3132 3327 2c20 4e6f 6e65 290a  abc_123', None).
-000199b0: 2020 2020 2020 2020 3e3e 3e20 4953 5f53          >>> IS_S
-000199c0: 4c55 4728 6368 6563 6b3d 4661 6c73 6529  LUG(check=False)
-000199d0: 2827 6162 6327 290a 2020 2020 2020 2020  ('abc').        
-000199e0: 2827 6162 6327 2c20 4e6f 6e65 290a 2020  ('abc', None).  
-000199f0: 2020 2020 2020 3e3e 3e20 4953 5f53 4c55        >>> IS_SLU
-00019a00: 4728 6368 6563 6b3d 5472 7565 2928 2761  G(check=True)('a
-00019a10: 6263 2729 0a20 2020 2020 2020 2028 2761  bc').        ('a
-00019a20: 6263 272c 204e 6f6e 6529 0a20 2020 2020  bc', None).     
-00019a30: 2020 203e 3e3e 2049 535f 534c 5547 2863     >>> IS_SLUG(c
-00019a40: 6865 636b 3d46 616c 7365 2928 2761 2062  heck=False)('a b
-00019a50: 6327 290a 2020 2020 2020 2020 2827 612d  c').        ('a-
-00019a60: 6263 272c 204e 6f6e 6529 0a20 2020 2020  bc', None).     
-00019a70: 2020 203e 3e3e 2049 535f 534c 5547 2863     >>> IS_SLUG(c
-00019a80: 6865 636b 3d54 7275 6529 2827 6120 6263  heck=True)('a bc
-00019a90: 2729 0a20 2020 2020 2020 2028 2761 2062  ').        ('a b
-00019aa0: 6327 2c20 276d 7573 7420 6265 2073 6c75  c', 'must be slu
-00019ab0: 6727 290a 2020 2020 2222 220a 0a20 2020  g').    """..   
-00019ac0: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-00019ad0: 2020 2064 6566 2075 726c 6966 7928 7661     def urlify(va
-00019ae0: 6c75 652c 206d 6178 6c65 6e3d 3830 2c20  lue, maxlen=80, 
-00019af0: 6b65 6570 5f75 6e64 6572 7363 6f72 6573  keep_underscores
-00019b00: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-00019b10: 2072 6574 7572 6e20 7572 6c69 6679 2876   return urlify(v
-00019b20: 616c 7565 2c20 6d61 786c 656e 2c20 6b65  alue, maxlen, ke
-00019b30: 6570 5f75 6e64 6572 7363 6f72 6573 290a  ep_underscores).
-00019b40: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00019b50: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
-00019b60: 0a20 2020 2020 2020 206d 6178 6c65 6e3d  .        maxlen=
-00019b70: 3830 2c0a 2020 2020 2020 2020 6368 6563  80,.        chec
-00019b80: 6b3d 4661 6c73 652c 0a20 2020 2020 2020  k=False,.       
-00019b90: 2065 7272 6f72 5f6d 6573 7361 6765 3d22   error_message="
-00019ba0: 4d75 7374 2062 6520 736c 7567 222c 0a20  Must be slug",. 
-00019bb0: 2020 2020 2020 206b 6565 705f 756e 6465         keep_unde
-00019bc0: 7273 636f 7265 733d 4661 6c73 652c 0a20  rscores=False,. 
-00019bd0: 2020 2029 3a0a 2020 2020 2020 2020 7365     ):.        se
-00019be0: 6c66 2e6d 6178 6c65 6e20 3d20 6d61 786c  lf.maxlen = maxl
-00019bf0: 656e 0a20 2020 2020 2020 2073 656c 662e  en.        self.
-00019c00: 6368 6563 6b20 3d20 6368 6563 6b0a 2020  check = check.  
-00019c10: 2020 2020 2020 7365 6c66 2e65 7272 6f72        self.error
-00019c20: 5f6d 6573 7361 6765 203d 2065 7272 6f72  _message = error
-00019c30: 5f6d 6573 7361 6765 0a20 2020 2020 2020  _message.       
-00019c40: 2073 656c 662e 6b65 6570 5f75 6e64 6572   self.keep_under
-00019c50: 7363 6f72 6573 203d 206b 6565 705f 756e  scores = keep_un
-00019c60: 6465 7273 636f 7265 730a 0a20 2020 2064  derscores..    d
-00019c70: 6566 2076 616c 6964 6174 6528 7365 6c66  ef validate(self
-00019c80: 2c20 7661 6c75 652c 2072 6563 6f72 645f  , value, record_
-00019c90: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
-00019ca0: 2020 6966 2073 656c 662e 6368 6563 6b20    if self.check 
-00019cb0: 616e 6420 7661 6c75 6520 213d 2075 726c  and value != url
-00019cc0: 6966 7928 7661 6c75 652c 2073 656c 662e  ify(value, self.
-00019cd0: 6d61 786c 656e 2c20 7365 6c66 2e6b 6565  maxlen, self.kee
-00019ce0: 705f 756e 6465 7273 636f 7265 7329 3a0a  p_underscores):.
-00019cf0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00019d00: 6520 5661 6c69 6461 7469 6f6e 4572 726f  e ValidationErro
-00019d10: 7228 7365 6c66 2e74 7261 6e73 6c61 746f  r(self.translato
-00019d20: 7228 7365 6c66 2e65 7272 6f72 5f6d 6573  r(self.error_mes
-00019d30: 7361 6765 2929 0a20 2020 2020 2020 2072  sage)).        r
-00019d40: 6574 7572 6e20 7572 6c69 6679 2876 616c  eturn urlify(val
-00019d50: 7565 2c20 7365 6c66 2e6d 6178 6c65 6e2c  ue, self.maxlen,
-00019d60: 2073 656c 662e 6b65 6570 5f75 6e64 6572   self.keep_under
-00019d70: 7363 6f72 6573 290a 0a0a 636c 6173 7320  scores)...class 
-00019d80: 414e 595f 4f46 2856 616c 6964 6174 6f72  ANY_OF(Validator
-00019d90: 293a 0a20 2020 2022 2222 0a20 2020 2054  ):.    """.    T
-00019da0: 6573 7473 2069 6620 616e 7920 6f66 2074  ests if any of t
-00019db0: 6865 2076 616c 6964 6174 6f72 7320 696e  he validators in
-00019dc0: 2061 206c 6973 7420 7265 7475 726e 7320   a list returns 
-00019dd0: 7375 6363 6573 7366 756c 6c79 3a3a 0a0a  successfully::..
-00019de0: 2020 2020 2020 2020 3e3e 3e20 414e 595f          >>> ANY_
-00019df0: 4f46 285b 4953 5f45 4d41 494c 2829 2c49  OF([IS_EMAIL(),I
-00019e00: 535f 414c 5048 414e 554d 4552 4943 2829  S_ALPHANUMERIC()
-00019e10: 5d29 2827 6140 622e 636f 2729 0a20 2020  ])('a@b.co').   
-00019e20: 2020 2020 2028 2761 4062 2e63 6f27 2c20       ('a@b.co', 
-00019e30: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
-00019e40: 3e20 414e 595f 4f46 285b 4953 5f45 4d41  > ANY_OF([IS_EMA
-00019e50: 494c 2829 2c49 535f 414c 5048 414e 554d  IL(),IS_ALPHANUM
-00019e60: 4552 4943 2829 5d29 2827 6162 636f 2729  ERIC()])('abco')
-00019e70: 0a20 2020 2020 2020 2028 2761 6263 6f27  .        ('abco'
-00019e80: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-00019e90: 3e3e 3e20 414e 595f 4f46 285b 4953 5f45  >>> ANY_OF([IS_E
-00019ea0: 4d41 494c 2829 2c49 535f 414c 5048 414e  MAIL(),IS_ALPHAN
-00019eb0: 554d 4552 4943 2829 5d29 2827 4061 622e  UMERIC()])('@ab.
-00019ec0: 636f 2729 0a20 2020 2020 2020 2028 2740  co').        ('@
-00019ed0: 6162 2e63 6f27 2c20 2765 6e74 6572 206f  ab.co', 'enter o
-00019ee0: 6e6c 7920 6c65 7474 6572 732c 206e 756d  nly letters, num
-00019ef0: 6265 7273 2c20 616e 6420 756e 6465 7273  bers, and unders
-00019f00: 636f 7265 2729 0a20 2020 2020 2020 203e  core').        >
-00019f10: 3e3e 2041 4e59 5f4f 4628 5b49 535f 414c  >> ANY_OF([IS_AL
-00019f20: 5048 414e 554d 4552 4943 2829 2c49 535f  PHANUMERIC(),IS_
-00019f30: 454d 4149 4c28 295d 2928 2740 6162 2e63  EMAIL()])('@ab.c
-00019f40: 6f27 290a 2020 2020 2020 2020 2827 4061  o').        ('@a
-00019f50: 622e 636f 272c 2027 656e 7465 7220 6120  b.co', 'enter a 
-00019f60: 7661 6c69 6420 656d 6169 6c20 6164 6472  valid email addr
-00019f70: 6573 7327 290a 0a20 2020 2022 2222 0a0a  ess')..    """..
-00019f80: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00019f90: 2873 656c 662c 2073 7562 732c 2065 7272  (self, subs, err
-00019fa0: 6f72 5f6d 6573 7361 6765 3d4e 6f6e 6529  or_message=None)
-00019fb0: 3a0a 2020 2020 2020 2020 7365 6c66 2e73  :.        self.s
-00019fc0: 7562 7320 3d20 7375 6273 0a20 2020 2020  ubs = subs.     
-00019fd0: 2020 2073 656c 662e 6572 726f 725f 6d65     self.error_me
-00019fe0: 7373 6167 6520 3d20 6572 726f 725f 6d65  ssage = error_me
-00019ff0: 7373 6167 650a 0a20 2020 2064 6566 2076  ssage..    def v
-0001a000: 616c 6964 6174 6528 7365 6c66 2c20 7661  alidate(self, va
-0001a010: 6c75 652c 2072 6563 6f72 645f 6964 3d4e  lue, record_id=N
-0001a020: 6f6e 6529 3a0a 2020 2020 2020 2020 666f  one):.        fo
-0001a030: 7220 7661 6c69 6461 746f 7220 696e 2073  r validator in s
-0001a040: 656c 662e 7375 6273 3a0a 2020 2020 2020  elf.subs:.      
-0001a050: 2020 2020 2020 762c 2065 203d 2076 616c        v, e = val
-0001a060: 6964 6174 6f72 2876 616c 7565 290a 2020  idator(value).  
-0001a070: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0001a080: 2065 3a0a 2020 2020 2020 2020 2020 2020   e:.            
-0001a090: 2020 2020 7265 7475 726e 2076 0a20 2020      return v.   
-0001a0a0: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
-0001a0b0: 6174 696f 6e45 7272 6f72 2865 290a 0a20  ationError(e).. 
-0001a0c0: 2020 2064 6566 2066 6f72 6d61 7474 6572     def formatter
-0001a0d0: 2873 656c 662c 2076 616c 7565 293a 0a20  (self, value):. 
-0001a0e0: 2020 2020 2020 2023 2055 7365 2074 6865         # Use the
-0001a0f0: 2066 6f72 6d61 7474 6572 206f 6620 7468   formatter of th
-0001a100: 6520 6669 7273 7420 7375 6276 616c 6964  e first subvalid
-0001a110: 6174 6f72 0a20 2020 2020 2020 2023 2074  ator.        # t
-0001a120: 6861 7420 7661 6c69 6461 7465 7320 7468  hat validates th
-0001a130: 6520 7661 6c75 6520 616e 6420 6861 7320  e value and has 
-0001a140: 6120 666f 726d 6174 7465 720a 2020 2020  a formatter.    
-0001a150: 2020 2020 666f 7220 7661 6c69 6461 746f      for validato
-0001a160: 7220 696e 2073 656c 662e 7375 6273 3a0a  r in self.subs:.
-0001a170: 2020 2020 2020 2020 2020 2020 6966 2068              if h
-0001a180: 6173 6174 7472 2876 616c 6964 6174 6f72  asattr(validator
-0001a190: 2c20 2266 6f72 6d61 7474 6572 2229 2061  , "formatter") a
-0001a1a0: 6e64 2076 616c 6964 6174 6f72 2876 616c  nd validator(val
-0001a1b0: 7565 295b 315d 2069 7320 4e6f 6e65 3a0a  ue)[1] is None:.
-0001a1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a1d0: 7265 7475 726e 2076 616c 6964 6174 6f72  return validator
-0001a1e0: 2e66 6f72 6d61 7474 6572 2876 616c 7565  .formatter(value
-0001a1f0: 290a 0a0a 636c 6173 7320 4953 5f45 4d50  )...class IS_EMP
-0001a200: 5459 5f4f 5228 5661 6c69 6461 746f 7229  TY_OR(Validator)
-0001a210: 3a0a 2020 2020 2222 220a 2020 2020 4475  :.    """.    Du
-0001a220: 6d6d 7920 636c 6173 7320 666f 7220 7465  mmy class for te
-0001a230: 7374 696e 6720 4953 5f45 4d50 5459 5f4f  sting IS_EMPTY_O
-0001a240: 523a 3a0a 0a20 2020 2020 2020 203e 3e3e  R::..        >>>
-0001a250: 2049 535f 454d 5054 595f 4f52 2849 535f   IS_EMPTY_OR(IS_
-0001a260: 454d 4149 4c28 2929 2827 6162 6340 6465  EMAIL())('abc@de
-0001a270: 662e 636f 6d27 290a 2020 2020 2020 2020  f.com').        
-0001a280: 2827 6162 6340 6465 662e 636f 6d27 2c20  ('abc@def.com', 
-0001a290: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
-0001a2a0: 3e20 4953 5f45 4d50 5459 5f4f 5228 4953  > IS_EMPTY_OR(IS
-0001a2b0: 5f45 4d41 494c 2829 2928 2720 2020 2729  _EMAIL())('   ')
-0001a2c0: 0a20 2020 2020 2020 2028 4e6f 6e65 2c20  .        (None, 
-0001a2d0: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
-0001a2e0: 3e20 4953 5f45 4d50 5459 5f4f 5228 4953  > IS_EMPTY_OR(IS
-0001a2f0: 5f45 4d41 494c 2829 2c20 6e75 6c6c 3d27  _EMAIL(), null='
-0001a300: 6162 6327 2928 2720 2020 2729 0a20 2020  abc')('   ').   
-0001a310: 2020 2020 2028 2761 6263 272c 204e 6f6e       ('abc', Non
-0001a320: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
-0001a330: 535f 454d 5054 595f 4f52 2849 535f 454d  S_EMPTY_OR(IS_EM
-0001a340: 4149 4c28 292c 206e 756c 6c3d 2761 6263  AIL(), null='abc
-0001a350: 272c 2065 6d70 7479 5f72 6567 6578 3d27  ', empty_regex='
-0001a360: 6465 6627 2928 2764 6566 2729 0a20 2020  def')('def').   
-0001a370: 2020 2020 2028 2761 6263 272c 204e 6f6e       ('abc', Non
-0001a380: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
-0001a390: 535f 454d 5054 595f 4f52 2849 535f 454d  S_EMPTY_OR(IS_EM
-0001a3a0: 4149 4c28 2929 2827 6162 6327 290a 2020  AIL())('abc').  
-0001a3b0: 2020 2020 2020 2827 6162 6327 2c20 2765        ('abc', 'e
-0001a3c0: 6e74 6572 2061 2076 616c 6964 2065 6d61  nter a valid ema
-0001a3d0: 696c 2061 6464 7265 7373 2729 0a20 2020  il address').   
-0001a3e0: 2020 2020 203e 3e3e 2049 535f 454d 5054       >>> IS_EMPT
-0001a3f0: 595f 4f52 2849 535f 454d 4149 4c28 2929  Y_OR(IS_EMAIL())
-0001a400: 2827 2061 6263 2027 290a 2020 2020 2020  (' abc ').      
-0001a410: 2020 2827 6162 6327 2c20 2765 6e74 6572    ('abc', 'enter
-0001a420: 2061 2076 616c 6964 2065 6d61 696c 2061   a valid email a
-0001a430: 6464 7265 7373 2729 0a20 2020 2022 2222  ddress').    """
-0001a440: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-0001a450: 5f5f 2873 656c 662c 206f 7468 6572 2c20  __(self, other, 
-0001a460: 6e75 6c6c 3d4e 6f6e 652c 2065 6d70 7479  null=None, empty
-0001a470: 5f72 6567 6578 3d4e 6f6e 6529 3a0a 2020  _regex=None):.  
-0001a480: 2020 2020 2020 2873 656c 662e 6f74 6865        (self.othe
-0001a490: 722c 2073 656c 662e 6e75 6c6c 2920 3d20  r, self.null) = 
-0001a4a0: 286f 7468 6572 2c20 6e75 6c6c 290a 2020  (other, null).  
-0001a4b0: 2020 2020 2020 6966 2065 6d70 7479 5f72        if empty_r
-0001a4c0: 6567 6578 2069 7320 6e6f 7420 4e6f 6e65  egex is not None
-0001a4d0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0001a4e0: 6c66 2e65 6d70 7479 5f72 6567 6578 203d  lf.empty_regex =
-0001a4f0: 2072 652e 636f 6d70 696c 6528 656d 7074   re.compile(empt
-0001a500: 795f 7265 6765 7829 0a20 2020 2020 2020  y_regex).       
-0001a510: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001a520: 2020 2073 656c 662e 656d 7074 795f 7265     self.empty_re
-0001a530: 6765 7820 3d20 4e6f 6e65 0a20 2020 2020  gex = None.     
-0001a540: 2020 2069 6620 6861 7361 7474 7228 6f74     if hasattr(ot
-0001a550: 6865 722c 2022 6d75 6c74 6970 6c65 2229  her, "multiple")
-0001a560: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0001a570: 6c66 2e6d 756c 7469 706c 6520 3d20 6f74  lf.multiple = ot
-0001a580: 6865 722e 6d75 6c74 6970 6c65 0a20 2020  her.multiple.   
-0001a590: 2020 2020 2069 6620 6861 7361 7474 7228       if hasattr(
-0001a5a0: 6f74 6865 722c 2022 6f70 7469 6f6e 7322  other, "options"
-0001a5b0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-0001a5c0: 656c 662e 6f70 7469 6f6e 7320 3d20 7365  elf.options = se
-0001a5d0: 6c66 2e5f 6f70 7469 6f6e 730a 0a20 2020  lf._options..   
-0001a5e0: 2064 6566 205f 6f70 7469 6f6e 7328 7365   def _options(se
-0001a5f0: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
-0001a600: 7267 7329 3a0a 2020 2020 2020 2020 6f70  rgs):.        op
-0001a610: 7469 6f6e 7320 3d20 7365 6c66 2e6f 7468  tions = self.oth
-0001a620: 6572 2e6f 7074 696f 6e73 282a 6172 6773  er.options(*args
-0001a630: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
-0001a640: 2020 2020 6966 2028 6e6f 7420 6f70 7469      if (not opti
-0001a650: 6f6e 7320 6f72 206f 7074 696f 6e73 5b30  ons or options[0
-0001a660: 5d5b 305d 2021 3d20 2222 2920 616e 6420  ][0] != "") and 
-0001a670: 6e6f 7420 7365 6c66 2e6d 756c 7469 706c  not self.multipl
-0001a680: 653a 0a20 2020 2020 2020 2020 2020 206f  e:.            o
-0001a690: 7074 696f 6e73 2e69 6e73 6572 7428 302c  ptions.insert(0,
-0001a6a0: 2028 2222 2c20 2222 2929 0a20 2020 2020   ("", "")).     
-0001a6b0: 2020 2072 6574 7572 6e20 6f70 7469 6f6e     return option
-0001a6c0: 730a 0a20 2020 2064 6566 2073 6574 5f73  s..    def set_s
-0001a6d0: 656c 665f 6964 2873 656c 662c 2069 6429  elf_id(self, id)
-0001a6e0: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
-0001a6f0: 6e73 7461 6e63 6528 7365 6c66 2e6f 7468  nstance(self.oth
-0001a700: 6572 2c20 286c 6973 742c 2074 7570 6c65  er, (list, tuple
-0001a710: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-0001a720: 666f 7220 6974 656d 2069 6e20 7365 6c66  for item in self
-0001a730: 2e6f 7468 6572 3a0a 2020 2020 2020 2020  .other:.        
-0001a740: 2020 2020 2020 2020 6966 2068 6173 6174          if hasat
-0001a750: 7472 2869 7465 6d2c 2022 7365 745f 7365  tr(item, "set_se
-0001a760: 6c66 5f69 6422 293a 0a20 2020 2020 2020  lf_id"):.       
-0001a770: 2020 2020 2020 2020 2020 2020 2069 7465               ite
-0001a780: 6d2e 7365 745f 7365 6c66 5f69 6428 6964  m.set_self_id(id
-0001a790: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0001a7a0: 2020 2020 2020 2020 2020 2020 6966 2068              if h
-0001a7b0: 6173 6174 7472 2873 656c 662e 6f74 6865  asattr(self.othe
-0001a7c0: 722c 2022 7365 745f 7365 6c66 5f69 6422  r, "set_self_id"
-0001a7d0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001a7e0: 2020 2073 656c 662e 6f74 6865 722e 7365     self.other.se
-0001a7f0: 745f 7365 6c66 5f69 6428 6964 290a 0a20  t_self_id(id).. 
-0001a800: 2020 2064 6566 2076 616c 6964 6174 6528     def validate(
-0001a810: 7365 6c66 2c20 7661 6c75 652c 2072 6563  self, value, rec
-0001a820: 6f72 645f 6964 3d4e 6f6e 6529 3a0a 2020  ord_id=None):.  
-0001a830: 2020 2020 2020 7661 6c75 652c 2065 6d70        value, emp
-0001a840: 7479 203d 2069 735f 656d 7074 7928 7661  ty = is_empty(va
-0001a850: 6c75 652c 2065 6d70 7479 5f72 6567 6578  lue, empty_regex
-0001a860: 3d73 656c 662e 656d 7074 795f 7265 6765  =self.empty_rege
-0001a870: 7829 0a20 2020 2020 2020 2069 6620 656d  x).        if em
-0001a880: 7074 793a 0a20 2020 2020 2020 2020 2020  pty:.           
-0001a890: 2072 6574 7572 6e20 7365 6c66 2e6e 756c   return self.nul
-0001a8a0: 6c0a 2020 2020 2020 2020 6966 2069 7369  l.        if isi
-0001a8b0: 6e73 7461 6e63 6528 7365 6c66 2e6f 7468  nstance(self.oth
-0001a8c0: 6572 2c20 286c 6973 742c 2074 7570 6c65  er, (list, tuple
-0001a8d0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-0001a8e0: 666f 7220 6974 656d 2069 6e20 7365 6c66  for item in self
-0001a8f0: 2e6f 7468 6572 3a0a 2020 2020 2020 2020  .other:.        
-0001a900: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
-0001a910: 7661 6c69 6461 746f 725f 6361 6c6c 6572  validator_caller
-0001a920: 2869 7465 6d2c 2076 616c 7565 2c20 7265  (item, value, re
-0001a930: 636f 7264 5f69 6429 0a20 2020 2020 2020  cord_id).       
-0001a940: 2020 2020 2072 6574 7572 6e20 7661 6c75       return valu
-0001a950: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
-0001a960: 2076 616c 6964 6174 6f72 5f63 616c 6c65   validator_calle
-0001a970: 7228 7365 6c66 2e6f 7468 6572 2c20 7661  r(self.other, va
-0001a980: 6c75 652c 2072 6563 6f72 645f 6964 290a  lue, record_id).
-0001a990: 0a20 2020 2064 6566 2066 6f72 6d61 7474  .    def formatt
-0001a9a0: 6572 2873 656c 662c 2076 616c 7565 293a  er(self, value):
-0001a9b0: 0a20 2020 2020 2020 2069 6620 6861 7361  .        if hasa
-0001a9c0: 7474 7228 7365 6c66 2e6f 7468 6572 2c20  ttr(self.other, 
-0001a9d0: 2266 6f72 6d61 7474 6572 2229 3a0a 2020  "formatter"):.  
-0001a9e0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001a9f0: 2073 656c 662e 6f74 6865 722e 666f 726d   self.other.form
-0001aa00: 6174 7465 7228 7661 6c75 6529 0a20 2020  atter(value).   
-0001aa10: 2020 2020 2072 6574 7572 6e20 7661 6c75       return valu
-0001aa20: 650a 0a0a 4953 5f4e 554c 4c5f 4f52 203d  e...IS_NULL_OR =
-0001aa30: 2049 535f 454d 5054 595f 4f52 2020 2320   IS_EMPTY_OR  # 
-0001aa40: 666f 7220 6261 636b 7761 7264 2063 6f6d  for backward com
-0001aa50: 7061 7469 6269 6c69 7479 0a0a 0a63 6c61  patibility...cla
-0001aa60: 7373 2043 4c45 414e 5550 2856 616c 6964  ss CLEANUP(Valid
-0001aa70: 6174 6f72 293a 0a20 2020 2022 2222 0a20  ator):.    """. 
-0001aa80: 2020 2045 7861 6d70 6c65 733a 0a20 2020     Examples:.   
-0001aa90: 2020 2020 2055 7365 2061 733a 3a0a 0a20       Use as::.. 
-0001aaa0: 2020 2020 2020 2020 2020 2049 4e50 5554             INPUT
-0001aab0: 285f 7479 7065 3d27 7465 7874 272c 205f  (_type='text', _
-0001aac0: 6e61 6d65 3d27 6e61 6d65 272c 2072 6571  name='name', req
-0001aad0: 7569 7265 733d 434c 4541 4e55 5028 2929  uires=CLEANUP())
-0001aae0: 0a0a 2020 2020 7265 6d6f 7665 7320 7370  ..    removes sp
-0001aaf0: 6563 6961 6c20 6368 6172 6163 7465 7273  ecial characters
-0001ab00: 206f 6e20 7661 6c69 6461 7469 6f6e 0a20   on validation. 
-0001ab10: 2020 2022 2222 0a0a 2020 2020 5245 4745     """..    REGE
-0001ab20: 585f 434c 4541 4e55 5020 3d20 225b 5e5c  X_CLEANUP = "[^\
-0001ab30: 7830 395c 7830 615c 7830 645c 7832 302d  x09\x0a\x0d\x20-
-0001ab40: 5c78 3765 5d22 0a0a 2020 2020 6465 6620  \x7e]"..    def 
-0001ab50: 5f5f 696e 6974 5f5f 2873 656c 662c 2072  __init__(self, r
-0001ab60: 6567 6578 3d4e 6f6e 6529 3a0a 2020 2020  egex=None):.    
-0001ab70: 2020 2020 7365 6c66 2e72 6567 6578 203d      self.regex =
-0001ab80: 2028 0a20 2020 2020 2020 2020 2020 2072   (.            r
-0001ab90: 652e 636f 6d70 696c 6528 7365 6c66 2e52  e.compile(self.R
-0001aba0: 4547 4558 5f43 4c45 414e 5550 2920 6966  EGEX_CLEANUP) if
-0001abb0: 2072 6567 6578 2069 7320 4e6f 6e65 2065   regex is None e
-0001abc0: 6c73 6520 7265 2e63 6f6d 7069 6c65 2872  lse re.compile(r
-0001abd0: 6567 6578 290a 2020 2020 2020 2020 290a  egex).        ).
-0001abe0: 0a20 2020 2064 6566 2076 616c 6964 6174  .    def validat
-0001abf0: 6528 7365 6c66 2c20 7661 6c75 652c 2072  e(self, value, r
-0001ac00: 6563 6f72 645f 6964 3d4e 6f6e 6529 3a0a  ecord_id=None):.
-0001ac10: 2020 2020 2020 2020 7620 3d20 7365 6c66          v = self
-0001ac20: 2e72 6567 6578 2e73 7562 2822 222c 2073  .regex.sub("", s
-0001ac30: 7472 2876 616c 7565 292e 7374 7269 7028  tr(value).strip(
-0001ac40: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
-0001ac50: 6e20 760a 0a0a 6465 6620 7062 6b64 6632  n v...def pbkdf2
-0001ac60: 5f68 6578 2864 6174 612c 2073 616c 742c  _hex(data, salt,
-0001ac70: 2069 7465 7261 7469 6f6e 733d 3130 3030   iterations=1000
-0001ac80: 2c20 6b65 796c 656e 3d32 342c 2068 6173  , keylen=24, has
-0001ac90: 6866 756e 633d 4e6f 6e65 293a 0a20 2020  hfunc=None):.   
-0001aca0: 2068 6173 6866 756e 6320 3d20 6861 7368   hashfunc = hash
-0001acb0: 6675 6e63 206f 7220 6861 7368 6c69 622e  func or hashlib.
-0001acc0: 7368 6131 0a20 2020 2068 6d61 6320 3d20  sha1.    hmac = 
-0001acd0: 6861 7368 6c69 622e 7062 6b64 6632 5f68  hashlib.pbkdf2_h
-0001ace0: 6d61 6328 0a20 2020 2020 2020 2068 6173  mac(.        has
-0001acf0: 6866 756e 6328 292e 6e61 6d65 2c20 746f  hfunc().name, to
-0001ad00: 5f62 7974 6573 2864 6174 6129 2c20 746f  _bytes(data), to
-0001ad10: 5f62 7974 6573 2873 616c 7429 2c20 6974  _bytes(salt), it
-0001ad20: 6572 6174 696f 6e73 2c20 6b65 796c 656e  erations, keylen
-0001ad30: 0a20 2020 2029 0a20 2020 2072 6574 7572  .    ).    retur
-0001ad40: 6e20 6269 6e61 7363 6969 2e68 6578 6c69  n binascii.hexli
-0001ad50: 6679 2868 6d61 6329 0a0a 0a64 6566 2073  fy(hmac)...def s
-0001ad60: 696d 706c 655f 6861 7368 2874 6578 742c  imple_hash(text,
-0001ad70: 206b 6579 3d22 222c 2073 616c 743d 2222   key="", salt=""
-0001ad80: 2c20 6469 6765 7374 5f61 6c67 3d22 6d64  , digest_alg="md
-0001ad90: 3522 293a 0a20 2020 2022 2222 4765 6e65  5"):.    """Gene
-0001ada0: 7261 7465 2068 6173 6820 7769 7468 2074  rate hash with t
-0001adb0: 6865 2067 6976 656e 2074 6578 7420 7573  he given text us
-0001adc0: 696e 6720 7468 6520 7370 6563 6966 6965  ing the specifie
-0001add0: 6420 6469 6765 7374 2061 6c67 6f72 6974  d digest algorit
-0001ade0: 686d 2e22 2222 0a20 2020 2074 6578 7420  hm.""".    text 
-0001adf0: 3d20 746f 5f62 7974 6573 2874 6578 7429  = to_bytes(text)
-0001ae00: 0a20 2020 206b 6579 203d 2074 6f5f 6279  .    key = to_by
-0001ae10: 7465 7328 6b65 7929 0a20 2020 2073 616c  tes(key).    sal
-0001ae20: 7420 3d20 746f 5f62 7974 6573 2873 616c  t = to_bytes(sal
-0001ae30: 7429 0a20 2020 2069 6620 6e6f 7420 6469  t).    if not di
-0001ae40: 6765 7374 5f61 6c67 3a0a 2020 2020 2020  gest_alg:.      
-0001ae50: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
-0001ae60: 7272 6f72 2822 7369 6d70 6c65 5f68 6173  rror("simple_has
-0001ae70: 6820 7769 7468 2064 6967 6573 745f 616c  h with digest_al
-0001ae80: 673d 4e6f 6e65 2229 0a20 2020 2065 6c69  g=None").    eli
-0001ae90: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-0001aea0: 2864 6967 6573 745f 616c 672c 2073 7472  (digest_alg, str
-0001aeb0: 293a 2020 2320 6d61 6e75 616c 2061 7070  ):  # manual app
-0001aec0: 726f 6163 680a 2020 2020 2020 2020 6820  roach.        h 
-0001aed0: 3d20 6469 6765 7374 5f61 6c67 2874 6578  = digest_alg(tex
-0001aee0: 7420 2b20 6b65 7920 2b20 7361 6c74 290a  t + key + salt).
-0001aef0: 2020 2020 656c 6966 2064 6967 6573 745f      elif digest_
-0001af00: 616c 672e 7374 6172 7473 7769 7468 2822  alg.startswith("
-0001af10: 7062 6b64 6632 2229 3a20 2023 206c 6174  pbkdf2"):  # lat
-0001af20: 6573 7420 616e 6420 636f 6f6c 6573 7421  est and coolest!
-0001af30: 0a20 2020 2020 2020 2069 7465 7261 7469  .        iterati
-0001af40: 6f6e 732c 206b 6579 6c65 6e2c 2061 6c67  ons, keylen, alg
-0001af50: 203d 2064 6967 6573 745f 616c 675b 373a   = digest_alg[7:
-0001af60: 2d31 5d2e 7370 6c69 7428 222c 2229 0a20  -1].split(","). 
-0001af70: 2020 2020 2020 2072 6574 7572 6e20 746f         return to
-0001af80: 5f6e 6174 6976 6528 0a20 2020 2020 2020  _native(.       
-0001af90: 2020 2020 2070 626b 6466 325f 6865 7828       pbkdf2_hex(
-0001afa0: 7465 7874 2c20 7361 6c74 2c20 696e 7428  text, salt, int(
-0001afb0: 6974 6572 6174 696f 6e73 292c 2069 6e74  iterations), int
-0001afc0: 286b 6579 6c65 6e29 2c20 6765 745f 6469  (keylen), get_di
-0001afd0: 6765 7374 2861 6c67 2929 0a20 2020 2020  gest(alg)).     
-0001afe0: 2020 2029 0a20 2020 2065 6c69 6620 6b65     ).    elif ke
-0001aff0: 793a 2020 2320 7573 6520 686d 6163 0a20  y:  # use hmac. 
-0001b000: 2020 2020 2020 2064 6967 6573 745f 616c         digest_al
-0001b010: 6720 3d20 6765 745f 6469 6765 7374 2864  g = get_digest(d
-0001b020: 6967 6573 745f 616c 6729 0a20 2020 2020  igest_alg).     
-0001b030: 2020 2068 203d 2068 6d61 632e 6e65 7728     h = hmac.new(
-0001b040: 6b65 7920 2b20 7361 6c74 2c20 7465 7874  key + salt, text
-0001b050: 2c20 6469 6765 7374 5f61 6c67 290a 2020  , digest_alg).  
-0001b060: 2020 656c 7365 3a20 2023 2063 6f6d 7061    else:  # compa
-0001b070: 7469 626c 6520 7769 7468 2074 6869 7264  tible with third
-0001b080: 2070 6172 7479 2073 7973 7465 6d73 0a20   party systems. 
-0001b090: 2020 2020 2020 2068 203d 2067 6574 5f64         h = get_d
-0001b0a0: 6967 6573 7428 6469 6765 7374 5f61 6c67  igest(digest_alg
-0001b0b0: 2928 290a 2020 2020 2020 2020 682e 7570  )().        h.up
-0001b0c0: 6461 7465 2874 6578 7420 2b20 7361 6c74  date(text + salt
-0001b0d0: 290a 2020 2020 7265 7475 726e 2068 2e68  ).    return h.h
-0001b0e0: 6578 6469 6765 7374 2829 0a0a 0a64 6566  exdigest()...def
-0001b0f0: 2067 6574 5f64 6967 6573 7428 7661 6c75   get_digest(valu
-0001b100: 6529 3a0a 2020 2020 2222 2252 6574 7572  e):.    """Retur
-0001b110: 6e20 6120 6861 7368 6c69 6220 6469 6765  n a hashlib dige
-0001b120: 7374 2061 6c67 6f72 6974 686d 2066 726f  st algorithm fro
-0001b130: 6d20 6120 7374 7269 6e67 2e22 2222 0a20  m a string.""". 
-0001b140: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0001b150: 2876 616c 7565 2c20 7374 7229 3a0a 2020  (value, str):.  
-0001b160: 2020 2020 2020 7661 6c75 6520 3d20 7661        value = va
-0001b170: 6c75 652e 6c6f 7765 7228 290a 2020 2020  lue.lower().    
-0001b180: 2020 2020 6966 2076 616c 7565 206e 6f74      if value not
-0001b190: 2069 6e20 2822 6d64 3522 2c20 2273 6861   in ("md5", "sha
-0001b1a0: 3122 2c20 2273 6861 3232 3422 2c20 2273  1", "sha224", "s
-0001b1b0: 6861 3235 3622 2c20 2273 6861 3338 3422  ha256", "sha384"
-0001b1c0: 2c20 2273 6861 3531 3222 293a 0a20 2020  , "sha512"):.   
-0001b1d0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0001b1e0: 616c 7565 4572 726f 7228 2249 6e76 616c  alueError("Inval
-0001b1f0: 6964 2064 6967 6573 7420 616c 676f 7269  id digest algori
-0001b200: 7468 6d3a 2025 7322 2025 2076 616c 7565  thm: %s" % value
-0001b210: 290a 2020 2020 2020 2020 7661 6c75 6520  ).        value 
-0001b220: 3d20 6765 7461 7474 7228 6861 7368 6c69  = getattr(hashli
-0001b230: 622c 2076 616c 7565 290a 2020 2020 7265  b, value).    re
-0001b240: 7475 726e 2076 616c 7565 0a0a 0a44 4947  turn value...DIG
-0001b250: 4553 545f 414c 475f 4259 5f53 495a 4520  EST_ALG_BY_SIZE 
-0001b260: 3d20 7b0a 2020 2020 3132 3820 2f2f 2034  = {.    128 // 4
-0001b270: 3a20 226d 6435 222c 0a20 2020 2031 3630  : "md5",.    160
-0001b280: 202f 2f20 343a 2022 7368 6131 222c 0a20   // 4: "sha1",. 
-0001b290: 2020 2032 3234 202f 2f20 343a 2022 7368     224 // 4: "sh
-0001b2a0: 6132 3234 222c 0a20 2020 2032 3536 202f  a224",.    256 /
-0001b2b0: 2f20 343a 2022 7368 6132 3536 222c 0a20  / 4: "sha256",. 
-0001b2c0: 2020 2033 3834 202f 2f20 343a 2022 7368     384 // 4: "sh
-0001b2d0: 6133 3834 222c 0a20 2020 2035 3132 202f  a384",.    512 /
-0001b2e0: 2f20 343a 2022 7368 6135 3132 222c 0a7d  / 4: "sha512",.}
-0001b2f0: 0a0a 0a63 6c61 7373 204c 617a 7943 7279  ...class LazyCry
-0001b300: 7074 286f 626a 6563 7429 3a0a 2020 2020  pt(object):.    
-0001b310: 2222 220a 2020 2020 5374 6f72 6573 2061  """.    Stores a
-0001b320: 206c 617a 7920 7061 7373 776f 7264 2068   lazy password h
-0001b330: 6173 680a 2020 2020 2222 220a 0a20 2020  ash.    """..   
-0001b340: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0001b350: 6c66 2c20 6372 7970 742c 2070 6173 7377  lf, crypt, passw
-0001b360: 6f72 6429 3a0a 2020 2020 2020 2020 2222  ord):.        ""
-0001b370: 220a 2020 2020 2020 2020 6372 7970 7420  ".        crypt 
-0001b380: 6973 2061 6e20 696e 7374 616e 6365 206f  is an instance o
-0001b390: 6620 7468 6520 4352 5950 5420 7661 6c69  f the CRYPT vali
-0001b3a0: 6461 746f 722c 0a20 2020 2020 2020 2070  dator,.        p
-0001b3b0: 6173 7377 6f72 6420 6973 2074 6865 2070  assword is the p
-0001b3c0: 6173 7377 6f72 6420 6173 2069 6e73 6572  assword as inser
-0001b3d0: 7465 6420 6279 2074 6865 2075 7365 720a  ted by the user.
-0001b3e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001b3f0: 2020 2020 7365 6c66 2e63 7279 7074 203d      self.crypt =
-0001b400: 2063 7279 7074 0a20 2020 2020 2020 2073   crypt.        s
-0001b410: 656c 662e 7061 7373 776f 7264 203d 2070  elf.password = p
-0001b420: 6173 7377 6f72 640a 2020 2020 2020 2020  assword.        
-0001b430: 7365 6c66 2e63 7279 7074 6564 203d 204e  self.crypted = N
-0001b440: 6f6e 650a 0a20 2020 2064 6566 205f 5f73  one..    def __s
-0001b450: 7472 5f5f 2873 656c 6629 3a0a 2020 2020  tr__(self):.    
-0001b460: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001b470: 456e 6372 7970 7465 6420 7365 6c66 2e70  Encrypted self.p
-0001b480: 6173 7377 6f72 6420 616e 6420 6361 6368  assword and cach
-0001b490: 6573 2069 7420 696e 2073 656c 662e 6372  es it in self.cr
-0001b4a0: 7970 7465 642e 0a20 2020 2020 2020 2049  ypted..        I
-0001b4b0: 6620 7365 6c66 2e63 7279 7074 2e73 616c  f self.crypt.sal
-0001b4c0: 7420 7468 6520 6f75 7470 7574 2069 7320  t the output is 
-0001b4d0: 696e 2074 6865 2066 6f72 6d61 7420 3c61  in the format <a
-0001b4e0: 6c67 6f72 6974 686d 3e24 3c73 616c 743e  lgorithm>$<salt>
-0001b4f0: 243c 6861 7368 3e0a 0a20 2020 2020 2020  $<hash>..       
-0001b500: 2054 7279 2067 6574 2074 6865 2064 6967   Try get the dig
-0001b510: 6573 745f 616c 6720 6672 6f6d 2074 6865  est_alg from the
-0001b520: 206b 6579 2028 6966 2069 7420 6578 6973   key (if it exis
-0001b530: 7473 290a 2020 2020 2020 2020 656c 7365  ts).        else
-0001b540: 2061 7373 756d 6520 7468 6520 6465 6661   assume the defa
-0001b550: 756c 7420 6469 6765 7374 5f61 6c67 2e20  ult digest_alg. 
-0001b560: 4966 206e 6f74 206b 6579 2061 7420 616c  If not key at al
-0001b570: 6c2c 2073 6574 206b 6579 3d27 270a 0a20  l, set key=''.. 
-0001b580: 2020 2020 2020 2049 6620 6120 7361 6c74         If a salt
-0001b590: 2069 7320 7370 6563 6966 6965 6420 7573   is specified us
-0001b5a0: 6520 6974 2c20 6966 2073 616c 7420 6973  e it, if salt is
-0001b5b0: 2054 7275 652c 2073 6574 2073 616c 7420   True, set salt 
-0001b5c0: 746f 2075 7569 640a 2020 2020 2020 2020  to uuid.        
-0001b5d0: 2874 6869 7320 7368 6f75 6c64 2061 6c6c  (this should all
-0001b5e0: 2062 6520 6261 636b 7761 7264 2063 6f6d   be backward com
-0001b5f0: 7061 7469 626c 6529 0a0a 2020 2020 2020  patible)..      
-0001b600: 2020 4f70 7469 6f6e 733a 0a20 2020 2020    Options:.     
-0001b610: 2020 206b 6579 203d 2027 7575 6964 270a     key = 'uuid'.
-0001b620: 2020 2020 2020 2020 6b65 7920 3d20 276d          key = 'm
-0001b630: 6435 3a75 7569 6427 0a20 2020 2020 2020  d5:uuid'.       
-0001b640: 206b 6579 203d 2027 7368 6135 3132 3a75   key = 'sha512:u
-0001b650: 7569 6427 0a20 2020 2020 2020 202e 2e2e  uid'.        ...
-0001b660: 0a20 2020 2020 2020 206b 6579 203d 2027  .        key = '
-0001b670: 7062 6b64 6632 2831 3030 302c 3634 2c73  pbkdf2(1000,64,s
-0001b680: 6861 3531 3229 3a75 7569 6427 2031 3030  ha512):uuid' 100
-0001b690: 3020 6974 6572 6174 696f 6e73 2061 6e64  0 iterations and
-0001b6a0: 2036 3420 6368 6172 7320 6c65 6e67 7468   64 chars length
-0001b6b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001b6c0: 2020 2020 2069 6620 7365 6c66 2e63 7279       if self.cry
-0001b6d0: 7074 6564 3a0a 2020 2020 2020 2020 2020  pted:.          
-0001b6e0: 2020 7265 7475 726e 2073 656c 662e 6372    return self.cr
-0001b6f0: 7970 7465 640a 2020 2020 2020 2020 6966  ypted.        if
-0001b700: 2073 656c 662e 6372 7970 742e 6b65 793a   self.crypt.key:
-0001b710: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001b720: 223a 2220 696e 2073 656c 662e 6372 7970  ":" in self.cryp
-0001b730: 742e 6b65 793a 0a20 2020 2020 2020 2020  t.key:.         
-0001b740: 2020 2020 2020 2064 6967 6573 745f 616c         digest_al
-0001b750: 672c 206b 6579 203d 2073 656c 662e 6372  g, key = self.cr
-0001b760: 7970 742e 6b65 792e 7370 6c69 7428 223a  ypt.key.split(":
-0001b770: 222c 2031 290a 2020 2020 2020 2020 2020  ", 1).          
-0001b780: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001b790: 2020 2020 2020 2020 6469 6765 7374 5f61          digest_a
-0001b7a0: 6c67 2c20 6b65 7920 3d20 7365 6c66 2e63  lg, key = self.c
-0001b7b0: 7279 7074 2e64 6967 6573 745f 616c 672c  rypt.digest_alg,
-0001b7c0: 2073 656c 662e 6372 7970 742e 6b65 790a   self.crypt.key.
-0001b7d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001b7e0: 2020 2020 2020 2020 2020 6469 6765 7374            digest
-0001b7f0: 5f61 6c67 2c20 6b65 7920 3d20 7365 6c66  _alg, key = self
-0001b800: 2e63 7279 7074 2e64 6967 6573 745f 616c  .crypt.digest_al
-0001b810: 672c 2022 220a 2020 2020 2020 2020 6966  g, "".        if
-0001b820: 2073 656c 662e 6372 7970 742e 7361 6c74   self.crypt.salt
-0001b830: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0001b840: 2073 656c 662e 6372 7970 742e 7361 6c74   self.crypt.salt
-0001b850: 2069 7320 5472 7565 3a0a 2020 2020 2020   is True:.      
-0001b860: 2020 2020 2020 2020 2020 7361 6c74 203d            salt =
-0001b870: 2073 7472 2875 7569 642e 7575 6964 3428   str(uuid.uuid4(
-0001b880: 2929 2e72 6570 6c61 6365 2822 2d22 2c20  )).replace("-", 
-0001b890: 2222 295b 2d31 363a 5d0a 2020 2020 2020  "")[-16:].      
-0001b8a0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001b8b0: 2020 2020 2020 2020 2020 2020 7361 6c74              salt
-0001b8c0: 203d 2073 656c 662e 6372 7970 742e 7361   = self.crypt.sa
-0001b8d0: 6c74 0a20 2020 2020 2020 2065 6c73 653a  lt.        else:
-0001b8e0: 0a20 2020 2020 2020 2020 2020 2073 616c  .            sal
-0001b8f0: 7420 3d20 2222 0a20 2020 2020 2020 2068  t = "".        h
-0001b900: 6173 6865 6420 3d20 7369 6d70 6c65 5f68  ashed = simple_h
-0001b910: 6173 6828 7365 6c66 2e70 6173 7377 6f72  ash(self.passwor
-0001b920: 642c 206b 6579 2c20 7361 6c74 2c20 6469  d, key, salt, di
-0001b930: 6765 7374 5f61 6c67 290a 2020 2020 2020  gest_alg).      
-0001b940: 2020 7365 6c66 2e63 7279 7074 6564 203d    self.crypted =
-0001b950: 2022 2573 2425 7324 2573 2220 2520 2864   "%s$%s$%s" % (d
-0001b960: 6967 6573 745f 616c 672c 2073 616c 742c  igest_alg, salt,
-0001b970: 2068 6173 6865 6429 0a20 2020 2020 2020   hashed).       
-0001b980: 2072 6574 7572 6e20 7365 6c66 2e63 7279   return self.cry
-0001b990: 7074 6564 0a0a 2020 2020 6465 6620 5f5f  pted..    def __
-0001b9a0: 6571 5f5f 2873 656c 662c 2073 746f 7265  eq__(self, store
-0001b9b0: 645f 7061 7373 776f 7264 293a 0a20 2020  d_password):.   
-0001b9c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001b9d0: 2063 6f6d 7061 7265 7320 7468 6520 6375   compares the cu
-0001b9e0: 7272 656e 7420 6c61 7a79 2063 7279 7074  rrent lazy crypt
-0001b9f0: 6564 2070 6173 7377 6f72 6420 7769 7468  ed password with
-0001ba00: 2061 2073 746f 7265 6420 7061 7373 776f   a stored passwo
-0001ba10: 7264 0a20 2020 2020 2020 2022 2222 0a0a  rd.        """..
-0001ba20: 2020 2020 2020 2020 2320 4c61 7a79 4372          # LazyCr
-0001ba30: 7970 7420 6f62 6a65 6374 7320 636f 6d70  ypt objects comp
-0001ba40: 6172 6973 6f6e 0a20 2020 2020 2020 2069  arison.        i
-0001ba50: 6620 6973 696e 7374 616e 6365 2873 746f  f isinstance(sto
-0001ba60: 7265 645f 7061 7373 776f 7264 2c20 7365  red_password, se
-0001ba70: 6c66 2e5f 5f63 6c61 7373 5f5f 293a 0a20  lf.__class__):. 
-0001ba80: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001ba90: 6e20 2873 656c 6620 6973 2073 746f 7265  n (self is store
-0001baa0: 645f 7061 7373 776f 7264 2920 6f72 2028  d_password) or (
-0001bab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001bac0: 2028 7365 6c66 2e63 7279 7074 2e6b 6579   (self.crypt.key
-0001bad0: 203d 3d20 7374 6f72 6564 5f70 6173 7377   == stored_passw
-0001bae0: 6f72 642e 6372 7970 742e 6b65 7929 0a20  ord.crypt.key). 
-0001baf0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0001bb00: 6e64 2028 7365 6c66 2e70 6173 7377 6f72  nd (self.passwor
-0001bb10: 6420 3d3d 2073 746f 7265 645f 7061 7373  d == stored_pass
-0001bb20: 776f 7264 2e70 6173 7377 6f72 6429 0a20  word.password). 
-0001bb30: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0001bb40: 2020 2020 2020 6966 2073 656c 662e 6372        if self.cr
-0001bb50: 7970 742e 6b65 793a 0a20 2020 2020 2020  ypt.key:.       
-0001bb60: 2020 2020 2069 6620 223a 2220 696e 2073       if ":" in s
-0001bb70: 656c 662e 6372 7970 742e 6b65 793a 0a20  elf.crypt.key:. 
-0001bb80: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-0001bb90: 6579 203d 2073 656c 662e 6372 7970 742e  ey = self.crypt.
-0001bba0: 6b65 792e 7370 6c69 7428 223a 2229 5b31  key.split(":")[1
-0001bbb0: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
-0001bbc0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001bbd0: 2020 2020 6b65 7920 3d20 7365 6c66 2e63      key = self.c
-0001bbe0: 7279 7074 2e6b 6579 0a20 2020 2020 2020  rypt.key.       
-0001bbf0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001bc00: 2020 206b 6579 203d 2022 220a 2020 2020     key = "".    
-0001bc10: 2020 2020 6966 2073 746f 7265 645f 7061      if stored_pa
-0001bc20: 7373 776f 7264 2069 7320 4e6f 6e65 3a0a  ssword is None:.
-0001bc30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001bc40: 726e 2046 616c 7365 0a20 2020 2020 2020  rn False.       
-0001bc50: 2065 6c69 6620 7374 6f72 6564 5f70 6173   elif stored_pas
-0001bc60: 7377 6f72 642e 636f 756e 7428 2224 2229  sword.count("$")
-0001bc70: 203d 3d20 323a 0a20 2020 2020 2020 2020   == 2:.         
-0001bc80: 2020 2028 6469 6765 7374 5f61 6c67 2c20     (digest_alg, 
-0001bc90: 7361 6c74 2c20 6861 7368 2920 3d20 7374  salt, hash) = st
-0001bca0: 6f72 6564 5f70 6173 7377 6f72 642e 7370  ored_password.sp
-0001bcb0: 6c69 7428 2224 2229 0a20 2020 2020 2020  lit("$").       
-0001bcc0: 2020 2020 2068 203d 2073 696d 706c 655f       h = simple_
-0001bcd0: 6861 7368 2873 656c 662e 7061 7373 776f  hash(self.passwo
-0001bce0: 7264 2c20 6b65 792c 2073 616c 742c 2064  rd, key, salt, d
-0001bcf0: 6967 6573 745f 616c 6729 0a20 2020 2020  igest_alg).     
-0001bd00: 2020 2020 2020 2074 656d 705f 7061 7373         temp_pass
-0001bd10: 203d 2022 2573 2425 7324 2573 2220 2520   = "%s$%s$%s" % 
-0001bd20: 2864 6967 6573 745f 616c 672c 2073 616c  (digest_alg, sal
-0001bd30: 742c 2068 290a 2020 2020 2020 2020 656c  t, h).        el
-0001bd40: 7365 3a20 2023 206e 6f20 7361 6c74 696e  se:  # no saltin
-0001bd50: 670a 2020 2020 2020 2020 2020 2020 2320  g.            # 
-0001bd60: 6775 6573 7320 6469 6765 7374 5f61 6c67  guess digest_alg
-0001bd70: 0a20 2020 2020 2020 2020 2020 2064 6967  .            dig
-0001bd80: 6573 745f 616c 6720 3d20 4449 4745 5354  est_alg = DIGEST
-0001bd90: 5f41 4c47 5f42 595f 5349 5a45 2e67 6574  _ALG_BY_SIZE.get
-0001bda0: 286c 656e 2873 746f 7265 645f 7061 7373  (len(stored_pass
-0001bdb0: 776f 7264 292c 204e 6f6e 6529 0a20 2020  word), None).   
-0001bdc0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0001bdd0: 6469 6765 7374 5f61 6c67 3a0a 2020 2020  digest_alg:.    
-0001bde0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001bdf0: 726e 2046 616c 7365 0a20 2020 2020 2020  rn False.       
-0001be00: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001be10: 2020 2020 2020 2020 2020 2074 656d 705f             temp_
-0001be20: 7061 7373 203d 2073 696d 706c 655f 6861  pass = simple_ha
-0001be30: 7368 2873 656c 662e 7061 7373 776f 7264  sh(self.password
-0001be40: 2c20 6b65 792c 2022 222c 2064 6967 6573  , key, "", diges
-0001be50: 745f 616c 6729 0a20 2020 2020 2020 2072  t_alg).        r
-0001be60: 6574 7572 6e20 7465 6d70 5f70 6173 7320  eturn temp_pass 
-0001be70: 3d3d 2073 746f 7265 645f 7061 7373 776f  == stored_passwo
-0001be80: 7264 0a0a 2020 2020 6465 6620 5f5f 6e65  rd..    def __ne
-0001be90: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
-0001bea0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001beb0: 6e6f 7420 7365 6c66 2e5f 5f65 715f 5f28  not self.__eq__(
-0001bec0: 6f74 6865 7229 0a0a 0a63 6c61 7373 2043  other)...class C
-0001bed0: 5259 5054 2856 616c 6964 6174 6f72 293a  RYPT(Validator):
-0001bee0: 0a20 2020 2022 2222 0a20 2020 2045 7861  .    """.    Exa
-0001bef0: 6d70 6c65 733a 0a20 2020 2020 2020 2055  mples:.        U
-0001bf00: 7365 2061 733a 3a0a 0a20 2020 2020 2020  se as::..       
-0001bf10: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
-0001bf20: 3d27 7465 7874 272c 205f 6e61 6d65 3d27  ='text', _name='
-0001bf30: 6e61 6d65 272c 2072 6571 7569 7265 733d  name', requires=
-0001bf40: 4352 5950 5428 2929 0a0a 2020 2020 656e  CRYPT())..    en
-0001bf50: 636f 6465 7320 7468 6520 7661 6c75 6520  codes the value 
-0001bf60: 6f6e 2076 616c 6964 6174 696f 6e20 7769  on validation wi
-0001bf70: 7468 2061 2064 6967 6573 742e 0a0a 2020  th a digest...  
-0001bf80: 2020 4966 206e 6f20 6172 6775 6d65 6e74    If no argument
-0001bf90: 7320 6172 6520 7072 6f76 6964 6564 2043  s are provided C
-0001bfa0: 5259 5054 2075 7365 7320 7468 6520 4d44  RYPT uses the MD
-0001bfb0: 3520 616c 676f 7269 7468 6d2e 0a20 2020  5 algorithm..   
-0001bfc0: 2049 6620 7468 6520 6b65 7920 6172 6775   If the key argu
-0001bfd0: 6d65 6e74 2069 7320 7072 6f76 6964 6564  ment is provided
-0001bfe0: 2074 6865 2048 4d41 432b 4d44 3520 616c   the HMAC+MD5 al
-0001bff0: 676f 7269 7468 6d20 6973 2075 7365 642e  gorithm is used.
-0001c000: 0a20 2020 2049 6620 7468 6520 6469 6765  .    If the dige
-0001c010: 7374 5f61 6c67 2069 7320 7370 6563 6966  st_alg is specif
-0001c020: 6965 6420 7468 6973 2069 7320 7573 6564  ied this is used
-0001c030: 2074 6f20 7265 706c 6163 6520 7468 650a   to replace the.
-0001c040: 2020 2020 4d44 3520 7769 7468 2c20 666f      MD5 with, fo
-0001c050: 7220 6578 616d 706c 652c 2053 4841 3531  r example, SHA51
-0001c060: 322e 2054 6865 2064 6967 6573 745f 616c  2. The digest_al
-0001c070: 6720 6361 6e20 6265 0a20 2020 2074 6865  g can be.    the
-0001c080: 206e 616d 6520 6f66 2061 2068 6173 686c   name of a hashl
-0001c090: 6962 2061 6c67 6f72 6974 686d 2061 7320  ib algorithm as 
-0001c0a0: 6120 7374 7269 6e67 206f 7220 7468 6520  a string or the 
-0001c0b0: 616c 676f 7269 7468 6d20 6974 7365 6c66  algorithm itself
-0001c0c0: 2e0a 0a20 2020 206d 696e 5f6c 656e 6774  ...    min_lengt
-0001c0d0: 6820 6973 2074 6865 206d 696e 696d 616c  h is the minimal
-0001c0e0: 2070 6173 7377 6f72 6420 6c65 6e67 7468   password length
-0001c0f0: 2028 6465 6661 756c 7420 3429 202d 2049   (default 4) - I
-0001c100: 535f 5354 524f 4e47 2066 6f72 2073 6572  S_STRONG for ser
-0001c110: 696f 7573 2073 6563 7572 6974 790a 2020  ious security.  
-0001c120: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-0001c130: 6973 2074 6865 206d 6573 7361 6765 2069  is the message i
-0001c140: 6620 7061 7373 776f 7264 2069 7320 746f  f password is to
-0001c150: 6f20 7368 6f72 740a 0a20 2020 204e 6f74  o short..    Not
-0001c160: 6963 6520 7468 6174 2061 6e20 656d 7074  ice that an empt
-0001c170: 7920 7061 7373 776f 7264 2069 7320 6163  y password is ac
-0001c180: 6365 7074 6564 2062 7574 2069 6e76 616c  cepted but inval
-0001c190: 6964 2e20 4974 2077 696c 6c20 6e6f 7420  id. It will not 
-0001c1a0: 616c 6c6f 7720 6c6f 6769 6e20 6261 636b  allow login back
-0001c1b0: 2e0a 2020 2020 5374 6f72 6573 206a 756e  ..    Stores jun
-0001c1c0: 6b20 6173 2068 6173 6865 6420 7061 7373  k as hashed pass
-0001c1d0: 776f 7264 2e0a 0a20 2020 2053 7065 6369  word...    Speci
-0001c1e0: 6679 2061 6e20 616c 676f 7269 7468 6d20  fy an algorithm 
-0001c1f0: 6f72 2062 7920 6465 6661 756c 7420 7765  or by default we
-0001c200: 2077 696c 6c20 7573 6520 7368 6135 3132   will use sha512
-0001c210: 2e0a 0a20 2020 2054 7970 6963 616c 2061  ...    Typical a
-0001c220: 7661 696c 6162 6c65 2061 6c67 6f72 6974  vailable algorit
-0001c230: 686d 733a 0a20 2020 2020 206d 6435 2c20  hms:.      md5, 
-0001c240: 7368 6131 2c20 7368 6132 3234 2c20 7368  sha1, sha224, sh
-0001c250: 6132 3536 2c20 7368 6133 3834 2c20 7368  a256, sha384, sh
-0001c260: 6135 3132 0a0a 2020 2020 4966 2073 616c  a512..    If sal
-0001c270: 742c 2069 7420 6861 7368 6573 2061 2070  t, it hashes a p
-0001c280: 6173 7377 6f72 6420 7769 7468 2061 2073  assword with a s
-0001c290: 616c 742e 0a20 2020 2049 6620 7361 6c74  alt..    If salt
-0001c2a0: 2069 7320 5472 7565 2c20 7468 6973 206d   is True, this m
-0001c2b0: 6574 686f 6420 7769 6c6c 2061 7574 6f6d  ethod will autom
-0001c2c0: 6174 6963 616c 6c79 2067 656e 6572 6174  atically generat
-0001c2d0: 6520 6f6e 652e 0a20 2020 2045 6974 6865  e one..    Eithe
-0001c2e0: 7220 6361 7365 2069 7420 7265 7475 726e  r case it return
-0001c2f0: 7320 616e 2065 6e63 7279 7074 6564 2070  s an encrypted p
-0001c300: 6173 7377 6f72 6420 7374 7269 6e67 2069  assword string i
-0001c310: 6e20 7468 6520 666f 6c6c 6f77 696e 6720  n the following 
-0001c320: 666f 726d 6174 3a0a 0a20 2020 2020 203c  format:..      <
-0001c330: 616c 676f 7269 7468 6d3e 243c 7361 6c74  algorithm>$<salt
-0001c340: 3e24 3c68 6173 683e 0a0a 2020 2020 496d  >$<hash>..    Im
-0001c350: 706f 7274 616e 743a 2068 6173 6865 6420  portant: hashed 
-0001c360: 7061 7373 776f 7264 2069 7320 7265 7475  password is retu
-0001c370: 726e 6564 2061 7320 6120 4c61 7a79 4372  rned as a LazyCr
-0001c380: 7970 7420 6f62 6a65 6374 2061 6e64 2063  ypt object and c
-0001c390: 6f6d 7075 7465 6420 6f6e 6c79 2069 6620  omputed only if 
-0001c3a0: 6e65 6564 6564 2e0a 2020 2020 5468 6520  needed..    The 
-0001c3b0: 4c61 7379 4372 7970 7420 6f62 6a65 6374  LasyCrypt object
-0001c3c0: 2061 6c73 6f20 6b6e 6f77 7320 686f 7720   also knows how 
-0001c3d0: 746f 2063 6f6d 7061 7265 2069 7473 656c  to compare itsel
-0001c3e0: 6620 7769 7468 2061 6e20 6578 6973 7469  f with an existi
-0001c3f0: 6e67 2073 616c 7465 6420 7061 7373 776f  ng salted passwo
-0001c400: 7264 0a0a 2020 2020 5375 7070 6f72 7473  rd..    Supports
-0001c410: 2073 7461 6e64 6172 6420 616c 676f 7269   standard algori
-0001c420: 7468 6d73 0a0a 2020 2020 2020 2020 3e3e  thms..        >>
-0001c430: 3e20 666f 7220 616c 6720 696e 2028 276d  > for alg in ('m
-0001c440: 6435 272c 2773 6861 3127 2c27 7368 6132  d5','sha1','sha2
-0001c450: 3536 272c 2773 6861 3338 3427 2c27 7368  56','sha384','sh
-0001c460: 6135 3132 2729 3a0a 2020 2020 2020 2020  a512'):.        
-0001c470: 2e2e 2e20 2020 2020 7072 696e 7428 7374  ...     print(st
-0001c480: 7228 4352 5950 5428 6469 6765 7374 5f61  r(CRYPT(digest_a
-0001c490: 6c67 3d61 6c67 2c73 616c 743d 5472 7565  lg=alg,salt=True
-0001c4a0: 2928 2774 6573 7427 295b 305d 2929 0a20  )('test')[0])). 
-0001c4b0: 2020 2020 2020 206d 6435 242e 2e2e 242e         md5$...$.
-0001c4c0: 2e2e 0a20 2020 2020 2020 2073 6861 3124  ...        sha1$
-0001c4d0: 2e2e 2e24 2e2e 2e0a 2020 2020 2020 2020  ...$....        
-0001c4e0: 7368 6132 3536 242e 2e2e 242e 2e2e 0a20  sha256$...$.... 
-0001c4f0: 2020 2020 2020 2073 6861 3338 3424 2e2e         sha384$..
-0001c500: 2e24 2e2e 2e0a 2020 2020 2020 2020 7368  .$....        sh
-0001c510: 6135 3132 242e 2e2e 242e 2e2e 0a0a 2020  a512$...$.....  
-0001c520: 2020 5468 6520 7379 6e74 6178 2069 7320    The syntax is 
-0001c530: 616c 7761 7973 2061 6c67 2473 616c 7424  always alg$salt$
-0001c540: 6861 7368 0a0a 2020 2020 5375 7070 6f72  hash..    Suppor
-0001c550: 7473 2066 6f72 2070 626b 6466 320a 0a20  ts for pbkdf2.. 
-0001c560: 2020 2020 2020 203e 3e3e 2061 6c67 203d         >>> alg =
-0001c570: 2027 7062 6b64 6632 2831 3030 302c 3230   'pbkdf2(1000,20
-0001c580: 2c73 6861 3531 3229 270a 2020 2020 2020  ,sha512)'.      
-0001c590: 2020 3e3e 3e20 7072 696e 7428 7374 7228    >>> print(str(
-0001c5a0: 4352 5950 5428 6469 6765 7374 5f61 6c67  CRYPT(digest_alg
-0001c5b0: 3d61 6c67 2c73 616c 743d 5472 7565 2928  =alg,salt=True)(
-0001c5c0: 2774 6573 7427 295b 305d 2929 0a20 2020  'test')[0])).   
-0001c5d0: 2020 2020 2070 626b 6466 3228 3130 3030       pbkdf2(1000
-0001c5e0: 2c32 302c 7368 6135 3132 2924 2e2e 2e24  ,20,sha512)$...$
-0001c5f0: 2e2e 2e0a 0a20 2020 2041 6e20 6f70 7469  .....    An opti
-0001c600: 6f6e 616c 2068 6d61 635f 6b65 7920 6361  onal hmac_key ca
-0001c610: 6e20 6265 2073 7065 6369 6669 6564 2061  n be specified a
-0001c620: 6e64 2069 7420 6973 2075 7365 6420 6173  nd it is used as
-0001c630: 2073 616c 7420 7072 6566 6978 0a0a 2020   salt prefix..  
-0001c640: 2020 2020 2020 3e3e 3e20 6120 3d20 7374        >>> a = st
-0001c650: 7228 4352 5950 5428 6469 6765 7374 5f61  r(CRYPT(digest_a
-0001c660: 6c67 3d27 6d64 3527 2c6b 6579 3d27 6d79  lg='md5',key='my
-0001c670: 6b65 7927 2c73 616c 743d 5472 7565 2928  key',salt=True)(
-0001c680: 2774 6573 7427 295b 305d 290a 2020 2020  'test')[0]).    
-0001c690: 2020 2020 3e3e 3e20 7072 696e 7428 6129      >>> print(a)
-0001c6a0: 0a20 2020 2020 2020 206d 6435 242e 2e2e  .        md5$...
-0001c6b0: 242e 2e2e 0a0a 2020 2020 4576 656e 2069  $.....    Even i
-0001c6c0: 6620 7468 6520 616c 676f 7269 7468 6d20  f the algorithm 
-0001c6d0: 6368 616e 6765 7320 7468 6520 6861 7368  changes the hash
-0001c6e0: 2063 616e 2073 7469 6c6c 2062 6520 7661   can still be va
-0001c6f0: 6c69 6461 7465 640a 0a20 2020 2020 2020  lidated..       
-0001c700: 203e 3e3e 2043 5259 5054 2864 6967 6573   >>> CRYPT(diges
-0001c710: 745f 616c 673d 2773 6861 3127 2c6b 6579  t_alg='sha1',key
-0001c720: 3d27 6d79 6b65 7927 2c73 616c 743d 5472  ='mykey',salt=Tr
-0001c730: 7565 2928 2774 6573 7427 295b 305d 203d  ue)('test')[0] =
-0001c740: 3d20 610a 2020 2020 2020 2020 5472 7565  = a.        True
-0001c750: 0a0a 2020 2020 4966 206e 6f20 7361 6c74  ..    If no salt
-0001c760: 2069 7320 7370 6563 6966 6965 6420 4352   is specified CR
-0001c770: 5950 5420 6361 6e20 6775 6573 7320 7468  YPT can guess th
-0001c780: 6520 616c 676f 7269 7468 6d73 2066 726f  e algorithms fro
-0001c790: 6d20 6c65 6e67 7468 3a0a 0a20 2020 2020  m length:..     
-0001c7a0: 2020 203e 3e3e 2061 203d 2073 7472 2843     >>> a = str(C
-0001c7b0: 5259 5054 2864 6967 6573 745f 616c 673d  RYPT(digest_alg=
-0001c7c0: 2773 6861 3127 2c73 616c 743d 4661 6c73  'sha1',salt=Fals
-0001c7d0: 6529 2827 7465 7374 2729 5b30 5d29 0a20  e)('test')[0]). 
-0001c7e0: 2020 2020 2020 203e 3e3e 2061 0a20 2020         >>> a.   
-0001c7f0: 2020 2020 2027 7368 6131 2424 6139 3461       'sha1$$a94a
-0001c800: 3866 6535 6363 6231 3962 6136 3163 3463  8fe5ccb19ba61c4c
-0001c810: 3038 3733 6433 3931 6539 3837 3938 3266  0873d391e987982f
-0001c820: 6262 6433 270a 2020 2020 2020 2020 3e3e  bbd3'.        >>
-0001c830: 3e20 4352 5950 5428 6469 6765 7374 5f61  > CRYPT(digest_a
-0001c840: 6c67 3d27 7368 6131 272c 7361 6c74 3d46  lg='sha1',salt=F
-0001c850: 616c 7365 2928 2774 6573 7427 295b 305d  alse)('test')[0]
-0001c860: 203d 3d20 610a 2020 2020 2020 2020 5472   == a.        Tr
-0001c870: 7565 0a20 2020 2020 2020 203e 3e3e 2043  ue.        >>> C
-0001c880: 5259 5054 2864 6967 6573 745f 616c 673d  RYPT(digest_alg=
-0001c890: 2773 6861 3127 2c73 616c 743d 4661 6c73  'sha1',salt=Fals
-0001c8a0: 6529 2827 7465 7374 2729 5b30 5d20 3d3d  e)('test')[0] ==
-0001c8b0: 2061 5b36 3a5d 0a20 2020 2020 2020 2054   a[6:].        T
-0001c8c0: 7275 650a 2020 2020 2020 2020 3e3e 3e20  rue.        >>> 
-0001c8d0: 4352 5950 5428 6469 6765 7374 5f61 6c67  CRYPT(digest_alg
-0001c8e0: 3d27 6d64 3527 2c73 616c 743d 4661 6c73  ='md5',salt=Fals
-0001c8f0: 6529 2827 7465 7374 2729 5b30 5d20 3d3d  e)('test')[0] ==
-0001c900: 2061 0a20 2020 2020 2020 2054 7275 650a   a.        True.
-0001c910: 2020 2020 2020 2020 3e3e 3e20 4352 5950          >>> CRYP
-0001c920: 5428 6469 6765 7374 5f61 6c67 3d27 6d64  T(digest_alg='md
-0001c930: 3527 2c73 616c 743d 4661 6c73 6529 2827  5',salt=False)('
-0001c940: 7465 7374 2729 5b30 5d20 3d3d 2061 5b36  test')[0] == a[6
-0001c950: 3a5d 0a20 2020 2020 2020 2054 7275 650a  :].        True.
-0001c960: 2020 2020 2222 220a 0a20 2020 2053 5441      """..    STA
-0001c970: 5253 203d 2022 2a2a 2a2a 2a2a 220a 0a20  RS = "******".. 
-0001c980: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-0001c990: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0001c9a0: 2020 2020 2020 206b 6579 3d4e 6f6e 652c         key=None,
-0001c9b0: 0a20 2020 2020 2020 2064 6967 6573 745f  .        digest_
-0001c9c0: 616c 673d 2270 626b 6466 3228 3130 3030  alg="pbkdf2(1000
-0001c9d0: 2c32 302c 7368 6135 3132 2922 2c0a 2020  ,20,sha512)",.  
-0001c9e0: 2020 2020 2020 6d69 6e5f 6c65 6e67 7468        min_length
-0001c9f0: 3d30 2c0a 2020 2020 2020 2020 6572 726f  =0,.        erro
-0001ca00: 725f 6d65 7373 6167 653d 2254 6f6f 2073  r_message="Too s
-0001ca10: 686f 7274 222c 0a20 2020 2020 2020 2073  hort",.        s
-0001ca20: 616c 743d 5472 7565 2c0a 2020 2020 2020  alt=True,.      
-0001ca30: 2020 6d61 785f 6c65 6e67 7468 3d31 3032    max_length=102
-0001ca40: 342c 0a20 2020 2029 3a0a 2020 2020 2020  4,.    ):.      
-0001ca50: 2020 2222 220a 2020 2020 2020 2020 696d    """.        im
-0001ca60: 706f 7274 616e 742c 2064 6967 6573 745f  portant, digest_
-0001ca70: 616c 673d 276d 6435 2720 6973 206e 6f74  alg='md5' is not
-0001ca80: 2074 6865 2064 6566 6175 6c74 2068 6173   the default has
-0001ca90: 6869 6e67 2061 6c67 6f72 6974 686d 2066  hing algorithm f
-0001caa0: 6f72 0a20 2020 2020 2020 2077 6562 3270  or.        web2p
-0001cab0: 792e 2054 6869 7320 6973 206f 6e6c 7920  y. This is only 
-0001cac0: 616e 2065 7861 6d70 6c65 206f 6620 7573  an example of us
-0001cad0: 6167 6520 6f66 2074 6869 7320 6675 6e63  age of this func
-0001cae0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2054  tion...        T
-0001caf0: 6865 2061 6374 7561 6c20 6861 7368 2061  he actual hash a
-0001cb00: 6c67 6f72 6974 686d 2069 7320 6465 7465  lgorithm is dete
-0001cb10: 726d 696e 6564 2066 726f 6d20 7468 6520  rmined from the 
-0001cb20: 6b65 7920 7768 6963 6820 6973 0a20 2020  key which is.   
-0001cb30: 2020 2020 2067 656e 6572 6174 6564 2062       generated b
-0001cb40: 7920 7765 6232 7079 2069 6e20 746f 6f6c  y web2py in tool
-0001cb50: 732e 7079 2e20 5468 6973 2064 6566 6175  s.py. This defau
-0001cb60: 6c74 7320 746f 2068 6d61 632b 7368 6135  lts to hmac+sha5
-0001cb70: 3132 2e0a 2020 2020 2020 2020 2222 220a  12..        """.
-0001cb80: 2020 2020 2020 2020 7365 6c66 2e6b 6579          self.key
-0001cb90: 203d 206b 6579 0a20 2020 2020 2020 2073   = key.        s
-0001cba0: 656c 662e 6469 6765 7374 5f61 6c67 203d  elf.digest_alg =
-0001cbb0: 2064 6967 6573 745f 616c 670a 2020 2020   digest_alg.    
-0001cbc0: 2020 2020 7365 6c66 2e6d 696e 5f6c 656e      self.min_len
-0001cbd0: 6774 6820 3d20 6d69 6e5f 6c65 6e67 7468  gth = min_length
-0001cbe0: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
-0001cbf0: 785f 6c65 6e67 7468 203d 206d 6178 5f6c  x_length = max_l
-0001cc00: 656e 6774 680a 2020 2020 2020 2020 7365  ength.        se
-0001cc10: 6c66 2e65 7272 6f72 5f6d 6573 7361 6765  lf.error_message
-0001cc20: 203d 2065 7272 6f72 5f6d 6573 7361 6765   = error_message
-0001cc30: 0a20 2020 2020 2020 2073 656c 662e 7361  .        self.sa
-0001cc40: 6c74 203d 2073 616c 740a 0a20 2020 2064  lt = salt..    d
-0001cc50: 6566 2076 616c 6964 6174 6528 7365 6c66  ef validate(self
-0001cc60: 2c20 7661 6c75 652c 2072 6563 6f72 645f  , value, record_
-0001cc70: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
-0001cc80: 2020 6966 2076 616c 7565 203d 3d20 7365    if value == se
-0001cc90: 6c66 2e53 5441 5253 3a0a 2020 2020 2020  lf.STARS:.      
-0001cca0: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-0001ccb0: 650a 2020 2020 2020 2020 7620 3d20 7661  e.        v = va
-0001ccc0: 6c75 6520 616e 6420 7374 7228 7661 6c75  lue and str(valu
-0001ccd0: 6529 5b3a 2073 656c 662e 6d61 785f 6c65  e)[: self.max_le
-0001cce0: 6e67 7468 5d0a 2020 2020 2020 2020 6966  ngth].        if
-0001ccf0: 206e 6f74 2076 206f 7220 6c65 6e28 7629   not v or len(v)
-0001cd00: 203c 2073 656c 662e 6d69 6e5f 6c65 6e67   < self.min_leng
-0001cd10: 7468 3a0a 2020 2020 2020 2020 2020 2020  th:.            
-0001cd20: 7261 6973 6520 5661 6c69 6461 7469 6f6e  raise Validation
-0001cd30: 4572 726f 7228 7365 6c66 2e74 7261 6e73  Error(self.trans
-0001cd40: 6c61 746f 7228 7365 6c66 2e65 7272 6f72  lator(self.error
-0001cd50: 5f6d 6573 7361 6765 2929 0a20 2020 2020  _message)).     
-0001cd60: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0001cd70: 2876 616c 7565 2c20 4c61 7a79 4372 7970  (value, LazyCryp
-0001cd80: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-0001cd90: 7265 7475 726e 2076 616c 7565 0a20 2020  return value.   
-0001cda0: 2020 2020 2072 6574 7572 6e20 4c61 7a79       return Lazy
-0001cdb0: 4372 7970 7428 7365 6c66 2c20 7661 6c75  Crypt(self, valu
-0001cdc0: 6529 0a0a 2020 2020 6465 6620 666f 726d  e)..    def form
-0001cdd0: 6174 7465 7228 7365 6c66 2c20 7661 6c75  atter(self, valu
-0001cde0: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
-0001cdf0: 726e 2073 656c 662e 5354 4152 530a 0a0a  rn self.STARS...
-0001ce00: 2320 2065 6e74 726f 7079 2063 616c 6375  #  entropy calcu
-0001ce10: 6c61 746f 7220 666f 7220 4953 5f53 5452  lator for IS_STR
-0001ce20: 4f4e 470a 230a 6c6f 7765 7273 6574 203d  ONG.#.lowerset =
-0001ce30: 2066 726f 7a65 6e73 6574 2862 2261 6263   frozenset(b"abc
-0001ce40: 6465 6667 6869 6a6b 6c6d 6e6f 7071 7273  defghijklmnopqrs
-0001ce50: 7475 7677 7879 7a22 290a 7570 7065 7273  tuvwxyz").uppers
-0001ce60: 6574 203d 2066 726f 7a65 6e73 6574 2862  et = frozenset(b
-0001ce70: 2241 4243 4445 4647 4849 4a4b 4c4d 4e4f  "ABCDEFGHIJKLMNO
-0001ce80: 5051 5253 5455 5657 5859 5a22 290a 6e75  PQRSTUVWXYZ").nu
-0001ce90: 6d62 6572 7365 7420 3d20 6672 6f7a 656e  mberset = frozen
-0001cea0: 7365 7428 6222 3031 3233 3435 3637 3839  set(b"0123456789
-0001ceb0: 2229 0a73 796d 3173 6574 203d 2066 726f  ").sym1set = fro
-0001cec0: 7a65 6e73 6574 2862 2221 4023 2425 5e26  zenset(b"!@#$%^&
-0001ced0: 2a28 2920 2229 0a73 796d 3273 6574 203d  *() ").sym2set =
-0001cee0: 2066 726f 7a65 6e73 6574 2862 227e 602d   frozenset(b"~`-
-0001cef0: 5f3d 2b5b 5d7b 7d5c 5c7c 3b3a 275c 222c  _=+[]{}\\|;:'\",
-0001cf00: 2e3c 3e3f 2f22 290a 6f74 6865 7273 6574  .<>?/").otherset
-0001cf10: 203d 2066 726f 7a65 6e73 6574 2862 2222   = frozenset(b""
-0001cf20: 2e6a 6f69 6e28 6368 7228 7829 2069 6620  .join(chr(x) if 
-0001cf30: 5059 3220 656c 7365 2063 6872 2878 292e  PY2 else chr(x).
-0001cf40: 656e 636f 6465 2829 2066 6f72 2078 2069  encode() for x i
-0001cf50: 6e20 7261 6e67 6528 3235 3629 2929 0a0a  n range(256)))..
-0001cf60: 0a64 6566 2063 616c 635f 656e 7472 6f70  .def calc_entrop
-0001cf70: 7928 7374 7269 6e67 293a 0a20 2020 2022  y(string):.    "
-0001cf80: 2222 2063 616c 6375 6c61 7465 7320 6120  "" calculates a 
-0001cf90: 7369 6d70 6c65 2065 6e74 726f 7079 2066  simple entropy f
-0001cfa0: 6f72 2061 2067 6976 656e 2073 7472 696e  or a given strin
-0001cfb0: 6720 2222 220a 2020 2020 616c 7068 6162  g """.    alphab
-0001cfc0: 6574 203d 2030 2020 2320 616c 7068 6162  et = 0  # alphab
-0001cfd0: 6574 2073 697a 650a 2020 2020 6f74 6865  et size.    othe
-0001cfe0: 7220 3d20 7365 7428 290a 2020 2020 7365  r = set().    se
-0001cff0: 656e 203d 2073 6574 2829 0a20 2020 206c  en = set().    l
-0001d000: 6173 7473 6574 203d 204e 6f6e 650a 2020  astset = None.  
-0001d010: 2020 7374 7269 6e67 203d 2074 6f5f 6279    string = to_by
-0001d020: 7465 7328 7374 7269 6e67 206f 7220 2222  tes(string or ""
-0001d030: 290a 2020 2020 666f 7220 6320 696e 2073  ).    for c in s
-0001d040: 7472 696e 673a 0a20 2020 2020 2020 2023  tring:.        #
-0001d050: 2063 6c61 7373 6966 7920 7468 6973 2063   classify this c
-0001d060: 6861 7261 6374 6572 0a20 2020 2020 2020  haracter.       
-0001d070: 2069 6e73 6574 203d 204e 6f6e 650a 2020   inset = None.  
-0001d080: 2020 2020 2020 666f 7220 6373 6574 2069        for cset i
-0001d090: 6e20 286c 6f77 6572 7365 742c 2075 7070  n (lowerset, upp
-0001d0a0: 6572 7365 742c 206e 756d 6265 7273 6574  erset, numberset
-0001d0b0: 2c20 7379 6d31 7365 742c 2073 796d 3273  , sym1set, sym2s
-0001d0c0: 6574 2c20 6f74 6865 7273 6574 293a 0a20  et, otherset):. 
-0001d0d0: 2020 2020 2020 2020 2020 2069 6620 6320             if c 
-0001d0e0: 696e 2063 7365 743a 0a20 2020 2020 2020  in cset:.       
-0001d0f0: 2020 2020 2020 2020 2069 6e73 6574 203d           inset =
-0001d100: 2063 7365 740a 2020 2020 2020 2020 2020   cset.          
-0001d110: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-0001d120: 2020 2020 6173 7365 7274 2069 6e73 6574      assert inset
-0001d130: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
-0001d140: 2020 2020 2023 2063 616c 6375 6c61 7465       # calculate
-0001d150: 2065 6666 6563 7420 6f66 2063 6861 7261   effect of chara
-0001d160: 6374 6572 206f 6e20 616c 7068 6162 6574  cter on alphabet
-0001d170: 2073 697a 650a 2020 2020 2020 2020 6966   size.        if
-0001d180: 2069 6e73 6574 206e 6f74 2069 6e20 7365   inset not in se
-0001d190: 656e 3a0a 2020 2020 2020 2020 2020 2020  en:.            
-0001d1a0: 7365 656e 2e61 6464 2869 6e73 6574 290a  seen.add(inset).
-0001d1b0: 2020 2020 2020 2020 2020 2020 616c 7068              alph
-0001d1c0: 6162 6574 202b 3d20 6c65 6e28 696e 7365  abet += len(inse
-0001d1d0: 7429 2020 2320 6372 6564 6974 2066 6f72  t)  # credit for
-0001d1e0: 2061 206e 6577 2063 6861 7261 6374 6572   a new character
-0001d1f0: 2073 6574 0a20 2020 2020 2020 2065 6c69   set.        eli
-0001d200: 6620 6320 6e6f 7420 696e 206f 7468 6572  f c not in other
-0001d210: 3a0a 2020 2020 2020 2020 2020 2020 616c  :.            al
-0001d220: 7068 6162 6574 202b 3d20 3120 2023 2063  phabet += 1  # c
-0001d230: 7265 6469 7420 666f 7220 756e 6971 7565  redit for unique
-0001d240: 2063 6861 7261 6374 6572 730a 2020 2020   characters.    
-0001d250: 2020 2020 2020 2020 6f74 6865 722e 6164          other.ad
-0001d260: 6428 6329 0a20 2020 2020 2020 2069 6620  d(c).        if 
-0001d270: 696e 7365 7420 6973 206e 6f74 206c 6173  inset is not las
-0001d280: 7473 6574 3a0a 2020 2020 2020 2020 2020  tset:.          
-0001d290: 2020 616c 7068 6162 6574 202b 3d20 3120    alphabet += 1 
-0001d2a0: 2023 2063 7265 6469 7420 666f 7220 7365   # credit for se
-0001d2b0: 7420 7472 616e 7369 7469 6f6e 730a 2020  t transitions.  
-0001d2c0: 2020 2020 2020 2020 2020 6c61 7374 7365            lastse
-0001d2d0: 7420 3d20 6373 6574 0a20 2020 2065 6e74  t = cset.    ent
-0001d2e0: 726f 7079 203d 206c 656e 2873 7472 696e  ropy = len(strin
-0001d2f0: 6729 202a 206d 6174 682e 6c6f 6728 616c  g) * math.log(al
-0001d300: 7068 6162 6574 206f 7220 3129 202f 2030  phabet or 1) / 0
-0001d310: 2e36 3933 3134 3731 3830 3535 3939 3435  .693147180559945
-0001d320: 3320 2023 206d 6174 682e 6c6f 6728 3229  3  # math.log(2)
-0001d330: 0a20 2020 2072 6574 7572 6e20 726f 756e  .    return roun
-0001d340: 6428 656e 7472 6f70 792c 2032 290a 0a0a  d(entropy, 2)...
-0001d350: 636c 6173 7320 4953 5f53 5452 4f4e 4728  class IS_STRONG(
-0001d360: 5661 6c69 6461 746f 7229 3a0a 2020 2020  Validator):.    
-0001d370: 2222 220a 2020 2020 4578 616d 706c 6573  """.    Examples
-0001d380: 3a0a 2020 2020 2020 2020 5573 6520 6173  :.        Use as
-0001d390: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
-0001d3a0: 494e 5055 5428 5f74 7970 653d 2770 6173  INPUT(_type='pas
-0001d3b0: 7377 6f72 6427 2c20 5f6e 616d 653d 2770  sword', _name='p
-0001d3c0: 6173 7377 6427 2c0a 2020 2020 2020 2020  asswd',.        
-0001d3d0: 2020 2020 7265 7175 6972 6573 3d49 535f      requires=IS_
-0001d3e0: 5354 524f 4e47 286d 696e 3d31 302c 2073  STRONG(min=10, s
-0001d3f0: 7065 6369 616c 3d32 2c20 7570 7065 723d  pecial=2, upper=
-0001d400: 3229 290a 0a20 2020 2065 6e66 6f72 6365  2))..    enforce
-0001d410: 7320 636f 6d70 6c65 7869 7479 2072 6571  s complexity req
-0001d420: 7569 7265 6d65 6e74 7320 6f6e 2061 2066  uirements on a f
-0001d430: 6965 6c64 0a0a 2020 2020 2020 2020 3e3e  ield..        >>
-0001d440: 3e20 4953 5f53 5452 4f4e 4728 6573 3d54  > IS_STRONG(es=T
-0001d450: 7275 6529 2827 4162 6364 3132 3334 2729  rue)('Abcd1234')
-0001d460: 0a20 2020 2020 2020 2028 2741 6263 6431  .        ('Abcd1
-0001d470: 3233 3427 2c0a 2020 2020 2020 2020 2027  234',.         '
-0001d480: 4d75 7374 2069 6e63 6c75 6465 2061 7420  Must include at 
-0001d490: 6c65 6173 7420 3120 6f66 2074 6865 2066  least 1 of the f
-0001d4a0: 6f6c 6c6f 7769 6e67 3a20 7e21 4023 2425  ollowing: ~!@#$%
-0001d4b0: 5e26 2a28 295f 2b2d 3d3f 3c3e 2c2e 3a3b  ^&*()_+-=?<>,.:;
-0001d4c0: 7b7d 5b5d 7c27 290a 2020 2020 2020 2020  {}[]|').        
-0001d4d0: 3e3e 3e20 4953 5f53 5452 4f4e 4728 6573  >>> IS_STRONG(es
-0001d4e0: 3d54 7275 6529 2827 4162 6364 3132 3334  =True)('Abcd1234
-0001d4f0: 2127 290a 2020 2020 2020 2020 2827 4162  !').        ('Ab
-0001d500: 6364 3132 3334 2127 2c20 4e6f 6e65 290a  cd1234!', None).
-0001d510: 2020 2020 2020 2020 3e3e 3e20 4953 5f53          >>> IS_S
-0001d520: 5452 4f4e 4728 6573 3d54 7275 652c 2065  TRONG(es=True, e
-0001d530: 6e74 726f 7079 3d31 2928 2761 2729 0a20  ntropy=1)('a'). 
-0001d540: 2020 2020 2020 2028 2761 272c 204e 6f6e         ('a', Non
-0001d550: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
-0001d560: 535f 5354 524f 4e47 2865 733d 5472 7565  S_STRONG(es=True
-0001d570: 2c20 656e 7472 6f70 793d 312c 206d 696e  , entropy=1, min
-0001d580: 3d32 2928 2761 2729 0a20 2020 2020 2020  =2)('a').       
-0001d590: 2028 2761 272c 2027 4d69 6e69 6d75 6d20   ('a', 'Minimum 
-0001d5a0: 6c65 6e67 7468 2069 7320 3227 290a 2020  length is 2').  
-0001d5b0: 2020 2020 2020 3e3e 3e20 4953 5f53 5452        >>> IS_STR
-0001d5c0: 4f4e 4728 6573 3d54 7275 652c 2065 6e74  ONG(es=True, ent
-0001d5d0: 726f 7079 3d31 3030 2928 2761 6263 3132  ropy=100)('abc12
-0001d5e0: 3327 290a 2020 2020 2020 2020 2827 6162  3').        ('ab
-0001d5f0: 6331 3233 272c 2027 5061 7373 776f 7264  c123', 'Password
-0001d600: 2074 6f6f 2073 696d 706c 6520 2833 322e   too simple (32.
-0001d610: 3335 2f31 3030 2927 290a 2020 2020 2020  35/100)').      
-0001d620: 2020 3e3e 3e20 4953 5f53 5452 4f4e 4728    >>> IS_STRONG(
-0001d630: 6573 3d54 7275 652c 2065 6e74 726f 7079  es=True, entropy
-0001d640: 3d31 3030 2928 2761 6e64 2729 0a20 2020  =100)('and').   
-0001d650: 2020 2020 2028 2761 6e64 272c 2027 5061       ('and', 'Pa
-0001d660: 7373 776f 7264 2074 6f6f 2073 696d 706c  ssword too simpl
-0001d670: 6520 2831 342e 3537 2f31 3030 2927 290a  e (14.57/100)').
-0001d680: 2020 2020 2020 2020 3e3e 3e20 4953 5f53          >>> IS_S
-0001d690: 5452 4f4e 4728 6573 3d54 7275 652c 2065  TRONG(es=True, e
-0001d6a0: 6e74 726f 7079 3d31 3030 2928 2761 6161  ntropy=100)('aaa
-0001d6b0: 2729 0a20 2020 2020 2020 2028 2761 6161  ').        ('aaa
-0001d6c0: 272c 2027 5061 7373 776f 7264 2074 6f6f  ', 'Password too
-0001d6d0: 2073 696d 706c 6520 2831 342e 3432 2f31   simple (14.42/1
-0001d6e0: 3030 2927 290a 2020 2020 2020 2020 3e3e  00)').        >>
-0001d6f0: 3e20 4953 5f53 5452 4f4e 4728 6573 3d54  > IS_STRONG(es=T
-0001d700: 7275 652c 2065 6e74 726f 7079 3d31 3030  rue, entropy=100
-0001d710: 2928 2761 3164 2729 0a20 2020 2020 2020  )('a1d').       
-0001d720: 2028 2761 3164 272c 2027 5061 7373 776f   ('a1d', 'Passwo
-0001d730: 7264 2074 6f6f 2073 696d 706c 6520 2831  rd too simple (1
-0001d740: 352e 3937 2f31 3030 2927 290a 2020 2020  5.97/100)').    
-0001d750: 2020 2020 3e3e 3e20 4953 5f53 5452 4f4e      >>> IS_STRON
-0001d760: 4728 6573 3d54 7275 652c 2065 6e74 726f  G(es=True, entro
-0001d770: 7079 3d31 3030 2928 2761 c3b1 6427 290a  py=100)('a..d').
-0001d780: 2020 2020 2020 2020 2827 615c 5c78 6333          ('a\\xc3
-0001d790: 5c5c 7862 3164 272c 2027 5061 7373 776f  \\xb1d', 'Passwo
-0001d7a0: 7264 2074 6f6f 2073 696d 706c 6520 2833  rd too simple (3
-0001d7b0: 312e 3236 2f31 3029 2729 0a0a 2020 2020  1.26/10)')..    
-0001d7c0: 2222 220a 0a20 2020 2064 6566 205f 5f69  """..    def __i
-0001d7d0: 6e69 745f 5f28 0a20 2020 2020 2020 2073  nit__(.        s
-0001d7e0: 656c 662c 0a20 2020 2020 2020 206d 696e  elf,.        min
-0001d7f0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206d  =None,.        m
-0001d800: 6178 3d4e 6f6e 652c 0a20 2020 2020 2020  ax=None,.       
-0001d810: 2075 7070 6572 3d4e 6f6e 652c 0a20 2020   upper=None,.   
-0001d820: 2020 2020 206c 6f77 6572 3d4e 6f6e 652c       lower=None,
-0001d830: 0a20 2020 2020 2020 206e 756d 6265 723d  .        number=
-0001d840: 4e6f 6e65 2c0a 2020 2020 2020 2020 656e  None,.        en
-0001d850: 7472 6f70 793d 4e6f 6e65 2c0a 2020 2020  tropy=None,.    
-0001d860: 2020 2020 7370 6563 6961 6c3d 4e6f 6e65      special=None
-0001d870: 2c0a 2020 2020 2020 2020 7370 6563 6961  ,.        specia
-0001d880: 6c73 3d72 227e 2140 2324 255e 262a 2829  ls=r"~!@#$%^&*()
-0001d890: 5f2b 2d3d 3f3c 3e2c 2e3a 3b7b 7d5b 5d7c  _+-=?<>,.:;{}[]|
-0001d8a0: 222c 0a20 2020 2020 2020 2069 6e76 616c  ",.        inval
-0001d8b0: 6964 3d27 2022 272c 0a20 2020 2020 2020  id=' "',.       
-0001d8c0: 2065 7272 6f72 5f6d 6573 7361 6765 3d4e   error_message=N
-0001d8d0: 6f6e 652c 0a20 2020 2020 2020 2065 733d  one,.        es=
-0001d8e0: 4661 6c73 652c 0a20 2020 2029 3a0a 2020  False,.    ):.  
-0001d8f0: 2020 2020 2020 7365 6c66 2e65 6e74 726f        self.entro
-0001d900: 7079 203d 2065 6e74 726f 7079 0a20 2020  py = entropy.   
-0001d910: 2020 2020 2069 6620 656e 7472 6f70 7920       if entropy 
-0001d920: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0001d930: 2020 2020 2023 2065 6e66 6f72 6365 2064       # enforce d
-0001d940: 6566 6175 6c74 2072 6571 7569 7265 6d65  efault requireme
-0001d950: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
-0001d960: 7365 6c66 2e6d 696e 203d 2038 2069 6620  self.min = 8 if 
-0001d970: 6d69 6e20 6973 204e 6f6e 6520 656c 7365  min is None else
-0001d980: 206d 696e 0a20 2020 2020 2020 2020 2020   min.           
-0001d990: 2073 656c 662e 6d61 7820 3d20 6d61 7820   self.max = max 
-0001d9a0: 2023 2077 6173 2032 302c 2062 7574 2074   # was 20, but t
-0001d9b0: 6861 7420 646f 6573 6e27 7420 6d61 6b65  hat doesn't make
-0001d9c0: 2073 656e 7365 0a20 2020 2020 2020 2020   sense.         
-0001d9d0: 2020 2073 656c 662e 7570 7065 7220 3d20     self.upper = 
-0001d9e0: 3120 6966 2075 7070 6572 2069 7320 4e6f  1 if upper is No
-0001d9f0: 6e65 2065 6c73 6520 7570 7065 720a 2020  ne else upper.  
-0001da00: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-0001da10: 6f77 6572 203d 2031 2069 6620 6c6f 7765  ower = 1 if lowe
-0001da20: 7220 6973 204e 6f6e 6520 656c 7365 206c  r is None else l
-0001da30: 6f77 6572 0a20 2020 2020 2020 2020 2020  ower.           
-0001da40: 2073 656c 662e 6e75 6d62 6572 203d 2031   self.number = 1
-0001da50: 2069 6620 6e75 6d62 6572 2069 7320 4e6f   if number is No
-0001da60: 6e65 2065 6c73 6520 6e75 6d62 6572 0a20  ne else number. 
-0001da70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001da80: 7370 6563 6961 6c20 3d20 3120 6966 2073  special = 1 if s
-0001da90: 7065 6369 616c 2069 7320 4e6f 6e65 2065  pecial is None e
-0001daa0: 6c73 6520 7370 6563 6961 6c0a 2020 2020  lse special.    
-0001dab0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001dac0: 2020 2020 2020 2320 6279 2064 6566 6175        # by defau
-0001dad0: 6c74 2c20 616e 2065 6e74 726f 7079 2073  lt, an entropy s
-0001dae0: 7065 6320 6973 2065 7863 6c75 7369 7665  pec is exclusive
-0001daf0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001db00: 662e 6d69 6e20 3d20 6d69 6e0a 2020 2020  f.min = min.    
-0001db10: 2020 2020 2020 2020 7365 6c66 2e6d 6178          self.max
-0001db20: 203d 206d 6178 0a20 2020 2020 2020 2020   = max.         
-0001db30: 2020 2073 656c 662e 7570 7065 7220 3d20     self.upper = 
-0001db40: 7570 7065 720a 2020 2020 2020 2020 2020  upper.          
-0001db50: 2020 7365 6c66 2e6c 6f77 6572 203d 206c    self.lower = l
-0001db60: 6f77 6572 0a20 2020 2020 2020 2020 2020  ower.           
-0001db70: 2073 656c 662e 6e75 6d62 6572 203d 206e   self.number = n
-0001db80: 756d 6265 720a 2020 2020 2020 2020 2020  umber.          
-0001db90: 2020 7365 6c66 2e73 7065 6369 616c 203d    self.special =
-0001dba0: 2073 7065 6369 616c 0a20 2020 2020 2020   special.       
-0001dbb0: 2073 656c 662e 7370 6563 6961 6c73 203d   self.specials =
-0001dbc0: 2073 7065 6369 616c 730a 2020 2020 2020   specials.      
-0001dbd0: 2020 7365 6c66 2e69 6e76 616c 6964 203d    self.invalid =
-0001dbe0: 2069 6e76 616c 6964 0a20 2020 2020 2020   invalid.       
-0001dbf0: 2073 656c 662e 6572 726f 725f 6d65 7373   self.error_mess
-0001dc00: 6167 6520 3d20 6572 726f 725f 6d65 7373  age = error_mess
-0001dc10: 6167 650a 2020 2020 2020 2020 7365 6c66  age.        self
-0001dc20: 2e65 7374 7269 6e67 203d 2065 7320 2023  .estring = es  #
-0001dc30: 2072 6574 7572 6e20 6572 726f 7220 6d65   return error me
-0001dc40: 7373 6167 6520 6173 2073 7472 696e 6720  ssage as string 
-0001dc50: 2866 6f72 2064 6f63 7465 7374 290a 0a20  (for doctest).. 
-0001dc60: 2020 2064 6566 2076 616c 6964 6174 6528     def validate(
-0001dc70: 7365 6c66 2c20 7661 6c75 652c 2072 6563  self, value, rec
-0001dc80: 6f72 645f 6964 3d4e 6f6e 6529 3a0a 2020  ord_id=None):.  
-0001dc90: 2020 2020 2020 6661 696c 7572 6573 203d        failures =
-0001dca0: 205b 5d0a 2020 2020 2020 2020 6966 2076   [].        if v
-0001dcb0: 616c 7565 2069 7320 4e6f 6e65 3a0a 2020  alue is None:.  
-0001dcc0: 2020 2020 2020 2020 2020 7661 6c75 6520            value 
-0001dcd0: 3d20 2222 0a20 2020 2020 2020 2069 6620  = "".        if 
-0001dce0: 7661 6c75 6520 616e 6420 6c65 6e28 7661  value and len(va
-0001dcf0: 6c75 6529 203d 3d20 7661 6c75 652e 636f  lue) == value.co
-0001dd00: 756e 7428 222a 2229 203e 2034 3a0a 2020  unt("*") > 4:.  
-0001dd10: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001dd20: 2076 616c 7565 0a20 2020 2020 2020 2069   value.        i
-0001dd30: 6620 7365 6c66 2e65 6e74 726f 7079 2069  f self.entropy i
-0001dd40: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0001dd50: 2020 2020 2020 2020 656e 7472 6f70 7920          entropy 
-0001dd60: 3d20 6361 6c63 5f65 6e74 726f 7079 2876  = calc_entropy(v
-0001dd70: 616c 7565 290a 2020 2020 2020 2020 2020  alue).          
-0001dd80: 2020 6966 2065 6e74 726f 7079 203c 2073    if entropy < s
-0001dd90: 656c 662e 656e 7472 6f70 793a 0a20 2020  elf.entropy:.   
-0001dda0: 2020 2020 2020 2020 2020 2020 2066 6169               fai
-0001ddb0: 6c75 7265 732e 6170 7065 6e64 280a 2020  lures.append(.  
-0001ddc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ddd0: 2020 7365 6c66 2e74 7261 6e73 6c61 746f    self.translato
-0001dde0: 7228 2250 6173 7377 6f72 6420 746f 6f20  r("Password too 
-0001ddf0: 7369 6d70 6c65 2028 2528 6861 7665 2973  simple (%(have)s
-0001de00: 2f25 286e 6565 6429 7329 2229 0a20 2020  /%(need)s)").   
-0001de10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001de20: 2025 2064 6963 7428 6861 7665 3d65 6e74   % dict(have=ent
-0001de30: 726f 7079 2c20 6e65 6564 3d73 656c 662e  ropy, need=self.
-0001de40: 656e 7472 6f70 7929 0a20 2020 2020 2020  entropy).       
-0001de50: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001de60: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0001de70: 2873 656c 662e 6d69 6e2c 2069 6e74 2920  (self.min, int) 
-0001de80: 616e 6420 7365 6c66 2e6d 696e 203e 2030  and self.min > 0
-0001de90: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0001dea0: 206e 6f74 206c 656e 2876 616c 7565 2920   not len(value) 
-0001deb0: 3e3d 2073 656c 662e 6d69 6e3a 0a20 2020  >= self.min:.   
-0001dec0: 2020 2020 2020 2020 2020 2020 2066 6169               fai
-0001ded0: 6c75 7265 732e 6170 7065 6e64 2873 656c  lures.append(sel
-0001dee0: 662e 7472 616e 736c 6174 6f72 2822 4d69  f.translator("Mi
-0001def0: 6e69 6d75 6d20 6c65 6e67 7468 2069 7320  nimum length is 
-0001df00: 2573 2229 2025 2073 656c 662e 6d69 6e29  %s") % self.min)
-0001df10: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0001df20: 7374 616e 6365 2873 656c 662e 6d61 782c  stance(self.max,
-0001df30: 2069 6e74 2920 616e 6420 7365 6c66 2e6d   int) and self.m
-0001df40: 6178 203e 2030 3a0a 2020 2020 2020 2020  ax > 0:.        
-0001df50: 2020 2020 6966 206e 6f74 206c 656e 2876      if not len(v
-0001df60: 616c 7565 2920 3c3d 2073 656c 662e 6d61  alue) <= self.ma
-0001df70: 783a 0a20 2020 2020 2020 2020 2020 2020  x:.             
-0001df80: 2020 2066 6169 6c75 7265 732e 6170 7065     failures.appe
-0001df90: 6e64 2873 656c 662e 7472 616e 736c 6174  nd(self.translat
-0001dfa0: 6f72 2822 4d61 7869 6d75 6d20 6c65 6e67  or("Maximum leng
-0001dfb0: 7468 2069 7320 2573 2229 2025 2073 656c  th is %s") % sel
-0001dfc0: 662e 6d61 7829 0a20 2020 2020 2020 2069  f.max).        i
-0001dfd0: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
-0001dfe0: 662e 7370 6563 6961 6c2c 2069 6e74 293a  f.special, int):
-0001dff0: 0a20 2020 2020 2020 2020 2020 2061 6c6c  .            all
-0001e000: 5f73 7065 6369 616c 203d 205b 6368 2069  _special = [ch i
-0001e010: 6e20 7661 6c75 6520 666f 7220 6368 2069  n value for ch i
-0001e020: 6e20 7365 6c66 2e73 7065 6369 616c 735d  n self.specials]
-0001e030: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001e040: 7365 6c66 2e73 7065 6369 616c 203e 2030  self.special > 0
-0001e050: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001e060: 2020 6966 206e 6f74 2061 6c6c 5f73 7065    if not all_spe
-0001e070: 6369 616c 2e63 6f75 6e74 2854 7275 6529  cial.count(True)
-0001e080: 203e 3d20 7365 6c66 2e73 7065 6369 616c   >= self.special
-0001e090: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001e0a0: 2020 2020 2020 6661 696c 7572 6573 2e61        failures.a
-0001e0b0: 7070 656e 6428 0a20 2020 2020 2020 2020  ppend(.         
-0001e0c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001e0d0: 656c 662e 7472 616e 736c 6174 6f72 2822  elf.translator("
-0001e0e0: 4d75 7374 2069 6e63 6c75 6465 2061 7420  Must include at 
-0001e0f0: 6c65 6173 7420 2573 206f 6620 7468 6520  least %s of the 
-0001e100: 666f 6c6c 6f77 696e 673a 2025 7322 290a  following: %s").
+00017b60: 2020 2020 2020 2020 2020 2020 666f 726d              form
+00017b70: 6174 3d22 256d 2f25 642f 2559 222c 6572  at="%m/%d/%Y",er
+00017b80: 726f 725f 6d65 7373 6167 653d 224f 6f70  ror_message="Oop
+00017b90: 7322 290a 0a20 2020 2020 2020 2020 2020  s")..           
+00017ba0: 203e 3e3e 2076 2827 3033 2f30 332f 3230   >>> v('03/03/20
+00017bb0: 3038 2729 0a20 2020 2020 2020 2020 2020  08').           
+00017bc0: 2028 6461 7465 7469 6d65 2e64 6174 6528   (datetime.date(
+00017bd0: 3230 3038 2c20 332c 2033 292c 204e 6f6e  2008, 3, 3), Non
+00017be0: 6529 0a0a 2020 2020 2020 2020 2020 2020  e)..            
+00017bf0: 3e3e 3e20 7628 2730 332f 3033 2f32 3031  >>> v('03/03/201
+00017c00: 3027 290a 2020 2020 2020 2020 2020 2020  0').            
+00017c10: 2827 3033 2f30 332f 3230 3130 272c 2027  ('03/03/2010', '
+00017c20: 6f6f 7073 2729 0a0a 2020 2020 2020 2020  oops')..        
+00017c30: 2020 2020 3e3e 3e20 7628 6461 7465 7469      >>> v(dateti
+00017c40: 6d65 2e64 6174 6528 3230 3038 2c33 2c33  me.date(2008,3,3
+00017c50: 2929 0a20 2020 2020 2020 2020 2020 2028  )).            (
+00017c60: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
+00017c70: 3038 2c20 332c 2033 292c 204e 6f6e 6529  08, 3, 3), None)
+00017c80: 0a0a 2020 2020 2020 2020 2020 2020 3e3e  ..            >>
+00017c90: 3e20 7628 6461 7465 7469 6d65 2e64 6174  > v(datetime.dat
+00017ca0: 6528 3230 3130 2c33 2c33 2929 0a20 2020  e(2010,3,3)).   
+00017cb0: 2020 2020 2020 2020 2028 6461 7465 7469           (dateti
+00017cc0: 6d65 2e64 6174 6528 3230 3130 2c20 332c  me.date(2010, 3,
+00017cd0: 2033 292c 2027 6f6f 7073 2729 0a0a 2020   3), 'oops')..  
+00017ce0: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
+00017cf0: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
+00017d00: 2073 656c 662c 206d 696e 696d 756d 3d4e   self, minimum=N
+00017d10: 6f6e 652c 206d 6178 696d 756d 3d4e 6f6e  one, maximum=Non
+00017d20: 652c 2066 6f72 6d61 743d 2225 592d 256d  e, format="%Y-%m
+00017d30: 2d25 6422 2c20 6572 726f 725f 6d65 7373  -%d", error_mess
+00017d40: 6167 653d 4e6f 6e65 0a20 2020 2029 3a0a  age=None.    ):.
+00017d50: 2020 2020 2020 2020 7365 6c66 2e6d 696e          self.min
+00017d60: 696d 756d 203d 206d 696e 696d 756d 0a20  imum = minimum. 
+00017d70: 2020 2020 2020 2073 656c 662e 6d61 7869         self.maxi
+00017d80: 6d75 6d20 3d20 6d61 7869 6d75 6d0a 2020  mum = maximum.  
+00017d90: 2020 2020 2020 6966 2065 7272 6f72 5f6d        if error_m
+00017da0: 6573 7361 6765 2069 7320 4e6f 6e65 3a0a  essage is None:.
+00017db0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+00017dc0: 696e 696d 756d 2069 7320 4e6f 6e65 3a0a  inimum is None:.
+00017dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017de0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00017df0: 2245 6e74 6572 2064 6174 6520 6f6e 206f  "Enter date on o
+00017e00: 7220 6265 666f 7265 2025 286d 6178 2973  r before %(max)s
+00017e10: 220a 2020 2020 2020 2020 2020 2020 656c  ".            el
+00017e20: 6966 206d 6178 696d 756d 2069 7320 4e6f  if maximum is No
+00017e30: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00017e40: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00017e50: 6520 3d20 2245 6e74 6572 2064 6174 6520  e = "Enter date 
+00017e60: 6f6e 206f 7220 6166 7465 7220 2528 6d69  on or after %(mi
+00017e70: 6e29 7322 0a20 2020 2020 2020 2020 2020  n)s".           
+00017e80: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00017e90: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00017ea0: 7361 6765 203d 2022 456e 7465 7220 6461  sage = "Enter da
+00017eb0: 7465 2069 6e20 7261 6e67 6520 2528 6d69  te in range %(mi
+00017ec0: 6e29 7320 2528 6d61 7829 7322 0a20 2020  n)s %(max)s".   
+00017ed0: 2020 2020 2049 535f 4441 5445 2e5f 5f69       IS_DATE.__i
+00017ee0: 6e69 745f 5f28 7365 6c66 2c20 666f 726d  nit__(self, form
+00017ef0: 6174 3d66 6f72 6d61 742c 2065 7272 6f72  at=format, error
+00017f00: 5f6d 6573 7361 6765 3d65 7272 6f72 5f6d  _message=error_m
+00017f10: 6573 7361 6765 290a 2020 2020 2020 2020  essage).        
+00017f20: 7365 6c66 2e65 7874 7265 6d65 7320 3d20  self.extremes = 
+00017f30: 6469 6374 286d 696e 3d73 656c 662e 666f  dict(min=self.fo
+00017f40: 726d 6174 7465 7228 6d69 6e69 6d75 6d29  rmatter(minimum)
+00017f50: 2c20 6d61 783d 7365 6c66 2e66 6f72 6d61  , max=self.forma
+00017f60: 7474 6572 286d 6178 696d 756d 2929 0a0a  tter(maximum))..
+00017f70: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
+00017f80: 2873 656c 662c 2076 616c 7565 2c20 7265  (self, value, re
+00017f90: 636f 7264 5f69 643d 4e6f 6e65 293a 0a20  cord_id=None):. 
+00017fa0: 2020 2020 2020 2076 616c 7565 203d 2049         value = I
+00017fb0: 535f 4441 5445 2e76 616c 6964 6174 6528  S_DATE.validate(
+00017fc0: 7365 6c66 2c20 7661 6c75 652c 2072 6563  self, value, rec
+00017fd0: 6f72 645f 6964 3d4e 6f6e 6529 0a20 2020  ord_id=None).   
+00017fe0: 2020 2020 2069 6620 7365 6c66 2e6d 696e       if self.min
+00017ff0: 696d 756d 2061 6e64 2073 656c 662e 6d69  imum and self.mi
+00018000: 6e69 6d75 6d20 3e20 7661 6c75 653a 0a20  nimum > value:. 
+00018010: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00018020: 2056 616c 6964 6174 696f 6e45 7272 6f72   ValidationError
+00018030: 2873 656c 662e 7472 616e 736c 6174 6f72  (self.translator
+00018040: 2873 656c 662e 6572 726f 725f 6d65 7373  (self.error_mess
+00018050: 6167 6529 2025 2073 656c 662e 6578 7472  age) % self.extr
+00018060: 656d 6573 290a 2020 2020 2020 2020 6966  emes).        if
+00018070: 2073 656c 662e 6d61 7869 6d75 6d20 616e   self.maximum an
+00018080: 6420 7661 6c75 6520 3e20 7365 6c66 2e6d  d value > self.m
+00018090: 6178 696d 756d 3a0a 2020 2020 2020 2020  aximum:.        
+000180a0: 2020 2020 7261 6973 6520 5661 6c69 6461      raise Valida
+000180b0: 7469 6f6e 4572 726f 7228 7365 6c66 2e74  tionError(self.t
+000180c0: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
+000180d0: 7272 6f72 5f6d 6573 7361 6765 2920 2520  rror_message) % 
+000180e0: 7365 6c66 2e65 7874 7265 6d65 7329 0a20  self.extremes). 
+000180f0: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
+00018100: 6c75 650a 0a0a 636c 6173 7320 4953 5f44  lue...class IS_D
+00018110: 4154 4554 494d 455f 494e 5f52 414e 4745  ATETIME_IN_RANGE
+00018120: 2849 535f 4441 5445 5449 4d45 293a 0a20  (IS_DATETIME):. 
+00018130: 2020 2022 2222 0a20 2020 2045 7861 6d70     """.    Examp
+00018140: 6c65 733a 0a20 2020 2020 2020 2055 7365  les:.        Use
+00018150: 2061 733a 3a0a 2020 2020 2020 2020 2020   as::.          
+00018160: 2020 3e3e 3e20 7620 3d20 4953 5f44 4154    >>> v = IS_DAT
+00018170: 4554 494d 455f 494e 5f52 414e 4745 285c  ETIME_IN_RANGE(\
+00018180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018190: 2020 2020 206d 696e 696d 756d 3d64 6174       minimum=dat
+000181a0: 6574 696d 652e 6461 7465 7469 6d65 2832  etime.datetime(2
+000181b0: 3030 382c 312c 312c 3132 2c32 3029 2c20  008,1,1,12,20), 
+000181c0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+000181d0: 2020 2020 2020 6d61 7869 6d75 6d3d 6461        maximum=da
+000181e0: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
+000181f0: 3230 3039 2c31 322c 3331 2c31 322c 3230  2009,12,31,12,20
+00018200: 292c 205c 0a20 2020 2020 2020 2020 2020  ), \.           
+00018210: 2020 2020 2020 2020 2066 6f72 6d61 743d           format=
+00018220: 2225 6d2f 2564 2f25 5920 2548 3a25 4d22  "%m/%d/%Y %H:%M"
+00018230: 2c65 7272 6f72 5f6d 6573 7361 6765 3d22  ,error_message="
+00018240: 4f6f 7073 2229 0a20 2020 2020 2020 2020  Oops").         
+00018250: 2020 203e 3e3e 2076 2827 3033 2f30 332f     >>> v('03/03/
+00018260: 3230 3038 2031 323a 3430 2729 0a20 2020  2008 12:40').   
+00018270: 2020 2020 2020 2020 2028 6461 7465 7469           (dateti
+00018280: 6d65 2e64 6174 6574 696d 6528 3230 3038  me.datetime(2008
+00018290: 2c20 332c 2033 2c20 3132 2c20 3430 292c  , 3, 3, 12, 40),
+000182a0: 204e 6f6e 6529 0a0a 2020 2020 2020 2020   None)..        
+000182b0: 2020 2020 3e3e 3e20 7628 2730 332f 3033      >>> v('03/03
+000182c0: 2f32 3031 3020 3130 3a33 3427 290a 2020  /2010 10:34').  
+000182d0: 2020 2020 2020 2020 2020 2827 3033 2f30            ('03/0
+000182e0: 332f 3230 3130 2031 303a 3334 272c 2027  3/2010 10:34', '
+000182f0: 6f6f 7073 2729 0a0a 2020 2020 2020 2020  oops')..        
+00018300: 2020 2020 3e3e 3e20 7628 6461 7465 7469      >>> v(dateti
+00018310: 6d65 2e64 6174 6574 696d 6528 3230 3038  me.datetime(2008
+00018320: 2c33 2c33 2c30 2c30 2929 0a20 2020 2020  ,3,3,0,0)).     
+00018330: 2020 2020 2020 2028 6461 7465 7469 6d65         (datetime
+00018340: 2e64 6174 6574 696d 6528 3230 3038 2c20  .datetime(2008, 
+00018350: 332c 2033 2c20 302c 2030 292c 204e 6f6e  3, 3, 0, 0), Non
+00018360: 6529 0a0a 2020 2020 2020 2020 2020 2020  e)..            
+00018370: 3e3e 3e20 7628 6461 7465 7469 6d65 2e64  >>> v(datetime.d
+00018380: 6174 6574 696d 6528 3230 3130 2c33 2c33  atetime(2010,3,3
+00018390: 2c30 2c30 2929 0a20 2020 2020 2020 2020  ,0,0)).         
+000183a0: 2020 2028 6461 7465 7469 6d65 2e64 6174     (datetime.dat
+000183b0: 6574 696d 6528 3230 3130 2c20 332c 2033  etime(2010, 3, 3
+000183c0: 2c20 302c 2030 292c 2027 6f6f 7073 2729  , 0, 0), 'oops')
+000183d0: 0a0a 2020 2020 2222 220a 0a20 2020 2064  ..    """..    d
+000183e0: 6566 205f 5f69 6e69 745f 5f28 0a20 2020  ef __init__(.   
+000183f0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00018400: 2020 206d 696e 696d 756d 3d4e 6f6e 652c     minimum=None,
+00018410: 0a20 2020 2020 2020 206d 6178 696d 756d  .        maximum
+00018420: 3d4e 6f6e 652c 0a20 2020 2020 2020 2066  =None,.        f
+00018430: 6f72 6d61 743d 2225 592d 256d 2d25 6420  ormat="%Y-%m-%d 
+00018440: 2548 3a25 4d3a 2553 222c 0a20 2020 2020  %H:%M:%S",.     
+00018450: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00018460: 3d4e 6f6e 652c 0a20 2020 2020 2020 2074  =None,.        t
+00018470: 696d 657a 6f6e 653d 4e6f 6e65 2c0a 2020  imezone=None,.  
+00018480: 2020 293a 0a20 2020 2020 2020 2073 656c    ):.        sel
+00018490: 662e 6d69 6e69 6d75 6d20 3d20 6d69 6e69  f.minimum = mini
+000184a0: 6d75 6d0a 2020 2020 2020 2020 7365 6c66  mum.        self
+000184b0: 2e6d 6178 696d 756d 203d 206d 6178 696d  .maximum = maxim
+000184c0: 756d 0a20 2020 2020 2020 2069 6620 6572  um.        if er
+000184d0: 726f 725f 6d65 7373 6167 6520 6973 204e  ror_message is N
+000184e0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000184f0: 2069 6620 6d69 6e69 6d75 6d20 6973 204e   if minimum is N
+00018500: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00018510: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00018520: 6765 203d 2022 456e 7465 7220 6461 7465  ge = "Enter date
+00018530: 2061 6e64 2074 696d 6520 6f6e 206f 7220   and time on or 
+00018540: 6265 666f 7265 2025 286d 6178 2973 220a  before %(max)s".
+00018550: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00018560: 206d 6178 696d 756d 2069 7320 4e6f 6e65   maximum is None
+00018570: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018580: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00018590: 3d20 2245 6e74 6572 2064 6174 6520 616e  = "Enter date an
+000185a0: 6420 7469 6d65 206f 6e20 6f72 2061 6674  d time on or aft
+000185b0: 6572 2025 286d 696e 2973 220a 2020 2020  er %(min)s".    
+000185c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000185d0: 2020 2020 2020 2020 2020 2020 2020 6572                er
+000185e0: 726f 725f 6d65 7373 6167 6520 3d20 2245  ror_message = "E
+000185f0: 6e74 6572 2064 6174 6520 616e 6420 7469  nter date and ti
+00018600: 6d65 2069 6e20 7261 6e67 6520 2528 6d69  me in range %(mi
+00018610: 6e29 7320 2528 6d61 7829 7322 0a20 2020  n)s %(max)s".   
+00018620: 2020 2020 2049 535f 4441 5445 5449 4d45       IS_DATETIME
+00018630: 2e5f 5f69 6e69 745f 5f28 0a20 2020 2020  .__init__(.     
+00018640: 2020 2020 2020 2073 656c 662c 2066 6f72         self, for
+00018650: 6d61 743d 666f 726d 6174 2c20 6572 726f  mat=format, erro
+00018660: 725f 6d65 7373 6167 653d 6572 726f 725f  r_message=error_
+00018670: 6d65 7373 6167 652c 2074 696d 657a 6f6e  message, timezon
+00018680: 653d 7469 6d65 7a6f 6e65 0a20 2020 2020  e=timezone.     
+00018690: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+000186a0: 662e 6578 7472 656d 6573 203d 2064 6963  f.extremes = dic
+000186b0: 7428 6d69 6e3d 7365 6c66 2e66 6f72 6d61  t(min=self.forma
+000186c0: 7474 6572 286d 696e 696d 756d 292c 206d  tter(minimum), m
+000186d0: 6178 3d73 656c 662e 666f 726d 6174 7465  ax=self.formatte
+000186e0: 7228 6d61 7869 6d75 6d29 290a 0a20 2020  r(maximum))..   
+000186f0: 2064 6566 2076 616c 6964 6174 6528 7365   def validate(se
+00018700: 6c66 2c20 7661 6c75 652c 2072 6563 6f72  lf, value, recor
+00018710: 645f 6964 3d4e 6f6e 6529 3a0a 2020 2020  d_id=None):.    
+00018720: 2020 2020 7661 6c75 6520 3d20 4953 5f44      value = IS_D
+00018730: 4154 4554 494d 452e 7661 6c69 6461 7465  ATETIME.validate
+00018740: 2873 656c 662c 2076 616c 7565 2c20 7265  (self, value, re
+00018750: 636f 7264 5f69 643d 4e6f 6e65 290a 2020  cord_id=None).  
+00018760: 2020 2020 2020 6966 2073 656c 662e 6d69        if self.mi
+00018770: 6e69 6d75 6d20 616e 6420 7365 6c66 2e6d  nimum and self.m
+00018780: 696e 696d 756d 203e 2076 616c 7565 3a0a  inimum > value:.
+00018790: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000187a0: 6520 5661 6c69 6461 7469 6f6e 4572 726f  e ValidationErro
+000187b0: 7228 7365 6c66 2e74 7261 6e73 6c61 746f  r(self.translato
+000187c0: 7228 7365 6c66 2e65 7272 6f72 5f6d 6573  r(self.error_mes
+000187d0: 7361 6765 2920 2520 7365 6c66 2e65 7874  sage) % self.ext
+000187e0: 7265 6d65 7329 0a20 2020 2020 2020 2069  remes).        i
+000187f0: 6620 7365 6c66 2e6d 6178 696d 756d 2061  f self.maximum a
+00018800: 6e64 2076 616c 7565 203e 2073 656c 662e  nd value > self.
+00018810: 6d61 7869 6d75 6d3a 0a20 2020 2020 2020  maximum:.       
+00018820: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
+00018830: 6174 696f 6e45 7272 6f72 2873 656c 662e  ationError(self.
+00018840: 7472 616e 736c 6174 6f72 2873 656c 662e  translator(self.
+00018850: 6572 726f 725f 6d65 7373 6167 6529 2025  error_message) %
+00018860: 2073 656c 662e 6578 7472 656d 6573 290a   self.extremes).
+00018870: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+00018880: 616c 7565 0a0a 0a63 6c61 7373 2049 535f  alue...class IS_
+00018890: 4c49 5354 5f4f 4628 5661 6c69 6461 746f  LIST_OF(Validato
+000188a0: 7229 3a0a 2020 2020 6465 6620 5f5f 696e  r):.    def __in
+000188b0: 6974 5f5f 2873 656c 662c 206f 7468 6572  it__(self, other
+000188c0: 3d4e 6f6e 652c 206d 696e 696d 756d 3d4e  =None, minimum=N
+000188d0: 6f6e 652c 206d 6178 696d 756d 3d4e 6f6e  one, maximum=Non
+000188e0: 652c 2065 7272 6f72 5f6d 6573 7361 6765  e, error_message
+000188f0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00018900: 7365 6c66 2e6f 7468 6572 203d 206f 7468  self.other = oth
+00018910: 6572 0a20 2020 2020 2020 2073 656c 662e  er.        self.
+00018920: 6d69 6e69 6d75 6d20 3d20 6d69 6e69 6d75  minimum = minimu
+00018930: 6d0a 2020 2020 2020 2020 7365 6c66 2e6d  m.        self.m
+00018940: 6178 696d 756d 203d 206d 6178 696d 756d  aximum = maximum
+00018950: 0a20 2020 2020 2020 2073 656c 662e 6572  .        self.er
+00018960: 726f 725f 6d65 7373 6167 6520 3d20 6572  ror_message = er
+00018970: 726f 725f 6d65 7373 6167 650a 0a20 2020  ror_message..   
+00018980: 2064 6566 2076 616c 6964 6174 6528 7365   def validate(se
+00018990: 6c66 2c20 7661 6c75 652c 2072 6563 6f72  lf, value, recor
+000189a0: 645f 6964 3d4e 6f6e 6529 3a0a 2020 2020  d_id=None):.    
+000189b0: 2020 2020 6976 616c 7565 203d 2076 616c      ivalue = val
+000189c0: 7565 0a20 2020 2020 2020 2069 6620 6e6f  ue.        if no
+000189d0: 7420 6973 696e 7374 616e 6365 2876 616c  t isinstance(val
+000189e0: 7565 2c20 6c69 7374 293a 0a20 2020 2020  ue, list):.     
+000189f0: 2020 2020 2020 2069 7661 6c75 6520 3d20         ivalue = 
+00018a00: 5b69 7661 6c75 655d 0a20 2020 2020 2020  [ivalue].       
+00018a10: 2069 7661 6c75 6520 3d20 5b69 2066 6f72   ivalue = [i for
+00018a20: 2069 2069 6e20 6976 616c 7565 2069 6620   i in ivalue if 
+00018a30: 7374 7228 6929 2e73 7472 6970 2829 5d0a  str(i).strip()].
+00018a40: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00018a50: 6d69 6e69 6d75 6d20 6973 206e 6f74 204e  minimum is not N
+00018a60: 6f6e 6520 616e 6420 6c65 6e28 6976 616c  one and len(ival
+00018a70: 7565 2920 3c20 7365 6c66 2e6d 696e 696d  ue) < self.minim
+00018a80: 756d 3a0a 2020 2020 2020 2020 2020 2020  um:.            
+00018a90: 7261 6973 6520 5661 6c69 6461 7469 6f6e  raise Validation
+00018aa0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00018ab0: 2020 2020 2020 2073 656c 662e 7472 616e         self.tran
+00018ac0: 736c 6174 6f72 2873 656c 662e 6572 726f  slator(self.erro
+00018ad0: 725f 6d65 7373 6167 6520 6f72 2022 4d69  r_message or "Mi
+00018ae0: 6e69 6d75 6d20 6c65 6e67 7468 2069 7320  nimum length is 
+00018af0: 2528 6d69 6e29 7322 290a 2020 2020 2020  %(min)s").      
+00018b00: 2020 2020 2020 2020 2020 2520 6469 6374            % dict
+00018b10: 286d 696e 3d73 656c 662e 6d69 6e69 6d75  (min=self.minimu
+00018b20: 6d2c 206d 6178 3d73 656c 662e 6d61 7869  m, max=self.maxi
+00018b30: 6d75 6d29 0a20 2020 2020 2020 2020 2020  mum).           
+00018b40: 2029 0a20 2020 2020 2020 2069 6620 7365   ).        if se
+00018b50: 6c66 2e6d 6178 696d 756d 2069 7320 6e6f  lf.maximum is no
+00018b60: 7420 4e6f 6e65 2061 6e64 206c 656e 2869  t None and len(i
+00018b70: 7661 6c75 6529 203e 2073 656c 662e 6d61  value) > self.ma
+00018b80: 7869 6d75 6d3a 0a20 2020 2020 2020 2020  ximum:.         
+00018b90: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
+00018ba0: 696f 6e45 7272 6f72 280a 2020 2020 2020  ionError(.      
+00018bb0: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+00018bc0: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
+00018bd0: 7272 6f72 5f6d 6573 7361 6765 206f 7220  rror_message or 
+00018be0: 224d 6178 696d 756d 206c 656e 6774 6820  "Maximum length 
+00018bf0: 6973 2025 286d 6178 2973 2229 0a20 2020  is %(max)s").   
+00018c00: 2020 2020 2020 2020 2020 2020 2025 2064               % d
+00018c10: 6963 7428 6d69 6e3d 7365 6c66 2e6d 696e  ict(min=self.min
+00018c20: 696d 756d 2c20 6d61 783d 7365 6c66 2e6d  imum, max=self.m
+00018c30: 6178 696d 756d 290a 2020 2020 2020 2020  aximum).        
+00018c40: 2020 2020 290a 2020 2020 2020 2020 6e65      ).        ne
+00018c50: 775f 7661 6c75 6520 3d20 5b5d 0a20 2020  w_value = [].   
+00018c60: 2020 2020 206f 7468 6572 203d 2073 656c       other = sel
+00018c70: 662e 6f74 6865 720a 2020 2020 2020 2020  f.other.        
+00018c80: 6966 2073 656c 662e 6f74 6865 723a 0a20  if self.other:. 
+00018c90: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00018ca0: 7420 6973 696e 7374 616e 6365 286f 7468  t isinstance(oth
+00018cb0: 6572 2c20 286c 6973 742c 2074 7570 6c65  er, (list, tuple
+00018cc0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00018cd0: 2020 2020 6f74 6865 7220 3d20 5b6f 7468      other = [oth
+00018ce0: 6572 5d0a 2020 2020 2020 2020 2020 2020  er].            
+00018cf0: 666f 7220 6974 656d 2069 6e20 6976 616c  for item in ival
+00018d00: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
+00018d10: 2020 2020 7620 3d20 6974 656d 0a20 2020      v = item.   
+00018d20: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00018d30: 2076 616c 6964 6174 6f72 2069 6e20 6f74   validator in ot
+00018d40: 6865 723a 0a20 2020 2020 2020 2020 2020  her:.           
+00018d50: 2020 2020 2020 2020 2076 203d 2076 616c           v = val
+00018d60: 6964 6174 6f72 5f63 616c 6c65 7228 7661  idator_caller(va
+00018d70: 6c69 6461 746f 722c 2076 2c20 7265 636f  lidator, v, reco
+00018d80: 7264 5f69 6429 0a20 2020 2020 2020 2020  rd_id).         
+00018d90: 2020 2020 2020 206e 6577 5f76 616c 7565         new_value
+00018da0: 2e61 7070 656e 6428 7629 0a20 2020 2020  .append(v).     
+00018db0: 2020 2020 2020 2069 7661 6c75 6520 3d20         ivalue = 
+00018dc0: 6e65 775f 7661 6c75 650a 2020 2020 2020  new_value.      
+00018dd0: 2020 7265 7475 726e 2069 7661 6c75 650a    return ivalue.
+00018de0: 0a0a 636c 6173 7320 4953 5f4c 4f57 4552  ..class IS_LOWER
+00018df0: 2856 616c 6964 6174 6f72 293a 0a20 2020  (Validator):.   
+00018e00: 2022 2222 0a20 2020 2043 6f6e 7665 7274   """.    Convert
+00018e10: 7320 746f 206c 6f77 6572 6361 7365 3a3a  s to lowercase::
+00018e20: 0a0a 2020 2020 2020 2020 3e3e 3e20 4953  ..        >>> IS
+00018e30: 5f4c 4f57 4552 2829 2827 4142 4327 290a  _LOWER()('ABC').
+00018e40: 2020 2020 2020 2020 2827 6162 6327 2c20          ('abc', 
+00018e50: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+00018e60: 3e20 4953 5f4c 4f57 4552 2829 2827 c391  > IS_LOWER()('..
+00018e70: 2729 0a20 2020 2020 2020 2028 275c 5c78  ').        ('\\x
+00018e80: 6333 5c5c 7862 3127 2c20 4e6f 6e65 290a  c3\\xb1', None).
+00018e90: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
+00018ea0: 6620 7661 6c69 6461 7465 2873 656c 662c  f validate(self,
+00018eb0: 2076 616c 7565 2c20 7265 636f 7264 5f69   value, record_i
+00018ec0: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
+00018ed0: 2063 6173 745f 6261 636b 203d 206c 616d   cast_back = lam
+00018ee0: 6264 6120 783a 2078 0a20 2020 2020 2020  bda x: x.       
+00018ef0: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
+00018f00: 616c 7565 2c20 7374 7229 3a0a 2020 2020  alue, str):.    
+00018f10: 2020 2020 2020 2020 6361 7374 5f62 6163          cast_bac
+00018f20: 6b20 3d20 746f 5f6e 6174 6976 650a 2020  k = to_native.  
+00018f30: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00018f40: 7461 6e63 6528 7661 6c75 652c 2062 7974  tance(value, byt
+00018f50: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+00018f60: 2063 6173 745f 6261 636b 203d 2074 6f5f   cast_back = to_
+00018f70: 6279 7465 730a 2020 2020 2020 2020 7661  bytes.        va
+00018f80: 6c75 6520 3d20 746f 5f75 6e69 636f 6465  lue = to_unicode
+00018f90: 2876 616c 7565 292e 6c6f 7765 7228 290a  (value).lower().
+00018fa0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+00018fb0: 6173 745f 6261 636b 2876 616c 7565 290a  ast_back(value).
+00018fc0: 0a0a 636c 6173 7320 4953 5f55 5050 4552  ..class IS_UPPER
+00018fd0: 2856 616c 6964 6174 6f72 293a 0a20 2020  (Validator):.   
+00018fe0: 2022 2222 0a20 2020 2043 6f6e 7665 7274   """.    Convert
+00018ff0: 7320 746f 2075 7070 6572 6361 7365 3a3a  s to uppercase::
+00019000: 0a0a 2020 2020 2020 2020 3e3e 3e20 4953  ..        >>> IS
+00019010: 5f55 5050 4552 2829 2827 6162 6327 290a  _UPPER()('abc').
+00019020: 2020 2020 2020 2020 2827 4142 4327 2c20          ('ABC', 
+00019030: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+00019040: 3e20 4953 5f55 5050 4552 2829 2827 c3b1  > IS_UPPER()('..
+00019050: 2729 0a20 2020 2020 2020 2028 275c 5c78  ').        ('\\x
+00019060: 6333 5c5c 7839 3127 2c20 4e6f 6e65 290a  c3\\x91', None).
+00019070: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
+00019080: 6620 7661 6c69 6461 7465 2873 656c 662c  f validate(self,
+00019090: 2076 616c 7565 2c20 7265 636f 7264 5f69   value, record_i
+000190a0: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
+000190b0: 2063 6173 745f 6261 636b 203d 206c 616d   cast_back = lam
+000190c0: 6264 6120 783a 2078 0a20 2020 2020 2020  bda x: x.       
+000190d0: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
+000190e0: 616c 7565 2c20 7374 7229 3a0a 2020 2020  alue, str):.    
+000190f0: 2020 2020 2020 2020 6361 7374 5f62 6163          cast_bac
+00019100: 6b20 3d20 746f 5f6e 6174 6976 650a 2020  k = to_native.  
+00019110: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00019120: 7461 6e63 6528 7661 6c75 652c 2062 7974  tance(value, byt
+00019130: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+00019140: 2063 6173 745f 6261 636b 203d 2074 6f5f   cast_back = to_
+00019150: 6279 7465 730a 2020 2020 2020 2020 7661  bytes.        va
+00019160: 6c75 6520 3d20 746f 5f75 6e69 636f 6465  lue = to_unicode
+00019170: 2876 616c 7565 292e 7570 7065 7228 290a  (value).upper().
+00019180: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+00019190: 6173 745f 6261 636b 2876 616c 7565 290a  ast_back(value).
+000191a0: 0a0a 6465 6620 7572 6c69 6679 2873 2c20  ..def urlify(s, 
+000191b0: 6d61 786c 656e 3d38 302c 206b 6565 705f  maxlen=80, keep_
+000191c0: 756e 6465 7273 636f 7265 733d 4661 6c73  underscores=Fals
+000191d0: 6529 3a0a 2020 2020 2222 220a 2020 2020  e):.    """.    
+000191e0: 436f 6e76 6572 7473 2069 6e63 6f6d 696e  Converts incomin
+000191f0: 6720 7374 7269 6e67 2074 6f20 6120 7369  g string to a si
+00019200: 6d70 6c69 6669 6564 2041 5343 4949 2073  mplified ASCII s
+00019210: 7562 7365 742e 0a20 2020 2069 6620 286b  ubset..    if (k
+00019220: 6565 705f 756e 6465 7273 636f 7265 7329  eep_underscores)
+00019230: 3a20 756e 6465 7273 636f 7265 7320 6172  : underscores ar
+00019240: 6520 7265 7461 696e 6564 2069 6e20 7468  e retained in th
+00019250: 6520 7374 7269 6e67 0a20 2020 2065 6c73  e string.    els
+00019260: 653a 2075 6e64 6572 7363 6f72 6573 2061  e: underscores a
+00019270: 7265 2074 7261 6e73 6c61 7465 6420 746f  re translated to
+00019280: 2068 7970 6865 6e73 2028 6465 6661 756c   hyphens (defaul
+00019290: 7429 0a20 2020 2022 2222 0a20 2020 2073  t).    """.    s
+000192a0: 203d 2074 6f5f 756e 6963 6f64 6528 7329   = to_unicode(s)
+000192b0: 2020 2320 746f 2075 6e69 636f 6465 0a20    # to unicode. 
+000192c0: 2020 2073 203d 2073 2e6c 6f77 6572 2829     s = s.lower()
+000192d0: 2020 2320 746f 206c 6f77 6572 6361 7365    # to lowercase
+000192e0: 0a20 2020 2073 203d 2075 6e69 636f 6465  .    s = unicode
+000192f0: 6461 7461 2e6e 6f72 6d61 6c69 7a65 2822  data.normalize("
+00019300: 4e46 4b44 222c 2073 2920 2023 2072 6570  NFKD", s)  # rep
+00019310: 6c61 6365 2073 7065 6369 616c 2063 6861  lace special cha
+00019320: 7261 6374 6572 730a 2020 2020 7320 3d20  racters.    s = 
+00019330: 746f 5f6e 6174 6976 6528 732c 2063 6861  to_native(s, cha
+00019340: 7273 6574 3d22 6173 6369 6922 2c20 6572  rset="ascii", er
+00019350: 726f 7273 3d22 6967 6e6f 7265 2229 2020  rors="ignore")  
+00019360: 2320 656e 636f 6465 2061 7320 4153 4349  # encode as ASCI
+00019370: 490a 2020 2020 7320 3d20 7265 2e73 7562  I.    s = re.sub
+00019380: 2872 2226 5c77 2b3f 3b22 2c20 2222 2c20  (r"&\w+?;", "", 
+00019390: 7329 2020 2320 7374 7269 7020 6874 6d6c  s)  # strip html
+000193a0: 2065 6e74 6974 6965 730a 2020 2020 6966   entities.    if
+000193b0: 206b 6565 705f 756e 6465 7273 636f 7265   keep_underscore
+000193c0: 733a 0a20 2020 2020 2020 2073 203d 2072  s:.        s = r
+000193d0: 652e 7375 6228 7222 5c73 2b22 2c20 222d  e.sub(r"\s+", "-
+000193e0: 222c 2073 2920 2023 2077 6869 7465 7370  ", s)  # whitesp
+000193f0: 6163 6520 746f 2068 7970 6865 6e73 0a20  ace to hyphens. 
+00019400: 2020 2020 2020 2073 203d 2072 652e 7375         s = re.su
+00019410: 6228 7222 5b5e 5c77 5c2d 5d22 2c20 2222  b(r"[^\w\-]", ""
+00019420: 2c20 7329 0a20 2020 2020 2020 2023 2073  , s).        # s
+00019430: 7472 6970 2061 6c6c 2062 7574 2061 6c70  trip all but alp
+00019440: 6861 6e75 6d65 7269 632f 756e 6465 7273  hanumeric/unders
+00019450: 636f 7265 2f68 7970 6865 6e0a 2020 2020  core/hyphen.    
+00019460: 656c 7365 3a0a 2020 2020 2020 2020 7320  else:.        s 
+00019470: 3d20 7265 2e73 7562 2872 225b 5c73 5f5d  = re.sub(r"[\s_]
+00019480: 2b22 2c20 222d 222c 2073 2920 2023 2077  +", "-", s)  # w
+00019490: 6869 7465 7370 6163 6520 2620 756e 6465  hitespace & unde
+000194a0: 7273 636f 7265 7320 746f 2068 7970 6865  rscores to hyphe
+000194b0: 6e73 0a20 2020 2020 2020 2073 203d 2072  ns.        s = r
+000194c0: 652e 7375 6228 7222 5b5e 612d 7a30 2d39  e.sub(r"[^a-z0-9
+000194d0: 5c2d 5d22 2c20 2222 2c20 7329 2020 2320  \-]", "", s)  # 
+000194e0: 7374 7269 7020 616c 6c20 6275 7420 616c  strip all but al
+000194f0: 7068 616e 756d 6572 6963 2f68 7970 6865  phanumeric/hyphe
+00019500: 6e0a 2020 2020 7320 3d20 7265 2e73 7562  n.    s = re.sub
+00019510: 2872 225b 2d5f 5d5b 2d5f 5d2b 222c 2022  (r"[-_][-_]+", "
+00019520: 2d22 2c20 7329 2020 2320 636f 6c6c 6170  -", s)  # collap
+00019530: 7365 2073 7472 696e 6773 206f 6620 6879  se strings of hy
+00019540: 7068 656e 730a 2020 2020 7320 3d20 732e  phens.    s = s.
+00019550: 7374 7269 7028 222d 2229 2020 2320 7265  strip("-")  # re
+00019560: 6d6f 7665 206c 6561 6469 6e67 2061 6e64  move leading and
+00019570: 2074 7261 696c 696e 6720 6879 7068 656e   trailing hyphen
+00019580: 730a 2020 2020 7265 7475 726e 2073 5b3a  s.    return s[:
+00019590: 6d61 786c 656e 5d20 2023 2065 6e66 6f72  maxlen]  # enfor
+000195a0: 6365 206d 6178 696d 756d 206c 656e 6774  ce maximum lengt
+000195b0: 680a 0a0a 636c 6173 7320 4953 5f53 4c55  h...class IS_SLU
+000195c0: 4728 5661 6c69 6461 746f 7229 3a0a 2020  G(Validator):.  
+000195d0: 2020 2222 220a 2020 2020 636f 6e76 6572    """.    conver
+000195e0: 7473 2061 7262 6974 7261 7279 2074 6578  ts arbitrary tex
+000195f0: 7420 7374 7269 6e67 2074 6f20 6120 736c  t string to a sl
+00019600: 7567 3a3a 0a0a 2020 2020 2020 2020 3e3e  ug::..        >>
+00019610: 3e20 4953 5f53 4c55 4728 2928 2761 6263  > IS_SLUG()('abc
+00019620: 3132 3327 290a 2020 2020 2020 2020 2827  123').        ('
+00019630: 6162 6331 3233 272c 204e 6f6e 6529 0a20  abc123', None). 
+00019640: 2020 2020 2020 203e 3e3e 2049 535f 534c         >>> IS_SL
+00019650: 5547 2829 2827 4142 4331 3233 2729 0a20  UG()('ABC123'). 
+00019660: 2020 2020 2020 2028 2761 6263 3132 3327         ('abc123'
+00019670: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+00019680: 3e3e 3e20 4953 5f53 4c55 4728 2928 2761  >>> IS_SLUG()('a
+00019690: 6263 2d31 3233 2729 0a20 2020 2020 2020  bc-123').       
+000196a0: 2028 2761 6263 2d31 3233 272c 204e 6f6e   ('abc-123', Non
+000196b0: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
+000196c0: 535f 534c 5547 2829 2827 6162 632d 2d31  S_SLUG()('abc--1
+000196d0: 3233 2729 0a20 2020 2020 2020 2028 2761  23').        ('a
+000196e0: 6263 2d31 3233 272c 204e 6f6e 6529 0a20  bc-123', None). 
+000196f0: 2020 2020 2020 203e 3e3e 2049 535f 534c         >>> IS_SL
+00019700: 5547 2829 2827 6162 6320 3132 3327 290a  UG()('abc 123').
+00019710: 2020 2020 2020 2020 2827 6162 632d 3132          ('abc-12
+00019720: 3327 2c20 4e6f 6e65 290a 2020 2020 2020  3', None).      
+00019730: 2020 3e3e 3e20 4953 5f53 4c55 4728 2928    >>> IS_SLUG()(
+00019740: 2761 6263 5c74 5f31 3233 2729 0a20 2020  'abc\t_123').   
+00019750: 2020 2020 2028 2761 6263 2d31 3233 272c       ('abc-123',
+00019760: 204e 6f6e 6529 0a20 2020 2020 2020 203e   None).        >
+00019770: 3e3e 2049 535f 534c 5547 2829 2827 2d61  >> IS_SLUG()('-a
+00019780: 6263 2d27 290a 2020 2020 2020 2020 2827  bc-').        ('
+00019790: 6162 6327 2c20 4e6f 6e65 290a 2020 2020  abc', None).    
+000197a0: 2020 2020 3e3e 3e20 4953 5f53 4c55 4728      >>> IS_SLUG(
+000197b0: 2928 272d 2d61 2d2d 622d 2d5f 202d 632d  )('--a--b--_ -c-
+000197c0: 2d27 290a 2020 2020 2020 2020 2827 612d  -').        ('a-
+000197d0: 622d 6327 2c20 4e6f 6e65 290a 2020 2020  b-c', None).    
+000197e0: 2020 2020 3e3e 3e20 4953 5f53 4c55 4728      >>> IS_SLUG(
+000197f0: 2928 2761 6263 2661 6d70 3b31 3233 2729  )('abc&amp;123')
+00019800: 0a20 2020 2020 2020 2028 2761 6263 3132  .        ('abc12
+00019810: 3327 2c20 4e6f 6e65 290a 2020 2020 2020  3', None).      
+00019820: 2020 3e3e 3e20 4953 5f53 4c55 4728 2928    >>> IS_SLUG()(
+00019830: 2761 6263 2661 6d70 3b31 3233 2661 6d70  'abc&amp;123&amp
+00019840: 3b64 6566 2729 0a20 2020 2020 2020 2028  ;def').        (
+00019850: 2761 6263 3132 3364 6566 272c 204e 6f6e  'abc123def', Non
+00019860: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
+00019870: 535f 534c 5547 2829 2827 c3b1 2729 0a20  S_SLUG()('..'). 
+00019880: 2020 2020 2020 2028 276e 272c 204e 6f6e         ('n', Non
+00019890: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
+000198a0: 535f 534c 5547 286d 6178 6c65 6e3d 3429  S_SLUG(maxlen=4)
+000198b0: 2827 6162 6331 3233 2729 0a20 2020 2020  ('abc123').     
+000198c0: 2020 2028 2761 6263 3127 2c20 4e6f 6e65     ('abc1', None
+000198d0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+000198e0: 5f53 4c55 4728 2928 2761 6263 5f31 3233  _SLUG()('abc_123
+000198f0: 2729 0a20 2020 2020 2020 2028 2761 6263  ').        ('abc
+00019900: 2d31 3233 272c 204e 6f6e 6529 0a20 2020  -123', None).   
+00019910: 2020 2020 203e 3e3e 2049 535f 534c 5547       >>> IS_SLUG
+00019920: 286b 6565 705f 756e 6465 7273 636f 7265  (keep_underscore
+00019930: 733d 4661 6c73 6529 2827 6162 635f 3132  s=False)('abc_12
+00019940: 3327 290a 2020 2020 2020 2020 2827 6162  3').        ('ab
+00019950: 632d 3132 3327 2c20 4e6f 6e65 290a 2020  c-123', None).  
+00019960: 2020 2020 2020 3e3e 3e20 4953 5f53 4c55        >>> IS_SLU
+00019970: 4728 6b65 6570 5f75 6e64 6572 7363 6f72  G(keep_underscor
+00019980: 6573 3d54 7275 6529 2827 6162 635f 3132  es=True)('abc_12
+00019990: 3327 290a 2020 2020 2020 2020 2827 6162  3').        ('ab
+000199a0: 635f 3132 3327 2c20 4e6f 6e65 290a 2020  c_123', None).  
+000199b0: 2020 2020 2020 3e3e 3e20 4953 5f53 4c55        >>> IS_SLU
+000199c0: 4728 6368 6563 6b3d 4661 6c73 6529 2827  G(check=False)('
+000199d0: 6162 6327 290a 2020 2020 2020 2020 2827  abc').        ('
+000199e0: 6162 6327 2c20 4e6f 6e65 290a 2020 2020  abc', None).    
+000199f0: 2020 2020 3e3e 3e20 4953 5f53 4c55 4728      >>> IS_SLUG(
+00019a00: 6368 6563 6b3d 5472 7565 2928 2761 6263  check=True)('abc
+00019a10: 2729 0a20 2020 2020 2020 2028 2761 6263  ').        ('abc
+00019a20: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
+00019a30: 203e 3e3e 2049 535f 534c 5547 2863 6865   >>> IS_SLUG(che
+00019a40: 636b 3d46 616c 7365 2928 2761 2062 6327  ck=False)('a bc'
+00019a50: 290a 2020 2020 2020 2020 2827 612d 6263  ).        ('a-bc
+00019a60: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
+00019a70: 203e 3e3e 2049 535f 534c 5547 2863 6865   >>> IS_SLUG(che
+00019a80: 636b 3d54 7275 6529 2827 6120 6263 2729  ck=True)('a bc')
+00019a90: 0a20 2020 2020 2020 2028 2761 2062 6327  .        ('a bc'
+00019aa0: 2c20 276d 7573 7420 6265 2073 6c75 6727  , 'must be slug'
+00019ab0: 290a 2020 2020 2222 220a 0a20 2020 2040  ).    """..    @
+00019ac0: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+00019ad0: 2064 6566 2075 726c 6966 7928 7661 6c75   def urlify(valu
+00019ae0: 652c 206d 6178 6c65 6e3d 3830 2c20 6b65  e, maxlen=80, ke
+00019af0: 6570 5f75 6e64 6572 7363 6f72 6573 3d46  ep_underscores=F
+00019b00: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
+00019b10: 6574 7572 6e20 7572 6c69 6679 2876 616c  eturn urlify(val
+00019b20: 7565 2c20 6d61 786c 656e 2c20 6b65 6570  ue, maxlen, keep
+00019b30: 5f75 6e64 6572 7363 6f72 6573 290a 0a20  _underscores).. 
+00019b40: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00019b50: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00019b60: 2020 2020 2020 206d 6178 6c65 6e3d 3830         maxlen=80
+00019b70: 2c0a 2020 2020 2020 2020 6368 6563 6b3d  ,.        check=
+00019b80: 4661 6c73 652c 0a20 2020 2020 2020 2065  False,.        e
+00019b90: 7272 6f72 5f6d 6573 7361 6765 3d22 4d75  rror_message="Mu
+00019ba0: 7374 2062 6520 736c 7567 222c 0a20 2020  st be slug",.   
+00019bb0: 2020 2020 206b 6565 705f 756e 6465 7273       keep_unders
+00019bc0: 636f 7265 733d 4661 6c73 652c 0a20 2020  cores=False,.   
+00019bd0: 2029 3a0a 2020 2020 2020 2020 7365 6c66   ):.        self
+00019be0: 2e6d 6178 6c65 6e20 3d20 6d61 786c 656e  .maxlen = maxlen
+00019bf0: 0a20 2020 2020 2020 2073 656c 662e 6368  .        self.ch
+00019c00: 6563 6b20 3d20 6368 6563 6b0a 2020 2020  eck = check.    
+00019c10: 2020 2020 7365 6c66 2e65 7272 6f72 5f6d      self.error_m
+00019c20: 6573 7361 6765 203d 2065 7272 6f72 5f6d  essage = error_m
+00019c30: 6573 7361 6765 0a20 2020 2020 2020 2073  essage.        s
+00019c40: 656c 662e 6b65 6570 5f75 6e64 6572 7363  elf.keep_undersc
+00019c50: 6f72 6573 203d 206b 6565 705f 756e 6465  ores = keep_unde
+00019c60: 7273 636f 7265 730a 0a20 2020 2064 6566  rscores..    def
+00019c70: 2076 616c 6964 6174 6528 7365 6c66 2c20   validate(self, 
+00019c80: 7661 6c75 652c 2072 6563 6f72 645f 6964  value, record_id
+00019c90: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00019ca0: 6966 2073 656c 662e 6368 6563 6b20 616e  if self.check an
+00019cb0: 6420 7661 6c75 6520 213d 2075 726c 6966  d value != urlif
+00019cc0: 7928 7661 6c75 652c 2073 656c 662e 6d61  y(value, self.ma
+00019cd0: 786c 656e 2c20 7365 6c66 2e6b 6565 705f  xlen, self.keep_
+00019ce0: 756e 6465 7273 636f 7265 7329 3a0a 2020  underscores):.  
+00019cf0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00019d00: 5661 6c69 6461 7469 6f6e 4572 726f 7228  ValidationError(
+00019d10: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
+00019d20: 7365 6c66 2e65 7272 6f72 5f6d 6573 7361  self.error_messa
+00019d30: 6765 2929 0a20 2020 2020 2020 2072 6574  ge)).        ret
+00019d40: 7572 6e20 7572 6c69 6679 2876 616c 7565  urn urlify(value
+00019d50: 2c20 7365 6c66 2e6d 6178 6c65 6e2c 2073  , self.maxlen, s
+00019d60: 656c 662e 6b65 6570 5f75 6e64 6572 7363  elf.keep_undersc
+00019d70: 6f72 6573 290a 0a0a 636c 6173 7320 414e  ores)...class AN
+00019d80: 595f 4f46 2856 616c 6964 6174 6f72 293a  Y_OF(Validator):
+00019d90: 0a20 2020 2022 2222 0a20 2020 2054 6573  .    """.    Tes
+00019da0: 7473 2069 6620 616e 7920 6f66 2074 6865  ts if any of the
+00019db0: 2076 616c 6964 6174 6f72 7320 696e 2061   validators in a
+00019dc0: 206c 6973 7420 7265 7475 726e 7320 7375   list returns su
+00019dd0: 6363 6573 7366 756c 6c79 3a3a 0a0a 2020  ccessfully::..  
+00019de0: 2020 2020 2020 3e3e 3e20 414e 595f 4f46        >>> ANY_OF
+00019df0: 285b 4953 5f45 4d41 494c 2829 2c49 535f  ([IS_EMAIL(),IS_
+00019e00: 414c 5048 414e 554d 4552 4943 2829 5d29  ALPHANUMERIC()])
+00019e10: 2827 6140 622e 636f 2729 0a20 2020 2020  ('a@b.co').     
+00019e20: 2020 2028 2761 4062 2e63 6f27 2c20 4e6f     ('a@b.co', No
+00019e30: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
+00019e40: 414e 595f 4f46 285b 4953 5f45 4d41 494c  ANY_OF([IS_EMAIL
+00019e50: 2829 2c49 535f 414c 5048 414e 554d 4552  (),IS_ALPHANUMER
+00019e60: 4943 2829 5d29 2827 6162 636f 2729 0a20  IC()])('abco'). 
+00019e70: 2020 2020 2020 2028 2761 6263 6f27 2c20         ('abco', 
+00019e80: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+00019e90: 3e20 414e 595f 4f46 285b 4953 5f45 4d41  > ANY_OF([IS_EMA
+00019ea0: 494c 2829 2c49 535f 414c 5048 414e 554d  IL(),IS_ALPHANUM
+00019eb0: 4552 4943 2829 5d29 2827 4061 622e 636f  ERIC()])('@ab.co
+00019ec0: 2729 0a20 2020 2020 2020 2028 2740 6162  ').        ('@ab
+00019ed0: 2e63 6f27 2c20 2765 6e74 6572 206f 6e6c  .co', 'enter onl
+00019ee0: 7920 6c65 7474 6572 732c 206e 756d 6265  y letters, numbe
+00019ef0: 7273 2c20 616e 6420 756e 6465 7273 636f  rs, and undersco
+00019f00: 7265 2729 0a20 2020 2020 2020 203e 3e3e  re').        >>>
+00019f10: 2041 4e59 5f4f 4628 5b49 535f 414c 5048   ANY_OF([IS_ALPH
+00019f20: 414e 554d 4552 4943 2829 2c49 535f 454d  ANUMERIC(),IS_EM
+00019f30: 4149 4c28 295d 2928 2740 6162 2e63 6f27  AIL()])('@ab.co'
+00019f40: 290a 2020 2020 2020 2020 2827 4061 622e  ).        ('@ab.
+00019f50: 636f 272c 2027 656e 7465 7220 6120 7661  co', 'enter a va
+00019f60: 6c69 6420 656d 6169 6c20 6164 6472 6573  lid email addres
+00019f70: 7327 290a 0a20 2020 2022 2222 0a0a 2020  s')..    """..  
+00019f80: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00019f90: 656c 662c 2073 7562 732c 2065 7272 6f72  elf, subs, error
+00019fa0: 5f6d 6573 7361 6765 3d4e 6f6e 6529 3a0a  _message=None):.
+00019fb0: 2020 2020 2020 2020 7365 6c66 2e73 7562          self.sub
+00019fc0: 7320 3d20 7375 6273 0a20 2020 2020 2020  s = subs.       
+00019fd0: 2073 656c 662e 6572 726f 725f 6d65 7373   self.error_mess
+00019fe0: 6167 6520 3d20 6572 726f 725f 6d65 7373  age = error_mess
+00019ff0: 6167 650a 0a20 2020 2064 6566 2076 616c  age..    def val
+0001a000: 6964 6174 6528 7365 6c66 2c20 7661 6c75  idate(self, valu
+0001a010: 652c 2072 6563 6f72 645f 6964 3d4e 6f6e  e, record_id=Non
+0001a020: 6529 3a0a 2020 2020 2020 2020 666f 7220  e):.        for 
+0001a030: 7661 6c69 6461 746f 7220 696e 2073 656c  validator in sel
+0001a040: 662e 7375 6273 3a0a 2020 2020 2020 2020  f.subs:.        
+0001a050: 2020 2020 762c 2065 203d 2076 616c 6964      v, e = valid
+0001a060: 6174 6f72 2876 616c 7565 290a 2020 2020  ator(value).    
+0001a070: 2020 2020 2020 2020 6966 206e 6f74 2065          if not e
+0001a080: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001a090: 2020 7265 7475 726e 2076 0a20 2020 2020    return v.     
+0001a0a0: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
+0001a0b0: 696f 6e45 7272 6f72 2865 290a 0a20 2020  ionError(e)..   
+0001a0c0: 2064 6566 2066 6f72 6d61 7474 6572 2873   def formatter(s
+0001a0d0: 656c 662c 2076 616c 7565 293a 0a20 2020  elf, value):.   
+0001a0e0: 2020 2020 2023 2055 7365 2074 6865 2066       # Use the f
+0001a0f0: 6f72 6d61 7474 6572 206f 6620 7468 6520  ormatter of the 
+0001a100: 6669 7273 7420 7375 6276 616c 6964 6174  first subvalidat
+0001a110: 6f72 0a20 2020 2020 2020 2023 2074 6861  or.        # tha
+0001a120: 7420 7661 6c69 6461 7465 7320 7468 6520  t validates the 
+0001a130: 7661 6c75 6520 616e 6420 6861 7320 6120  value and has a 
+0001a140: 666f 726d 6174 7465 720a 2020 2020 2020  formatter.      
+0001a150: 2020 666f 7220 7661 6c69 6461 746f 7220    for validator 
+0001a160: 696e 2073 656c 662e 7375 6273 3a0a 2020  in self.subs:.  
+0001a170: 2020 2020 2020 2020 2020 6966 2068 6173            if has
+0001a180: 6174 7472 2876 616c 6964 6174 6f72 2c20  attr(validator, 
+0001a190: 2266 6f72 6d61 7474 6572 2229 2061 6e64  "formatter") and
+0001a1a0: 2076 616c 6964 6174 6f72 2876 616c 7565   validator(value
+0001a1b0: 295b 315d 2069 7320 4e6f 6e65 3a0a 2020  )[1] is None:.  
+0001a1c0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001a1d0: 7475 726e 2076 616c 6964 6174 6f72 2e66  turn validator.f
+0001a1e0: 6f72 6d61 7474 6572 2876 616c 7565 290a  ormatter(value).
+0001a1f0: 0a0a 636c 6173 7320 4953 5f45 4d50 5459  ..class IS_EMPTY
+0001a200: 5f4f 5228 5661 6c69 6461 746f 7229 3a0a  _OR(Validator):.
+0001a210: 2020 2020 2222 220a 2020 2020 4475 6d6d      """.    Dumm
+0001a220: 7920 636c 6173 7320 666f 7220 7465 7374  y class for test
+0001a230: 696e 6720 4953 5f45 4d50 5459 5f4f 523a  ing IS_EMPTY_OR:
+0001a240: 3a0a 0a20 2020 2020 2020 203e 3e3e 2049  :..        >>> I
+0001a250: 535f 454d 5054 595f 4f52 2849 535f 454d  S_EMPTY_OR(IS_EM
+0001a260: 4149 4c28 2929 2827 6162 6340 6465 662e  AIL())('abc@def.
+0001a270: 636f 6d27 290a 2020 2020 2020 2020 2827  com').        ('
+0001a280: 6162 6340 6465 662e 636f 6d27 2c20 4e6f  abc@def.com', No
+0001a290: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
+0001a2a0: 4953 5f45 4d50 5459 5f4f 5228 4953 5f45  IS_EMPTY_OR(IS_E
+0001a2b0: 4d41 494c 2829 2928 2720 2020 2729 0a20  MAIL())('   '). 
+0001a2c0: 2020 2020 2020 2028 4e6f 6e65 2c20 4e6f         (None, No
+0001a2d0: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
+0001a2e0: 4953 5f45 4d50 5459 5f4f 5228 4953 5f45  IS_EMPTY_OR(IS_E
+0001a2f0: 4d41 494c 2829 2c20 6e75 6c6c 3d27 6162  MAIL(), null='ab
+0001a300: 6327 2928 2720 2020 2729 0a20 2020 2020  c')('   ').     
+0001a310: 2020 2028 2761 6263 272c 204e 6f6e 6529     ('abc', None)
+0001a320: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+0001a330: 454d 5054 595f 4f52 2849 535f 454d 4149  EMPTY_OR(IS_EMAI
+0001a340: 4c28 292c 206e 756c 6c3d 2761 6263 272c  L(), null='abc',
+0001a350: 2065 6d70 7479 5f72 6567 6578 3d27 6465   empty_regex='de
+0001a360: 6627 2928 2764 6566 2729 0a20 2020 2020  f')('def').     
+0001a370: 2020 2028 2761 6263 272c 204e 6f6e 6529     ('abc', None)
+0001a380: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+0001a390: 454d 5054 595f 4f52 2849 535f 454d 4149  EMPTY_OR(IS_EMAI
+0001a3a0: 4c28 2929 2827 6162 6327 290a 2020 2020  L())('abc').    
+0001a3b0: 2020 2020 2827 6162 6327 2c20 2765 6e74      ('abc', 'ent
+0001a3c0: 6572 2061 2076 616c 6964 2065 6d61 696c  er a valid email
+0001a3d0: 2061 6464 7265 7373 2729 0a20 2020 2020   address').     
+0001a3e0: 2020 203e 3e3e 2049 535f 454d 5054 595f     >>> IS_EMPTY_
+0001a3f0: 4f52 2849 535f 454d 4149 4c28 2929 2827  OR(IS_EMAIL())('
+0001a400: 2061 6263 2027 290a 2020 2020 2020 2020   abc ').        
+0001a410: 2827 6162 6327 2c20 2765 6e74 6572 2061  ('abc', 'enter a
+0001a420: 2076 616c 6964 2065 6d61 696c 2061 6464   valid email add
+0001a430: 7265 7373 2729 0a20 2020 2022 2222 0a0a  ress').    """..
+0001a440: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+0001a450: 2873 656c 662c 206f 7468 6572 2c20 6e75  (self, other, nu
+0001a460: 6c6c 3d4e 6f6e 652c 2065 6d70 7479 5f72  ll=None, empty_r
+0001a470: 6567 6578 3d4e 6f6e 6529 3a0a 2020 2020  egex=None):.    
+0001a480: 2020 2020 2873 656c 662e 6f74 6865 722c      (self.other,
+0001a490: 2073 656c 662e 6e75 6c6c 2920 3d20 286f   self.null) = (o
+0001a4a0: 7468 6572 2c20 6e75 6c6c 290a 2020 2020  ther, null).    
+0001a4b0: 2020 2020 6966 2065 6d70 7479 5f72 6567      if empty_reg
+0001a4c0: 6578 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ex is not None:.
+0001a4d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a4e0: 2e65 6d70 7479 5f72 6567 6578 203d 2072  .empty_regex = r
+0001a4f0: 652e 636f 6d70 696c 6528 656d 7074 795f  e.compile(empty_
+0001a500: 7265 6765 7829 0a20 2020 2020 2020 2065  regex).        e
+0001a510: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001a520: 2073 656c 662e 656d 7074 795f 7265 6765   self.empty_rege
+0001a530: 7820 3d20 4e6f 6e65 0a20 2020 2020 2020  x = None.       
+0001a540: 2069 6620 6861 7361 7474 7228 6f74 6865   if hasattr(othe
+0001a550: 722c 2022 6d75 6c74 6970 6c65 2229 3a0a  r, "multiple"):.
+0001a560: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a570: 2e6d 756c 7469 706c 6520 3d20 6f74 6865  .multiple = othe
+0001a580: 722e 6d75 6c74 6970 6c65 0a20 2020 2020  r.multiple.     
+0001a590: 2020 2069 6620 6861 7361 7474 7228 6f74     if hasattr(ot
+0001a5a0: 6865 722c 2022 6f70 7469 6f6e 7322 293a  her, "options"):
+0001a5b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001a5c0: 662e 6f70 7469 6f6e 7320 3d20 7365 6c66  f.options = self
+0001a5d0: 2e5f 6f70 7469 6f6e 730a 0a20 2020 2064  ._options..    d
+0001a5e0: 6566 205f 6f70 7469 6f6e 7328 7365 6c66  ef _options(self
+0001a5f0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+0001a600: 7329 3a0a 2020 2020 2020 2020 6f70 7469  s):.        opti
+0001a610: 6f6e 7320 3d20 7365 6c66 2e6f 7468 6572  ons = self.other
+0001a620: 2e6f 7074 696f 6e73 282a 6172 6773 2c20  .options(*args, 
+0001a630: 2a2a 6b77 6172 6773 290a 2020 2020 2020  **kwargs).      
+0001a640: 2020 6966 2028 6e6f 7420 6f70 7469 6f6e    if (not option
+0001a650: 7320 6f72 206f 7074 696f 6e73 5b30 5d5b  s or options[0][
+0001a660: 305d 2021 3d20 2222 2920 616e 6420 6e6f  0] != "") and no
+0001a670: 7420 7365 6c66 2e6d 756c 7469 706c 653a  t self.multiple:
+0001a680: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+0001a690: 696f 6e73 2e69 6e73 6572 7428 302c 2028  ions.insert(0, (
+0001a6a0: 2222 2c20 2222 2929 0a20 2020 2020 2020  "", "")).       
+0001a6b0: 2072 6574 7572 6e20 6f70 7469 6f6e 730a   return options.
+0001a6c0: 0a20 2020 2064 6566 2073 6574 5f73 656c  .    def set_sel
+0001a6d0: 665f 6964 2873 656c 662c 2069 6429 3a0a  f_id(self, id):.
+0001a6e0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0001a6f0: 7461 6e63 6528 7365 6c66 2e6f 7468 6572  tance(self.other
+0001a700: 2c20 286c 6973 742c 2074 7570 6c65 2929  , (list, tuple))
+0001a710: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+0001a720: 7220 6974 656d 2069 6e20 7365 6c66 2e6f  r item in self.o
+0001a730: 7468 6572 3a0a 2020 2020 2020 2020 2020  ther:.          
+0001a740: 2020 2020 2020 6966 2068 6173 6174 7472        if hasattr
+0001a750: 2869 7465 6d2c 2022 7365 745f 7365 6c66  (item, "set_self
+0001a760: 5f69 6422 293a 0a20 2020 2020 2020 2020  _id"):.         
+0001a770: 2020 2020 2020 2020 2020 2069 7465 6d2e             item.
+0001a780: 7365 745f 7365 6c66 5f69 6428 6964 290a  set_self_id(id).
+0001a790: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001a7a0: 2020 2020 2020 2020 2020 6966 2068 6173            if has
+0001a7b0: 6174 7472 2873 656c 662e 6f74 6865 722c  attr(self.other,
+0001a7c0: 2022 7365 745f 7365 6c66 5f69 6422 293a   "set_self_id"):
+0001a7d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a7e0: 2073 656c 662e 6f74 6865 722e 7365 745f   self.other.set_
+0001a7f0: 7365 6c66 5f69 6428 6964 290a 0a20 2020  self_id(id)..   
+0001a800: 2064 6566 2076 616c 6964 6174 6528 7365   def validate(se
+0001a810: 6c66 2c20 7661 6c75 652c 2072 6563 6f72  lf, value, recor
+0001a820: 645f 6964 3d4e 6f6e 6529 3a0a 2020 2020  d_id=None):.    
+0001a830: 2020 2020 7661 6c75 652c 2065 6d70 7479      value, empty
+0001a840: 203d 2069 735f 656d 7074 7928 7661 6c75   = is_empty(valu
+0001a850: 652c 2065 6d70 7479 5f72 6567 6578 3d73  e, empty_regex=s
+0001a860: 656c 662e 656d 7074 795f 7265 6765 7829  elf.empty_regex)
+0001a870: 0a20 2020 2020 2020 2069 6620 656d 7074  .        if empt
+0001a880: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
+0001a890: 6574 7572 6e20 7365 6c66 2e6e 756c 6c0a  eturn self.null.
+0001a8a0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0001a8b0: 7461 6e63 6528 7365 6c66 2e6f 7468 6572  tance(self.other
+0001a8c0: 2c20 286c 6973 742c 2074 7570 6c65 2929  , (list, tuple))
+0001a8d0: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+0001a8e0: 7220 6974 656d 2069 6e20 7365 6c66 2e6f  r item in self.o
+0001a8f0: 7468 6572 3a0a 2020 2020 2020 2020 2020  ther:.          
+0001a900: 2020 2020 2020 7661 6c75 6520 3d20 7661        value = va
+0001a910: 6c69 6461 746f 725f 6361 6c6c 6572 2869  lidator_caller(i
+0001a920: 7465 6d2c 2076 616c 7565 2c20 7265 636f  tem, value, reco
+0001a930: 7264 5f69 6429 0a20 2020 2020 2020 2020  rd_id).         
+0001a940: 2020 2072 6574 7572 6e20 7661 6c75 650a     return value.
+0001a950: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+0001a960: 616c 6964 6174 6f72 5f63 616c 6c65 7228  alidator_caller(
+0001a970: 7365 6c66 2e6f 7468 6572 2c20 7661 6c75  self.other, valu
+0001a980: 652c 2072 6563 6f72 645f 6964 290a 0a20  e, record_id).. 
+0001a990: 2020 2064 6566 2066 6f72 6d61 7474 6572     def formatter
+0001a9a0: 2873 656c 662c 2076 616c 7565 293a 0a20  (self, value):. 
+0001a9b0: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
+0001a9c0: 7228 7365 6c66 2e6f 7468 6572 2c20 2266  r(self.other, "f
+0001a9d0: 6f72 6d61 7474 6572 2229 3a0a 2020 2020  ormatter"):.    
+0001a9e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001a9f0: 656c 662e 6f74 6865 722e 666f 726d 6174  elf.other.format
+0001aa00: 7465 7228 7661 6c75 6529 0a20 2020 2020  ter(value).     
+0001aa10: 2020 2072 6574 7572 6e20 7661 6c75 650a     return value.
+0001aa20: 0a0a 4953 5f4e 554c 4c5f 4f52 203d 2049  ..IS_NULL_OR = I
+0001aa30: 535f 454d 5054 595f 4f52 2020 2320 666f  S_EMPTY_OR  # fo
+0001aa40: 7220 6261 636b 7761 7264 2063 6f6d 7061  r backward compa
+0001aa50: 7469 6269 6c69 7479 0a0a 0a63 6c61 7373  tibility...class
+0001aa60: 2043 4c45 414e 5550 2856 616c 6964 6174   CLEANUP(Validat
+0001aa70: 6f72 293a 0a20 2020 2022 2222 0a20 2020  or):.    """.   
+0001aa80: 2045 7861 6d70 6c65 733a 0a20 2020 2020   Examples:.     
+0001aa90: 2020 2055 7365 2061 733a 3a0a 0a20 2020     Use as::..   
+0001aaa0: 2020 2020 2020 2020 2049 4e50 5554 285f           INPUT(_
+0001aab0: 7479 7065 3d27 7465 7874 272c 205f 6e61  type='text', _na
+0001aac0: 6d65 3d27 6e61 6d65 272c 2072 6571 7569  me='name', requi
+0001aad0: 7265 733d 434c 4541 4e55 5028 2929 0a0a  res=CLEANUP())..
+0001aae0: 2020 2020 7265 6d6f 7665 7320 7370 6563      removes spec
+0001aaf0: 6961 6c20 6368 6172 6163 7465 7273 206f  ial characters o
+0001ab00: 6e20 7661 6c69 6461 7469 6f6e 0a20 2020  n validation.   
+0001ab10: 2022 2222 0a0a 2020 2020 5245 4745 585f   """..    REGEX_
+0001ab20: 434c 4541 4e55 5020 3d20 225b 5e5c 7830  CLEANUP = "[^\x0
+0001ab30: 395c 7830 615c 7830 645c 7832 302d 5c78  9\x0a\x0d\x20-\x
+0001ab40: 3765 5d22 0a0a 2020 2020 6465 6620 5f5f  7e]"..    def __
+0001ab50: 696e 6974 5f5f 2873 656c 662c 2072 6567  init__(self, reg
+0001ab60: 6578 3d4e 6f6e 6529 3a0a 2020 2020 2020  ex=None):.      
+0001ab70: 2020 7365 6c66 2e72 6567 6578 203d 2028    self.regex = (
+0001ab80: 0a20 2020 2020 2020 2020 2020 2072 652e  .            re.
+0001ab90: 636f 6d70 696c 6528 7365 6c66 2e52 4547  compile(self.REG
+0001aba0: 4558 5f43 4c45 414e 5550 2920 6966 2072  EX_CLEANUP) if r
+0001abb0: 6567 6578 2069 7320 4e6f 6e65 2065 6c73  egex is None els
+0001abc0: 6520 7265 2e63 6f6d 7069 6c65 2872 6567  e re.compile(reg
+0001abd0: 6578 290a 2020 2020 2020 2020 290a 0a20  ex).        ).. 
+0001abe0: 2020 2064 6566 2076 616c 6964 6174 6528     def validate(
+0001abf0: 7365 6c66 2c20 7661 6c75 652c 2072 6563  self, value, rec
+0001ac00: 6f72 645f 6964 3d4e 6f6e 6529 3a0a 2020  ord_id=None):.  
+0001ac10: 2020 2020 2020 7620 3d20 7365 6c66 2e72        v = self.r
+0001ac20: 6567 6578 2e73 7562 2822 222c 2073 7472  egex.sub("", str
+0001ac30: 2876 616c 7565 292e 7374 7269 7028 2929  (value).strip())
+0001ac40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001ac50: 760a 0a0a 6465 6620 7062 6b64 6632 5f68  v...def pbkdf2_h
+0001ac60: 6578 2864 6174 612c 2073 616c 742c 2069  ex(data, salt, i
+0001ac70: 7465 7261 7469 6f6e 733d 3130 3030 2c20  terations=1000, 
+0001ac80: 6b65 796c 656e 3d32 342c 2068 6173 6866  keylen=24, hashf
+0001ac90: 756e 633d 4e6f 6e65 293a 0a20 2020 2068  unc=None):.    h
+0001aca0: 6173 6866 756e 6320 3d20 6861 7368 6675  ashfunc = hashfu
+0001acb0: 6e63 206f 7220 6861 7368 6c69 622e 7368  nc or hashlib.sh
+0001acc0: 6131 0a20 2020 2068 6d61 6320 3d20 6861  a1.    hmac = ha
+0001acd0: 7368 6c69 622e 7062 6b64 6632 5f68 6d61  shlib.pbkdf2_hma
+0001ace0: 6328 0a20 2020 2020 2020 2068 6173 6866  c(.        hashf
+0001acf0: 756e 6328 292e 6e61 6d65 2c20 746f 5f62  unc().name, to_b
+0001ad00: 7974 6573 2864 6174 6129 2c20 746f 5f62  ytes(data), to_b
+0001ad10: 7974 6573 2873 616c 7429 2c20 6974 6572  ytes(salt), iter
+0001ad20: 6174 696f 6e73 2c20 6b65 796c 656e 0a20  ations, keylen. 
+0001ad30: 2020 2029 0a20 2020 2072 6574 7572 6e20     ).    return 
+0001ad40: 6269 6e61 7363 6969 2e68 6578 6c69 6679  binascii.hexlify
+0001ad50: 2868 6d61 6329 0a0a 0a64 6566 2073 696d  (hmac)...def sim
+0001ad60: 706c 655f 6861 7368 2874 6578 742c 206b  ple_hash(text, k
+0001ad70: 6579 3d22 222c 2073 616c 743d 2222 2c20  ey="", salt="", 
+0001ad80: 6469 6765 7374 5f61 6c67 3d22 6d64 3522  digest_alg="md5"
+0001ad90: 293a 0a20 2020 2022 2222 4765 6e65 7261  ):.    """Genera
+0001ada0: 7465 2068 6173 6820 7769 7468 2074 6865  te hash with the
+0001adb0: 2067 6976 656e 2074 6578 7420 7573 696e   given text usin
+0001adc0: 6720 7468 6520 7370 6563 6966 6965 6420  g the specified 
+0001add0: 6469 6765 7374 2061 6c67 6f72 6974 686d  digest algorithm
+0001ade0: 2e22 2222 0a20 2020 2074 6578 7420 3d20  .""".    text = 
+0001adf0: 746f 5f62 7974 6573 2874 6578 7429 0a20  to_bytes(text). 
+0001ae00: 2020 206b 6579 203d 2074 6f5f 6279 7465     key = to_byte
+0001ae10: 7328 6b65 7929 0a20 2020 2073 616c 7420  s(key).    salt 
+0001ae20: 3d20 746f 5f62 7974 6573 2873 616c 7429  = to_bytes(salt)
+0001ae30: 0a20 2020 2069 6620 6e6f 7420 6469 6765  .    if not dige
+0001ae40: 7374 5f61 6c67 3a0a 2020 2020 2020 2020  st_alg:.        
+0001ae50: 7261 6973 6520 5275 6e74 696d 6545 7272  raise RuntimeErr
+0001ae60: 6f72 2822 7369 6d70 6c65 5f68 6173 6820  or("simple_hash 
+0001ae70: 7769 7468 2064 6967 6573 745f 616c 673d  with digest_alg=
+0001ae80: 4e6f 6e65 2229 0a20 2020 2065 6c69 6620  None").    elif 
+0001ae90: 6e6f 7420 6973 696e 7374 616e 6365 2864  not isinstance(d
+0001aea0: 6967 6573 745f 616c 672c 2073 7472 293a  igest_alg, str):
+0001aeb0: 2020 2320 6d61 6e75 616c 2061 7070 726f    # manual appro
+0001aec0: 6163 680a 2020 2020 2020 2020 6820 3d20  ach.        h = 
+0001aed0: 6469 6765 7374 5f61 6c67 2874 6578 7420  digest_alg(text 
+0001aee0: 2b20 6b65 7920 2b20 7361 6c74 290a 2020  + key + salt).  
+0001aef0: 2020 656c 6966 2064 6967 6573 745f 616c    elif digest_al
+0001af00: 672e 7374 6172 7473 7769 7468 2822 7062  g.startswith("pb
+0001af10: 6b64 6632 2229 3a20 2023 206c 6174 6573  kdf2"):  # lates
+0001af20: 7420 616e 6420 636f 6f6c 6573 7421 0a20  t and coolest!. 
+0001af30: 2020 2020 2020 2069 7465 7261 7469 6f6e         iteration
+0001af40: 732c 206b 6579 6c65 6e2c 2061 6c67 203d  s, keylen, alg =
+0001af50: 2064 6967 6573 745f 616c 675b 373a 2d31   digest_alg[7:-1
+0001af60: 5d2e 7370 6c69 7428 222c 2229 0a20 2020  ].split(",").   
+0001af70: 2020 2020 2072 6574 7572 6e20 746f 5f6e       return to_n
+0001af80: 6174 6976 6528 0a20 2020 2020 2020 2020  ative(.         
+0001af90: 2020 2070 626b 6466 325f 6865 7828 7465     pbkdf2_hex(te
+0001afa0: 7874 2c20 7361 6c74 2c20 696e 7428 6974  xt, salt, int(it
+0001afb0: 6572 6174 696f 6e73 292c 2069 6e74 286b  erations), int(k
+0001afc0: 6579 6c65 6e29 2c20 6765 745f 6469 6765  eylen), get_dige
+0001afd0: 7374 2861 6c67 2929 0a20 2020 2020 2020  st(alg)).       
+0001afe0: 2029 0a20 2020 2065 6c69 6620 6b65 793a   ).    elif key:
+0001aff0: 2020 2320 7573 6520 686d 6163 0a20 2020    # use hmac.   
+0001b000: 2020 2020 2064 6967 6573 745f 616c 6720       digest_alg 
+0001b010: 3d20 6765 745f 6469 6765 7374 2864 6967  = get_digest(dig
+0001b020: 6573 745f 616c 6729 0a20 2020 2020 2020  est_alg).       
+0001b030: 2068 203d 2068 6d61 632e 6e65 7728 6b65   h = hmac.new(ke
+0001b040: 7920 2b20 7361 6c74 2c20 7465 7874 2c20  y + salt, text, 
+0001b050: 6469 6765 7374 5f61 6c67 290a 2020 2020  digest_alg).    
+0001b060: 656c 7365 3a20 2023 2063 6f6d 7061 7469  else:  # compati
+0001b070: 626c 6520 7769 7468 2074 6869 7264 2070  ble with third p
+0001b080: 6172 7479 2073 7973 7465 6d73 0a20 2020  arty systems.   
+0001b090: 2020 2020 2068 203d 2067 6574 5f64 6967       h = get_dig
+0001b0a0: 6573 7428 6469 6765 7374 5f61 6c67 2928  est(digest_alg)(
+0001b0b0: 290a 2020 2020 2020 2020 682e 7570 6461  ).        h.upda
+0001b0c0: 7465 2874 6578 7420 2b20 7361 6c74 290a  te(text + salt).
+0001b0d0: 2020 2020 7265 7475 726e 2068 2e68 6578      return h.hex
+0001b0e0: 6469 6765 7374 2829 0a0a 0a64 6566 2067  digest()...def g
+0001b0f0: 6574 5f64 6967 6573 7428 7661 6c75 6529  et_digest(value)
+0001b100: 3a0a 2020 2020 2222 2252 6574 7572 6e20  :.    """Return 
+0001b110: 6120 6861 7368 6c69 6220 6469 6765 7374  a hashlib digest
+0001b120: 2061 6c67 6f72 6974 686d 2066 726f 6d20   algorithm from 
+0001b130: 6120 7374 7269 6e67 2e22 2222 0a20 2020  a string.""".   
+0001b140: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
+0001b150: 616c 7565 2c20 7374 7229 3a0a 2020 2020  alue, str):.    
+0001b160: 2020 2020 7661 6c75 6520 3d20 7661 6c75      value = valu
+0001b170: 652e 6c6f 7765 7228 290a 2020 2020 2020  e.lower().      
+0001b180: 2020 6966 2076 616c 7565 206e 6f74 2069    if value not i
+0001b190: 6e20 2822 6d64 3522 2c20 2273 6861 3122  n ("md5", "sha1"
+0001b1a0: 2c20 2273 6861 3232 3422 2c20 2273 6861  , "sha224", "sha
+0001b1b0: 3235 3622 2c20 2273 6861 3338 3422 2c20  256", "sha384", 
+0001b1c0: 2273 6861 3531 3222 293a 0a20 2020 2020  "sha512"):.     
+0001b1d0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0001b1e0: 7565 4572 726f 7228 2249 6e76 616c 6964  ueError("Invalid
+0001b1f0: 2064 6967 6573 7420 616c 676f 7269 7468   digest algorith
+0001b200: 6d3a 2025 7322 2025 2076 616c 7565 290a  m: %s" % value).
+0001b210: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
+0001b220: 6765 7461 7474 7228 6861 7368 6c69 622c  getattr(hashlib,
+0001b230: 2076 616c 7565 290a 2020 2020 7265 7475   value).    retu
+0001b240: 726e 2076 616c 7565 0a0a 0a44 4947 4553  rn value...DIGES
+0001b250: 545f 414c 475f 4259 5f53 495a 4520 3d20  T_ALG_BY_SIZE = 
+0001b260: 7b0a 2020 2020 3132 3820 2f2f 2034 3a20  {.    128 // 4: 
+0001b270: 226d 6435 222c 0a20 2020 2031 3630 202f  "md5",.    160 /
+0001b280: 2f20 343a 2022 7368 6131 222c 0a20 2020  / 4: "sha1",.   
+0001b290: 2032 3234 202f 2f20 343a 2022 7368 6132   224 // 4: "sha2
+0001b2a0: 3234 222c 0a20 2020 2032 3536 202f 2f20  24",.    256 // 
+0001b2b0: 343a 2022 7368 6132 3536 222c 0a20 2020  4: "sha256",.   
+0001b2c0: 2033 3834 202f 2f20 343a 2022 7368 6133   384 // 4: "sha3
+0001b2d0: 3834 222c 0a20 2020 2035 3132 202f 2f20  84",.    512 // 
+0001b2e0: 343a 2022 7368 6135 3132 222c 0a7d 0a0a  4: "sha512",.}..
+0001b2f0: 0a63 6c61 7373 204c 617a 7943 7279 7074  .class LazyCrypt
+0001b300: 286f 626a 6563 7429 3a0a 2020 2020 2222  (object):.    ""
+0001b310: 220a 2020 2020 5374 6f72 6573 2061 206c  ".    Stores a l
+0001b320: 617a 7920 7061 7373 776f 7264 2068 6173  azy password has
+0001b330: 680a 2020 2020 2222 220a 0a20 2020 2064  h.    """..    d
+0001b340: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+0001b350: 2c20 6372 7970 742c 2070 6173 7377 6f72  , crypt, passwor
+0001b360: 6429 3a0a 2020 2020 2020 2020 2222 220a  d):.        """.
+0001b370: 2020 2020 2020 2020 6372 7970 7420 6973          crypt is
+0001b380: 2061 6e20 696e 7374 616e 6365 206f 6620   an instance of 
+0001b390: 7468 6520 4352 5950 5420 7661 6c69 6461  the CRYPT valida
+0001b3a0: 746f 722c 0a20 2020 2020 2020 2070 6173  tor,.        pas
+0001b3b0: 7377 6f72 6420 6973 2074 6865 2070 6173  sword is the pas
+0001b3c0: 7377 6f72 6420 6173 2069 6e73 6572 7465  sword as inserte
+0001b3d0: 6420 6279 2074 6865 2075 7365 720a 2020  d by the user.  
+0001b3e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001b3f0: 2020 7365 6c66 2e63 7279 7074 203d 2063    self.crypt = c
+0001b400: 7279 7074 0a20 2020 2020 2020 2073 656c  rypt.        sel
+0001b410: 662e 7061 7373 776f 7264 203d 2070 6173  f.password = pas
+0001b420: 7377 6f72 640a 2020 2020 2020 2020 7365  sword.        se
+0001b430: 6c66 2e63 7279 7074 6564 203d 204e 6f6e  lf.crypted = Non
+0001b440: 650a 0a20 2020 2064 6566 205f 5f73 7472  e..    def __str
+0001b450: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+0001b460: 2020 2222 220a 2020 2020 2020 2020 456e    """.        En
+0001b470: 6372 7970 7465 6420 7365 6c66 2e70 6173  crypted self.pas
+0001b480: 7377 6f72 6420 616e 6420 6361 6368 6573  sword and caches
+0001b490: 2069 7420 696e 2073 656c 662e 6372 7970   it in self.cryp
+0001b4a0: 7465 642e 0a20 2020 2020 2020 2049 6620  ted..        If 
+0001b4b0: 7365 6c66 2e63 7279 7074 2e73 616c 7420  self.crypt.salt 
+0001b4c0: 7468 6520 6f75 7470 7574 2069 7320 696e  the output is in
+0001b4d0: 2074 6865 2066 6f72 6d61 7420 3c61 6c67   the format <alg
+0001b4e0: 6f72 6974 686d 3e24 3c73 616c 743e 243c  orithm>$<salt>$<
+0001b4f0: 6861 7368 3e0a 0a20 2020 2020 2020 2054  hash>..        T
+0001b500: 7279 2067 6574 2074 6865 2064 6967 6573  ry get the diges
+0001b510: 745f 616c 6720 6672 6f6d 2074 6865 206b  t_alg from the k
+0001b520: 6579 2028 6966 2069 7420 6578 6973 7473  ey (if it exists
+0001b530: 290a 2020 2020 2020 2020 656c 7365 2061  ).        else a
+0001b540: 7373 756d 6520 7468 6520 6465 6661 756c  ssume the defaul
+0001b550: 7420 6469 6765 7374 5f61 6c67 2e20 4966  t digest_alg. If
+0001b560: 206e 6f74 206b 6579 2061 7420 616c 6c2c   not key at all,
+0001b570: 2073 6574 206b 6579 3d27 270a 0a20 2020   set key=''..   
+0001b580: 2020 2020 2049 6620 6120 7361 6c74 2069       If a salt i
+0001b590: 7320 7370 6563 6966 6965 6420 7573 6520  s specified use 
+0001b5a0: 6974 2c20 6966 2073 616c 7420 6973 2054  it, if salt is T
+0001b5b0: 7275 652c 2073 6574 2073 616c 7420 746f  rue, set salt to
+0001b5c0: 2075 7569 640a 2020 2020 2020 2020 2874   uuid.        (t
+0001b5d0: 6869 7320 7368 6f75 6c64 2061 6c6c 2062  his should all b
+0001b5e0: 6520 6261 636b 7761 7264 2063 6f6d 7061  e backward compa
+0001b5f0: 7469 626c 6529 0a0a 2020 2020 2020 2020  tible)..        
+0001b600: 4f70 7469 6f6e 733a 0a20 2020 2020 2020  Options:.       
+0001b610: 206b 6579 203d 2027 7575 6964 270a 2020   key = 'uuid'.  
+0001b620: 2020 2020 2020 6b65 7920 3d20 276d 6435        key = 'md5
+0001b630: 3a75 7569 6427 0a20 2020 2020 2020 206b  :uuid'.        k
+0001b640: 6579 203d 2027 7368 6135 3132 3a75 7569  ey = 'sha512:uui
+0001b650: 6427 0a20 2020 2020 2020 202e 2e2e 0a20  d'.        .... 
+0001b660: 2020 2020 2020 206b 6579 203d 2027 7062         key = 'pb
+0001b670: 6b64 6632 2831 3030 302c 3634 2c73 6861  kdf2(1000,64,sha
+0001b680: 3531 3229 3a75 7569 6427 2031 3030 3020  512):uuid' 1000 
+0001b690: 6974 6572 6174 696f 6e73 2061 6e64 2036  iterations and 6
+0001b6a0: 3420 6368 6172 7320 6c65 6e67 7468 0a20  4 chars length. 
+0001b6b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001b6c0: 2020 2069 6620 7365 6c66 2e63 7279 7074     if self.crypt
+0001b6d0: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
+0001b6e0: 7265 7475 726e 2073 656c 662e 6372 7970  return self.cryp
+0001b6f0: 7465 640a 2020 2020 2020 2020 6966 2073  ted.        if s
+0001b700: 656c 662e 6372 7970 742e 6b65 793a 0a20  elf.crypt.key:. 
+0001b710: 2020 2020 2020 2020 2020 2069 6620 223a             if ":
+0001b720: 2220 696e 2073 656c 662e 6372 7970 742e  " in self.crypt.
+0001b730: 6b65 793a 0a20 2020 2020 2020 2020 2020  key:.           
+0001b740: 2020 2020 2064 6967 6573 745f 616c 672c       digest_alg,
+0001b750: 206b 6579 203d 2073 656c 662e 6372 7970   key = self.cryp
+0001b760: 742e 6b65 792e 7370 6c69 7428 223a 222c  t.key.split(":",
+0001b770: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
+0001b780: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001b790: 2020 2020 2020 6469 6765 7374 5f61 6c67        digest_alg
+0001b7a0: 2c20 6b65 7920 3d20 7365 6c66 2e63 7279  , key = self.cry
+0001b7b0: 7074 2e64 6967 6573 745f 616c 672c 2073  pt.digest_alg, s
+0001b7c0: 656c 662e 6372 7970 742e 6b65 790a 2020  elf.crypt.key.  
+0001b7d0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001b7e0: 2020 2020 2020 2020 6469 6765 7374 5f61          digest_a
+0001b7f0: 6c67 2c20 6b65 7920 3d20 7365 6c66 2e63  lg, key = self.c
+0001b800: 7279 7074 2e64 6967 6573 745f 616c 672c  rypt.digest_alg,
+0001b810: 2022 220a 2020 2020 2020 2020 6966 2073   "".        if s
+0001b820: 656c 662e 6372 7970 742e 7361 6c74 3a0a  elf.crypt.salt:.
+0001b830: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001b840: 656c 662e 6372 7970 742e 7361 6c74 2069  elf.crypt.salt i
+0001b850: 7320 5472 7565 3a0a 2020 2020 2020 2020  s True:.        
+0001b860: 2020 2020 2020 2020 7361 6c74 203d 2073          salt = s
+0001b870: 7472 2875 7569 642e 7575 6964 3428 2929  tr(uuid.uuid4())
+0001b880: 2e72 6570 6c61 6365 2822 2d22 2c20 2222  .replace("-", ""
+0001b890: 295b 2d31 363a 5d0a 2020 2020 2020 2020  )[-16:].        
+0001b8a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001b8b0: 2020 2020 2020 2020 2020 7361 6c74 203d            salt =
+0001b8c0: 2073 656c 662e 6372 7970 742e 7361 6c74   self.crypt.salt
+0001b8d0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0001b8e0: 2020 2020 2020 2020 2020 2073 616c 7420             salt 
+0001b8f0: 3d20 2222 0a20 2020 2020 2020 2068 6173  = "".        has
+0001b900: 6865 6420 3d20 7369 6d70 6c65 5f68 6173  hed = simple_has
+0001b910: 6828 7365 6c66 2e70 6173 7377 6f72 642c  h(self.password,
+0001b920: 206b 6579 2c20 7361 6c74 2c20 6469 6765   key, salt, dige
+0001b930: 7374 5f61 6c67 290a 2020 2020 2020 2020  st_alg).        
+0001b940: 7365 6c66 2e63 7279 7074 6564 203d 2022  self.crypted = "
+0001b950: 2573 2425 7324 2573 2220 2520 2864 6967  %s$%s$%s" % (dig
+0001b960: 6573 745f 616c 672c 2073 616c 742c 2068  est_alg, salt, h
+0001b970: 6173 6865 6429 0a20 2020 2020 2020 2072  ashed).        r
+0001b980: 6574 7572 6e20 7365 6c66 2e63 7279 7074  eturn self.crypt
+0001b990: 6564 0a0a 2020 2020 6465 6620 5f5f 6571  ed..    def __eq
+0001b9a0: 5f5f 2873 656c 662c 2073 746f 7265 645f  __(self, stored_
+0001b9b0: 7061 7373 776f 7264 293a 0a20 2020 2020  password):.     
+0001b9c0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+0001b9d0: 6f6d 7061 7265 7320 7468 6520 6375 7272  ompares the curr
+0001b9e0: 656e 7420 6c61 7a79 2063 7279 7074 6564  ent lazy crypted
+0001b9f0: 2070 6173 7377 6f72 6420 7769 7468 2061   password with a
+0001ba00: 2073 746f 7265 6420 7061 7373 776f 7264   stored password
+0001ba10: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+0001ba20: 2020 2020 2020 2320 4c61 7a79 4372 7970        # LazyCryp
+0001ba30: 7420 6f62 6a65 6374 7320 636f 6d70 6172  t objects compar
+0001ba40: 6973 6f6e 0a20 2020 2020 2020 2069 6620  ison.        if 
+0001ba50: 6973 696e 7374 616e 6365 2873 746f 7265  isinstance(store
+0001ba60: 645f 7061 7373 776f 7264 2c20 7365 6c66  d_password, self
+0001ba70: 2e5f 5f63 6c61 7373 5f5f 293a 0a20 2020  .__class__):.   
+0001ba80: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001ba90: 2873 656c 6620 6973 2073 746f 7265 645f  (self is stored_
+0001baa0: 7061 7373 776f 7264 2920 6f72 2028 0a20  password) or (. 
+0001bab0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0001bac0: 7365 6c66 2e63 7279 7074 2e6b 6579 203d  self.crypt.key =
+0001bad0: 3d20 7374 6f72 6564 5f70 6173 7377 6f72  = stored_passwor
+0001bae0: 642e 6372 7970 742e 6b65 7929 0a20 2020  d.crypt.key).   
+0001baf0: 2020 2020 2020 2020 2020 2020 2061 6e64               and
+0001bb00: 2028 7365 6c66 2e70 6173 7377 6f72 6420   (self.password 
+0001bb10: 3d3d 2073 746f 7265 645f 7061 7373 776f  == stored_passwo
+0001bb20: 7264 2e70 6173 7377 6f72 6429 0a20 2020  rd.password).   
+0001bb30: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0001bb40: 2020 2020 6966 2073 656c 662e 6372 7970      if self.cryp
+0001bb50: 742e 6b65 793a 0a20 2020 2020 2020 2020  t.key:.         
+0001bb60: 2020 2069 6620 223a 2220 696e 2073 656c     if ":" in sel
+0001bb70: 662e 6372 7970 742e 6b65 793a 0a20 2020  f.crypt.key:.   
+0001bb80: 2020 2020 2020 2020 2020 2020 206b 6579               key
+0001bb90: 203d 2073 656c 662e 6372 7970 742e 6b65   = self.crypt.ke
+0001bba0: 792e 7370 6c69 7428 223a 2229 5b31 5d0a  y.split(":")[1].
+0001bbb0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0001bbc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001bbd0: 2020 6b65 7920 3d20 7365 6c66 2e63 7279    key = self.cry
+0001bbe0: 7074 2e6b 6579 0a20 2020 2020 2020 2065  pt.key.        e
+0001bbf0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001bc00: 206b 6579 203d 2022 220a 2020 2020 2020   key = "".      
+0001bc10: 2020 6966 2073 746f 7265 645f 7061 7373    if stored_pass
+0001bc20: 776f 7264 2069 7320 4e6f 6e65 3a0a 2020  word is None:.  
+0001bc30: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001bc40: 2046 616c 7365 0a20 2020 2020 2020 2065   False.        e
+0001bc50: 6c69 6620 7374 6f72 6564 5f70 6173 7377  lif stored_passw
+0001bc60: 6f72 642e 636f 756e 7428 2224 2229 203d  ord.count("$") =
+0001bc70: 3d20 323a 0a20 2020 2020 2020 2020 2020  = 2:.           
+0001bc80: 2028 6469 6765 7374 5f61 6c67 2c20 7361   (digest_alg, sa
+0001bc90: 6c74 2c20 6861 7368 2920 3d20 7374 6f72  lt, hash) = stor
+0001bca0: 6564 5f70 6173 7377 6f72 642e 7370 6c69  ed_password.spli
+0001bcb0: 7428 2224 2229 0a20 2020 2020 2020 2020  t("$").         
+0001bcc0: 2020 2068 203d 2073 696d 706c 655f 6861     h = simple_ha
+0001bcd0: 7368 2873 656c 662e 7061 7373 776f 7264  sh(self.password
+0001bce0: 2c20 6b65 792c 2073 616c 742c 2064 6967  , key, salt, dig
+0001bcf0: 6573 745f 616c 6729 0a20 2020 2020 2020  est_alg).       
+0001bd00: 2020 2020 2074 656d 705f 7061 7373 203d       temp_pass =
+0001bd10: 2022 2573 2425 7324 2573 2220 2520 2864   "%s$%s$%s" % (d
+0001bd20: 6967 6573 745f 616c 672c 2073 616c 742c  igest_alg, salt,
+0001bd30: 2068 290a 2020 2020 2020 2020 656c 7365   h).        else
+0001bd40: 3a20 2023 206e 6f20 7361 6c74 696e 670a  :  # no salting.
+0001bd50: 2020 2020 2020 2020 2020 2020 2320 6775              # gu
+0001bd60: 6573 7320 6469 6765 7374 5f61 6c67 0a20  ess digest_alg. 
+0001bd70: 2020 2020 2020 2020 2020 2064 6967 6573             diges
+0001bd80: 745f 616c 6720 3d20 4449 4745 5354 5f41  t_alg = DIGEST_A
+0001bd90: 4c47 5f42 595f 5349 5a45 2e67 6574 286c  LG_BY_SIZE.get(l
+0001bda0: 656e 2873 746f 7265 645f 7061 7373 776f  en(stored_passwo
+0001bdb0: 7264 292c 204e 6f6e 6529 0a20 2020 2020  rd), None).     
+0001bdc0: 2020 2020 2020 2069 6620 6e6f 7420 6469         if not di
+0001bdd0: 6765 7374 5f61 6c67 3a0a 2020 2020 2020  gest_alg:.      
+0001bde0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001bdf0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+0001be00: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001be10: 2020 2020 2020 2020 2074 656d 705f 7061           temp_pa
+0001be20: 7373 203d 2073 696d 706c 655f 6861 7368  ss = simple_hash
+0001be30: 2873 656c 662e 7061 7373 776f 7264 2c20  (self.password, 
+0001be40: 6b65 792c 2022 222c 2064 6967 6573 745f  key, "", digest_
+0001be50: 616c 6729 0a20 2020 2020 2020 2072 6574  alg).        ret
+0001be60: 7572 6e20 7465 6d70 5f70 6173 7320 3d3d  urn temp_pass ==
+0001be70: 2073 746f 7265 645f 7061 7373 776f 7264   stored_password
+0001be80: 0a0a 2020 2020 6465 6620 5f5f 6e65 5f5f  ..    def __ne__
+0001be90: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
+0001bea0: 2020 2020 2020 2072 6574 7572 6e20 6e6f         return no
+0001beb0: 7420 7365 6c66 2e5f 5f65 715f 5f28 6f74  t self.__eq__(ot
+0001bec0: 6865 7229 0a0a 0a63 6c61 7373 2043 5259  her)...class CRY
+0001bed0: 5054 2856 616c 6964 6174 6f72 293a 0a20  PT(Validator):. 
+0001bee0: 2020 2022 2222 0a20 2020 2045 7861 6d70     """.    Examp
+0001bef0: 6c65 733a 0a20 2020 2020 2020 2055 7365  les:.        Use
+0001bf00: 2061 733a 3a0a 0a20 2020 2020 2020 2020   as::..         
+0001bf10: 2020 2049 4e50 5554 285f 7479 7065 3d27     INPUT(_type='
+0001bf20: 7465 7874 272c 205f 6e61 6d65 3d27 6e61  text', _name='na
+0001bf30: 6d65 272c 2072 6571 7569 7265 733d 4352  me', requires=CR
+0001bf40: 5950 5428 2929 0a0a 2020 2020 656e 636f  YPT())..    enco
+0001bf50: 6465 7320 7468 6520 7661 6c75 6520 6f6e  des the value on
+0001bf60: 2076 616c 6964 6174 696f 6e20 7769 7468   validation with
+0001bf70: 2061 2064 6967 6573 742e 0a0a 2020 2020   a digest...    
+0001bf80: 4966 206e 6f20 6172 6775 6d65 6e74 7320  If no arguments 
+0001bf90: 6172 6520 7072 6f76 6964 6564 2043 5259  are provided CRY
+0001bfa0: 5054 2075 7365 7320 7468 6520 4d44 3520  PT uses the MD5 
+0001bfb0: 616c 676f 7269 7468 6d2e 0a20 2020 2049  algorithm..    I
+0001bfc0: 6620 7468 6520 6b65 7920 6172 6775 6d65  f the key argume
+0001bfd0: 6e74 2069 7320 7072 6f76 6964 6564 2074  nt is provided t
+0001bfe0: 6865 2048 4d41 432b 4d44 3520 616c 676f  he HMAC+MD5 algo
+0001bff0: 7269 7468 6d20 6973 2075 7365 642e 0a20  rithm is used.. 
+0001c000: 2020 2049 6620 7468 6520 6469 6765 7374     If the digest
+0001c010: 5f61 6c67 2069 7320 7370 6563 6966 6965  _alg is specifie
+0001c020: 6420 7468 6973 2069 7320 7573 6564 2074  d this is used t
+0001c030: 6f20 7265 706c 6163 6520 7468 650a 2020  o replace the.  
+0001c040: 2020 4d44 3520 7769 7468 2c20 666f 7220    MD5 with, for 
+0001c050: 6578 616d 706c 652c 2053 4841 3531 322e  example, SHA512.
+0001c060: 2054 6865 2064 6967 6573 745f 616c 6720   The digest_alg 
+0001c070: 6361 6e20 6265 0a20 2020 2074 6865 206e  can be.    the n
+0001c080: 616d 6520 6f66 2061 2068 6173 686c 6962  ame of a hashlib
+0001c090: 2061 6c67 6f72 6974 686d 2061 7320 6120   algorithm as a 
+0001c0a0: 7374 7269 6e67 206f 7220 7468 6520 616c  string or the al
+0001c0b0: 676f 7269 7468 6d20 6974 7365 6c66 2e0a  gorithm itself..
+0001c0c0: 0a20 2020 206d 696e 5f6c 656e 6774 6820  .    min_length 
+0001c0d0: 6973 2074 6865 206d 696e 696d 616c 2070  is the minimal p
+0001c0e0: 6173 7377 6f72 6420 6c65 6e67 7468 2028  assword length (
+0001c0f0: 6465 6661 756c 7420 3429 202d 2049 535f  default 4) - IS_
+0001c100: 5354 524f 4e47 2066 6f72 2073 6572 696f  STRONG for serio
+0001c110: 7573 2073 6563 7572 6974 790a 2020 2020  us security.    
+0001c120: 6572 726f 725f 6d65 7373 6167 6520 6973  error_message is
+0001c130: 2074 6865 206d 6573 7361 6765 2069 6620   the message if 
+0001c140: 7061 7373 776f 7264 2069 7320 746f 6f20  password is too 
+0001c150: 7368 6f72 740a 0a20 2020 204e 6f74 6963  short..    Notic
+0001c160: 6520 7468 6174 2061 6e20 656d 7074 7920  e that an empty 
+0001c170: 7061 7373 776f 7264 2069 7320 6163 6365  password is acce
+0001c180: 7074 6564 2062 7574 2069 6e76 616c 6964  pted but invalid
+0001c190: 2e20 4974 2077 696c 6c20 6e6f 7420 616c  . It will not al
+0001c1a0: 6c6f 7720 6c6f 6769 6e20 6261 636b 2e0a  low login back..
+0001c1b0: 2020 2020 5374 6f72 6573 206a 756e 6b20      Stores junk 
+0001c1c0: 6173 2068 6173 6865 6420 7061 7373 776f  as hashed passwo
+0001c1d0: 7264 2e0a 0a20 2020 2053 7065 6369 6679  rd...    Specify
+0001c1e0: 2061 6e20 616c 676f 7269 7468 6d20 6f72   an algorithm or
+0001c1f0: 2062 7920 6465 6661 756c 7420 7765 2077   by default we w
+0001c200: 696c 6c20 7573 6520 7368 6135 3132 2e0a  ill use sha512..
+0001c210: 0a20 2020 2054 7970 6963 616c 2061 7661  .    Typical ava
+0001c220: 696c 6162 6c65 2061 6c67 6f72 6974 686d  ilable algorithm
+0001c230: 733a 0a20 2020 2020 206d 6435 2c20 7368  s:.      md5, sh
+0001c240: 6131 2c20 7368 6132 3234 2c20 7368 6132  a1, sha224, sha2
+0001c250: 3536 2c20 7368 6133 3834 2c20 7368 6135  56, sha384, sha5
+0001c260: 3132 0a0a 2020 2020 4966 2073 616c 742c  12..    If salt,
+0001c270: 2069 7420 6861 7368 6573 2061 2070 6173   it hashes a pas
+0001c280: 7377 6f72 6420 7769 7468 2061 2073 616c  sword with a sal
+0001c290: 742e 0a20 2020 2049 6620 7361 6c74 2069  t..    If salt i
+0001c2a0: 7320 5472 7565 2c20 7468 6973 206d 6574  s True, this met
+0001c2b0: 686f 6420 7769 6c6c 2061 7574 6f6d 6174  hod will automat
+0001c2c0: 6963 616c 6c79 2067 656e 6572 6174 6520  ically generate 
+0001c2d0: 6f6e 652e 0a20 2020 2045 6974 6865 7220  one..    Either 
+0001c2e0: 6361 7365 2069 7420 7265 7475 726e 7320  case it returns 
+0001c2f0: 616e 2065 6e63 7279 7074 6564 2070 6173  an encrypted pas
+0001c300: 7377 6f72 6420 7374 7269 6e67 2069 6e20  sword string in 
+0001c310: 7468 6520 666f 6c6c 6f77 696e 6720 666f  the following fo
+0001c320: 726d 6174 3a0a 0a20 2020 2020 203c 616c  rmat:..      <al
+0001c330: 676f 7269 7468 6d3e 243c 7361 6c74 3e24  gorithm>$<salt>$
+0001c340: 3c68 6173 683e 0a0a 2020 2020 496d 706f  <hash>..    Impo
+0001c350: 7274 616e 743a 2068 6173 6865 6420 7061  rtant: hashed pa
+0001c360: 7373 776f 7264 2069 7320 7265 7475 726e  ssword is return
+0001c370: 6564 2061 7320 6120 4c61 7a79 4372 7970  ed as a LazyCryp
+0001c380: 7420 6f62 6a65 6374 2061 6e64 2063 6f6d  t object and com
+0001c390: 7075 7465 6420 6f6e 6c79 2069 6620 6e65  puted only if ne
+0001c3a0: 6564 6564 2e0a 2020 2020 5468 6520 4c61  eded..    The La
+0001c3b0: 7379 4372 7970 7420 6f62 6a65 6374 2061  syCrypt object a
+0001c3c0: 6c73 6f20 6b6e 6f77 7320 686f 7720 746f  lso knows how to
+0001c3d0: 2063 6f6d 7061 7265 2069 7473 656c 6620   compare itself 
+0001c3e0: 7769 7468 2061 6e20 6578 6973 7469 6e67  with an existing
+0001c3f0: 2073 616c 7465 6420 7061 7373 776f 7264   salted password
+0001c400: 0a0a 2020 2020 5375 7070 6f72 7473 2073  ..    Supports s
+0001c410: 7461 6e64 6172 6420 616c 676f 7269 7468  tandard algorith
+0001c420: 6d73 0a0a 2020 2020 2020 2020 3e3e 3e20  ms..        >>> 
+0001c430: 666f 7220 616c 6720 696e 2028 276d 6435  for alg in ('md5
+0001c440: 272c 2773 6861 3127 2c27 7368 6132 3536  ','sha1','sha256
+0001c450: 272c 2773 6861 3338 3427 2c27 7368 6135  ','sha384','sha5
+0001c460: 3132 2729 3a0a 2020 2020 2020 2020 2e2e  12'):.        ..
+0001c470: 2e20 2020 2020 7072 696e 7428 7374 7228  .     print(str(
+0001c480: 4352 5950 5428 6469 6765 7374 5f61 6c67  CRYPT(digest_alg
+0001c490: 3d61 6c67 2c73 616c 743d 5472 7565 2928  =alg,salt=True)(
+0001c4a0: 2774 6573 7427 295b 305d 2929 0a20 2020  'test')[0])).   
+0001c4b0: 2020 2020 206d 6435 242e 2e2e 242e 2e2e       md5$...$...
+0001c4c0: 0a20 2020 2020 2020 2073 6861 3124 2e2e  .        sha1$..
+0001c4d0: 2e24 2e2e 2e0a 2020 2020 2020 2020 7368  .$....        sh
+0001c4e0: 6132 3536 242e 2e2e 242e 2e2e 0a20 2020  a256$...$....   
+0001c4f0: 2020 2020 2073 6861 3338 3424 2e2e 2e24       sha384$...$
+0001c500: 2e2e 2e0a 2020 2020 2020 2020 7368 6135  ....        sha5
+0001c510: 3132 242e 2e2e 242e 2e2e 0a0a 2020 2020  12$...$.....    
+0001c520: 5468 6520 7379 6e74 6178 2069 7320 616c  The syntax is al
+0001c530: 7761 7973 2061 6c67 2473 616c 7424 6861  ways alg$salt$ha
+0001c540: 7368 0a0a 2020 2020 5375 7070 6f72 7473  sh..    Supports
+0001c550: 2066 6f72 2070 626b 6466 320a 0a20 2020   for pbkdf2..   
+0001c560: 2020 2020 203e 3e3e 2061 6c67 203d 2027       >>> alg = '
+0001c570: 7062 6b64 6632 2831 3030 302c 3230 2c73  pbkdf2(1000,20,s
+0001c580: 6861 3531 3229 270a 2020 2020 2020 2020  ha512)'.        
+0001c590: 3e3e 3e20 7072 696e 7428 7374 7228 4352  >>> print(str(CR
+0001c5a0: 5950 5428 6469 6765 7374 5f61 6c67 3d61  YPT(digest_alg=a
+0001c5b0: 6c67 2c73 616c 743d 5472 7565 2928 2774  lg,salt=True)('t
+0001c5c0: 6573 7427 295b 305d 2929 0a20 2020 2020  est')[0])).     
+0001c5d0: 2020 2070 626b 6466 3228 3130 3030 2c32     pbkdf2(1000,2
+0001c5e0: 302c 7368 6135 3132 2924 2e2e 2e24 2e2e  0,sha512)$...$..
+0001c5f0: 2e0a 0a20 2020 2041 6e20 6f70 7469 6f6e  ...    An option
+0001c600: 616c 2068 6d61 635f 6b65 7920 6361 6e20  al hmac_key can 
+0001c610: 6265 2073 7065 6369 6669 6564 2061 6e64  be specified and
+0001c620: 2069 7420 6973 2075 7365 6420 6173 2073   it is used as s
+0001c630: 616c 7420 7072 6566 6978 0a0a 2020 2020  alt prefix..    
+0001c640: 2020 2020 3e3e 3e20 6120 3d20 7374 7228      >>> a = str(
+0001c650: 4352 5950 5428 6469 6765 7374 5f61 6c67  CRYPT(digest_alg
+0001c660: 3d27 6d64 3527 2c6b 6579 3d27 6d79 6b65  ='md5',key='myke
+0001c670: 7927 2c73 616c 743d 5472 7565 2928 2774  y',salt=True)('t
+0001c680: 6573 7427 295b 305d 290a 2020 2020 2020  est')[0]).      
+0001c690: 2020 3e3e 3e20 7072 696e 7428 6129 0a20    >>> print(a). 
+0001c6a0: 2020 2020 2020 206d 6435 242e 2e2e 242e         md5$...$.
+0001c6b0: 2e2e 0a0a 2020 2020 4576 656e 2069 6620  ....    Even if 
+0001c6c0: 7468 6520 616c 676f 7269 7468 6d20 6368  the algorithm ch
+0001c6d0: 616e 6765 7320 7468 6520 6861 7368 2063  anges the hash c
+0001c6e0: 616e 2073 7469 6c6c 2062 6520 7661 6c69  an still be vali
+0001c6f0: 6461 7465 640a 0a20 2020 2020 2020 203e  dated..        >
+0001c700: 3e3e 2043 5259 5054 2864 6967 6573 745f  >> CRYPT(digest_
+0001c710: 616c 673d 2773 6861 3127 2c6b 6579 3d27  alg='sha1',key='
+0001c720: 6d79 6b65 7927 2c73 616c 743d 5472 7565  mykey',salt=True
+0001c730: 2928 2774 6573 7427 295b 305d 203d 3d20  )('test')[0] == 
+0001c740: 610a 2020 2020 2020 2020 5472 7565 0a0a  a.        True..
+0001c750: 2020 2020 4966 206e 6f20 7361 6c74 2069      If no salt i
+0001c760: 7320 7370 6563 6966 6965 6420 4352 5950  s specified CRYP
+0001c770: 5420 6361 6e20 6775 6573 7320 7468 6520  T can guess the 
+0001c780: 616c 676f 7269 7468 6d73 2066 726f 6d20  algorithms from 
+0001c790: 6c65 6e67 7468 3a0a 0a20 2020 2020 2020  length:..       
+0001c7a0: 203e 3e3e 2061 203d 2073 7472 2843 5259   >>> a = str(CRY
+0001c7b0: 5054 2864 6967 6573 745f 616c 673d 2773  PT(digest_alg='s
+0001c7c0: 6861 3127 2c73 616c 743d 4661 6c73 6529  ha1',salt=False)
+0001c7d0: 2827 7465 7374 2729 5b30 5d29 0a20 2020  ('test')[0]).   
+0001c7e0: 2020 2020 203e 3e3e 2061 0a20 2020 2020       >>> a.     
+0001c7f0: 2020 2027 7368 6131 2424 6139 3461 3866     'sha1$$a94a8f
+0001c800: 6535 6363 6231 3962 6136 3163 3463 3038  e5ccb19ba61c4c08
+0001c810: 3733 6433 3931 6539 3837 3938 3266 6262  73d391e987982fbb
+0001c820: 6433 270a 2020 2020 2020 2020 3e3e 3e20  d3'.        >>> 
+0001c830: 4352 5950 5428 6469 6765 7374 5f61 6c67  CRYPT(digest_alg
+0001c840: 3d27 7368 6131 272c 7361 6c74 3d46 616c  ='sha1',salt=Fal
+0001c850: 7365 2928 2774 6573 7427 295b 305d 203d  se)('test')[0] =
+0001c860: 3d20 610a 2020 2020 2020 2020 5472 7565  = a.        True
+0001c870: 0a20 2020 2020 2020 203e 3e3e 2043 5259  .        >>> CRY
+0001c880: 5054 2864 6967 6573 745f 616c 673d 2773  PT(digest_alg='s
+0001c890: 6861 3127 2c73 616c 743d 4661 6c73 6529  ha1',salt=False)
+0001c8a0: 2827 7465 7374 2729 5b30 5d20 3d3d 2061  ('test')[0] == a
+0001c8b0: 5b36 3a5d 0a20 2020 2020 2020 2054 7275  [6:].        Tru
+0001c8c0: 650a 2020 2020 2020 2020 3e3e 3e20 4352  e.        >>> CR
+0001c8d0: 5950 5428 6469 6765 7374 5f61 6c67 3d27  YPT(digest_alg='
+0001c8e0: 6d64 3527 2c73 616c 743d 4661 6c73 6529  md5',salt=False)
+0001c8f0: 2827 7465 7374 2729 5b30 5d20 3d3d 2061  ('test')[0] == a
+0001c900: 0a20 2020 2020 2020 2054 7275 650a 2020  .        True.  
+0001c910: 2020 2020 2020 3e3e 3e20 4352 5950 5428        >>> CRYPT(
+0001c920: 6469 6765 7374 5f61 6c67 3d27 6d64 3527  digest_alg='md5'
+0001c930: 2c73 616c 743d 4661 6c73 6529 2827 7465  ,salt=False)('te
+0001c940: 7374 2729 5b30 5d20 3d3d 2061 5b36 3a5d  st')[0] == a[6:]
+0001c950: 0a20 2020 2020 2020 2054 7275 650a 2020  .        True.  
+0001c960: 2020 2222 220a 0a20 2020 2053 5441 5253    """..    STARS
+0001c970: 203d 2022 2a2a 2a2a 2a2a 220a 0a20 2020   = "******"..   
+0001c980: 2064 6566 205f 5f69 6e69 745f 5f28 0a20   def __init__(. 
+0001c990: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001c9a0: 2020 2020 206b 6579 3d4e 6f6e 652c 0a20       key=None,. 
+0001c9b0: 2020 2020 2020 2064 6967 6573 745f 616c         digest_al
+0001c9c0: 673d 2270 626b 6466 3228 3130 3030 2c32  g="pbkdf2(1000,2
+0001c9d0: 302c 7368 6135 3132 2922 2c0a 2020 2020  0,sha512)",.    
+0001c9e0: 2020 2020 6d69 6e5f 6c65 6e67 7468 3d30      min_length=0
+0001c9f0: 2c0a 2020 2020 2020 2020 6572 726f 725f  ,.        error_
+0001ca00: 6d65 7373 6167 653d 2254 6f6f 2073 686f  message="Too sho
+0001ca10: 7274 222c 0a20 2020 2020 2020 2073 616c  rt",.        sal
+0001ca20: 743d 5472 7565 2c0a 2020 2020 2020 2020  t=True,.        
+0001ca30: 6d61 785f 6c65 6e67 7468 3d31 3032 342c  max_length=1024,
+0001ca40: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0001ca50: 2222 220a 2020 2020 2020 2020 696d 706f  """.        impo
+0001ca60: 7274 616e 742c 2064 6967 6573 745f 616c  rtant, digest_al
+0001ca70: 673d 276d 6435 2720 6973 206e 6f74 2074  g='md5' is not t
+0001ca80: 6865 2064 6566 6175 6c74 2068 6173 6869  he default hashi
+0001ca90: 6e67 2061 6c67 6f72 6974 686d 2066 6f72  ng algorithm for
+0001caa0: 0a20 2020 2020 2020 2077 6562 3270 792e  .        web2py.
+0001cab0: 2054 6869 7320 6973 206f 6e6c 7920 616e   This is only an
+0001cac0: 2065 7861 6d70 6c65 206f 6620 7573 6167   example of usag
+0001cad0: 6520 6f66 2074 6869 7320 6675 6e63 7469  e of this functi
+0001cae0: 6f6e 2e0a 0a20 2020 2020 2020 2054 6865  on...        The
+0001caf0: 2061 6374 7561 6c20 6861 7368 2061 6c67   actual hash alg
+0001cb00: 6f72 6974 686d 2069 7320 6465 7465 726d  orithm is determ
+0001cb10: 696e 6564 2066 726f 6d20 7468 6520 6b65  ined from the ke
+0001cb20: 7920 7768 6963 6820 6973 0a20 2020 2020  y which is.     
+0001cb30: 2020 2067 656e 6572 6174 6564 2062 7920     generated by 
+0001cb40: 7765 6232 7079 2069 6e20 746f 6f6c 732e  web2py in tools.
+0001cb50: 7079 2e20 5468 6973 2064 6566 6175 6c74  py. This default
+0001cb60: 7320 746f 2068 6d61 632b 7368 6135 3132  s to hmac+sha512
+0001cb70: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0001cb80: 2020 2020 2020 7365 6c66 2e6b 6579 203d        self.key =
+0001cb90: 206b 6579 0a20 2020 2020 2020 2073 656c   key.        sel
+0001cba0: 662e 6469 6765 7374 5f61 6c67 203d 2064  f.digest_alg = d
+0001cbb0: 6967 6573 745f 616c 670a 2020 2020 2020  igest_alg.      
+0001cbc0: 2020 7365 6c66 2e6d 696e 5f6c 656e 6774    self.min_lengt
+0001cbd0: 6820 3d20 6d69 6e5f 6c65 6e67 7468 0a20  h = min_length. 
+0001cbe0: 2020 2020 2020 2073 656c 662e 6d61 785f         self.max_
+0001cbf0: 6c65 6e67 7468 203d 206d 6178 5f6c 656e  length = max_len
+0001cc00: 6774 680a 2020 2020 2020 2020 7365 6c66  gth.        self
+0001cc10: 2e65 7272 6f72 5f6d 6573 7361 6765 203d  .error_message =
+0001cc20: 2065 7272 6f72 5f6d 6573 7361 6765 0a20   error_message. 
+0001cc30: 2020 2020 2020 2073 656c 662e 7361 6c74         self.salt
+0001cc40: 203d 2073 616c 740a 0a20 2020 2064 6566   = salt..    def
+0001cc50: 2076 616c 6964 6174 6528 7365 6c66 2c20   validate(self, 
+0001cc60: 7661 6c75 652c 2072 6563 6f72 645f 6964  value, record_id
+0001cc70: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+0001cc80: 6966 2076 616c 7565 203d 3d20 7365 6c66  if value == self
+0001cc90: 2e53 5441 5253 3a0a 2020 2020 2020 2020  .STARS:.        
+0001cca0: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+0001ccb0: 2020 2020 2020 2020 7620 3d20 7661 6c75          v = valu
+0001ccc0: 6520 616e 6420 7374 7228 7661 6c75 6529  e and str(value)
+0001ccd0: 5b3a 2073 656c 662e 6d61 785f 6c65 6e67  [: self.max_leng
+0001cce0: 7468 5d0a 2020 2020 2020 2020 6966 206e  th].        if n
+0001ccf0: 6f74 2076 206f 7220 6c65 6e28 7629 203c  ot v or len(v) <
+0001cd00: 2073 656c 662e 6d69 6e5f 6c65 6e67 7468   self.min_length
+0001cd10: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001cd20: 6973 6520 5661 6c69 6461 7469 6f6e 4572  ise ValidationEr
+0001cd30: 726f 7228 7365 6c66 2e74 7261 6e73 6c61  ror(self.transla
+0001cd40: 746f 7228 7365 6c66 2e65 7272 6f72 5f6d  tor(self.error_m
+0001cd50: 6573 7361 6765 2929 0a20 2020 2020 2020  essage)).       
+0001cd60: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
+0001cd70: 616c 7565 2c20 4c61 7a79 4372 7970 7429  alue, LazyCrypt)
+0001cd80: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0001cd90: 7475 726e 2076 616c 7565 0a20 2020 2020  turn value.     
+0001cda0: 2020 2072 6574 7572 6e20 4c61 7a79 4372     return LazyCr
+0001cdb0: 7970 7428 7365 6c66 2c20 7661 6c75 6529  ypt(self, value)
+0001cdc0: 0a0a 2020 2020 6465 6620 666f 726d 6174  ..    def format
+0001cdd0: 7465 7228 7365 6c66 2c20 7661 6c75 6529  ter(self, value)
+0001cde0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001cdf0: 2073 656c 662e 5354 4152 530a 0a0a 2320   self.STARS...# 
+0001ce00: 2065 6e74 726f 7079 2063 616c 6375 6c61   entropy calcula
+0001ce10: 746f 7220 666f 7220 4953 5f53 5452 4f4e  tor for IS_STRON
+0001ce20: 470a 230a 6c6f 7765 7273 6574 203d 2066  G.#.lowerset = f
+0001ce30: 726f 7a65 6e73 6574 2862 2261 6263 6465  rozenset(b"abcde
+0001ce40: 6667 6869 6a6b 6c6d 6e6f 7071 7273 7475  fghijklmnopqrstu
+0001ce50: 7677 7879 7a22 290a 7570 7065 7273 6574  vwxyz").upperset
+0001ce60: 203d 2066 726f 7a65 6e73 6574 2862 2241   = frozenset(b"A
+0001ce70: 4243 4445 4647 4849 4a4b 4c4d 4e4f 5051  BCDEFGHIJKLMNOPQ
+0001ce80: 5253 5455 5657 5859 5a22 290a 6e75 6d62  RSTUVWXYZ").numb
+0001ce90: 6572 7365 7420 3d20 6672 6f7a 656e 7365  erset = frozense
+0001cea0: 7428 6222 3031 3233 3435 3637 3839 2229  t(b"0123456789")
+0001ceb0: 0a73 796d 3173 6574 203d 2066 726f 7a65  .sym1set = froze
+0001cec0: 6e73 6574 2862 2221 4023 2425 5e26 2a28  nset(b"!@#$%^&*(
+0001ced0: 2920 2229 0a73 796d 3273 6574 203d 2066  ) ").sym2set = f
+0001cee0: 726f 7a65 6e73 6574 2862 227e 602d 5f3d  rozenset(b"~`-_=
+0001cef0: 2b5b 5d7b 7d5c 5c7c 3b3a 275c 222c 2e3c  +[]{}\\|;:'\",.<
+0001cf00: 3e3f 2f22 290a 6f74 6865 7273 6574 203d  >?/").otherset =
+0001cf10: 2066 726f 7a65 6e73 6574 2862 2222 2e6a   frozenset(b"".j
+0001cf20: 6f69 6e28 6368 7228 7829 2069 6620 5059  oin(chr(x) if PY
+0001cf30: 3220 656c 7365 2063 6872 2878 292e 656e  2 else chr(x).en
+0001cf40: 636f 6465 2829 2066 6f72 2078 2069 6e20  code() for x in 
+0001cf50: 7261 6e67 6528 3235 3629 2929 0a0a 0a64  range(256)))...d
+0001cf60: 6566 2063 616c 635f 656e 7472 6f70 7928  ef calc_entropy(
+0001cf70: 7374 7269 6e67 293a 0a20 2020 2022 2222  string):.    """
+0001cf80: 6361 6c63 756c 6174 6573 2061 2073 696d  calculates a sim
+0001cf90: 706c 6520 656e 7472 6f70 7920 666f 7220  ple entropy for 
+0001cfa0: 6120 6769 7665 6e20 7374 7269 6e67 2222  a given string""
+0001cfb0: 220a 2020 2020 616c 7068 6162 6574 203d  ".    alphabet =
+0001cfc0: 2030 2020 2320 616c 7068 6162 6574 2073   0  # alphabet s
+0001cfd0: 697a 650a 2020 2020 6f74 6865 7220 3d20  ize.    other = 
+0001cfe0: 7365 7428 290a 2020 2020 7365 656e 203d  set().    seen =
+0001cff0: 2073 6574 2829 0a20 2020 206c 6173 7473   set().    lasts
+0001d000: 6574 203d 204e 6f6e 650a 2020 2020 7374  et = None.    st
+0001d010: 7269 6e67 203d 2074 6f5f 6279 7465 7328  ring = to_bytes(
+0001d020: 7374 7269 6e67 206f 7220 2222 290a 2020  string or "").  
+0001d030: 2020 666f 7220 6320 696e 2073 7472 696e    for c in strin
+0001d040: 673a 0a20 2020 2020 2020 2023 2063 6c61  g:.        # cla
+0001d050: 7373 6966 7920 7468 6973 2063 6861 7261  ssify this chara
+0001d060: 6374 6572 0a20 2020 2020 2020 2069 6e73  cter.        ins
+0001d070: 6574 203d 204e 6f6e 650a 2020 2020 2020  et = None.      
+0001d080: 2020 666f 7220 6373 6574 2069 6e20 286c    for cset in (l
+0001d090: 6f77 6572 7365 742c 2075 7070 6572 7365  owerset, upperse
+0001d0a0: 742c 206e 756d 6265 7273 6574 2c20 7379  t, numberset, sy
+0001d0b0: 6d31 7365 742c 2073 796d 3273 6574 2c20  m1set, sym2set, 
+0001d0c0: 6f74 6865 7273 6574 293a 0a20 2020 2020  otherset):.     
+0001d0d0: 2020 2020 2020 2069 6620 6320 696e 2063         if c in c
+0001d0e0: 7365 743a 0a20 2020 2020 2020 2020 2020  set:.           
+0001d0f0: 2020 2020 2069 6e73 6574 203d 2063 7365       inset = cse
+0001d100: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+0001d110: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+0001d120: 6173 7365 7274 2069 6e73 6574 2069 7320  assert inset is 
+0001d130: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+0001d140: 2023 2063 616c 6375 6c61 7465 2065 6666   # calculate eff
+0001d150: 6563 7420 6f66 2063 6861 7261 6374 6572  ect of character
+0001d160: 206f 6e20 616c 7068 6162 6574 2073 697a   on alphabet siz
+0001d170: 650a 2020 2020 2020 2020 6966 2069 6e73  e.        if ins
+0001d180: 6574 206e 6f74 2069 6e20 7365 656e 3a0a  et not in seen:.
+0001d190: 2020 2020 2020 2020 2020 2020 7365 656e              seen
+0001d1a0: 2e61 6464 2869 6e73 6574 290a 2020 2020  .add(inset).    
+0001d1b0: 2020 2020 2020 2020 616c 7068 6162 6574          alphabet
+0001d1c0: 202b 3d20 6c65 6e28 696e 7365 7429 2020   += len(inset)  
+0001d1d0: 2320 6372 6564 6974 2066 6f72 2061 206e  # credit for a n
+0001d1e0: 6577 2063 6861 7261 6374 6572 2073 6574  ew character set
+0001d1f0: 0a20 2020 2020 2020 2065 6c69 6620 6320  .        elif c 
+0001d200: 6e6f 7420 696e 206f 7468 6572 3a0a 2020  not in other:.  
+0001d210: 2020 2020 2020 2020 2020 616c 7068 6162            alphab
+0001d220: 6574 202b 3d20 3120 2023 2063 7265 6469  et += 1  # credi
+0001d230: 7420 666f 7220 756e 6971 7565 2063 6861  t for unique cha
+0001d240: 7261 6374 6572 730a 2020 2020 2020 2020  racters.        
+0001d250: 2020 2020 6f74 6865 722e 6164 6428 6329      other.add(c)
+0001d260: 0a20 2020 2020 2020 2069 6620 696e 7365  .        if inse
+0001d270: 7420 6973 206e 6f74 206c 6173 7473 6574  t is not lastset
+0001d280: 3a0a 2020 2020 2020 2020 2020 2020 616c  :.            al
+0001d290: 7068 6162 6574 202b 3d20 3120 2023 2063  phabet += 1  # c
+0001d2a0: 7265 6469 7420 666f 7220 7365 7420 7472  redit for set tr
+0001d2b0: 616e 7369 7469 6f6e 730a 2020 2020 2020  ansitions.      
+0001d2c0: 2020 2020 2020 6c61 7374 7365 7420 3d20        lastset = 
+0001d2d0: 6373 6574 0a20 2020 2065 6e74 726f 7079  cset.    entropy
+0001d2e0: 203d 206c 656e 2873 7472 696e 6729 202a   = len(string) *
+0001d2f0: 206d 6174 682e 6c6f 6728 616c 7068 6162   math.log(alphab
+0001d300: 6574 206f 7220 3129 202f 2030 2e36 3933  et or 1) / 0.693
+0001d310: 3134 3731 3830 3535 3939 3435 3320 2023  1471805599453  #
+0001d320: 206d 6174 682e 6c6f 6728 3229 0a20 2020   math.log(2).   
+0001d330: 2072 6574 7572 6e20 726f 756e 6428 656e   return round(en
+0001d340: 7472 6f70 792c 2032 290a 0a0a 636c 6173  tropy, 2)...clas
+0001d350: 7320 4953 5f53 5452 4f4e 4728 5661 6c69  s IS_STRONG(Vali
+0001d360: 6461 746f 7229 3a0a 2020 2020 2222 220a  dator):.    """.
+0001d370: 2020 2020 4578 616d 706c 6573 3a0a 2020      Examples:.  
+0001d380: 2020 2020 2020 5573 6520 6173 3a3a 0a0a        Use as::..
+0001d390: 2020 2020 2020 2020 2020 2020 494e 5055              INPU
+0001d3a0: 5428 5f74 7970 653d 2770 6173 7377 6f72  T(_type='passwor
+0001d3b0: 6427 2c20 5f6e 616d 653d 2770 6173 7377  d', _name='passw
+0001d3c0: 6427 2c0a 2020 2020 2020 2020 2020 2020  d',.            
+0001d3d0: 7265 7175 6972 6573 3d49 535f 5354 524f  requires=IS_STRO
+0001d3e0: 4e47 286d 696e 3d31 302c 2073 7065 6369  NG(min=10, speci
+0001d3f0: 616c 3d32 2c20 7570 7065 723d 3229 290a  al=2, upper=2)).
+0001d400: 0a20 2020 2065 6e66 6f72 6365 7320 636f  .    enforces co
+0001d410: 6d70 6c65 7869 7479 2072 6571 7569 7265  mplexity require
+0001d420: 6d65 6e74 7320 6f6e 2061 2066 6965 6c64  ments on a field
+0001d430: 0a0a 2020 2020 2020 2020 3e3e 3e20 4953  ..        >>> IS
+0001d440: 5f53 5452 4f4e 4728 6573 3d54 7275 6529  _STRONG(es=True)
+0001d450: 2827 4162 6364 3132 3334 2729 0a20 2020  ('Abcd1234').   
+0001d460: 2020 2020 2028 2741 6263 6431 3233 3427       ('Abcd1234'
+0001d470: 2c0a 2020 2020 2020 2020 2027 4d75 7374  ,.         'Must
+0001d480: 2069 6e63 6c75 6465 2061 7420 6c65 6173   include at leas
+0001d490: 7420 3120 6f66 2074 6865 2066 6f6c 6c6f  t 1 of the follo
+0001d4a0: 7769 6e67 3a20 7e21 4023 2425 5e26 2a28  wing: ~!@#$%^&*(
+0001d4b0: 295f 2b2d 3d3f 3c3e 2c2e 3a3b 7b7d 5b5d  )_+-=?<>,.:;{}[]
+0001d4c0: 7c27 290a 2020 2020 2020 2020 3e3e 3e20  |').        >>> 
+0001d4d0: 4953 5f53 5452 4f4e 4728 6573 3d54 7275  IS_STRONG(es=Tru
+0001d4e0: 6529 2827 4162 6364 3132 3334 2127 290a  e)('Abcd1234!').
+0001d4f0: 2020 2020 2020 2020 2827 4162 6364 3132          ('Abcd12
+0001d500: 3334 2127 2c20 4e6f 6e65 290a 2020 2020  34!', None).    
+0001d510: 2020 2020 3e3e 3e20 4953 5f53 5452 4f4e      >>> IS_STRON
+0001d520: 4728 6573 3d54 7275 652c 2065 6e74 726f  G(es=True, entro
+0001d530: 7079 3d31 2928 2761 2729 0a20 2020 2020  py=1)('a').     
+0001d540: 2020 2028 2761 272c 204e 6f6e 6529 0a20     ('a', None). 
+0001d550: 2020 2020 2020 203e 3e3e 2049 535f 5354         >>> IS_ST
+0001d560: 524f 4e47 2865 733d 5472 7565 2c20 656e  RONG(es=True, en
+0001d570: 7472 6f70 793d 312c 206d 696e 3d32 2928  tropy=1, min=2)(
+0001d580: 2761 2729 0a20 2020 2020 2020 2028 2761  'a').        ('a
+0001d590: 272c 2027 4d69 6e69 6d75 6d20 6c65 6e67  ', 'Minimum leng
+0001d5a0: 7468 2069 7320 3227 290a 2020 2020 2020  th is 2').      
+0001d5b0: 2020 3e3e 3e20 4953 5f53 5452 4f4e 4728    >>> IS_STRONG(
+0001d5c0: 6573 3d54 7275 652c 2065 6e74 726f 7079  es=True, entropy
+0001d5d0: 3d31 3030 2928 2761 6263 3132 3327 290a  =100)('abc123').
+0001d5e0: 2020 2020 2020 2020 2827 6162 6331 3233          ('abc123
+0001d5f0: 272c 2027 5061 7373 776f 7264 2074 6f6f  ', 'Password too
+0001d600: 2073 696d 706c 6520 2833 322e 3335 2f31   simple (32.35/1
+0001d610: 3030 2927 290a 2020 2020 2020 2020 3e3e  00)').        >>
+0001d620: 3e20 4953 5f53 5452 4f4e 4728 6573 3d54  > IS_STRONG(es=T
+0001d630: 7275 652c 2065 6e74 726f 7079 3d31 3030  rue, entropy=100
+0001d640: 2928 2761 6e64 2729 0a20 2020 2020 2020  )('and').       
+0001d650: 2028 2761 6e64 272c 2027 5061 7373 776f   ('and', 'Passwo
+0001d660: 7264 2074 6f6f 2073 696d 706c 6520 2831  rd too simple (1
+0001d670: 342e 3537 2f31 3030 2927 290a 2020 2020  4.57/100)').    
+0001d680: 2020 2020 3e3e 3e20 4953 5f53 5452 4f4e      >>> IS_STRON
+0001d690: 4728 6573 3d54 7275 652c 2065 6e74 726f  G(es=True, entro
+0001d6a0: 7079 3d31 3030 2928 2761 6161 2729 0a20  py=100)('aaa'). 
+0001d6b0: 2020 2020 2020 2028 2761 6161 272c 2027         ('aaa', '
+0001d6c0: 5061 7373 776f 7264 2074 6f6f 2073 696d  Password too sim
+0001d6d0: 706c 6520 2831 342e 3432 2f31 3030 2927  ple (14.42/100)'
+0001d6e0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+0001d6f0: 5f53 5452 4f4e 4728 6573 3d54 7275 652c  _STRONG(es=True,
+0001d700: 2065 6e74 726f 7079 3d31 3030 2928 2761   entropy=100)('a
+0001d710: 3164 2729 0a20 2020 2020 2020 2028 2761  1d').        ('a
+0001d720: 3164 272c 2027 5061 7373 776f 7264 2074  1d', 'Password t
+0001d730: 6f6f 2073 696d 706c 6520 2831 352e 3937  oo simple (15.97
+0001d740: 2f31 3030 2927 290a 2020 2020 2020 2020  /100)').        
+0001d750: 3e3e 3e20 4953 5f53 5452 4f4e 4728 6573  >>> IS_STRONG(es
+0001d760: 3d54 7275 652c 2065 6e74 726f 7079 3d31  =True, entropy=1
+0001d770: 3030 2928 2761 c3b1 6427 290a 2020 2020  00)('a..d').    
+0001d780: 2020 2020 2827 615c 5c78 6333 5c5c 7862      ('a\\xc3\\xb
+0001d790: 3164 272c 2027 5061 7373 776f 7264 2074  1d', 'Password t
+0001d7a0: 6f6f 2073 696d 706c 6520 2833 312e 3236  oo simple (31.26
+0001d7b0: 2f31 3029 2729 0a0a 2020 2020 2222 220a  /10)')..    """.
+0001d7c0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+0001d7d0: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
+0001d7e0: 0a20 2020 2020 2020 206d 696e 3d4e 6f6e  .        min=Non
+0001d7f0: 652c 0a20 2020 2020 2020 206d 6178 3d4e  e,.        max=N
+0001d800: 6f6e 652c 0a20 2020 2020 2020 2075 7070  one,.        upp
+0001d810: 6572 3d4e 6f6e 652c 0a20 2020 2020 2020  er=None,.       
+0001d820: 206c 6f77 6572 3d4e 6f6e 652c 0a20 2020   lower=None,.   
+0001d830: 2020 2020 206e 756d 6265 723d 4e6f 6e65       number=None
+0001d840: 2c0a 2020 2020 2020 2020 656e 7472 6f70  ,.        entrop
+0001d850: 793d 4e6f 6e65 2c0a 2020 2020 2020 2020  y=None,.        
+0001d860: 7370 6563 6961 6c3d 4e6f 6e65 2c0a 2020  special=None,.  
+0001d870: 2020 2020 2020 7370 6563 6961 6c73 3d72        specials=r
+0001d880: 227e 2140 2324 255e 262a 2829 5f2b 2d3d  "~!@#$%^&*()_+-=
+0001d890: 3f3c 3e2c 2e3a 3b7b 7d5b 5d7c 222c 0a20  ?<>,.:;{}[]|",. 
+0001d8a0: 2020 2020 2020 2069 6e76 616c 6964 3d27         invalid='
+0001d8b0: 2022 272c 0a20 2020 2020 2020 2065 7272   "',.        err
+0001d8c0: 6f72 5f6d 6573 7361 6765 3d4e 6f6e 652c  or_message=None,
+0001d8d0: 0a20 2020 2020 2020 2065 733d 4661 6c73  .        es=Fals
+0001d8e0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+0001d8f0: 2020 7365 6c66 2e65 6e74 726f 7079 203d    self.entropy =
+0001d900: 2065 6e74 726f 7079 0a20 2020 2020 2020   entropy.       
+0001d910: 2069 6620 656e 7472 6f70 7920 6973 204e   if entropy is N
+0001d920: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0001d930: 2023 2065 6e66 6f72 6365 2064 6566 6175   # enforce defau
+0001d940: 6c74 2072 6571 7569 7265 6d65 6e74 730a  lt requirements.
+0001d950: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001d960: 2e6d 696e 203d 2038 2069 6620 6d69 6e20  .min = 8 if min 
+0001d970: 6973 204e 6f6e 6520 656c 7365 206d 696e  is None else min
+0001d980: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001d990: 662e 6d61 7820 3d20 6d61 7820 2023 2077  f.max = max  # w
+0001d9a0: 6173 2032 302c 2062 7574 2074 6861 7420  as 20, but that 
+0001d9b0: 646f 6573 6e27 7420 6d61 6b65 2073 656e  doesn't make sen
+0001d9c0: 7365 0a20 2020 2020 2020 2020 2020 2073  se.            s
+0001d9d0: 656c 662e 7570 7065 7220 3d20 3120 6966  elf.upper = 1 if
+0001d9e0: 2075 7070 6572 2069 7320 4e6f 6e65 2065   upper is None e
+0001d9f0: 6c73 6520 7570 7065 720a 2020 2020 2020  lse upper.      
+0001da00: 2020 2020 2020 7365 6c66 2e6c 6f77 6572        self.lower
+0001da10: 203d 2031 2069 6620 6c6f 7765 7220 6973   = 1 if lower is
+0001da20: 204e 6f6e 6520 656c 7365 206c 6f77 6572   None else lower
+0001da30: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001da40: 662e 6e75 6d62 6572 203d 2031 2069 6620  f.number = 1 if 
+0001da50: 6e75 6d62 6572 2069 7320 4e6f 6e65 2065  number is None e
+0001da60: 6c73 6520 6e75 6d62 6572 0a20 2020 2020  lse number.     
+0001da70: 2020 2020 2020 2073 656c 662e 7370 6563         self.spec
+0001da80: 6961 6c20 3d20 3120 6966 2073 7065 6369  ial = 1 if speci
+0001da90: 616c 2069 7320 4e6f 6e65 2065 6c73 6520  al is None else 
+0001daa0: 7370 6563 6961 6c0a 2020 2020 2020 2020  special.        
+0001dab0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001dac0: 2020 2320 6279 2064 6566 6175 6c74 2c20    # by default, 
+0001dad0: 616e 2065 6e74 726f 7079 2073 7065 6320  an entropy spec 
+0001dae0: 6973 2065 7863 6c75 7369 7665 0a20 2020  is exclusive.   
+0001daf0: 2020 2020 2020 2020 2073 656c 662e 6d69           self.mi
+0001db00: 6e20 3d20 6d69 6e0a 2020 2020 2020 2020  n = min.        
+0001db10: 2020 2020 7365 6c66 2e6d 6178 203d 206d      self.max = m
+0001db20: 6178 0a20 2020 2020 2020 2020 2020 2073  ax.            s
+0001db30: 656c 662e 7570 7065 7220 3d20 7570 7065  elf.upper = uppe
+0001db40: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
+0001db50: 6c66 2e6c 6f77 6572 203d 206c 6f77 6572  lf.lower = lower
+0001db60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001db70: 662e 6e75 6d62 6572 203d 206e 756d 6265  f.number = numbe
+0001db80: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
+0001db90: 6c66 2e73 7065 6369 616c 203d 2073 7065  lf.special = spe
+0001dba0: 6369 616c 0a20 2020 2020 2020 2073 656c  cial.        sel
+0001dbb0: 662e 7370 6563 6961 6c73 203d 2073 7065  f.specials = spe
+0001dbc0: 6369 616c 730a 2020 2020 2020 2020 7365  cials.        se
+0001dbd0: 6c66 2e69 6e76 616c 6964 203d 2069 6e76  lf.invalid = inv
+0001dbe0: 616c 6964 0a20 2020 2020 2020 2073 656c  alid.        sel
+0001dbf0: 662e 6572 726f 725f 6d65 7373 6167 6520  f.error_message 
+0001dc00: 3d20 6572 726f 725f 6d65 7373 6167 650a  = error_message.
+0001dc10: 2020 2020 2020 2020 7365 6c66 2e65 7374          self.est
+0001dc20: 7269 6e67 203d 2065 7320 2023 2072 6574  ring = es  # ret
+0001dc30: 7572 6e20 6572 726f 7220 6d65 7373 6167  urn error messag
+0001dc40: 6520 6173 2073 7472 696e 6720 2866 6f72  e as string (for
+0001dc50: 2064 6f63 7465 7374 290a 0a20 2020 2064   doctest)..    d
+0001dc60: 6566 2076 616c 6964 6174 6528 7365 6c66  ef validate(self
+0001dc70: 2c20 7661 6c75 652c 2072 6563 6f72 645f  , value, record_
+0001dc80: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
+0001dc90: 2020 6661 696c 7572 6573 203d 205b 5d0a    failures = [].
+0001dca0: 2020 2020 2020 2020 6966 2076 616c 7565          if value
+0001dcb0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0001dcc0: 2020 2020 2020 7661 6c75 6520 3d20 2222        value = ""
+0001dcd0: 0a20 2020 2020 2020 2069 6620 7661 6c75  .        if valu
+0001dce0: 6520 616e 6420 6c65 6e28 7661 6c75 6529  e and len(value)
+0001dcf0: 203d 3d20 7661 6c75 652e 636f 756e 7428   == value.count(
+0001dd00: 222a 2229 203e 2034 3a0a 2020 2020 2020  "*") > 4:.      
+0001dd10: 2020 2020 2020 7265 7475 726e 2076 616c        return val
+0001dd20: 7565 0a20 2020 2020 2020 2069 6620 7365  ue.        if se
+0001dd30: 6c66 2e65 6e74 726f 7079 2069 7320 6e6f  lf.entropy is no
+0001dd40: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0001dd50: 2020 2020 656e 7472 6f70 7920 3d20 6361      entropy = ca
+0001dd60: 6c63 5f65 6e74 726f 7079 2876 616c 7565  lc_entropy(value
+0001dd70: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0001dd80: 2065 6e74 726f 7079 203c 2073 656c 662e   entropy < self.
+0001dd90: 656e 7472 6f70 793a 0a20 2020 2020 2020  entropy:.       
+0001dda0: 2020 2020 2020 2020 2066 6169 6c75 7265           failure
+0001ddb0: 732e 6170 7065 6e64 280a 2020 2020 2020  s.append(.      
+0001ddc0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001ddd0: 6c66 2e74 7261 6e73 6c61 746f 7228 2250  lf.translator("P
+0001dde0: 6173 7377 6f72 6420 746f 6f20 7369 6d70  assword too simp
+0001ddf0: 6c65 2028 2528 6861 7665 2973 2f25 286e  le (%(have)s/%(n
+0001de00: 6565 6429 7329 2229 0a20 2020 2020 2020  eed)s)").       
+0001de10: 2020 2020 2020 2020 2020 2020 2025 2064               % d
+0001de20: 6963 7428 6861 7665 3d65 6e74 726f 7079  ict(have=entropy
+0001de30: 2c20 6e65 6564 3d73 656c 662e 656e 7472  , need=self.entr
+0001de40: 6f70 7929 0a20 2020 2020 2020 2020 2020  opy).           
+0001de50: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+0001de60: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
+0001de70: 662e 6d69 6e2c 2069 6e74 2920 616e 6420  f.min, int) and 
+0001de80: 7365 6c66 2e6d 696e 203e 2030 3a0a 2020  self.min > 0:.  
+0001de90: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0001dea0: 206c 656e 2876 616c 7565 2920 3e3d 2073   len(value) >= s
+0001deb0: 656c 662e 6d69 6e3a 0a20 2020 2020 2020  elf.min:.       
+0001dec0: 2020 2020 2020 2020 2066 6169 6c75 7265           failure
+0001ded0: 732e 6170 7065 6e64 2873 656c 662e 7472  s.append(self.tr
+0001dee0: 616e 736c 6174 6f72 2822 4d69 6e69 6d75  anslator("Minimu
+0001def0: 6d20 6c65 6e67 7468 2069 7320 2573 2229  m length is %s")
+0001df00: 2025 2073 656c 662e 6d69 6e29 0a20 2020   % self.min).   
+0001df10: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0001df20: 6365 2873 656c 662e 6d61 782c 2069 6e74  ce(self.max, int
+0001df30: 2920 616e 6420 7365 6c66 2e6d 6178 203e  ) and self.max >
+0001df40: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0001df50: 6966 206e 6f74 206c 656e 2876 616c 7565  if not len(value
+0001df60: 2920 3c3d 2073 656c 662e 6d61 783a 0a20  ) <= self.max:. 
+0001df70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001df80: 6169 6c75 7265 732e 6170 7065 6e64 2873  ailures.append(s
+0001df90: 656c 662e 7472 616e 736c 6174 6f72 2822  elf.translator("
+0001dfa0: 4d61 7869 6d75 6d20 6c65 6e67 7468 2069  Maximum length i
+0001dfb0: 7320 2573 2229 2025 2073 656c 662e 6d61  s %s") % self.ma
+0001dfc0: 7829 0a20 2020 2020 2020 2069 6620 6973  x).        if is
+0001dfd0: 696e 7374 616e 6365 2873 656c 662e 7370  instance(self.sp
+0001dfe0: 6563 6961 6c2c 2069 6e74 293a 0a20 2020  ecial, int):.   
+0001dff0: 2020 2020 2020 2020 2061 6c6c 5f73 7065           all_spe
+0001e000: 6369 616c 203d 205b 6368 2069 6e20 7661  cial = [ch in va
+0001e010: 6c75 6520 666f 7220 6368 2069 6e20 7365  lue for ch in se
+0001e020: 6c66 2e73 7065 6369 616c 735d 0a20 2020  lf.specials].   
+0001e030: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0001e040: 2e73 7065 6369 616c 203e 2030 3a0a 2020  .special > 0:.  
+0001e050: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001e060: 206e 6f74 2061 6c6c 5f73 7065 6369 616c   not all_special
+0001e070: 2e63 6f75 6e74 2854 7275 6529 203e 3d20  .count(True) >= 
+0001e080: 7365 6c66 2e73 7065 6369 616c 3a0a 2020  self.special:.  
+0001e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e0a0: 2020 6661 696c 7572 6573 2e61 7070 656e    failures.appen
+0001e0b0: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
+0001e0c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001e0d0: 7472 616e 736c 6174 6f72 2822 4d75 7374  translator("Must
+0001e0e0: 2069 6e63 6c75 6465 2061 7420 6c65 6173   include at leas
+0001e0f0: 7420 2573 206f 6620 7468 6520 666f 6c6c  t %s of the foll
+0001e100: 6f77 696e 673a 2025 7322 290a 2020 2020  owing: %s").    
 0001e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e120: 2020 2020 2020 2020 2520 2873 656c 662e          % (self.
-0001e130: 7370 6563 6961 6c2c 2073 656c 662e 7370  special, self.sp
-0001e140: 6563 6961 6c73 290a 2020 2020 2020 2020  ecials).        
-0001e150: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001e160: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-0001e170: 656c 662e 7370 6563 6961 6c20 3d3d 2030  elf.special == 0
-0001e180: 2061 6e64 2073 656c 662e 7370 6563 6961   and self.specia
-0001e190: 6c20 6973 206e 6f74 2046 616c 7365 3a0a  l is not False:.
-0001e1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e1b0: 6966 206c 656e 285b 6974 656d 2066 6f72  if len([item for
-0001e1c0: 2069 7465 6d20 696e 2061 6c6c 5f73 7065   item in all_spe
-0001e1d0: 6369 616c 2069 6620 6974 656d 5d29 203e  cial if item]) >
-0001e1e0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0001e1f0: 2020 2020 2020 2020 6661 696c 7572 6573          failures
-0001e200: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
-0001e210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e220: 2073 656c 662e 7472 616e 736c 6174 6f72   self.translator
-0001e230: 2822 4d61 7920 6e6f 7420 636f 6e74 6169  ("May not contai
-0001e240: 6e20 616e 7920 6f66 2074 6865 2066 6f6c  n any of the fol
-0001e250: 6c6f 7769 6e67 3a20 2573 2229 0a20 2020  lowing: %s").   
+0001e120: 2020 2020 2520 2873 656c 662e 7370 6563      % (self.spec
+0001e130: 6961 6c2c 2073 656c 662e 7370 6563 6961  ial, self.specia
+0001e140: 6c73 290a 2020 2020 2020 2020 2020 2020  ls).            
+0001e150: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001e160: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0001e170: 7370 6563 6961 6c20 3d3d 2030 2061 6e64  special == 0 and
+0001e180: 2073 656c 662e 7370 6563 6961 6c20 6973   self.special is
+0001e190: 206e 6f74 2046 616c 7365 3a0a 2020 2020   not False:.    
+0001e1a0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0001e1b0: 656e 285b 6974 656d 2066 6f72 2069 7465  en([item for ite
+0001e1c0: 6d20 696e 2061 6c6c 5f73 7065 6369 616c  m in all_special
+0001e1d0: 2069 6620 6974 656d 5d29 203e 2030 3a0a   if item]) > 0:.
+0001e1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e1f0: 2020 2020 6661 696c 7572 6573 2e61 7070      failures.app
+0001e200: 656e 6428 0a20 2020 2020 2020 2020 2020  end(.           
+0001e210: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001e220: 662e 7472 616e 736c 6174 6f72 2822 4d61  f.translator("Ma
+0001e230: 7920 6e6f 7420 636f 6e74 6169 6e20 616e  y not contain an
+0001e240: 7920 6f66 2074 6865 2066 6f6c 6c6f 7769  y of the followi
+0001e250: 6e67 3a20 2573 2229 0a20 2020 2020 2020  ng: %s").       
 0001e260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e270: 2020 2020 2025 2073 656c 662e 7370 6563       % self.spec
-0001e280: 6961 6c73 0a20 2020 2020 2020 2020 2020  ials.           
-0001e290: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001e2a0: 2020 2069 6620 7365 6c66 2e69 6e76 616c     if self.inval
-0001e2b0: 6964 3a0a 2020 2020 2020 2020 2020 2020  id:.            
-0001e2c0: 616c 6c5f 696e 7661 6c69 6420 3d20 5b63  all_invalid = [c
-0001e2d0: 6820 696e 2076 616c 7565 2066 6f72 2063  h in value for c
-0001e2e0: 6820 696e 2073 656c 662e 696e 7661 6c69  h in self.invali
-0001e2f0: 645d 0a20 2020 2020 2020 2020 2020 2069  d].            i
-0001e300: 6620 616c 6c5f 696e 7661 6c69 642e 636f  f all_invalid.co
-0001e310: 756e 7428 5472 7565 2920 3e20 303a 0a20  unt(True) > 0:. 
-0001e320: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001e330: 6169 6c75 7265 732e 6170 7065 6e64 280a  ailures.append(.
+0001e270: 2025 2073 656c 662e 7370 6563 6961 6c73   % self.specials
+0001e280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e290: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+0001e2a0: 6620 7365 6c66 2e69 6e76 616c 6964 3a0a  f self.invalid:.
+0001e2b0: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
+0001e2c0: 696e 7661 6c69 6420 3d20 5b63 6820 696e  invalid = [ch in
+0001e2d0: 2076 616c 7565 2066 6f72 2063 6820 696e   value for ch in
+0001e2e0: 2073 656c 662e 696e 7661 6c69 645d 0a20   self.invalid]. 
+0001e2f0: 2020 2020 2020 2020 2020 2069 6620 616c             if al
+0001e300: 6c5f 696e 7661 6c69 642e 636f 756e 7428  l_invalid.count(
+0001e310: 5472 7565 2920 3e20 303a 0a20 2020 2020  True) > 0:.     
+0001e320: 2020 2020 2020 2020 2020 2066 6169 6c75             failu
+0001e330: 7265 732e 6170 7065 6e64 280a 2020 2020  res.append(.    
 0001e340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e350: 2020 2020 7365 6c66 2e74 7261 6e73 6c61      self.transla
-0001e360: 746f 7228 224d 6179 206e 6f74 2063 6f6e  tor("May not con
-0001e370: 7461 696e 2061 6e79 206f 6620 7468 6520  tain any of the 
-0001e380: 666f 6c6c 6f77 696e 673a 2025 7322 290a  following: %s").
+0001e350: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
+0001e360: 224d 6179 206e 6f74 2063 6f6e 7461 696e  "May not contain
+0001e370: 2061 6e79 206f 6620 7468 6520 666f 6c6c   any of the foll
+0001e380: 6f77 696e 673a 2025 7322 290a 2020 2020  owing: %s").    
 0001e390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e3a0: 2020 2020 2520 7365 6c66 2e69 6e76 616c      % self.inval
-0001e3b0: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
-0001e3c0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-0001e3d0: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
-0001e3e0: 7570 7065 722c 2069 6e74 293a 0a20 2020  upper, int):.   
-0001e3f0: 2020 2020 2020 2020 2061 6c6c 5f75 7070           all_upp
-0001e400: 6572 203d 2072 652e 6669 6e64 616c 6c28  er = re.findall(
-0001e410: 225b 412d 5a5d 222c 2076 616c 7565 290a  "[A-Z]", value).
-0001e420: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001e430: 656c 662e 7570 7065 7220 3e20 303a 0a20  elf.upper > 0:. 
-0001e440: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001e450: 6620 6e6f 7420 6c65 6e28 616c 6c5f 7570  f not len(all_up
-0001e460: 7065 7229 203e 3d20 7365 6c66 2e75 7070  per) >= self.upp
-0001e470: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
-0001e480: 2020 2020 2020 2020 6661 696c 7572 6573          failures
-0001e490: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
-0001e4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e4b0: 2073 656c 662e 7472 616e 736c 6174 6f72   self.translator
-0001e4c0: 2822 4d75 7374 2069 6e63 6c75 6465 2061  ("Must include a
-0001e4d0: 7420 6c65 6173 7420 2573 2075 7070 6572  t least %s upper
-0001e4e0: 6361 7365 2229 0a20 2020 2020 2020 2020  case").         
-0001e4f0: 2020 2020 2020 2020 2020 2020 2020 2025                 %
-0001e500: 2073 7472 2873 656c 662e 7570 7065 7229   str(self.upper)
-0001e510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e520: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0001e530: 2020 2065 6c69 6620 7365 6c66 2e75 7070     elif self.upp
-0001e540: 6572 203d 3d20 3020 616e 6420 7365 6c66  er == 0 and self
-0001e550: 2e75 7070 6572 2069 7320 6e6f 7420 4661  .upper is not Fa
-0001e560: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001e570: 2020 2020 2069 6620 6c65 6e28 616c 6c5f       if len(all_
-0001e580: 7570 7065 7229 203e 2030 3a0a 2020 2020  upper) > 0:.    
-0001e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e5a0: 6661 696c 7572 6573 2e61 7070 656e 6428  failures.append(
-0001e5b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e5c0: 2020 2020 2020 2020 2073 656c 662e 7472           self.tr
-0001e5d0: 616e 736c 6174 6f72 2822 4d61 7920 6e6f  anslator("May no
-0001e5e0: 7420 696e 636c 7564 6520 616e 7920 7570  t include any up
-0001e5f0: 7065 7263 6173 6520 6c65 7474 6572 7322  percase letters"
-0001e600: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001e610: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001e620: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
-0001e630: 6c66 2e6c 6f77 6572 2c20 696e 7429 3a0a  lf.lower, int):.
-0001e640: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
-0001e650: 6c6f 7765 7220 3d20 7265 2e66 696e 6461  lower = re.finda
-0001e660: 6c6c 2822 5b61 2d7a 5d22 2c20 7661 6c75  ll("[a-z]", valu
-0001e670: 6529 0a20 2020 2020 2020 2020 2020 2069  e).            i
-0001e680: 6620 7365 6c66 2e6c 6f77 6572 203e 2030  f self.lower > 0
-0001e690: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001e6a0: 2020 6966 206e 6f74 206c 656e 2861 6c6c    if not len(all
-0001e6b0: 5f6c 6f77 6572 2920 3e3d 2073 656c 662e  _lower) >= self.
-0001e6c0: 6c6f 7765 723a 0a20 2020 2020 2020 2020  lower:.         
-0001e6d0: 2020 2020 2020 2020 2020 2066 6169 6c75             failu
-0001e6e0: 7265 732e 6170 7065 6e64 280a 2020 2020  res.append(.    
+0001e3a0: 2520 7365 6c66 2e69 6e76 616c 6964 0a20  % self.invalid. 
+0001e3b0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001e3c0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0001e3d0: 7374 616e 6365 2873 656c 662e 7570 7065  stance(self.uppe
+0001e3e0: 722c 2069 6e74 293a 0a20 2020 2020 2020  r, int):.       
+0001e3f0: 2020 2020 2061 6c6c 5f75 7070 6572 203d       all_upper =
+0001e400: 2072 652e 6669 6e64 616c 6c28 225b 412d   re.findall("[A-
+0001e410: 5a5d 222c 2076 616c 7565 290a 2020 2020  Z]", value).    
+0001e420: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001e430: 7570 7065 7220 3e20 303a 0a20 2020 2020  upper > 0:.     
+0001e440: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0001e450: 7420 6c65 6e28 616c 6c5f 7570 7065 7229  t len(all_upper)
+0001e460: 203e 3d20 7365 6c66 2e75 7070 6572 3a0a   >= self.upper:.
+0001e470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e480: 2020 2020 6661 696c 7572 6573 2e61 7070      failures.app
+0001e490: 656e 6428 0a20 2020 2020 2020 2020 2020  end(.           
+0001e4a0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001e4b0: 662e 7472 616e 736c 6174 6f72 2822 4d75  f.translator("Mu
+0001e4c0: 7374 2069 6e63 6c75 6465 2061 7420 6c65  st include at le
+0001e4d0: 6173 7420 2573 2075 7070 6572 6361 7365  ast %s uppercase
+0001e4e0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+0001e4f0: 2020 2020 2020 2020 2020 2025 2073 7472             % str
+0001e500: 2873 656c 662e 7570 7065 7229 0a20 2020  (self.upper).   
+0001e510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e520: 2029 0a20 2020 2020 2020 2020 2020 2065   ).            e
+0001e530: 6c69 6620 7365 6c66 2e75 7070 6572 203d  lif self.upper =
+0001e540: 3d20 3020 616e 6420 7365 6c66 2e75 7070  = 0 and self.upp
+0001e550: 6572 2069 7320 6e6f 7420 4661 6c73 653a  er is not False:
+0001e560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e570: 2069 6620 6c65 6e28 616c 6c5f 7570 7065   if len(all_uppe
+0001e580: 7229 203e 2030 3a0a 2020 2020 2020 2020  r) > 0:.        
+0001e590: 2020 2020 2020 2020 2020 2020 6661 696c              fail
+0001e5a0: 7572 6573 2e61 7070 656e 6428 0a20 2020  ures.append(.   
+0001e5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e5c0: 2020 2020 2073 656c 662e 7472 616e 736c       self.transl
+0001e5d0: 6174 6f72 2822 4d61 7920 6e6f 7420 696e  ator("May not in
+0001e5e0: 636c 7564 6520 616e 7920 7570 7065 7263  clude any upperc
+0001e5f0: 6173 6520 6c65 7474 6572 7322 290a 2020  ase letters").  
+0001e600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e610: 2020 290a 2020 2020 2020 2020 6966 2069    ).        if i
+0001e620: 7369 6e73 7461 6e63 6528 7365 6c66 2e6c  sinstance(self.l
+0001e630: 6f77 6572 2c20 696e 7429 3a0a 2020 2020  ower, int):.    
+0001e640: 2020 2020 2020 2020 616c 6c5f 6c6f 7765          all_lowe
+0001e650: 7220 3d20 7265 2e66 696e 6461 6c6c 2822  r = re.findall("
+0001e660: 5b61 2d7a 5d22 2c20 7661 6c75 6529 0a20  [a-z]", value). 
+0001e670: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001e680: 6c66 2e6c 6f77 6572 203e 2030 3a0a 2020  lf.lower > 0:.  
+0001e690: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001e6a0: 206e 6f74 206c 656e 2861 6c6c 5f6c 6f77   not len(all_low
+0001e6b0: 6572 2920 3e3d 2073 656c 662e 6c6f 7765  er) >= self.lowe
+0001e6c0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+0001e6d0: 2020 2020 2020 2066 6169 6c75 7265 732e         failures.
+0001e6e0: 6170 7065 6e64 280a 2020 2020 2020 2020  append(.        
 0001e6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e700: 2020 2020 7365 6c66 2e74 7261 6e73 6c61      self.transla
-0001e710: 746f 7228 224d 7573 7420 696e 636c 7564  tor("Must includ
-0001e720: 6520 6174 206c 6561 7374 2025 7320 6c6f  e at least %s lo
-0001e730: 7765 7263 6173 6522 290a 2020 2020 2020  wercase").      
-0001e740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e750: 2020 2520 7374 7228 7365 6c66 2e6c 6f77    % str(self.low
-0001e760: 6572 290a 2020 2020 2020 2020 2020 2020  er).            
-0001e770: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001e780: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0001e790: 6c6f 7765 7220 3d3d 2030 2061 6e64 2073  lower == 0 and s
-0001e7a0: 656c 662e 6c6f 7765 7220 6973 206e 6f74  elf.lower is not
-0001e7b0: 2046 616c 7365 3a0a 2020 2020 2020 2020   False:.        
-0001e7c0: 2020 2020 2020 2020 6966 206c 656e 2861          if len(a
-0001e7d0: 6c6c 5f6c 6f77 6572 2920 3e20 303a 0a20  ll_lower) > 0:. 
-0001e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e7f0: 2020 2066 6169 6c75 7265 732e 6170 7065     failures.appe
-0001e800: 6e64 280a 2020 2020 2020 2020 2020 2020  nd(.            
-0001e810: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001e820: 2e74 7261 6e73 6c61 746f 7228 224d 6179  .translator("May
-0001e830: 206e 6f74 2069 6e63 6c75 6465 2061 6e79   not include any
-0001e840: 206c 6f77 6572 6361 7365 206c 6574 7465   lowercase lette
-0001e850: 7273 2229 0a20 2020 2020 2020 2020 2020  rs").           
-0001e860: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001e870: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0001e880: 2873 656c 662e 6e75 6d62 6572 2c20 696e  (self.number, in
-0001e890: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-0001e8a0: 616c 6c5f 6e75 6d62 6572 203d 2072 652e  all_number = re.
-0001e8b0: 6669 6e64 616c 6c28 225b 302d 395d 222c  findall("[0-9]",
-0001e8c0: 2076 616c 7565 290a 2020 2020 2020 2020   value).        
-0001e8d0: 2020 2020 6966 2073 656c 662e 6e75 6d62      if self.numb
-0001e8e0: 6572 203e 2030 3a0a 2020 2020 2020 2020  er > 0:.        
-0001e8f0: 2020 2020 2020 2020 6e75 6d62 6572 7320          numbers 
-0001e900: 3d20 226e 756d 6265 7222 0a20 2020 2020  = "number".     
-0001e910: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001e920: 6c66 2e6e 756d 6265 7220 3e20 313a 0a20  lf.number > 1:. 
-0001e930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e940: 2020 206e 756d 6265 7273 203d 2022 6e75     numbers = "nu
-0001e950: 6d62 6572 7322 0a20 2020 2020 2020 2020  mbers".         
-0001e960: 2020 2020 2020 206e 756d 6265 7273 203d         numbers =
-0001e970: 2073 656c 662e 7472 616e 736c 6174 6f72   self.translator
-0001e980: 286e 756d 6265 7273 290a 2020 2020 2020  (numbers).      
-0001e990: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0001e9a0: 206c 656e 2861 6c6c 5f6e 756d 6265 7229   len(all_number)
-0001e9b0: 203e 3d20 7365 6c66 2e6e 756d 6265 723a   >= self.number:
-0001e9c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e9d0: 2020 2020 2066 6169 6c75 7265 732e 6170       failures.ap
-0001e9e0: 7065 6e64 280a 2020 2020 2020 2020 2020  pend(.          
-0001e9f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001ea00: 6c66 2e74 7261 6e73 6c61 746f 7228 224d  lf.translator("M
-0001ea10: 7573 7420 696e 636c 7564 6520 6174 206c  ust include at l
-0001ea20: 6561 7374 2025 7320 2573 2229 0a20 2020  east %s %s").   
+0001e700: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
+0001e710: 224d 7573 7420 696e 636c 7564 6520 6174  "Must include at
+0001e720: 206c 6561 7374 2025 7320 6c6f 7765 7263   least %s lowerc
+0001e730: 6173 6522 290a 2020 2020 2020 2020 2020  ase").          
+0001e740: 2020 2020 2020 2020 2020 2020 2020 2520                % 
+0001e750: 7374 7228 7365 6c66 2e6c 6f77 6572 290a  str(self.lower).
+0001e760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e770: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0001e780: 2020 656c 6966 2073 656c 662e 6c6f 7765    elif self.lowe
+0001e790: 7220 3d3d 2030 2061 6e64 2073 656c 662e  r == 0 and self.
+0001e7a0: 6c6f 7765 7220 6973 206e 6f74 2046 616c  lower is not Fal
+0001e7b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001e7c0: 2020 2020 6966 206c 656e 2861 6c6c 5f6c      if len(all_l
+0001e7d0: 6f77 6572 2920 3e20 303a 0a20 2020 2020  ower) > 0:.     
+0001e7e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001e7f0: 6169 6c75 7265 732e 6170 7065 6e64 280a  ailures.append(.
+0001e800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e810: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
+0001e820: 6e73 6c61 746f 7228 224d 6179 206e 6f74  nslator("May not
+0001e830: 2069 6e63 6c75 6465 2061 6e79 206c 6f77   include any low
+0001e840: 6572 6361 7365 206c 6574 7465 7273 2229  ercase letters")
+0001e850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e860: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+0001e870: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
+0001e880: 662e 6e75 6d62 6572 2c20 696e 7429 3a0a  f.number, int):.
+0001e890: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
+0001e8a0: 6e75 6d62 6572 203d 2072 652e 6669 6e64  number = re.find
+0001e8b0: 616c 6c28 225b 302d 395d 222c 2076 616c  all("[0-9]", val
+0001e8c0: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
+0001e8d0: 6966 2073 656c 662e 6e75 6d62 6572 203e  if self.number >
+0001e8e0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0001e8f0: 2020 2020 6e75 6d62 6572 7320 3d20 226e      numbers = "n
+0001e900: 756d 6265 7222 0a20 2020 2020 2020 2020  umber".         
+0001e910: 2020 2020 2020 2069 6620 7365 6c66 2e6e         if self.n
+0001e920: 756d 6265 7220 3e20 313a 0a20 2020 2020  umber > 1:.     
+0001e930: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0001e940: 756d 6265 7273 203d 2022 6e75 6d62 6572  umbers = "number
+0001e950: 7322 0a20 2020 2020 2020 2020 2020 2020  s".             
+0001e960: 2020 206e 756d 6265 7273 203d 2073 656c     numbers = sel
+0001e970: 662e 7472 616e 736c 6174 6f72 286e 756d  f.translator(num
+0001e980: 6265 7273 290a 2020 2020 2020 2020 2020  bers).          
+0001e990: 2020 2020 2020 6966 206e 6f74 206c 656e        if not len
+0001e9a0: 2861 6c6c 5f6e 756d 6265 7229 203e 3d20  (all_number) >= 
+0001e9b0: 7365 6c66 2e6e 756d 6265 723a 0a20 2020  self.number:.   
+0001e9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e9d0: 2066 6169 6c75 7265 732e 6170 7065 6e64   failures.append
+0001e9e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001e9f0: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+0001ea00: 7261 6e73 6c61 746f 7228 224d 7573 7420  ranslator("Must 
+0001ea10: 696e 636c 7564 6520 6174 206c 6561 7374  include at least
+0001ea20: 2025 7320 2573 2229 0a20 2020 2020 2020   %s %s").       
 0001ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ea40: 2020 2020 2025 2028 7374 7228 7365 6c66       % (str(self
-0001ea50: 2e6e 756d 6265 7229 2c20 6e75 6d62 6572  .number), number
-0001ea60: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-0001ea70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001ea80: 2020 2020 2065 6c69 6620 7365 6c66 2e6e       elif self.n
-0001ea90: 756d 6265 7220 3d3d 2030 2061 6e64 2073  umber == 0 and s
-0001eaa0: 656c 662e 6e75 6d62 6572 2069 7320 6e6f  elf.number is no
-0001eab0: 7420 4661 6c73 653a 0a20 2020 2020 2020  t False:.       
-0001eac0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-0001ead0: 616c 6c5f 6e75 6d62 6572 2920 3e20 303a  all_number) > 0:
-0001eae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001eaf0: 2020 2020 2066 6169 6c75 7265 732e 6170       failures.ap
-0001eb00: 7065 6e64 2873 656c 662e 7472 616e 736c  pend(self.transl
-0001eb10: 6174 6f72 2822 4d61 7920 6e6f 7420 696e  ator("May not in
-0001eb20: 636c 7564 6520 616e 7920 6e75 6d62 6572  clude any number
-0001eb30: 7322 2929 0a20 2020 2020 2020 2069 6620  s")).        if 
-0001eb40: 6c65 6e28 6661 696c 7572 6573 2920 3d3d  len(failures) ==
-0001eb50: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0001eb60: 7265 7475 726e 2076 616c 7565 0a20 2020  return value.   
-0001eb70: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-0001eb80: 2e65 7272 6f72 5f6d 6573 7361 6765 3a0a  .error_message:.
-0001eb90: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001eba0: 656c 662e 6573 7472 696e 673a 0a20 2020  elf.estring:.   
-0001ebb0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001ebc0: 7365 2056 616c 6964 6174 696f 6e45 7272  se ValidationErr
-0001ebd0: 6f72 2822 7c22 2e6a 6f69 6e28 6d61 7028  or("|".join(map(
-0001ebe0: 7374 722c 2066 6169 6c75 7265 7329 2929  str, failures)))
-0001ebf0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001ec00: 7365 2056 616c 6964 6174 696f 6e45 7272  se ValidationErr
-0001ec10: 6f72 2822 2c20 222e 6a6f 696e 2866 6169  or(", ".join(fai
-0001ec20: 6c75 7265 7329 290a 2020 2020 2020 2020  lures)).        
-0001ec30: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001ec40: 2020 7261 6973 6520 5661 6c69 6461 7469    raise Validati
-0001ec50: 6f6e 4572 726f 7228 7365 6c66 2e74 7261  onError(self.tra
-0001ec60: 6e73 6c61 746f 7228 7365 6c66 2e65 7272  nslator(self.err
-0001ec70: 6f72 5f6d 6573 7361 6765 2929 0a0a 0a63  or_message))...c
-0001ec80: 6c61 7373 2049 535f 494d 4147 4528 5661  lass IS_IMAGE(Va
-0001ec90: 6c69 6461 746f 7229 3a0a 2020 2020 2222  lidator):.    ""
-0001eca0: 220a 2020 2020 4368 6563 6b73 2069 6620  ".    Checks if 
-0001ecb0: 6669 6c65 2075 706c 6f61 6465 6420 7468  file uploaded th
-0001ecc0: 726f 7567 6820 6669 6c65 2069 6e70 7574  rough file input
-0001ecd0: 2077 6173 2073 6176 6564 2069 6e20 6f6e   was saved in on
-0001ece0: 6520 6f66 2073 656c 6563 7465 640a 2020  e of selected.  
-0001ecf0: 2020 696d 6167 6520 666f 726d 6174 7320    image formats 
-0001ed00: 616e 6420 6861 7320 6469 6d65 6e73 696f  and has dimensio
-0001ed10: 6e73 2028 7769 6474 6820 616e 6420 6865  ns (width and he
-0001ed20: 6967 6874 2920 7769 7468 696e 2067 6976  ight) within giv
-0001ed30: 656e 2062 6f75 6e64 6172 6965 732e 0a0a  en boundaries...
-0001ed40: 2020 2020 446f 6573 202a 6e6f 742a 2063      Does *not* c
-0001ed50: 6865 636b 2066 6f72 206d 6178 696d 756d  heck for maximum
-0001ed60: 2066 696c 6520 7369 7a65 2028 7573 6520   file size (use 
-0001ed70: 4953 5f4c 454e 4754 4820 666f 7220 7468  IS_LENGTH for th
-0001ed80: 6174 292e 2052 6574 7572 6e73 0a20 2020  at). Returns.   
-0001ed90: 2076 616c 6964 6174 696f 6e20 6661 696c   validation fail
-0001eda0: 7572 6520 6966 206e 6f20 6461 7461 2077  ure if no data w
-0001edb0: 6173 2075 706c 6f61 6465 642e 0a0a 2020  as uploaded...  
-0001edc0: 2020 5375 7070 6f72 7465 6420 6669 6c65    Supported file
-0001edd0: 2066 6f72 6d61 7473 3a20 424d 502c 2047   formats: BMP, G
-0001ede0: 4946 2c20 4a50 4547 2c20 504e 472e 0a0a  IF, JPEG, PNG...
-0001edf0: 2020 2020 436f 6465 2070 6172 7473 2074      Code parts t
-0001ee00: 616b 656e 2066 726f 6d0a 2020 2020 6874  aken from.    ht
-0001ee10: 7470 3a2f 2f6d 6169 6c2e 7079 7468 6f6e  tp://mail.python
-0001ee20: 2e6f 7267 2f70 6970 6572 6d61 696c 2f70  .org/pipermail/p
-0001ee30: 7974 686f 6e2d 6c69 7374 2f32 3030 372d  ython-list/2007-
-0001ee40: 4a75 6e65 2f36 3137 3132 362e 6874 6d6c  June/617126.html
-0001ee50: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
-0001ee60: 2020 2020 6578 7465 6e73 696f 6e73 3a20      extensions: 
-0001ee70: 6974 6572 6162 6c65 2063 6f6e 7461 696e  iterable contain
-0001ee80: 696e 6720 616c 6c6f 7765 6420 2a6c 6f77  ing allowed *low
-0001ee90: 6572 6361 7365 2a20 696d 6167 6520 6669  ercase* image fi
-0001eea0: 6c65 2065 7874 656e 7369 6f6e 730a 2020  le extensions.  
-0001eeb0: 2020 2020 2020 2827 6a70 6727 2065 7874        ('jpg' ext
-0001eec0: 656e 7369 6f6e 206f 6620 7570 6c6f 6164  ension of upload
-0001eed0: 6564 2066 696c 6520 636f 756e 7473 2061  ed file counts a
-0001eee0: 7320 276a 7065 6727 290a 2020 2020 2020  s 'jpeg').      
-0001eef0: 2020 6d61 7873 697a 653a 2069 7465 7261    maxsize: itera
-0001ef00: 626c 6520 636f 6e74 6169 6e69 6e67 206d  ble containing m
-0001ef10: 6178 696d 756d 2077 6964 7468 2061 6e64  aximum width and
-0001ef20: 2068 6569 6768 7420 6f66 2074 6865 2069   height of the i
-0001ef30: 6d61 6765 0a20 2020 2020 2020 206d 696e  mage.        min
-0001ef40: 7369 7a65 3a20 6974 6572 6162 6c65 2063  size: iterable c
-0001ef50: 6f6e 7461 696e 696e 6720 6d69 6e69 6d75  ontaining minimu
-0001ef60: 6d20 7769 6474 6820 616e 6420 6865 6967  m width and heig
-0001ef70: 6874 206f 6620 7468 6520 696d 6167 650a  ht of the image.
-0001ef80: 2020 2020 2020 2020 6173 7065 6374 7261          aspectra
-0001ef90: 7469 6f3a 2069 7465 7261 626c 6520 636f  tio: iterable co
-0001efa0: 6e74 6169 6e69 6e67 2074 6172 6765 7420  ntaining target 
-0001efb0: 6173 7065 6374 2072 6174 696f 0a0a 2020  aspect ratio..  
-0001efc0: 2020 5573 6520 282d 312c 202d 3129 2061    Use (-1, -1) a
-0001efd0: 7320 6d69 6e73 697a 6520 746f 2070 6173  s minsize to pas
-0001efe0: 7320 696d 6167 6520 7369 7a65 2063 6865  s image size che
-0001eff0: 636b 2e0a 2020 2020 5573 6520 282d 312c  ck..    Use (-1,
-0001f000: 202d 3129 2061 7320 6173 7065 6374 7261   -1) as aspectra
-0001f010: 7469 6f20 746f 2070 6173 7320 6173 7065  tio to pass aspe
-0001f020: 6374 2072 6174 696f 2063 6865 636b 2e0a  ct ratio check..
-0001f030: 0a20 2020 2045 7861 6d70 6c65 733a 0a20  .    Examples:. 
-0001f040: 2020 2020 2020 2043 6865 636b 2069 6620         Check if 
-0001f050: 7570 6c6f 6164 6564 2066 696c 6520 6973  uploaded file is
-0001f060: 2069 6e20 616e 7920 6f66 2073 7570 706f   in any of suppo
-0001f070: 7274 6564 2069 6d61 6765 2066 6f72 6d61  rted image forma
-0001f080: 7473 3a0a 0a20 2020 2020 2020 2020 2020  ts:..           
-0001f090: 2049 4e50 5554 285f 7479 7065 3d27 6669   INPUT(_type='fi
-0001f0a0: 6c65 272c 205f 6e61 6d65 3d27 6e61 6d65  le', _name='name
-0001f0b0: 272c 2072 6571 7569 7265 733d 4953 5f49  ', requires=IS_I
-0001f0c0: 4d41 4745 2829 290a 0a20 2020 2020 2020  MAGE())..       
-0001f0d0: 2043 6865 636b 2069 6620 7570 6c6f 6164   Check if upload
-0001f0e0: 6564 2066 696c 6520 6973 2065 6974 6865  ed file is eithe
-0001f0f0: 7220 4a50 4547 206f 7220 504e 473a 0a0a  r JPEG or PNG:..
-0001f100: 2020 2020 2020 2020 2020 2020 494e 5055              INPU
-0001f110: 5428 5f74 7970 653d 2766 696c 6527 2c20  T(_type='file', 
-0001f120: 5f6e 616d 653d 276e 616d 6527 2c0a 2020  _name='name',.  
-0001f130: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001f140: 7175 6972 6573 3d49 535f 494d 4147 4528  quires=IS_IMAGE(
-0001f150: 6578 7465 6e73 696f 6e73 3d28 276a 7065  extensions=('jpe
-0001f160: 6727 2c20 2770 6e67 2729 2929 0a0a 2020  g', 'png')))..  
-0001f170: 2020 2020 2020 4368 6563 6b20 6966 2075        Check if u
-0001f180: 706c 6f61 6465 6420 6669 6c65 2069 7320  ploaded file is 
-0001f190: 504e 4720 7769 7468 206d 6178 696d 756d  PNG with maximum
-0001f1a0: 2073 697a 6520 6f66 2032 3030 7832 3030   size of 200x200
-0001f1b0: 2070 6978 656c 733a 0a0a 2020 2020 2020   pixels:..      
-0001f1c0: 2020 2020 2020 494e 5055 5428 5f74 7970        INPUT(_typ
-0001f1d0: 653d 2766 696c 6527 2c20 5f6e 616d 653d  e='file', _name=
-0001f1e0: 276e 616d 6527 2c0a 2020 2020 2020 2020  'name',.        
-0001f1f0: 2020 2020 2020 2020 7265 7175 6972 6573          requires
-0001f200: 3d49 535f 494d 4147 4528 6578 7465 6e73  =IS_IMAGE(extens
-0001f210: 696f 6e73 3d28 2770 6e67 2729 2c20 6d61  ions=('png'), ma
-0001f220: 7873 697a 653d 2832 3030 2c20 3230 3029  xsize=(200, 200)
-0001f230: 2929 0a0a 2020 2020 2020 2020 4368 6563  ))..        Chec
-0001f240: 6b20 6966 2075 706c 6f61 6465 6420 6669  k if uploaded fi
-0001f250: 6c65 2068 6173 2061 2031 363a 3920 6173  le has a 16:9 as
-0001f260: 7065 6374 2072 6174 696f 3a0a 0a20 2020  pect ratio:..   
-0001f270: 2020 2020 2020 2020 2049 4e50 5554 285f           INPUT(_
-0001f280: 7479 7065 3d27 6669 6c65 272c 205f 6e61  type='file', _na
-0001f290: 6d65 3d27 6e61 6d65 272c 0a20 2020 2020  me='name',.     
-0001f2a0: 2020 2020 2020 2020 2020 2072 6571 7569             requi
-0001f2b0: 7265 733d 4953 5f49 4d41 4745 2861 7370  res=IS_IMAGE(asp
-0001f2c0: 6563 7472 6174 696f 3d28 3136 2c20 3929  ectratio=(16, 9)
-0001f2d0: 2929 0a20 2020 2022 2222 0a0a 2020 2020  )).    """..    
-0001f2e0: 6465 6620 5f5f 696e 6974 5f5f 280a 2020  def __init__(.  
-0001f2f0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0001f300: 2020 2020 6578 7465 6e73 696f 6e73 3d28      extensions=(
-0001f310: 2262 6d70 222c 2022 6769 6622 2c20 226a  "bmp", "gif", "j
-0001f320: 7065 6722 2c20 2270 6e67 2229 2c0a 2020  peg", "png"),.  
-0001f330: 2020 2020 2020 6d61 7873 697a 653d 2831        maxsize=(1
-0001f340: 3030 3030 2c20 3130 3030 3029 2c0a 2020  0000, 10000),.  
-0001f350: 2020 2020 2020 6d69 6e73 697a 653d 2830        minsize=(0
-0001f360: 2c20 3029 2c0a 2020 2020 2020 2020 6173  , 0),.        as
-0001f370: 7065 6374 7261 7469 6f3d 282d 312c 202d  pectratio=(-1, -
-0001f380: 3129 2c0a 2020 2020 2020 2020 6572 726f  1),.        erro
-0001f390: 725f 6d65 7373 6167 653d 2249 6e76 616c  r_message="Inval
-0001f3a0: 6964 2069 6d61 6765 222c 0a20 2020 2029  id image",.    )
-0001f3b0: 3a0a 0a20 2020 2020 2020 2073 656c 662e  :..        self.
-0001f3c0: 6578 7465 6e73 696f 6e73 203d 2065 7874  extensions = ext
-0001f3d0: 656e 7369 6f6e 730a 2020 2020 2020 2020  ensions.        
-0001f3e0: 7365 6c66 2e6d 6178 7369 7a65 203d 206d  self.maxsize = m
-0001f3f0: 6178 7369 7a65 0a20 2020 2020 2020 2073  axsize.        s
-0001f400: 656c 662e 6d69 6e73 697a 6520 3d20 6d69  elf.minsize = mi
-0001f410: 6e73 697a 650a 2020 2020 2020 2020 7365  nsize.        se
-0001f420: 6c66 2e61 7370 6563 7472 6174 696f 203d  lf.aspectratio =
-0001f430: 2061 7370 6563 7472 6174 696f 0a20 2020   aspectratio.   
-0001f440: 2020 2020 2073 656c 662e 6572 726f 725f       self.error_
-0001f450: 6d65 7373 6167 6520 3d20 6572 726f 725f  message = error_
-0001f460: 6d65 7373 6167 650a 0a20 2020 2064 6566  message..    def
-0001f470: 2076 616c 6964 6174 6528 7365 6c66 2c20   validate(self, 
-0001f480: 7661 6c75 652c 2072 6563 6f72 645f 6964  value, record_id
-0001f490: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-0001f4a0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0001f4b0: 2065 7874 656e 7369 6f6e 203d 2076 616c   extension = val
-0001f4c0: 7565 2e66 696c 656e 616d 652e 7266 696e  ue.filename.rfin
-0001f4d0: 6428 222e 2229 0a20 2020 2020 2020 2020  d(".").         
-0001f4e0: 2020 2061 7373 6572 7420 6578 7465 6e73     assert extens
-0001f4f0: 696f 6e20 3e3d 2030 0a20 2020 2020 2020  ion >= 0.       
-0001f500: 2020 2020 2065 7874 656e 7369 6f6e 203d       extension =
-0001f510: 2076 616c 7565 2e66 696c 656e 616d 655b   value.filename[
-0001f520: 6578 7465 6e73 696f 6e20 2b20 3120 3a5d  extension + 1 :]
-0001f530: 2e6c 6f77 6572 2829 0a20 2020 2020 2020  .lower().       
-0001f540: 2020 2020 2069 6620 6578 7465 6e73 696f       if extensio
-0001f550: 6e20 3d3d 2022 6a70 6722 3a0a 2020 2020  n == "jpg":.    
-0001f560: 2020 2020 2020 2020 2020 2020 6578 7465              exte
-0001f570: 6e73 696f 6e20 3d20 226a 7065 6722 0a20  nsion = "jpeg". 
-0001f580: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-0001f590: 7420 6578 7465 6e73 696f 6e20 696e 2073  t extension in s
-0001f5a0: 656c 662e 6578 7465 6e73 696f 6e73 0a20  elf.extensions. 
-0001f5b0: 2020 2020 2020 2020 2020 2069 6620 6578             if ex
-0001f5c0: 7465 6e73 696f 6e20 3d3d 2022 626d 7022  tension == "bmp"
-0001f5d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001f5e0: 2020 7769 6474 682c 2068 6569 6768 7420    width, height 
-0001f5f0: 3d20 7365 6c66 2e5f 5f62 6d70 2876 616c  = self.__bmp(val
-0001f600: 7565 2e66 696c 6529 0a20 2020 2020 2020  ue.file).       
-0001f610: 2020 2020 2065 6c69 6620 6578 7465 6e73       elif extens
-0001f620: 696f 6e20 3d3d 2022 6769 6622 3a0a 2020  ion == "gif":.  
-0001f630: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-0001f640: 6474 682c 2068 6569 6768 7420 3d20 7365  dth, height = se
-0001f650: 6c66 2e5f 5f67 6966 2876 616c 7565 2e66  lf.__gif(value.f
-0001f660: 696c 6529 0a20 2020 2020 2020 2020 2020  ile).           
-0001f670: 2065 6c69 6620 6578 7465 6e73 696f 6e20   elif extension 
-0001f680: 3d3d 2022 6a70 6567 223a 0a20 2020 2020  == "jpeg":.     
-0001f690: 2020 2020 2020 2020 2020 2077 6964 7468             width
-0001f6a0: 2c20 6865 6967 6874 203d 2073 656c 662e  , height = self.
-0001f6b0: 5f5f 6a70 6567 2876 616c 7565 2e66 696c  __jpeg(value.fil
-0001f6c0: 6529 0a20 2020 2020 2020 2020 2020 2065  e).            e
-0001f6d0: 6c69 6620 6578 7465 6e73 696f 6e20 3d3d  lif extension ==
-0001f6e0: 2022 706e 6722 3a0a 2020 2020 2020 2020   "png":.        
-0001f6f0: 2020 2020 2020 2020 7769 6474 682c 2068          width, h
-0001f700: 6569 6768 7420 3d20 7365 6c66 2e5f 5f70  eight = self.__p
-0001f710: 6e67 2876 616c 7565 2e66 696c 6529 0a20  ng(value.file). 
-0001f720: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001f730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f740: 2077 6964 7468 203d 202d 310a 2020 2020   width = -1.    
-0001f750: 2020 2020 2020 2020 2020 2020 6865 6967              heig
-0001f760: 6874 203d 202d 310a 0a20 2020 2020 2020  ht = -1..       
-0001f770: 2020 2020 2061 7373 6572 7420 280a 2020       assert (.  
-0001f780: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001f790: 6c66 2e6d 696e 7369 7a65 5b30 5d20 3c3d  lf.minsize[0] <=
-0001f7a0: 2077 6964 7468 203c 3d20 7365 6c66 2e6d   width <= self.m
-0001f7b0: 6178 7369 7a65 5b30 5d0a 2020 2020 2020  axsize[0].      
-0001f7c0: 2020 2020 2020 2020 2020 616e 6420 7365            and se
-0001f7d0: 6c66 2e6d 696e 7369 7a65 5b31 5d20 3c3d  lf.minsize[1] <=
-0001f7e0: 2068 6569 6768 7420 3c3d 2073 656c 662e   height <= self.
-0001f7f0: 6d61 7873 697a 655b 315d 0a20 2020 2020  maxsize[1].     
-0001f800: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0001f810: 2020 2020 2020 6966 2073 656c 662e 6173        if self.as
-0001f820: 7065 6374 7261 7469 6f20 3e20 282d 312c  pectratio > (-1,
-0001f830: 202d 3129 3a0a 2020 2020 2020 2020 2020   -1):.          
-0001f840: 2020 2020 2020 7461 7267 6574 5f72 6174        target_rat
-0001f850: 696f 203d 2028 312e 3020 2a20 7365 6c66  io = (1.0 * self
-0001f860: 2e61 7370 6563 7472 6174 696f 5b31 5d29  .aspectratio[1])
-0001f870: 202f 2073 656c 662e 6173 7065 6374 7261   / self.aspectra
-0001f880: 7469 6f5b 305d 0a20 2020 2020 2020 2020  tio[0].         
-0001f890: 2020 2020 2020 2061 6374 7561 6c5f 7261         actual_ra
-0001f8a0: 7469 6f20 3d20 2831 2e30 202a 2068 6569  tio = (1.0 * hei
-0001f8b0: 6768 7429 202f 2077 6964 7468 0a0a 2020  ght) / width..  
-0001f8c0: 2020 2020 2020 2020 2020 2020 2020 6173                as
-0001f8d0: 7365 7274 2061 6374 7561 6c5f 7261 7469  sert actual_rati
-0001f8e0: 6f20 3d3d 2074 6172 6765 745f 7261 7469  o == target_rati
-0001f8f0: 6f0a 0a20 2020 2020 2020 2020 2020 2076  o..            v
-0001f900: 616c 7565 2e66 696c 652e 7365 656b 2830  alue.file.seek(0
-0001f910: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0001f920: 7475 726e 2076 616c 7565 0a20 2020 2020  turn value.     
-0001f930: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-0001f940: 696f 6e20 6173 2065 3a0a 2020 2020 2020  ion as e:.      
-0001f950: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
-0001f960: 6461 7469 6f6e 4572 726f 7228 7365 6c66  dationError(self
-0001f970: 2e74 7261 6e73 6c61 746f 7228 7365 6c66  .translator(self
-0001f980: 2e65 7272 6f72 5f6d 6573 7361 6765 2929  .error_message))
-0001f990: 0a0a 2020 2020 6465 6620 5f5f 626d 7028  ..    def __bmp(
-0001f9a0: 7365 6c66 2c20 7374 7265 616d 293a 0a20  self, stream):. 
-0001f9b0: 2020 2020 2020 2069 6620 7374 7265 616d         if stream
-0001f9c0: 2e72 6561 6428 3229 203d 3d20 6222 424d  .read(2) == b"BM
-0001f9d0: 223a 0a20 2020 2020 2020 2020 2020 2073  ":.            s
-0001f9e0: 7472 6561 6d2e 7265 6164 2831 3629 0a20  tream.read(16). 
-0001f9f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001fa00: 6e20 7374 7275 6374 2e75 6e70 6163 6b28  n struct.unpack(
-0001fa10: 223c 4c4c 222c 2073 7472 6561 6d2e 7265  "<LL", stream.re
-0001fa20: 6164 2838 2929 0a20 2020 2020 2020 2072  ad(8)).        r
-0001fa30: 6574 7572 6e20 282d 312c 202d 3129 0a0a  eturn (-1, -1)..
-0001fa40: 2020 2020 6465 6620 5f5f 6769 6628 7365      def __gif(se
-0001fa50: 6c66 2c20 7374 7265 616d 293a 0a20 2020  lf, stream):.   
-0001fa60: 2020 2020 2069 6620 7374 7265 616d 2e72       if stream.r
-0001fa70: 6561 6428 3629 2069 6e20 2862 2247 4946  ead(6) in (b"GIF
-0001fa80: 3837 6122 2c20 6222 4749 4638 3961 2229  87a", b"GIF89a")
-0001fa90: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
-0001faa0: 7265 616d 203d 2073 7472 6561 6d2e 7265  ream = stream.re
-0001fab0: 6164 2835 290a 2020 2020 2020 2020 2020  ad(5).          
-0001fac0: 2020 6966 206c 656e 2873 7472 6561 6d29    if len(stream)
-0001fad0: 203d 3d20 353a 0a20 2020 2020 2020 2020   == 5:.         
-0001fae0: 2020 2020 2020 2072 6574 7572 6e20 7475         return tu
-0001faf0: 706c 6528 7374 7275 6374 2e75 6e70 6163  ple(struct.unpac
-0001fb00: 6b28 223c 4848 4222 2c20 7374 7265 616d  k("<HHB", stream
-0001fb10: 295b 3a2d 315d 290a 2020 2020 2020 2020  )[:-1]).        
-0001fb20: 7265 7475 726e 2028 2d31 2c20 2d31 290a  return (-1, -1).
-0001fb30: 0a20 2020 2064 6566 205f 5f6a 7065 6728  .    def __jpeg(
-0001fb40: 7365 6c66 2c20 7374 7265 616d 293a 0a20  self, stream):. 
-0001fb50: 2020 2020 2020 2069 6620 7374 7265 616d         if stream
-0001fb60: 2e72 6561 6428 3229 203d 3d20 6222 5c78  .read(2) == b"\x
-0001fb70: 4646 5c78 4438 223a 0a20 2020 2020 2020  FF\xD8":.       
-0001fb80: 2020 2020 2077 6869 6c65 2054 7275 653a       while True:
-0001fb90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fba0: 2028 6d61 726b 6572 2c20 636f 6465 2c20   (marker, code, 
-0001fbb0: 6c65 6e67 7468 2920 3d20 7374 7275 6374  length) = struct
-0001fbc0: 2e75 6e70 6163 6b28 2221 4242 4822 2c20  .unpack("!BBH", 
-0001fbd0: 7374 7265 616d 2e72 6561 6428 3429 290a  stream.read(4)).
-0001fbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fbf0: 6966 206d 6172 6b65 7220 213d 2030 7846  if marker != 0xF
-0001fc00: 463a 0a20 2020 2020 2020 2020 2020 2020  F:.             
-0001fc10: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
-0001fc20: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0001fc30: 6620 636f 6465 203e 3d20 3078 4330 2061  f code >= 0xC0 a
-0001fc40: 6e64 2063 6f64 6520 3c3d 2030 7843 333a  nd code <= 0xC3:
-0001fc50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fc60: 2020 2020 2072 6574 7572 6e20 7475 706c       return tupl
-0001fc70: 6528 7265 7665 7273 6564 2873 7472 7563  e(reversed(struc
-0001fc80: 742e 756e 7061 636b 2822 2178 4848 222c  t.unpack("!xHH",
-0001fc90: 2073 7472 6561 6d2e 7265 6164 2835 2929   stream.read(5))
-0001fca0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-0001fcb0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001fcc0: 2020 2020 2020 2020 2020 2020 2073 7472               str
-0001fcd0: 6561 6d2e 7265 6164 286c 656e 6774 6820  eam.read(length 
-0001fce0: 2d20 3229 0a20 2020 2020 2020 2072 6574  - 2).        ret
-0001fcf0: 7572 6e20 282d 312c 202d 3129 0a0a 2020  urn (-1, -1)..  
-0001fd00: 2020 6465 6620 5f5f 706e 6728 7365 6c66    def __png(self
-0001fd10: 2c20 7374 7265 616d 293a 0a20 2020 2020  , stream):.     
-0001fd20: 2020 2069 6620 7374 7265 616d 2e72 6561     if stream.rea
-0001fd30: 6428 3829 203d 3d20 6222 5c32 3131 504e  d(8) == b"\211PN
-0001fd40: 475c 725c 6e5c 3033 325c 6e22 3a0a 2020  G\r\n\032\n":.  
-0001fd50: 2020 2020 2020 2020 2020 7374 7265 616d            stream
-0001fd60: 2e72 6561 6428 3429 0a20 2020 2020 2020  .read(4).       
-0001fd70: 2020 2020 2069 6620 7374 7265 616d 2e72       if stream.r
-0001fd80: 6561 6428 3429 203d 3d20 6222 4948 4452  ead(4) == b"IHDR
-0001fd90: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-0001fda0: 2020 2072 6574 7572 6e20 7374 7275 6374     return struct
-0001fdb0: 2e75 6e70 6163 6b28 2221 4c4c 222c 2073  .unpack("!LL", s
-0001fdc0: 7472 6561 6d2e 7265 6164 2838 2929 0a20  tream.read(8)). 
-0001fdd0: 2020 2020 2020 2072 6574 7572 6e20 282d         return (-
-0001fde0: 312c 202d 3129 0a0a 0a63 6c61 7373 2049  1, -1)...class I
-0001fdf0: 535f 4649 4c45 2856 616c 6964 6174 6f72  S_FILE(Validator
-0001fe00: 293a 0a20 2020 2022 2222 0a20 2020 2043  ):.    """.    C
-0001fe10: 6865 636b 7320 6966 206e 616d 6520 616e  hecks if name an
-0001fe20: 6420 6578 7465 6e73 696f 6e20 6f66 2066  d extension of f
-0001fe30: 696c 6520 7570 6c6f 6164 6564 2074 6872  ile uploaded thr
-0001fe40: 6f75 6768 2066 696c 6520 696e 7075 7420  ough file input 
-0001fe50: 6d61 7463 6865 730a 2020 2020 6769 7665  matches.    give
-0001fe60: 6e20 6372 6974 6572 6961 2e0a 0a20 2020  n criteria...   
-0001fe70: 2044 6f65 7320 2a6e 6f74 2a20 656e 7375   Does *not* ensu
-0001fe80: 7265 2074 6865 2066 696c 6520 7479 7065  re the file type
-0001fe90: 2069 6e20 616e 7920 7761 792e 2052 6574   in any way. Ret
-0001fea0: 7572 6e73 2076 616c 6964 6174 696f 6e20  urns validation 
-0001feb0: 6661 696c 7572 650a 2020 2020 6966 206e  failure.    if n
-0001fec0: 6f20 6461 7461 2077 6173 2075 706c 6f61  o data was uploa
-0001fed0: 6465 642e 0a0a 2020 2020 4172 6773 3a0a  ded...    Args:.
-0001fee0: 2020 2020 2020 2020 6669 6c65 6e61 6d65          filename
-0001fef0: 3a20 7374 7269 6e67 2f63 6f6d 7069 6c65  : string/compile
-0001ff00: 6420 7265 6765 7820 6f72 2061 206c 6973  d regex or a lis
-0001ff10: 7420 6f66 2073 7472 696e 6773 2f72 6567  t of strings/reg
-0001ff20: 6578 206f 6620 7661 6c69 6420 6669 6c65  ex of valid file
-0001ff30: 6e61 6d65 730a 2020 2020 2020 2020 6578  names.        ex
-0001ff40: 7465 6e73 696f 6e3a 2073 7472 696e 672f  tension: string/
-0001ff50: 636f 6d70 696c 6564 2072 6567 6578 206f  compiled regex o
-0001ff60: 7220 6120 6c69 7374 206f 6620 7374 7269  r a list of stri
-0001ff70: 6e67 732f 7265 6765 7820 6f66 2076 616c  ngs/regex of val
-0001ff80: 6964 2065 7874 656e 7369 6f6e 730a 2020  id extensions.  
-0001ff90: 2020 2020 2020 6c61 7374 646f 743a 2077        lastdot: w
-0001ffa0: 6869 6368 2064 6f74 2073 686f 756c 6420  hich dot should 
-0001ffb0: 6265 2075 7365 6420 6173 2061 2066 696c  be used as a fil
-0001ffc0: 656e 616d 6520 2f20 6578 7465 6e73 696f  ename / extensio
-0001ffd0: 6e20 7365 7061 7261 746f 723a 0a20 2020  n separator:.   
-0001ffe0: 2020 2020 2020 2020 2054 7275 6520 6d65           True me
-0001fff0: 616e 7320 6c61 7374 2064 6f74 2c20 6567  ans last dot, eg
-00020000: 2e20 6669 6c65 2e6a 7067 2e70 6e67 202d  . file.jpg.png -
-00020010: 3e20 6669 6c65 2e6a 7067 202f 2070 6e67  > file.jpg / png
-00020020: 0a20 2020 2020 2020 2020 2020 2046 616c  .            Fal
-00020030: 7365 206d 6561 6e73 2066 6972 7374 2064  se means first d
-00020040: 6f74 2c20 6567 2e20 6669 6c65 2e74 6172  ot, eg. file.tar
-00020050: 2e67 7a20 2d3e 2066 696c 6520 2f20 7461  .gz -> file / ta
-00020060: 722e 677a 0a20 2020 2020 2020 2063 6173  r.gz.        cas
-00020070: 653a 2030 202d 206b 6565 7020 7468 6520  e: 0 - keep the 
-00020080: 6361 7365 2c20 3120 2d20 7472 616e 7366  case, 1 - transf
-00020090: 6f72 6d20 7468 6520 7374 7269 6e67 2069  orm the string i
-000200a0: 6e74 6f20 6c6f 7765 7263 6173 6520 2864  nto lowercase (d
-000200b0: 6566 6175 6c74 292c 0a20 2020 2020 2020  efault),.       
-000200c0: 2020 2020 2032 202d 2074 7261 6e73 666f       2 - transfo
-000200d0: 726d 2074 6865 2073 7472 696e 6720 696e  rm the string in
-000200e0: 746f 2075 7070 6572 6361 7365 0a0a 2020  to uppercase..  
-000200f0: 2020 4966 2074 6865 7265 2069 7320 6e6f    If there is no
-00020100: 2064 6f74 2070 7265 7365 6e74 2c20 6578   dot present, ex
-00020110: 7465 6e73 696f 6e20 6368 6563 6b73 2077  tension checks w
-00020120: 696c 6c20 6265 2064 6f6e 6520 6167 6169  ill be done agai
-00020130: 6e73 7420 656d 7074 790a 2020 2020 7374  nst empty.    st
-00020140: 7269 6e67 2061 6e64 2066 696c 656e 616d  ring and filenam
-00020150: 6520 6368 6563 6b73 2061 6761 696e 7374  e checks against
-00020160: 2077 686f 6c65 2076 616c 7565 2e0a 0a20   whole value... 
-00020170: 2020 2045 7861 6d70 6c65 733a 0a20 2020     Examples:.   
-00020180: 2020 2020 2043 6865 636b 2069 6620 6669       Check if fi
-00020190: 6c65 2068 6173 2061 2070 6466 2065 7874  le has a pdf ext
-000201a0: 656e 7369 6f6e 2028 6361 7365 2069 6e73  ension (case ins
-000201b0: 656e 7369 7469 7665 293a 0a0a 2020 2020  ensitive):..    
-000201c0: 2020 2020 494e 5055 5428 5f74 7970 653d      INPUT(_type=
-000201d0: 2766 696c 6527 2c20 5f6e 616d 653d 276e  'file', _name='n
-000201e0: 616d 6527 2c0a 2020 2020 2020 2020 2020  ame',.          
-000201f0: 2020 2020 2020 7265 7175 6972 6573 3d49        requires=I
-00020200: 535f 4649 4c45 2865 7874 656e 7369 6f6e  S_FILE(extension
-00020210: 3d27 7064 6627 2929 0a0a 2020 2020 2020  ='pdf'))..      
-00020220: 2020 4368 6563 6b20 6966 2066 696c 6520    Check if file 
-00020230: 6973 2063 616c 6c65 6420 2774 6875 6d62  is called 'thumb
-00020240: 6e61 696c 2720 616e 6420 6861 7320 6120  nail' and has a 
-00020250: 6a70 6720 6f72 2070 6e67 2065 7874 656e  jpg or png exten
-00020260: 7369 6f6e 0a20 2020 2020 2020 2028 6361  sion.        (ca
-00020270: 7365 2069 6e73 656e 7369 7469 7665 293a  se insensitive):
-00020280: 0a0a 2020 2020 2020 2020 494e 5055 5428  ..        INPUT(
-00020290: 5f74 7970 653d 2766 696c 6527 2c20 5f6e  _type='file', _n
-000202a0: 616d 653d 276e 616d 6527 2c0a 2020 2020  ame='name',.    
-000202b0: 2020 2020 2020 2020 2020 2020 7265 7175              requ
-000202c0: 6972 6573 3d49 535f 4649 4c45 2866 696c  ires=IS_FILE(fil
-000202d0: 656e 616d 653d 2774 6875 6d62 6e61 696c  ename='thumbnail
-000202e0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-000202f0: 2020 2065 7874 656e 7369 6f6e 3d5b 276a     extension=['j
-00020300: 7067 272c 2027 706e 6727 5d29 290a 0a20  pg', 'png'])).. 
-00020310: 2020 2020 2020 2043 6865 636b 2069 6620         Check if 
-00020320: 6669 6c65 2068 6173 2061 2074 6172 2e67  file has a tar.g
-00020330: 7a20 6578 7465 6e73 696f 6e20 616e 6420  z extension and 
-00020340: 6e61 6d65 2073 7461 7274 696e 6720 7769  name starting wi
-00020350: 7468 2062 6163 6b75 703a 0a0a 2020 2020  th backup:..    
-00020360: 2020 2020 494e 5055 5428 5f74 7970 653d      INPUT(_type=
-00020370: 2766 696c 6527 2c20 5f6e 616d 653d 276e  'file', _name='n
-00020380: 616d 6527 2c0a 2020 2020 2020 2020 2020  ame',.          
-00020390: 2020 2020 2020 7265 7175 6972 6573 3d49        requires=I
-000203a0: 535f 4649 4c45 2866 696c 656e 616d 653d  S_FILE(filename=
-000203b0: 7265 2e63 6f6d 7069 6c65 2827 6261 636b  re.compile('back
-000203c0: 7570 2e2a 2729 2c0a 2020 2020 2020 2020  up.*'),.        
-000203d0: 2020 2020 2020 2020 6578 7465 6e73 696f          extensio
-000203e0: 6e3d 2774 6172 2e67 7a27 2c20 6c61 7374  n='tar.gz', last
-000203f0: 646f 743d 4661 6c73 6529 290a 0a20 2020  dot=False))..   
-00020400: 2020 2020 2043 6865 636b 2069 6620 6669       Check if fi
-00020410: 6c65 2068 6173 206e 6f20 6578 7465 6e73  le has no extens
-00020420: 696f 6e20 616e 6420 6e61 6d65 206d 6174  ion and name mat
-00020430: 6368 696e 6720 5245 4144 4d45 0a20 2020  ching README.   
-00020440: 2020 2020 2028 6361 7365 2073 656e 7369       (case sensi
-00020450: 7469 7665 293a 0a0a 2020 2020 2020 2020  tive):..        
-00020460: 2020 2020 494e 5055 5428 5f74 7970 653d      INPUT(_type=
-00020470: 2766 696c 6527 2c20 5f6e 616d 653d 276e  'file', _name='n
-00020480: 616d 6527 2c0a 2020 2020 2020 2020 2020  ame',.          
-00020490: 2020 2020 2020 7265 7175 6972 6573 3d49        requires=I
-000204a0: 535f 4649 4c45 2866 696c 656e 616d 653d  S_FILE(filename=
-000204b0: 2752 4541 444d 4527 2c0a 2020 2020 2020  'README',.      
-000204c0: 2020 2020 2020 2020 2020 6578 7465 6e73            extens
-000204d0: 696f 6e3d 2727 2c20 6361 7365 3d30 290a  ion='', case=0).
-000204e0: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
-000204f0: 6620 5f5f 696e 6974 5f5f 280a 2020 2020  f __init__(.    
-00020500: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00020510: 2020 6669 6c65 6e61 6d65 3d4e 6f6e 652c    filename=None,
-00020520: 0a20 2020 2020 2020 2065 7874 656e 7369  .        extensi
-00020530: 6f6e 3d4e 6f6e 652c 0a20 2020 2020 2020  on=None,.       
-00020540: 206c 6173 7464 6f74 3d54 7275 652c 0a20   lastdot=True,. 
-00020550: 2020 2020 2020 2063 6173 653d 312c 0a20         case=1,. 
-00020560: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00020570: 7361 6765 3d22 456e 7465 7220 7661 6c69  sage="Enter vali
-00020580: 6420 6669 6c65 6e61 6d65 222c 0a20 2020  d filename",.   
-00020590: 2029 3a0a 2020 2020 2020 2020 7365 6c66   ):.        self
-000205a0: 2e66 696c 656e 616d 6520 3d20 6669 6c65  .filename = file
-000205b0: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
-000205c0: 662e 6578 7465 6e73 696f 6e20 3d20 6578  f.extension = ex
-000205d0: 7465 6e73 696f 6e0a 2020 2020 2020 2020  tension.        
-000205e0: 7365 6c66 2e6c 6173 7464 6f74 203d 206c  self.lastdot = l
-000205f0: 6173 7464 6f74 0a20 2020 2020 2020 2073  astdot.        s
-00020600: 656c 662e 6361 7365 203d 2063 6173 650a  elf.case = case.
-00020610: 2020 2020 2020 2020 7365 6c66 2e65 7272          self.err
-00020620: 6f72 5f6d 6573 7361 6765 203d 2065 7272  or_message = err
-00020630: 6f72 5f6d 6573 7361 6765 0a0a 2020 2020  or_message..    
-00020640: 6465 6620 6d61 7463 6828 7365 6c66 2c20  def match(self, 
-00020650: 7661 6c75 6531 2c20 7661 6c75 6532 293a  value1, value2):
-00020660: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00020670: 7374 616e 6365 2876 616c 7565 312c 2028  stance(value1, (
-00020680: 6c69 7374 2c20 7475 706c 6529 293a 0a20  list, tuple)):. 
-00020690: 2020 2020 2020 2020 2020 2066 6f72 2076             for v
-000206a0: 2069 6e20 7661 6c75 6531 3a0a 2020 2020   in value1:.    
-000206b0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000206c0: 656c 662e 6d61 7463 6828 762c 2076 616c  elf.match(v, val
-000206d0: 7565 3229 3a0a 2020 2020 2020 2020 2020  ue2):.          
-000206e0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000206f0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-00020700: 2020 7265 7475 726e 2046 616c 7365 0a20    return False. 
-00020710: 2020 2020 2020 2065 6c69 6620 6361 6c6c         elif call
-00020720: 6162 6c65 2867 6574 6174 7472 2876 616c  able(getattr(val
-00020730: 7565 312c 2022 6d61 7463 6822 2c20 4e6f  ue1, "match", No
-00020740: 6e65 2929 3a0a 2020 2020 2020 2020 2020  ne)):.          
-00020750: 2020 7265 7475 726e 2076 616c 7565 312e    return value1.
-00020760: 6d61 7463 6828 7661 6c75 6532 290a 2020  match(value2).  
-00020770: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00020780: 7461 6e63 6528 7661 6c75 6531 2c20 7374  tance(value1, st
-00020790: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-000207a0: 7265 7475 726e 2076 616c 7565 3120 3d3d  return value1 ==
-000207b0: 2076 616c 7565 320a 0a20 2020 2064 6566   value2..    def
-000207c0: 2076 616c 6964 6174 6528 7365 6c66 2c20   validate(self, 
-000207d0: 7661 6c75 652c 2072 6563 6f72 645f 6964  value, record_id
-000207e0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-000207f0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00020800: 2073 7472 696e 6720 3d20 7661 6c75 652e   string = value.
-00020810: 6669 6c65 6e61 6d65 0a20 2020 2020 2020  filename.       
-00020820: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
-00020830: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
-00020840: 6174 696f 6e45 7272 6f72 2873 656c 662e  ationError(self.
-00020850: 7472 616e 736c 6174 6f72 2873 656c 662e  translator(self.
-00020860: 6572 726f 725f 6d65 7373 6167 6529 290a  error_message)).
-00020870: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00020880: 6361 7365 203d 3d20 313a 0a20 2020 2020  case == 1:.     
-00020890: 2020 2020 2020 2073 7472 696e 6720 3d20         string = 
-000208a0: 7374 7269 6e67 2e6c 6f77 6572 2829 0a20  string.lower(). 
-000208b0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-000208c0: 2e63 6173 6520 3d3d 2032 3a0a 2020 2020  .case == 2:.    
-000208d0: 2020 2020 2020 2020 7374 7269 6e67 203d          string =
-000208e0: 2073 7472 696e 672e 7570 7065 7228 290a   string.upper().
-000208f0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00020900: 6c61 7374 646f 743a 0a20 2020 2020 2020  lastdot:.       
-00020910: 2020 2020 2064 6f74 203d 2073 7472 696e       dot = strin
-00020920: 672e 7266 696e 6428 222e 2229 0a20 2020  g.rfind(".").   
-00020930: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00020940: 2020 2020 2020 2064 6f74 203d 2073 7472         dot = str
-00020950: 696e 672e 6669 6e64 2822 2e22 290a 2020  ing.find(".").  
-00020960: 2020 2020 2020 6966 2064 6f74 203d 3d20        if dot == 
-00020970: 2d31 3a0a 2020 2020 2020 2020 2020 2020  -1:.            
-00020980: 646f 7420 3d20 6c65 6e28 7374 7269 6e67  dot = len(string
-00020990: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
-000209a0: 662e 6669 6c65 6e61 6d65 2061 6e64 206e  f.filename and n
-000209b0: 6f74 2073 656c 662e 6d61 7463 6828 7365  ot self.match(se
-000209c0: 6c66 2e66 696c 656e 616d 652c 2073 7472  lf.filename, str
-000209d0: 696e 675b 3a64 6f74 5d29 3a0a 2020 2020  ing[:dot]):.    
-000209e0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-000209f0: 6c69 6461 7469 6f6e 4572 726f 7228 7365  lidationError(se
-00020a00: 6c66 2e74 7261 6e73 6c61 746f 7228 7365  lf.translator(se
-00020a10: 6c66 2e65 7272 6f72 5f6d 6573 7361 6765  lf.error_message
-00020a20: 2929 0a20 2020 2020 2020 2065 6c69 6620  )).        elif 
-00020a30: 7365 6c66 2e65 7874 656e 7369 6f6e 2061  self.extension a
-00020a40: 6e64 206e 6f74 2073 656c 662e 6d61 7463  nd not self.matc
-00020a50: 6828 7365 6c66 2e65 7874 656e 7369 6f6e  h(self.extension
-00020a60: 2c20 7374 7269 6e67 5b64 6f74 202b 2031  , string[dot + 1
-00020a70: 203a 5d29 3a0a 2020 2020 2020 2020 2020   :]):.          
-00020a80: 2020 7261 6973 6520 5661 6c69 6461 7469    raise Validati
-00020a90: 6f6e 4572 726f 7228 7365 6c66 2e74 7261  onError(self.tra
-00020aa0: 6e73 6c61 746f 7228 7365 6c66 2e65 7272  nslator(self.err
-00020ab0: 6f72 5f6d 6573 7361 6765 2929 0a20 2020  or_message)).   
-00020ac0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00020ad0: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
-00020ae0: 6c75 650a 0a0a 636c 6173 7320 4953 5f55  lue...class IS_U
-00020af0: 504c 4f41 445f 4649 4c45 4e41 4d45 2856  PLOAD_FILENAME(V
-00020b00: 616c 6964 6174 6f72 293a 0a20 2020 2022  alidator):.    "
-00020b10: 2222 0a20 2020 2046 6f72 206e 6577 2061  "".    For new a
-00020b20: 7070 6c69 6361 7469 6f6e 732c 2075 7365  pplications, use
-00020b30: 2049 535f 4649 4c45 2829 2e0a 0a20 2020   IS_FILE()...   
-00020b40: 2043 6865 636b 7320 6966 206e 616d 6520   Checks if name 
-00020b50: 616e 6420 6578 7465 6e73 696f 6e20 6f66  and extension of
-00020b60: 2066 696c 6520 7570 6c6f 6164 6564 2074   file uploaded t
-00020b70: 6872 6f75 6768 2066 696c 6520 696e 7075  hrough file inpu
-00020b80: 7420 6d61 7463 6865 730a 2020 2020 6769  t matches.    gi
-00020b90: 7665 6e20 6372 6974 6572 6961 2e0a 0a20  ven criteria... 
-00020ba0: 2020 2044 6f65 7320 2a6e 6f74 2a20 656e     Does *not* en
-00020bb0: 7375 7265 2074 6865 2066 696c 6520 7479  sure the file ty
-00020bc0: 7065 2069 6e20 616e 7920 7761 792e 2052  pe in any way. R
-00020bd0: 6574 7572 6e73 2076 616c 6964 6174 696f  eturns validatio
-00020be0: 6e20 6661 696c 7572 650a 2020 2020 6966  n failure.    if
-00020bf0: 206e 6f20 6461 7461 2077 6173 2075 706c   no data was upl
-00020c00: 6f61 6465 642e 0a0a 2020 2020 4172 6773  oaded...    Args
-00020c10: 3a0a 2020 2020 2020 2020 6669 6c65 6e61  :.        filena
-00020c20: 6d65 3a20 6669 6c65 6e61 6d65 2028 6265  me: filename (be
-00020c30: 666f 7265 2064 6f74 2920 7265 6765 780a  fore dot) regex.
-00020c40: 2020 2020 2020 2020 6578 7465 6e73 696f          extensio
-00020c50: 6e3a 2065 7874 656e 7369 6f6e 2028 6166  n: extension (af
-00020c60: 7465 7220 646f 7429 2072 6567 6578 0a20  ter dot) regex. 
-00020c70: 2020 2020 2020 206c 6173 7464 6f74 3a20         lastdot: 
-00020c80: 7768 6963 6820 646f 7420 7368 6f75 6c64  which dot should
-00020c90: 2062 6520 7573 6564 2061 7320 6120 6669   be used as a fi
-00020ca0: 6c65 6e61 6d65 202f 2065 7874 656e 7369  lename / extensi
-00020cb0: 6f6e 2073 6570 6172 6174 6f72 3a0a 2020  on separator:.  
-00020cc0: 2020 2020 2020 2020 2020 5472 7565 206d            True m
-00020cd0: 6561 6e73 206c 6173 7420 646f 742c 2065  eans last dot, e
-00020ce0: 672e 2066 696c 652e 706e 6720 2d3e 2066  g. file.png -> f
-00020cf0: 696c 6520 2f20 706e 670a 2020 2020 2020  ile / png.      
-00020d00: 2020 2020 2020 4661 6c73 6520 6d65 616e        False mean
-00020d10: 7320 6669 7273 7420 646f 742c 2065 672e  s first dot, eg.
-00020d20: 2066 696c 652e 7461 722e 677a 202d 3e20   file.tar.gz -> 
-00020d30: 6669 6c65 202f 2074 6172 2e67 7a0a 2020  file / tar.gz.  
-00020d40: 2020 2020 2020 6361 7365 3a20 3020 2d20        case: 0 - 
-00020d50: 6b65 6570 2074 6865 2063 6173 652c 2031  keep the case, 1
-00020d60: 202d 2074 7261 6e73 666f 726d 2074 6865   - transform the
-00020d70: 2073 7472 696e 6720 696e 746f 206c 6f77   string into low
-00020d80: 6572 6361 7365 2028 6465 6661 756c 7429  ercase (default)
-00020d90: 2c0a 2020 2020 2020 2020 2020 2020 3220  ,.            2 
-00020da0: 2d20 7472 616e 7366 6f72 6d20 7468 6520  - transform the 
-00020db0: 7374 7269 6e67 2069 6e74 6f20 7570 7065  string into uppe
-00020dc0: 7263 6173 650a 0a20 2020 2049 6620 7468  rcase..    If th
-00020dd0: 6572 6520 6973 206e 6f20 646f 7420 7072  ere is no dot pr
-00020de0: 6573 656e 742c 2065 7874 656e 7369 6f6e  esent, extension
-00020df0: 2063 6865 636b 7320 7769 6c6c 2062 6520   checks will be 
-00020e00: 646f 6e65 2061 6761 696e 7374 2065 6d70  done against emp
-00020e10: 7479 0a20 2020 2073 7472 696e 6720 616e  ty.    string an
-00020e20: 6420 6669 6c65 6e61 6d65 2063 6865 636b  d filename check
-00020e30: 7320 6167 6169 6e73 7420 7768 6f6c 6520  s against whole 
-00020e40: 7661 6c75 652e 0a0a 2020 2020 4578 616d  value...    Exam
-00020e50: 706c 6573 3a0a 2020 2020 2020 2020 4368  ples:.        Ch
-00020e60: 6563 6b20 6966 2066 696c 6520 6861 7320  eck if file has 
-00020e70: 6120 7064 6620 6578 7465 6e73 696f 6e20  a pdf extension 
-00020e80: 2863 6173 6520 696e 7365 6e73 6974 6976  (case insensitiv
-00020e90: 6529 3a0a 0a20 2020 2020 2020 2049 4e50  e):..        INP
-00020ea0: 5554 285f 7479 7065 3d27 6669 6c65 272c  UT(_type='file',
-00020eb0: 205f 6e61 6d65 3d27 6e61 6d65 272c 0a20   _name='name',. 
-00020ec0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00020ed0: 6571 7569 7265 733d 4953 5f55 504c 4f41  equires=IS_UPLOA
-00020ee0: 445f 4649 4c45 4e41 4d45 2865 7874 656e  D_FILENAME(exten
-00020ef0: 7369 6f6e 3d27 7064 6627 2929 0a0a 2020  sion='pdf'))..  
-00020f00: 2020 2020 2020 4368 6563 6b20 6966 2066        Check if f
-00020f10: 696c 6520 6861 7320 6120 7461 722e 677a  ile has a tar.gz
-00020f20: 2065 7874 656e 7369 6f6e 2061 6e64 206e   extension and n
-00020f30: 616d 6520 7374 6172 7469 6e67 2077 6974  ame starting wit
-00020f40: 6820 6261 636b 7570 3a0a 0a20 2020 2020  h backup:..     
-00020f50: 2020 2049 4e50 5554 285f 7479 7065 3d27     INPUT(_type='
-00020f60: 6669 6c65 272c 205f 6e61 6d65 3d27 6e61  file', _name='na
-00020f70: 6d65 272c 0a20 2020 2020 2020 2020 2020  me',.           
-00020f80: 2020 2020 2072 6571 7569 7265 733d 4953       requires=IS
-00020f90: 5f55 504c 4f41 445f 4649 4c45 4e41 4d45  _UPLOAD_FILENAME
-00020fa0: 2866 696c 656e 616d 653d 2762 6163 6b75  (filename='backu
-00020fb0: 702e 2a27 2c0a 2020 2020 2020 2020 2020  p.*',.          
-00020fc0: 2020 2020 2020 6578 7465 6e73 696f 6e3d        extension=
-00020fd0: 2774 6172 2e67 7a27 2c20 6c61 7374 646f  'tar.gz', lastdo
-00020fe0: 743d 4661 6c73 6529 290a 0a20 2020 2020  t=False))..     
-00020ff0: 2020 2043 6865 636b 2069 6620 6669 6c65     Check if file
-00021000: 2068 6173 206e 6f20 6578 7465 6e73 696f   has no extensio
-00021010: 6e20 616e 6420 6e61 6d65 206d 6174 6368  n and name match
-00021020: 696e 6720 5245 4144 4d45 0a20 2020 2020  ing README.     
-00021030: 2020 2028 6361 7365 2073 656e 7369 7469     (case sensiti
-00021040: 7665 293a 0a0a 2020 2020 2020 2020 2020  ve):..          
-00021050: 2020 494e 5055 5428 5f74 7970 653d 2766    INPUT(_type='f
-00021060: 696c 6527 2c20 5f6e 616d 653d 276e 616d  ile', _name='nam
-00021070: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
-00021080: 2020 2020 7265 7175 6972 6573 3d49 535f      requires=IS_
-00021090: 5550 4c4f 4144 5f46 494c 454e 414d 4528  UPLOAD_FILENAME(
-000210a0: 6669 6c65 6e61 6d65 3d27 5e52 4541 444d  filename='^READM
-000210b0: 4524 272c 0a20 2020 2020 2020 2020 2020  E$',.           
-000210c0: 2020 2020 2065 7874 656e 7369 6f6e 3d27       extension='
-000210d0: 5e24 272c 2063 6173 653d 3029 0a0a 2020  ^$', case=0)..  
-000210e0: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
-000210f0: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
-00021100: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
-00021110: 696c 656e 616d 653d 4e6f 6e65 2c0a 2020  ilename=None,.  
-00021120: 2020 2020 2020 6578 7465 6e73 696f 6e3d        extension=
-00021130: 4e6f 6e65 2c0a 2020 2020 2020 2020 6c61  None,.        la
-00021140: 7374 646f 743d 5472 7565 2c0a 2020 2020  stdot=True,.    
-00021150: 2020 2020 6361 7365 3d31 2c0a 2020 2020      case=1,.    
-00021160: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00021170: 653d 2245 6e74 6572 2076 616c 6964 2066  e="Enter valid f
-00021180: 696c 656e 616d 6522 2c0a 2020 2020 293a  ilename",.    ):
-00021190: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-000211a0: 7374 616e 6365 2866 696c 656e 616d 652c  stance(filename,
-000211b0: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
-000211c0: 2020 2066 696c 656e 616d 6520 3d20 7265     filename = re
-000211d0: 2e63 6f6d 7069 6c65 2866 696c 656e 616d  .compile(filenam
-000211e0: 6529 0a20 2020 2020 2020 2069 6620 6973  e).        if is
-000211f0: 696e 7374 616e 6365 2865 7874 656e 7369  instance(extensi
-00021200: 6f6e 2c20 7374 7229 3a0a 2020 2020 2020  on, str):.      
-00021210: 2020 2020 2020 6578 7465 6e73 696f 6e20        extension 
-00021220: 3d20 7265 2e63 6f6d 7069 6c65 2865 7874  = re.compile(ext
-00021230: 656e 7369 6f6e 290a 2020 2020 2020 2020  ension).        
-00021240: 7365 6c66 2e66 696c 656e 616d 6520 3d20  self.filename = 
-00021250: 6669 6c65 6e61 6d65 0a20 2020 2020 2020  filename.       
-00021260: 2073 656c 662e 6578 7465 6e73 696f 6e20   self.extension 
-00021270: 3d20 6578 7465 6e73 696f 6e0a 2020 2020  = extension.    
-00021280: 2020 2020 7365 6c66 2e6c 6173 7464 6f74      self.lastdot
-00021290: 203d 206c 6173 7464 6f74 0a20 2020 2020   = lastdot.     
-000212a0: 2020 2073 656c 662e 6361 7365 203d 2063     self.case = c
-000212b0: 6173 650a 2020 2020 2020 2020 7365 6c66  ase.        self
-000212c0: 2e65 7272 6f72 5f6d 6573 7361 6765 203d  .error_message =
-000212d0: 2065 7272 6f72 5f6d 6573 7361 6765 0a0a   error_message..
-000212e0: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
-000212f0: 2873 656c 662c 2076 616c 7565 2c20 7265  (self, value, re
-00021300: 636f 7264 5f69 643d 4e6f 6e65 293a 0a20  cord_id=None):. 
-00021310: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00021320: 2020 2020 2020 2020 7374 7269 6e67 203d          string =
-00021330: 2076 616c 7565 2e66 696c 656e 616d 650a   value.filename.
-00021340: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
-00021350: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00021360: 6520 5661 6c69 6461 7469 6f6e 4572 726f  e ValidationErro
-00021370: 7228 7365 6c66 2e74 7261 6e73 6c61 746f  r(self.translato
-00021380: 7228 7365 6c66 2e65 7272 6f72 5f6d 6573  r(self.error_mes
-00021390: 7361 6765 2929 0a20 2020 2020 2020 2069  sage)).        i
-000213a0: 6620 7365 6c66 2e63 6173 6520 3d3d 2031  f self.case == 1
-000213b0: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
-000213c0: 7269 6e67 203d 2073 7472 696e 672e 6c6f  ring = string.lo
-000213d0: 7765 7228 290a 2020 2020 2020 2020 656c  wer().        el
-000213e0: 6966 2073 656c 662e 6361 7365 203d 3d20  if self.case == 
-000213f0: 323a 0a20 2020 2020 2020 2020 2020 2073  2:.            s
-00021400: 7472 696e 6720 3d20 7374 7269 6e67 2e75  tring = string.u
-00021410: 7070 6572 2829 0a20 2020 2020 2020 2069  pper().        i
-00021420: 6620 7365 6c66 2e6c 6173 7464 6f74 3a0a  f self.lastdot:.
-00021430: 2020 2020 2020 2020 2020 2020 646f 7420              dot 
-00021440: 3d20 7374 7269 6e67 2e72 6669 6e64 2822  = string.rfind("
-00021450: 2e22 290a 2020 2020 2020 2020 656c 7365  .").        else
-00021460: 3a0a 2020 2020 2020 2020 2020 2020 646f  :.            do
-00021470: 7420 3d20 7374 7269 6e67 2e66 696e 6428  t = string.find(
-00021480: 222e 2229 0a20 2020 2020 2020 2069 6620  ".").        if 
-00021490: 646f 7420 3d3d 202d 313a 0a20 2020 2020  dot == -1:.     
-000214a0: 2020 2020 2020 2064 6f74 203d 206c 656e         dot = len
-000214b0: 2873 7472 696e 6729 0a20 2020 2020 2020  (string).       
-000214c0: 2069 6620 7365 6c66 2e66 696c 656e 616d   if self.filenam
-000214d0: 6520 616e 6420 6e6f 7420 7365 6c66 2e66  e and not self.f
-000214e0: 696c 656e 616d 652e 6d61 7463 6828 7374  ilename.match(st
-000214f0: 7269 6e67 5b3a 646f 745d 293a 0a20 2020  ring[:dot]):.   
-00021500: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00021510: 616c 6964 6174 696f 6e45 7272 6f72 2873  alidationError(s
-00021520: 656c 662e 7472 616e 736c 6174 6f72 2873  elf.translator(s
-00021530: 656c 662e 6572 726f 725f 6d65 7373 6167  elf.error_messag
-00021540: 6529 290a 2020 2020 2020 2020 656c 6966  e)).        elif
-00021550: 2073 656c 662e 6578 7465 6e73 696f 6e20   self.extension 
-00021560: 616e 6420 6e6f 7420 7365 6c66 2e65 7874  and not self.ext
-00021570: 656e 7369 6f6e 2e6d 6174 6368 2873 7472  ension.match(str
-00021580: 696e 675b 646f 7420 2b20 3120 3a5d 293a  ing[dot + 1 :]):
-00021590: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000215a0: 7365 2056 616c 6964 6174 696f 6e45 7272  se ValidationErr
-000215b0: 6f72 2873 656c 662e 7472 616e 736c 6174  or(self.translat
-000215c0: 6f72 2873 656c 662e 6572 726f 725f 6d65  or(self.error_me
-000215d0: 7373 6167 6529 290a 2020 2020 2020 2020  ssage)).        
-000215e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000215f0: 2020 7265 7475 726e 2076 616c 7565 0a0a    return value..
-00021600: 0a63 6c61 7373 2049 535f 4950 5634 2856  .class IS_IPV4(V
-00021610: 616c 6964 6174 6f72 293a 0a20 2020 2022  alidator):.    "
-00021620: 2222 0a20 2020 2043 6865 636b 7320 6966  "".    Checks if
-00021630: 2066 6965 6c64 2773 2076 616c 7565 2069   field's value i
-00021640: 7320 616e 2049 5020 7665 7273 696f 6e20  s an IP version 
-00021650: 3420 6164 6472 6573 7320 696e 2064 6563  4 address in dec
-00021660: 696d 616c 2066 6f72 6d2e 2043 616e 0a20  imal form. Can. 
-00021670: 2020 2062 6520 7365 7420 746f 2066 6f72     be set to for
-00021680: 6365 2061 6464 7265 7373 6573 2066 726f  ce addresses fro
-00021690: 6d20 6365 7274 6169 6e20 7261 6e67 652e  m certain range.
-000216a0: 0a0a 2020 2020 4950 7634 2072 6567 6578  ..    IPv4 regex
-000216b0: 2074 616b 656e 2066 726f 6d3a 2068 7474   taken from: htt
-000216c0: 703a 2f2f 7265 6765 786c 6962 2e63 6f6d  p://regexlib.com
-000216d0: 2f52 4544 6574 6169 6c73 2e61 7370 783f  /REDetails.aspx?
-000216e0: 7265 6765 7870 5f69 643d 3134 3131 0a0a  regexp_id=1411..
-000216f0: 2020 2020 4172 6773 3a0a 0a20 2020 2020      Args:..     
-00021700: 2020 206d 696e 6970 3a20 6c6f 7765 7374     minip: lowest
-00021710: 2061 6c6c 6f77 6564 2061 6464 7265 7373   allowed address
-00021720: 3b20 6163 6365 7074 733a 0a0a 2020 2020  ; accepts:..    
-00021730: 2020 2020 2020 2020 2d20 7374 722c 2065          - str, e
-00021740: 672e 2031 3932 2e31 3638 2e30 2e31 0a20  g. 192.168.0.1. 
-00021750: 2020 2020 2020 2020 2020 202d 206c 6973             - lis
-00021760: 7420 6f72 2074 7570 6c65 206f 6620 6f63  t or tuple of oc
-00021770: 7465 7473 2c20 6567 2e20 5b31 3932 2c20  tets, eg. [192, 
-00021780: 3136 382c 2030 2c20 315d 0a20 2020 2020  168, 0, 1].     
-00021790: 2020 206d 6178 6970 3a20 6869 6768 6573     maxip: highes
-000217a0: 7420 616c 6c6f 7765 6420 6164 6472 6573  t allowed addres
-000217b0: 733b 2073 616d 6520 6173 2061 626f 7665  s; same as above
-000217c0: 0a20 2020 2020 2020 2069 6e76 6572 743a  .        invert:
-000217d0: 2054 7275 6520 746f 2061 6c6c 6f77 2061   True to allow a
-000217e0: 6464 7265 7373 6573 206f 6e6c 7920 6672  ddresses only fr
-000217f0: 6f6d 206f 7574 7369 6465 206f 6620 6769  om outside of gi
-00021800: 7665 6e20 7261 6e67 653b 206e 6f74 650a  ven range; note.
-00021810: 2020 2020 2020 2020 2020 2020 7468 6174              that
-00021820: 2072 616e 6765 2062 6f75 6e64 6172 6965   range boundarie
-00021830: 7320 6172 6520 6e6f 7420 6d61 7463 6865  s are not matche
-00021840: 6420 7468 6973 2077 6179 0a20 2020 2020  d this way.     
-00021850: 2020 2069 735f 6c6f 6361 6c68 6f73 743a     is_localhost:
-00021860: 206c 6f63 616c 686f 7374 2061 6464 7265   localhost addre
-00021870: 7373 2074 7265 6174 6d65 6e74 3a0a 0a20  ss treatment:.. 
-00021880: 2020 2020 2020 2020 2020 202d 204e 6f6e             - Non
-00021890: 6520 2864 6566 6175 6c74 293a 2069 6e64  e (default): ind
-000218a0: 6966 6665 7265 6e74 0a20 2020 2020 2020  ifferent.       
-000218b0: 2020 2020 202d 2054 7275 6520 2865 6e66       - True (enf
-000218c0: 6f72 6365 293a 2071 7565 7279 2061 6464  orce): query add
-000218d0: 7265 7373 206d 7573 7420 6d61 7463 6820  ress must match 
-000218e0: 6c6f 6361 6c68 6f73 7420 6164 6472 6573  localhost addres
-000218f0: 7320 2831 3237 2e30 2e30 2e31 290a 2020  s (127.0.0.1).  
-00021900: 2020 2020 2020 2020 2020 2d20 4661 6c73            - Fals
-00021910: 6520 2866 6f72 6269 6429 3a20 7175 6572  e (forbid): quer
-00021920: 7920 6164 6472 6573 7320 6d75 7374 206e  y address must n
-00021930: 6f74 206d 6174 6368 206c 6f63 616c 686f  ot match localho
-00021940: 7374 2061 6464 7265 7373 0a20 2020 2020  st address.     
-00021950: 2020 2069 735f 7072 6976 6174 653a 2073     is_private: s
-00021960: 616d 6520 6173 2061 626f 7665 2c20 6578  ame as above, ex
-00021970: 6365 7074 2074 6861 7420 7175 6572 7920  cept that query 
-00021980: 6164 6472 6573 7320 6973 2063 6865 636b  address is check
-00021990: 6564 2061 6761 696e 7374 0a20 2020 2020  ed against.     
-000219a0: 2020 2020 2020 2074 776f 2061 6464 7265         two addre
-000219b0: 7373 2072 616e 6765 733a 2031 3732 2e31  ss ranges: 172.1
-000219c0: 362e 302e 3020 2d20 3137 322e 3331 2e32  6.0.0 - 172.31.2
-000219d0: 3535 2e32 3535 2061 6e64 0a20 2020 2020  55.255 and.     
-000219e0: 2020 2020 2020 2031 3932 2e31 3638 2e30         192.168.0
-000219f0: 2e30 202d 2031 3932 2e31 3638 2e32 3535  .0 - 192.168.255
-00021a00: 2e32 3535 0a20 2020 2020 2020 2069 735f  .255.        is_
-00021a10: 6175 746f 6d61 7469 633a 2073 616d 6520  automatic: same 
-00021a20: 6173 2061 626f 7665 2c20 6578 6365 7074  as above, except
-00021a30: 2074 6861 7420 7175 6572 7920 6164 6472   that query addr
-00021a40: 6573 7320 6973 2063 6865 636b 6564 2061  ess is checked a
-00021a50: 6761 696e 7374 0a20 2020 2020 2020 2020  gainst.         
-00021a60: 2020 206f 6e65 2061 6464 7265 7373 2072     one address r
-00021a70: 616e 6765 3a20 3136 392e 3235 342e 302e  ange: 169.254.0.
-00021a80: 3020 2d20 3136 392e 3235 342e 3235 352e  0 - 169.254.255.
-00021a90: 3235 350a 0a20 2020 204d 696e 6970 2061  255..    Minip a
-00021aa0: 6e64 206d 6178 6970 206d 6179 2061 6c73  nd maxip may als
-00021ab0: 6f20 6265 206c 6973 7473 206f 7220 7475  o be lists or tu
-00021ac0: 706c 6573 206f 6620 6164 6472 6573 7365  ples of addresse
-00021ad0: 7320 696e 2061 6c6c 2061 626f 7665 0a20  s in all above. 
-00021ae0: 2020 2066 6f72 6d73 2028 7374 722c 2069     forms (str, i
-00021af0: 6e74 2c20 6c69 7374 202f 2074 7570 6c65  nt, list / tuple
-00021b00: 292c 2061 6c6c 6f77 696e 6720 7365 7475  ), allowing setu
-00021b10: 7020 6f66 206d 756c 7469 706c 6520 6164  p of multiple ad
-00021b20: 6472 6573 7320 7261 6e67 6573 3a3a 0a0a  dress ranges::..
-00021b30: 2020 2020 2020 2020 6d69 6e69 7020 3d20          minip = 
-00021b40: 286d 696e 6970 312c 206d 696e 6970 322c  (minip1, minip2,
-00021b50: 202e 2e2e 206d 696e 6970 4e29 0a20 2020   ... minipN).   
-00021b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b70: 7c20 2020 2020 2020 7c20 2020 2020 2020  |       |       
-00021b80: 2020 2020 7c0a 2020 2020 2020 2020 2020      |.          
-00021b90: 2020 2020 2020 2020 207c 2020 2020 2020           |      
-00021ba0: 207c 2020 2020 2020 2020 2020 207c 0a20   |           |. 
-00021bb0: 2020 2020 2020 206d 6178 6970 203d 2028         maxip = (
-00021bc0: 6d61 7869 7031 2c20 6d61 7869 7032 2c20  maxip1, maxip2, 
-00021bd0: 2e2e 2e20 6d61 7869 704e 290a 0a20 2020  ... maxipN)..   
-00021be0: 204c 6f6e 6765 7220 6974 6572 6162 6c65   Longer iterable
-00021bf0: 2077 696c 6c20 6265 2074 7275 6e63 6174   will be truncat
-00021c00: 6564 2074 6f20 6d61 7463 6820 6c65 6e67  ed to match leng
-00021c10: 7468 206f 6620 7368 6f72 7465 7220 6f6e  th of shorter on
-00021c20: 652e 0a0a 2020 2020 4578 616d 706c 6573  e...    Examples
-00021c30: 3a0a 2020 2020 2020 2020 4368 6563 6b20  :.        Check 
-00021c40: 666f 7220 7661 6c69 6420 4950 7634 2061  for valid IPv4 a
-00021c50: 6464 7265 7373 3a0a 0a20 2020 2020 2020  ddress:..       
-00021c60: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
-00021c70: 3d27 7465 7874 272c 205f 6e61 6d65 3d27  ='text', _name='
-00021c80: 6e61 6d65 272c 2072 6571 7569 7265 733d  name', requires=
-00021c90: 4953 5f49 5056 3428 2929 0a0a 2020 2020  IS_IPV4())..    
-00021ca0: 2020 2020 4368 6563 6b20 666f 7220 7661      Check for va
-00021cb0: 6c69 6420 4950 7634 2061 6464 7265 7373  lid IPv4 address
-00021cc0: 2062 656c 6f6e 6769 6e67 2074 6f20 7370   belonging to sp
-00021cd0: 6563 6966 6963 2072 616e 6765 3a0a 0a20  ecific range:.. 
-00021ce0: 2020 2020 2020 2020 2020 2049 4e50 5554             INPUT
-00021cf0: 285f 7479 7065 3d27 7465 7874 272c 205f  (_type='text', _
-00021d00: 6e61 6d65 3d27 6e61 6d65 272c 0a20 2020  name='name',.   
-00021d10: 2020 2020 2020 2020 2020 2020 2072 6571               req
-00021d20: 7569 7265 733d 4953 5f49 5056 3428 6d69  uires=IS_IPV4(mi
-00021d30: 6e69 703d 2731 3030 2e32 3030 2e30 2e30  nip='100.200.0.0
-00021d40: 272c 206d 6178 6970 3d27 3130 302e 3230  ', maxip='100.20
-00021d50: 302e 3235 352e 3235 3527 2929 0a0a 2020  0.255.255'))..  
-00021d60: 2020 2020 2020 4368 6563 6b20 666f 7220        Check for 
-00021d70: 7661 6c69 6420 4950 7634 2061 6464 7265  valid IPv4 addre
-00021d80: 7373 2062 656c 6f6e 6769 6e67 2074 6f20  ss belonging to 
-00021d90: 6569 7468 6572 2031 3030 2e31 3130 2e30  either 100.110.0
-00021da0: 2e30 202d 0a20 2020 2020 2020 2031 3030  .0 -.        100
-00021db0: 2e31 3130 2e32 3535 2e32 3535 206f 7220  .110.255.255 or 
-00021dc0: 3230 302e 3530 2e30 2e30 202d 2032 3030  200.50.0.0 - 200
-00021dd0: 2e35 302e 302e 3235 3520 6164 6472 6573  .50.0.255 addres
-00021de0: 7320 7261 6e67 653a 0a0a 2020 2020 2020  s range:..      
-00021df0: 2020 2020 2020 494e 5055 5428 5f74 7970        INPUT(_typ
-00021e00: 653d 2774 6578 7427 2c20 5f6e 616d 653d  e='text', _name=
-00021e10: 276e 616d 6527 2c0a 2020 2020 2020 2020  'name',.        
-00021e20: 2020 2020 2020 2020 7265 7175 6972 6573          requires
-00021e30: 3d49 535f 4950 5634 286d 696e 6970 3d28  =IS_IPV4(minip=(
-00021e40: 2731 3030 2e31 3130 2e30 2e30 272c 2027  '100.110.0.0', '
-00021e50: 3230 302e 3530 2e30 2e30 2729 2c0a 2020  200.50.0.0'),.  
+0001ea40: 2025 2028 7374 7228 7365 6c66 2e6e 756d   % (str(self.num
+0001ea50: 6265 7229 2c20 6e75 6d62 6572 7329 0a20  ber), numbers). 
+0001ea60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea70: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001ea80: 2065 6c69 6620 7365 6c66 2e6e 756d 6265   elif self.numbe
+0001ea90: 7220 3d3d 2030 2061 6e64 2073 656c 662e  r == 0 and self.
+0001eaa0: 6e75 6d62 6572 2069 7320 6e6f 7420 4661  number is not Fa
+0001eab0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001eac0: 2020 2020 2069 6620 6c65 6e28 616c 6c5f       if len(all_
+0001ead0: 6e75 6d62 6572 2920 3e20 303a 0a20 2020  number) > 0:.   
+0001eae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eaf0: 2066 6169 6c75 7265 732e 6170 7065 6e64   failures.append
+0001eb00: 2873 656c 662e 7472 616e 736c 6174 6f72  (self.translator
+0001eb10: 2822 4d61 7920 6e6f 7420 696e 636c 7564  ("May not includ
+0001eb20: 6520 616e 7920 6e75 6d62 6572 7322 2929  e any numbers"))
+0001eb30: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0001eb40: 6661 696c 7572 6573 2920 3d3d 2030 3a0a  failures) == 0:.
+0001eb50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001eb60: 726e 2076 616c 7565 0a20 2020 2020 2020  rn value.       
+0001eb70: 2069 6620 6e6f 7420 7365 6c66 2e65 7272   if not self.err
+0001eb80: 6f72 5f6d 6573 7361 6765 3a0a 2020 2020  or_message:.    
+0001eb90: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001eba0: 6573 7472 696e 673a 0a20 2020 2020 2020  estring:.       
+0001ebb0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0001ebc0: 616c 6964 6174 696f 6e45 7272 6f72 2822  alidationError("
+0001ebd0: 7c22 2e6a 6f69 6e28 6d61 7028 7374 722c  |".join(map(str,
+0001ebe0: 2066 6169 6c75 7265 7329 2929 0a20 2020   failures))).   
+0001ebf0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0001ec00: 616c 6964 6174 696f 6e45 7272 6f72 2822  alidationError("
+0001ec10: 2c20 222e 6a6f 696e 2866 6169 6c75 7265  , ".join(failure
+0001ec20: 7329 290a 2020 2020 2020 2020 656c 7365  s)).        else
+0001ec30: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001ec40: 6973 6520 5661 6c69 6461 7469 6f6e 4572  ise ValidationEr
+0001ec50: 726f 7228 7365 6c66 2e74 7261 6e73 6c61  ror(self.transla
+0001ec60: 746f 7228 7365 6c66 2e65 7272 6f72 5f6d  tor(self.error_m
+0001ec70: 6573 7361 6765 2929 0a0a 0a63 6c61 7373  essage))...class
+0001ec80: 2049 535f 494d 4147 4528 5661 6c69 6461   IS_IMAGE(Valida
+0001ec90: 746f 7229 3a0a 2020 2020 2222 220a 2020  tor):.    """.  
+0001eca0: 2020 4368 6563 6b73 2069 6620 6669 6c65    Checks if file
+0001ecb0: 2075 706c 6f61 6465 6420 7468 726f 7567   uploaded throug
+0001ecc0: 6820 6669 6c65 2069 6e70 7574 2077 6173  h file input was
+0001ecd0: 2073 6176 6564 2069 6e20 6f6e 6520 6f66   saved in one of
+0001ece0: 2073 656c 6563 7465 640a 2020 2020 696d   selected.    im
+0001ecf0: 6167 6520 666f 726d 6174 7320 616e 6420  age formats and 
+0001ed00: 6861 7320 6469 6d65 6e73 696f 6e73 2028  has dimensions (
+0001ed10: 7769 6474 6820 616e 6420 6865 6967 6874  width and height
+0001ed20: 2920 7769 7468 696e 2067 6976 656e 2062  ) within given b
+0001ed30: 6f75 6e64 6172 6965 732e 0a0a 2020 2020  oundaries...    
+0001ed40: 446f 6573 202a 6e6f 742a 2063 6865 636b  Does *not* check
+0001ed50: 2066 6f72 206d 6178 696d 756d 2066 696c   for maximum fil
+0001ed60: 6520 7369 7a65 2028 7573 6520 4953 5f4c  e size (use IS_L
+0001ed70: 454e 4754 4820 666f 7220 7468 6174 292e  ENGTH for that).
+0001ed80: 2052 6574 7572 6e73 0a20 2020 2076 616c   Returns.    val
+0001ed90: 6964 6174 696f 6e20 6661 696c 7572 6520  idation failure 
+0001eda0: 6966 206e 6f20 6461 7461 2077 6173 2075  if no data was u
+0001edb0: 706c 6f61 6465 642e 0a0a 2020 2020 5375  ploaded...    Su
+0001edc0: 7070 6f72 7465 6420 6669 6c65 2066 6f72  pported file for
+0001edd0: 6d61 7473 3a20 424d 502c 2047 4946 2c20  mats: BMP, GIF, 
+0001ede0: 4a50 4547 2c20 504e 472e 0a0a 2020 2020  JPEG, PNG...    
+0001edf0: 436f 6465 2070 6172 7473 2074 616b 656e  Code parts taken
+0001ee00: 2066 726f 6d0a 2020 2020 6874 7470 3a2f   from.    http:/
+0001ee10: 2f6d 6169 6c2e 7079 7468 6f6e 2e6f 7267  /mail.python.org
+0001ee20: 2f70 6970 6572 6d61 696c 2f70 7974 686f  /pipermail/pytho
+0001ee30: 6e2d 6c69 7374 2f32 3030 372d 4a75 6e65  n-list/2007-June
+0001ee40: 2f36 3137 3132 362e 6874 6d6c 0a0a 2020  /617126.html..  
+0001ee50: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+0001ee60: 6578 7465 6e73 696f 6e73 3a20 6974 6572  extensions: iter
+0001ee70: 6162 6c65 2063 6f6e 7461 696e 696e 6720  able containing 
+0001ee80: 616c 6c6f 7765 6420 2a6c 6f77 6572 6361  allowed *lowerca
+0001ee90: 7365 2a20 696d 6167 6520 6669 6c65 2065  se* image file e
+0001eea0: 7874 656e 7369 6f6e 730a 2020 2020 2020  xtensions.      
+0001eeb0: 2020 2827 6a70 6727 2065 7874 656e 7369    ('jpg' extensi
+0001eec0: 6f6e 206f 6620 7570 6c6f 6164 6564 2066  on of uploaded f
+0001eed0: 696c 6520 636f 756e 7473 2061 7320 276a  ile counts as 'j
+0001eee0: 7065 6727 290a 2020 2020 2020 2020 6d61  peg').        ma
+0001eef0: 7873 697a 653a 2069 7465 7261 626c 6520  xsize: iterable 
+0001ef00: 636f 6e74 6169 6e69 6e67 206d 6178 696d  containing maxim
+0001ef10: 756d 2077 6964 7468 2061 6e64 2068 6569  um width and hei
+0001ef20: 6768 7420 6f66 2074 6865 2069 6d61 6765  ght of the image
+0001ef30: 0a20 2020 2020 2020 206d 696e 7369 7a65  .        minsize
+0001ef40: 3a20 6974 6572 6162 6c65 2063 6f6e 7461  : iterable conta
+0001ef50: 696e 696e 6720 6d69 6e69 6d75 6d20 7769  ining minimum wi
+0001ef60: 6474 6820 616e 6420 6865 6967 6874 206f  dth and height o
+0001ef70: 6620 7468 6520 696d 6167 650a 2020 2020  f the image.    
+0001ef80: 2020 2020 6173 7065 6374 7261 7469 6f3a      aspectratio:
+0001ef90: 2069 7465 7261 626c 6520 636f 6e74 6169   iterable contai
+0001efa0: 6e69 6e67 2074 6172 6765 7420 6173 7065  ning target aspe
+0001efb0: 6374 2072 6174 696f 0a0a 2020 2020 5573  ct ratio..    Us
+0001efc0: 6520 282d 312c 202d 3129 2061 7320 6d69  e (-1, -1) as mi
+0001efd0: 6e73 697a 6520 746f 2070 6173 7320 696d  nsize to pass im
+0001efe0: 6167 6520 7369 7a65 2063 6865 636b 2e0a  age size check..
+0001eff0: 2020 2020 5573 6520 282d 312c 202d 3129      Use (-1, -1)
+0001f000: 2061 7320 6173 7065 6374 7261 7469 6f20   as aspectratio 
+0001f010: 746f 2070 6173 7320 6173 7065 6374 2072  to pass aspect r
+0001f020: 6174 696f 2063 6865 636b 2e0a 0a20 2020  atio check...   
+0001f030: 2045 7861 6d70 6c65 733a 0a20 2020 2020   Examples:.     
+0001f040: 2020 2043 6865 636b 2069 6620 7570 6c6f     Check if uplo
+0001f050: 6164 6564 2066 696c 6520 6973 2069 6e20  aded file is in 
+0001f060: 616e 7920 6f66 2073 7570 706f 7274 6564  any of supported
+0001f070: 2069 6d61 6765 2066 6f72 6d61 7473 3a0a   image formats:.
+0001f080: 0a20 2020 2020 2020 2020 2020 2049 4e50  .            INP
+0001f090: 5554 285f 7479 7065 3d27 6669 6c65 272c  UT(_type='file',
+0001f0a0: 205f 6e61 6d65 3d27 6e61 6d65 272c 2072   _name='name', r
+0001f0b0: 6571 7569 7265 733d 4953 5f49 4d41 4745  equires=IS_IMAGE
+0001f0c0: 2829 290a 0a20 2020 2020 2020 2043 6865  ())..        Che
+0001f0d0: 636b 2069 6620 7570 6c6f 6164 6564 2066  ck if uploaded f
+0001f0e0: 696c 6520 6973 2065 6974 6865 7220 4a50  ile is either JP
+0001f0f0: 4547 206f 7220 504e 473a 0a0a 2020 2020  EG or PNG:..    
+0001f100: 2020 2020 2020 2020 494e 5055 5428 5f74          INPUT(_t
+0001f110: 7970 653d 2766 696c 6527 2c20 5f6e 616d  ype='file', _nam
+0001f120: 653d 276e 616d 6527 2c0a 2020 2020 2020  e='name',.      
+0001f130: 2020 2020 2020 2020 2020 7265 7175 6972            requir
+0001f140: 6573 3d49 535f 494d 4147 4528 6578 7465  es=IS_IMAGE(exte
+0001f150: 6e73 696f 6e73 3d28 276a 7065 6727 2c20  nsions=('jpeg', 
+0001f160: 2770 6e67 2729 2929 0a0a 2020 2020 2020  'png')))..      
+0001f170: 2020 4368 6563 6b20 6966 2075 706c 6f61    Check if uploa
+0001f180: 6465 6420 6669 6c65 2069 7320 504e 4720  ded file is PNG 
+0001f190: 7769 7468 206d 6178 696d 756d 2073 697a  with maximum siz
+0001f1a0: 6520 6f66 2032 3030 7832 3030 2070 6978  e of 200x200 pix
+0001f1b0: 656c 733a 0a0a 2020 2020 2020 2020 2020  els:..          
+0001f1c0: 2020 494e 5055 5428 5f74 7970 653d 2766    INPUT(_type='f
+0001f1d0: 696c 6527 2c20 5f6e 616d 653d 276e 616d  ile', _name='nam
+0001f1e0: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
+0001f1f0: 2020 2020 7265 7175 6972 6573 3d49 535f      requires=IS_
+0001f200: 494d 4147 4528 6578 7465 6e73 696f 6e73  IMAGE(extensions
+0001f210: 3d28 2770 6e67 2729 2c20 6d61 7873 697a  =('png'), maxsiz
+0001f220: 653d 2832 3030 2c20 3230 3029 2929 0a0a  e=(200, 200)))..
+0001f230: 2020 2020 2020 2020 4368 6563 6b20 6966          Check if
+0001f240: 2075 706c 6f61 6465 6420 6669 6c65 2068   uploaded file h
+0001f250: 6173 2061 2031 363a 3920 6173 7065 6374  as a 16:9 aspect
+0001f260: 2072 6174 696f 3a0a 0a20 2020 2020 2020   ratio:..       
+0001f270: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
+0001f280: 3d27 6669 6c65 272c 205f 6e61 6d65 3d27  ='file', _name='
+0001f290: 6e61 6d65 272c 0a20 2020 2020 2020 2020  name',.         
+0001f2a0: 2020 2020 2020 2072 6571 7569 7265 733d         requires=
+0001f2b0: 4953 5f49 4d41 4745 2861 7370 6563 7472  IS_IMAGE(aspectr
+0001f2c0: 6174 696f 3d28 3136 2c20 3929 2929 0a20  atio=(16, 9))). 
+0001f2d0: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
+0001f2e0: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
+0001f2f0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0001f300: 6578 7465 6e73 696f 6e73 3d28 2262 6d70  extensions=("bmp
+0001f310: 222c 2022 6769 6622 2c20 226a 7065 6722  ", "gif", "jpeg"
+0001f320: 2c20 2270 6e67 2229 2c0a 2020 2020 2020  , "png"),.      
+0001f330: 2020 6d61 7873 697a 653d 2831 3030 3030    maxsize=(10000
+0001f340: 2c20 3130 3030 3029 2c0a 2020 2020 2020  , 10000),.      
+0001f350: 2020 6d69 6e73 697a 653d 2830 2c20 3029    minsize=(0, 0)
+0001f360: 2c0a 2020 2020 2020 2020 6173 7065 6374  ,.        aspect
+0001f370: 7261 7469 6f3d 282d 312c 202d 3129 2c0a  ratio=(-1, -1),.
+0001f380: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+0001f390: 7373 6167 653d 2249 6e76 616c 6964 2069  ssage="Invalid i
+0001f3a0: 6d61 6765 222c 0a20 2020 2029 3a0a 0a20  mage",.    ):.. 
+0001f3b0: 2020 2020 2020 2073 656c 662e 6578 7465         self.exte
+0001f3c0: 6e73 696f 6e73 203d 2065 7874 656e 7369  nsions = extensi
+0001f3d0: 6f6e 730a 2020 2020 2020 2020 7365 6c66  ons.        self
+0001f3e0: 2e6d 6178 7369 7a65 203d 206d 6178 7369  .maxsize = maxsi
+0001f3f0: 7a65 0a20 2020 2020 2020 2073 656c 662e  ze.        self.
+0001f400: 6d69 6e73 697a 6520 3d20 6d69 6e73 697a  minsize = minsiz
+0001f410: 650a 2020 2020 2020 2020 7365 6c66 2e61  e.        self.a
+0001f420: 7370 6563 7472 6174 696f 203d 2061 7370  spectratio = asp
+0001f430: 6563 7472 6174 696f 0a20 2020 2020 2020  ectratio.       
+0001f440: 2073 656c 662e 6572 726f 725f 6d65 7373   self.error_mess
+0001f450: 6167 6520 3d20 6572 726f 725f 6d65 7373  age = error_mess
+0001f460: 6167 650a 0a20 2020 2064 6566 2076 616c  age..    def val
+0001f470: 6964 6174 6528 7365 6c66 2c20 7661 6c75  idate(self, valu
+0001f480: 652c 2072 6563 6f72 645f 6964 3d4e 6f6e  e, record_id=Non
+0001f490: 6529 3a0a 2020 2020 2020 2020 7472 793a  e):.        try:
+0001f4a0: 0a20 2020 2020 2020 2020 2020 2065 7874  .            ext
+0001f4b0: 656e 7369 6f6e 203d 2076 616c 7565 2e66  ension = value.f
+0001f4c0: 696c 656e 616d 652e 7266 696e 6428 222e  ilename.rfind(".
+0001f4d0: 2229 0a20 2020 2020 2020 2020 2020 2061  ").            a
+0001f4e0: 7373 6572 7420 6578 7465 6e73 696f 6e20  ssert extension 
+0001f4f0: 3e3d 2030 0a20 2020 2020 2020 2020 2020  >= 0.           
+0001f500: 2065 7874 656e 7369 6f6e 203d 2076 616c   extension = val
+0001f510: 7565 2e66 696c 656e 616d 655b 6578 7465  ue.filename[exte
+0001f520: 6e73 696f 6e20 2b20 3120 3a5d 2e6c 6f77  nsion + 1 :].low
+0001f530: 6572 2829 0a20 2020 2020 2020 2020 2020  er().           
+0001f540: 2069 6620 6578 7465 6e73 696f 6e20 3d3d   if extension ==
+0001f550: 2022 6a70 6722 3a0a 2020 2020 2020 2020   "jpg":.        
+0001f560: 2020 2020 2020 2020 6578 7465 6e73 696f          extensio
+0001f570: 6e20 3d20 226a 7065 6722 0a20 2020 2020  n = "jpeg".     
+0001f580: 2020 2020 2020 2061 7373 6572 7420 6578         assert ex
+0001f590: 7465 6e73 696f 6e20 696e 2073 656c 662e  tension in self.
+0001f5a0: 6578 7465 6e73 696f 6e73 0a20 2020 2020  extensions.     
+0001f5b0: 2020 2020 2020 2069 6620 6578 7465 6e73         if extens
+0001f5c0: 696f 6e20 3d3d 2022 626d 7022 3a0a 2020  ion == "bmp":.  
+0001f5d0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+0001f5e0: 6474 682c 2068 6569 6768 7420 3d20 7365  dth, height = se
+0001f5f0: 6c66 2e5f 5f62 6d70 2876 616c 7565 2e66  lf.__bmp(value.f
+0001f600: 696c 6529 0a20 2020 2020 2020 2020 2020  ile).           
+0001f610: 2065 6c69 6620 6578 7465 6e73 696f 6e20   elif extension 
+0001f620: 3d3d 2022 6769 6622 3a0a 2020 2020 2020  == "gif":.      
+0001f630: 2020 2020 2020 2020 2020 7769 6474 682c            width,
+0001f640: 2068 6569 6768 7420 3d20 7365 6c66 2e5f   height = self._
+0001f650: 5f67 6966 2876 616c 7565 2e66 696c 6529  _gif(value.file)
+0001f660: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0001f670: 6620 6578 7465 6e73 696f 6e20 3d3d 2022  f extension == "
+0001f680: 6a70 6567 223a 0a20 2020 2020 2020 2020  jpeg":.         
+0001f690: 2020 2020 2020 2077 6964 7468 2c20 6865         width, he
+0001f6a0: 6967 6874 203d 2073 656c 662e 5f5f 6a70  ight = self.__jp
+0001f6b0: 6567 2876 616c 7565 2e66 696c 6529 0a20  eg(value.file). 
+0001f6c0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0001f6d0: 6578 7465 6e73 696f 6e20 3d3d 2022 706e  extension == "pn
+0001f6e0: 6722 3a0a 2020 2020 2020 2020 2020 2020  g":.            
+0001f6f0: 2020 2020 7769 6474 682c 2068 6569 6768      width, heigh
+0001f700: 7420 3d20 7365 6c66 2e5f 5f70 6e67 2876  t = self.__png(v
+0001f710: 616c 7565 2e66 696c 6529 0a20 2020 2020  alue.file).     
+0001f720: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001f730: 2020 2020 2020 2020 2020 2020 2077 6964               wid
+0001f740: 7468 203d 202d 310a 2020 2020 2020 2020  th = -1.        
+0001f750: 2020 2020 2020 2020 6865 6967 6874 203d          height =
+0001f760: 202d 310a 0a20 2020 2020 2020 2020 2020   -1..           
+0001f770: 2061 7373 6572 7420 280a 2020 2020 2020   assert (.      
+0001f780: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0001f790: 696e 7369 7a65 5b30 5d20 3c3d 2077 6964  insize[0] <= wid
+0001f7a0: 7468 203c 3d20 7365 6c66 2e6d 6178 7369  th <= self.maxsi
+0001f7b0: 7a65 5b30 5d0a 2020 2020 2020 2020 2020  ze[0].          
+0001f7c0: 2020 2020 2020 616e 6420 7365 6c66 2e6d        and self.m
+0001f7d0: 696e 7369 7a65 5b31 5d20 3c3d 2068 6569  insize[1] <= hei
+0001f7e0: 6768 7420 3c3d 2073 656c 662e 6d61 7873  ght <= self.maxs
+0001f7f0: 697a 655b 315d 0a20 2020 2020 2020 2020  ize[1].         
+0001f800: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+0001f810: 2020 6966 2073 656c 662e 6173 7065 6374    if self.aspect
+0001f820: 7261 7469 6f20 3e20 282d 312c 202d 3129  ratio > (-1, -1)
+0001f830: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001f840: 2020 7461 7267 6574 5f72 6174 696f 203d    target_ratio =
+0001f850: 2028 312e 3020 2a20 7365 6c66 2e61 7370   (1.0 * self.asp
+0001f860: 6563 7472 6174 696f 5b31 5d29 202f 2073  ectratio[1]) / s
+0001f870: 656c 662e 6173 7065 6374 7261 7469 6f5b  elf.aspectratio[
+0001f880: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+0001f890: 2020 2061 6374 7561 6c5f 7261 7469 6f20     actual_ratio 
+0001f8a0: 3d20 2831 2e30 202a 2068 6569 6768 7429  = (1.0 * height)
+0001f8b0: 202f 2077 6964 7468 0a0a 2020 2020 2020   / width..      
+0001f8c0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+0001f8d0: 2061 6374 7561 6c5f 7261 7469 6f20 3d3d   actual_ratio ==
+0001f8e0: 2074 6172 6765 745f 7261 7469 6f0a 0a20   target_ratio.. 
+0001f8f0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+0001f900: 2e66 696c 652e 7365 656b 2830 290a 2020  .file.seek(0).  
+0001f910: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001f920: 2076 616c 7565 0a20 2020 2020 2020 2065   value.        e
+0001f930: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+0001f940: 6173 2065 3a0a 2020 2020 2020 2020 2020  as e:.          
+0001f950: 2020 7261 6973 6520 5661 6c69 6461 7469    raise Validati
+0001f960: 6f6e 4572 726f 7228 7365 6c66 2e74 7261  onError(self.tra
+0001f970: 6e73 6c61 746f 7228 7365 6c66 2e65 7272  nslator(self.err
+0001f980: 6f72 5f6d 6573 7361 6765 2929 0a0a 2020  or_message))..  
+0001f990: 2020 6465 6620 5f5f 626d 7028 7365 6c66    def __bmp(self
+0001f9a0: 2c20 7374 7265 616d 293a 0a20 2020 2020  , stream):.     
+0001f9b0: 2020 2069 6620 7374 7265 616d 2e72 6561     if stream.rea
+0001f9c0: 6428 3229 203d 3d20 6222 424d 223a 0a20  d(2) == b"BM":. 
+0001f9d0: 2020 2020 2020 2020 2020 2073 7472 6561             strea
+0001f9e0: 6d2e 7265 6164 2831 3629 0a20 2020 2020  m.read(16).     
+0001f9f0: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
+0001fa00: 7275 6374 2e75 6e70 6163 6b28 223c 4c4c  ruct.unpack("<LL
+0001fa10: 222c 2073 7472 6561 6d2e 7265 6164 2838  ", stream.read(8
+0001fa20: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
+0001fa30: 6e20 282d 312c 202d 3129 0a0a 2020 2020  n (-1, -1)..    
+0001fa40: 6465 6620 5f5f 6769 6628 7365 6c66 2c20  def __gif(self, 
+0001fa50: 7374 7265 616d 293a 0a20 2020 2020 2020  stream):.       
+0001fa60: 2069 6620 7374 7265 616d 2e72 6561 6428   if stream.read(
+0001fa70: 3629 2069 6e20 2862 2247 4946 3837 6122  6) in (b"GIF87a"
+0001fa80: 2c20 6222 4749 4638 3961 2229 3a0a 2020  , b"GIF89a"):.  
+0001fa90: 2020 2020 2020 2020 2020 7374 7265 616d            stream
+0001faa0: 203d 2073 7472 6561 6d2e 7265 6164 2835   = stream.read(5
+0001fab0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0001fac0: 206c 656e 2873 7472 6561 6d29 203d 3d20   len(stream) == 
+0001fad0: 353a 0a20 2020 2020 2020 2020 2020 2020  5:.             
+0001fae0: 2020 2072 6574 7572 6e20 7475 706c 6528     return tuple(
+0001faf0: 7374 7275 6374 2e75 6e70 6163 6b28 223c  struct.unpack("<
+0001fb00: 4848 4222 2c20 7374 7265 616d 295b 3a2d  HHB", stream)[:-
+0001fb10: 315d 290a 2020 2020 2020 2020 7265 7475  1]).        retu
+0001fb20: 726e 2028 2d31 2c20 2d31 290a 0a20 2020  rn (-1, -1)..   
+0001fb30: 2064 6566 205f 5f6a 7065 6728 7365 6c66   def __jpeg(self
+0001fb40: 2c20 7374 7265 616d 293a 0a20 2020 2020  , stream):.     
+0001fb50: 2020 2069 6620 7374 7265 616d 2e72 6561     if stream.rea
+0001fb60: 6428 3229 203d 3d20 6222 5c78 4646 5c78  d(2) == b"\xFF\x
+0001fb70: 4438 223a 0a20 2020 2020 2020 2020 2020  D8":.           
+0001fb80: 2077 6869 6c65 2054 7275 653a 0a20 2020   while True:.   
+0001fb90: 2020 2020 2020 2020 2020 2020 2028 6d61               (ma
+0001fba0: 726b 6572 2c20 636f 6465 2c20 6c65 6e67  rker, code, leng
+0001fbb0: 7468 2920 3d20 7374 7275 6374 2e75 6e70  th) = struct.unp
+0001fbc0: 6163 6b28 2221 4242 4822 2c20 7374 7265  ack("!BBH", stre
+0001fbd0: 616d 2e72 6561 6428 3429 290a 2020 2020  am.read(4)).    
+0001fbe0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+0001fbf0: 6172 6b65 7220 213d 2030 7846 463a 0a20  arker != 0xFF:. 
+0001fc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc10: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+0001fc20: 2020 2020 2020 2020 2065 6c69 6620 636f           elif co
+0001fc30: 6465 203e 3d20 3078 4330 2061 6e64 2063  de >= 0xC0 and c
+0001fc40: 6f64 6520 3c3d 2030 7843 333a 0a20 2020  ode <= 0xC3:.   
+0001fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc60: 2072 6574 7572 6e20 7475 706c 6528 7265   return tuple(re
+0001fc70: 7665 7273 6564 2873 7472 7563 742e 756e  versed(struct.un
+0001fc80: 7061 636b 2822 2178 4848 222c 2073 7472  pack("!xHH", str
+0001fc90: 6561 6d2e 7265 6164 2835 2929 2929 0a20  eam.read(5)))). 
+0001fca0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001fcb0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001fcc0: 2020 2020 2020 2020 2073 7472 6561 6d2e           stream.
+0001fcd0: 7265 6164 286c 656e 6774 6820 2d20 3229  read(length - 2)
+0001fce0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001fcf0: 282d 312c 202d 3129 0a0a 2020 2020 6465  (-1, -1)..    de
+0001fd00: 6620 5f5f 706e 6728 7365 6c66 2c20 7374  f __png(self, st
+0001fd10: 7265 616d 293a 0a20 2020 2020 2020 2069  ream):.        i
+0001fd20: 6620 7374 7265 616d 2e72 6561 6428 3829  f stream.read(8)
+0001fd30: 203d 3d20 6222 5c32 3131 504e 475c 725c   == b"\211PNG\r\
+0001fd40: 6e5c 3033 325c 6e22 3a0a 2020 2020 2020  n\032\n":.      
+0001fd50: 2020 2020 2020 7374 7265 616d 2e72 6561        stream.rea
+0001fd60: 6428 3429 0a20 2020 2020 2020 2020 2020  d(4).           
+0001fd70: 2069 6620 7374 7265 616d 2e72 6561 6428   if stream.read(
+0001fd80: 3429 203d 3d20 6222 4948 4452 223a 0a20  4) == b"IHDR":. 
+0001fd90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001fda0: 6574 7572 6e20 7374 7275 6374 2e75 6e70  eturn struct.unp
+0001fdb0: 6163 6b28 2221 4c4c 222c 2073 7472 6561  ack("!LL", strea
+0001fdc0: 6d2e 7265 6164 2838 2929 0a20 2020 2020  m.read(8)).     
+0001fdd0: 2020 2072 6574 7572 6e20 282d 312c 202d     return (-1, -
+0001fde0: 3129 0a0a 0a63 6c61 7373 2049 535f 4649  1)...class IS_FI
+0001fdf0: 4c45 2856 616c 6964 6174 6f72 293a 0a20  LE(Validator):. 
+0001fe00: 2020 2022 2222 0a20 2020 2043 6865 636b     """.    Check
+0001fe10: 7320 6966 206e 616d 6520 616e 6420 6578  s if name and ex
+0001fe20: 7465 6e73 696f 6e20 6f66 2066 696c 6520  tension of file 
+0001fe30: 7570 6c6f 6164 6564 2074 6872 6f75 6768  uploaded through
+0001fe40: 2066 696c 6520 696e 7075 7420 6d61 7463   file input matc
+0001fe50: 6865 730a 2020 2020 6769 7665 6e20 6372  hes.    given cr
+0001fe60: 6974 6572 6961 2e0a 0a20 2020 2044 6f65  iteria...    Doe
+0001fe70: 7320 2a6e 6f74 2a20 656e 7375 7265 2074  s *not* ensure t
+0001fe80: 6865 2066 696c 6520 7479 7065 2069 6e20  he file type in 
+0001fe90: 616e 7920 7761 792e 2052 6574 7572 6e73  any way. Returns
+0001fea0: 2076 616c 6964 6174 696f 6e20 6661 696c   validation fail
+0001feb0: 7572 650a 2020 2020 6966 206e 6f20 6461  ure.    if no da
+0001fec0: 7461 2077 6173 2075 706c 6f61 6465 642e  ta was uploaded.
+0001fed0: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
+0001fee0: 2020 2020 6669 6c65 6e61 6d65 3a20 7374      filename: st
+0001fef0: 7269 6e67 2f63 6f6d 7069 6c65 6420 7265  ring/compiled re
+0001ff00: 6765 7820 6f72 2061 206c 6973 7420 6f66  gex or a list of
+0001ff10: 2073 7472 696e 6773 2f72 6567 6578 206f   strings/regex o
+0001ff20: 6620 7661 6c69 6420 6669 6c65 6e61 6d65  f valid filename
+0001ff30: 730a 2020 2020 2020 2020 6578 7465 6e73  s.        extens
+0001ff40: 696f 6e3a 2073 7472 696e 672f 636f 6d70  ion: string/comp
+0001ff50: 696c 6564 2072 6567 6578 206f 7220 6120  iled regex or a 
+0001ff60: 6c69 7374 206f 6620 7374 7269 6e67 732f  list of strings/
+0001ff70: 7265 6765 7820 6f66 2076 616c 6964 2065  regex of valid e
+0001ff80: 7874 656e 7369 6f6e 730a 2020 2020 2020  xtensions.      
+0001ff90: 2020 6c61 7374 646f 743a 2077 6869 6368    lastdot: which
+0001ffa0: 2064 6f74 2073 686f 756c 6420 6265 2075   dot should be u
+0001ffb0: 7365 6420 6173 2061 2066 696c 656e 616d  sed as a filenam
+0001ffc0: 6520 2f20 6578 7465 6e73 696f 6e20 7365  e / extension se
+0001ffd0: 7061 7261 746f 723a 0a20 2020 2020 2020  parator:.       
+0001ffe0: 2020 2020 2054 7275 6520 6d65 616e 7320       True means 
+0001fff0: 6c61 7374 2064 6f74 2c20 6567 2e20 6669  last dot, eg. fi
+00020000: 6c65 2e6a 7067 2e70 6e67 202d 3e20 6669  le.jpg.png -> fi
+00020010: 6c65 2e6a 7067 202f 2070 6e67 0a20 2020  le.jpg / png.   
+00020020: 2020 2020 2020 2020 2046 616c 7365 206d           False m
+00020030: 6561 6e73 2066 6972 7374 2064 6f74 2c20  eans first dot, 
+00020040: 6567 2e20 6669 6c65 2e74 6172 2e67 7a20  eg. file.tar.gz 
+00020050: 2d3e 2066 696c 6520 2f20 7461 722e 677a  -> file / tar.gz
+00020060: 0a20 2020 2020 2020 2063 6173 653a 2030  .        case: 0
+00020070: 202d 206b 6565 7020 7468 6520 6361 7365   - keep the case
+00020080: 2c20 3120 2d20 7472 616e 7366 6f72 6d20  , 1 - transform 
+00020090: 7468 6520 7374 7269 6e67 2069 6e74 6f20  the string into 
+000200a0: 6c6f 7765 7263 6173 6520 2864 6566 6175  lowercase (defau
+000200b0: 6c74 292c 0a20 2020 2020 2020 2020 2020  lt),.           
+000200c0: 2032 202d 2074 7261 6e73 666f 726d 2074   2 - transform t
+000200d0: 6865 2073 7472 696e 6720 696e 746f 2075  he string into u
+000200e0: 7070 6572 6361 7365 0a0a 2020 2020 4966  ppercase..    If
+000200f0: 2074 6865 7265 2069 7320 6e6f 2064 6f74   there is no dot
+00020100: 2070 7265 7365 6e74 2c20 6578 7465 6e73   present, extens
+00020110: 696f 6e20 6368 6563 6b73 2077 696c 6c20  ion checks will 
+00020120: 6265 2064 6f6e 6520 6167 6169 6e73 7420  be done against 
+00020130: 656d 7074 790a 2020 2020 7374 7269 6e67  empty.    string
+00020140: 2061 6e64 2066 696c 656e 616d 6520 6368   and filename ch
+00020150: 6563 6b73 2061 6761 696e 7374 2077 686f  ecks against who
+00020160: 6c65 2076 616c 7565 2e0a 0a20 2020 2045  le value...    E
+00020170: 7861 6d70 6c65 733a 0a20 2020 2020 2020  xamples:.       
+00020180: 2043 6865 636b 2069 6620 6669 6c65 2068   Check if file h
+00020190: 6173 2061 2070 6466 2065 7874 656e 7369  as a pdf extensi
+000201a0: 6f6e 2028 6361 7365 2069 6e73 656e 7369  on (case insensi
+000201b0: 7469 7665 293a 0a0a 2020 2020 2020 2020  tive):..        
+000201c0: 494e 5055 5428 5f74 7970 653d 2766 696c  INPUT(_type='fil
+000201d0: 6527 2c20 5f6e 616d 653d 276e 616d 6527  e', _name='name'
+000201e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000201f0: 2020 7265 7175 6972 6573 3d49 535f 4649    requires=IS_FI
+00020200: 4c45 2865 7874 656e 7369 6f6e 3d27 7064  LE(extension='pd
+00020210: 6627 2929 0a0a 2020 2020 2020 2020 4368  f'))..        Ch
+00020220: 6563 6b20 6966 2066 696c 6520 6973 2063  eck if file is c
+00020230: 616c 6c65 6420 2774 6875 6d62 6e61 696c  alled 'thumbnail
+00020240: 2720 616e 6420 6861 7320 6120 6a70 6720  ' and has a jpg 
+00020250: 6f72 2070 6e67 2065 7874 656e 7369 6f6e  or png extension
+00020260: 0a20 2020 2020 2020 2028 6361 7365 2069  .        (case i
+00020270: 6e73 656e 7369 7469 7665 293a 0a0a 2020  nsensitive):..  
+00020280: 2020 2020 2020 494e 5055 5428 5f74 7970        INPUT(_typ
+00020290: 653d 2766 696c 6527 2c20 5f6e 616d 653d  e='file', _name=
+000202a0: 276e 616d 6527 2c0a 2020 2020 2020 2020  'name',.        
+000202b0: 2020 2020 2020 2020 7265 7175 6972 6573          requires
+000202c0: 3d49 535f 4649 4c45 2866 696c 656e 616d  =IS_FILE(filenam
+000202d0: 653d 2774 6875 6d62 6e61 696c 272c 0a20  e='thumbnail',. 
+000202e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000202f0: 7874 656e 7369 6f6e 3d5b 276a 7067 272c  xtension=['jpg',
+00020300: 2027 706e 6727 5d29 290a 0a20 2020 2020   'png']))..     
+00020310: 2020 2043 6865 636b 2069 6620 6669 6c65     Check if file
+00020320: 2068 6173 2061 2074 6172 2e67 7a20 6578   has a tar.gz ex
+00020330: 7465 6e73 696f 6e20 616e 6420 6e61 6d65  tension and name
+00020340: 2073 7461 7274 696e 6720 7769 7468 2062   starting with b
+00020350: 6163 6b75 703a 0a0a 2020 2020 2020 2020  ackup:..        
+00020360: 494e 5055 5428 5f74 7970 653d 2766 696c  INPUT(_type='fil
+00020370: 6527 2c20 5f6e 616d 653d 276e 616d 6527  e', _name='name'
+00020380: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00020390: 2020 7265 7175 6972 6573 3d49 535f 4649    requires=IS_FI
+000203a0: 4c45 2866 696c 656e 616d 653d 7265 2e63  LE(filename=re.c
+000203b0: 6f6d 7069 6c65 2827 6261 636b 7570 2e2a  ompile('backup.*
+000203c0: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
+000203d0: 2020 2020 6578 7465 6e73 696f 6e3d 2774      extension='t
+000203e0: 6172 2e67 7a27 2c20 6c61 7374 646f 743d  ar.gz', lastdot=
+000203f0: 4661 6c73 6529 290a 0a20 2020 2020 2020  False))..       
+00020400: 2043 6865 636b 2069 6620 6669 6c65 2068   Check if file h
+00020410: 6173 206e 6f20 6578 7465 6e73 696f 6e20  as no extension 
+00020420: 616e 6420 6e61 6d65 206d 6174 6368 696e  and name matchin
+00020430: 6720 5245 4144 4d45 0a20 2020 2020 2020  g README.       
+00020440: 2028 6361 7365 2073 656e 7369 7469 7665   (case sensitive
+00020450: 293a 0a0a 2020 2020 2020 2020 2020 2020  ):..            
+00020460: 494e 5055 5428 5f74 7970 653d 2766 696c  INPUT(_type='fil
+00020470: 6527 2c20 5f6e 616d 653d 276e 616d 6527  e', _name='name'
+00020480: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00020490: 2020 7265 7175 6972 6573 3d49 535f 4649    requires=IS_FI
+000204a0: 4c45 2866 696c 656e 616d 653d 2752 4541  LE(filename='REA
+000204b0: 444d 4527 2c0a 2020 2020 2020 2020 2020  DME',.          
+000204c0: 2020 2020 2020 6578 7465 6e73 696f 6e3d        extension=
+000204d0: 2727 2c20 6361 7365 3d30 290a 0a20 2020  '', case=0)..   
+000204e0: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
+000204f0: 696e 6974 5f5f 280a 2020 2020 2020 2020  init__(.        
+00020500: 7365 6c66 2c0a 2020 2020 2020 2020 6669  self,.        fi
+00020510: 6c65 6e61 6d65 3d4e 6f6e 652c 0a20 2020  lename=None,.   
+00020520: 2020 2020 2065 7874 656e 7369 6f6e 3d4e       extension=N
+00020530: 6f6e 652c 0a20 2020 2020 2020 206c 6173  one,.        las
+00020540: 7464 6f74 3d54 7275 652c 0a20 2020 2020  tdot=True,.     
+00020550: 2020 2063 6173 653d 312c 0a20 2020 2020     case=1,.     
+00020560: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00020570: 3d22 456e 7465 7220 7661 6c69 6420 6669  ="Enter valid fi
+00020580: 6c65 6e61 6d65 222c 0a20 2020 2029 3a0a  lename",.    ):.
+00020590: 2020 2020 2020 2020 7365 6c66 2e66 696c          self.fil
+000205a0: 656e 616d 6520 3d20 6669 6c65 6e61 6d65  ename = filename
+000205b0: 0a20 2020 2020 2020 2073 656c 662e 6578  .        self.ex
+000205c0: 7465 6e73 696f 6e20 3d20 6578 7465 6e73  tension = extens
+000205d0: 696f 6e0a 2020 2020 2020 2020 7365 6c66  ion.        self
+000205e0: 2e6c 6173 7464 6f74 203d 206c 6173 7464  .lastdot = lastd
+000205f0: 6f74 0a20 2020 2020 2020 2073 656c 662e  ot.        self.
+00020600: 6361 7365 203d 2063 6173 650a 2020 2020  case = case.    
+00020610: 2020 2020 7365 6c66 2e65 7272 6f72 5f6d      self.error_m
+00020620: 6573 7361 6765 203d 2065 7272 6f72 5f6d  essage = error_m
+00020630: 6573 7361 6765 0a0a 2020 2020 6465 6620  essage..    def 
+00020640: 6d61 7463 6828 7365 6c66 2c20 7661 6c75  match(self, valu
+00020650: 6531 2c20 7661 6c75 6532 293a 0a20 2020  e1, value2):.   
+00020660: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00020670: 6365 2876 616c 7565 312c 2028 6c69 7374  ce(value1, (list
+00020680: 2c20 7475 706c 6529 293a 0a20 2020 2020  , tuple)):.     
+00020690: 2020 2020 2020 2066 6f72 2076 2069 6e20         for v in 
+000206a0: 7661 6c75 6531 3a0a 2020 2020 2020 2020  value1:.        
+000206b0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000206c0: 6d61 7463 6828 762c 2076 616c 7565 3229  match(v, value2)
+000206d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000206e0: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+000206f0: 650a 2020 2020 2020 2020 2020 2020 7265  e.            re
+00020700: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
+00020710: 2020 2065 6c69 6620 6361 6c6c 6162 6c65     elif callable
+00020720: 2867 6574 6174 7472 2876 616c 7565 312c  (getattr(value1,
+00020730: 2022 6d61 7463 6822 2c20 4e6f 6e65 2929   "match", None))
+00020740: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00020750: 7475 726e 2076 616c 7565 312e 6d61 7463  turn value1.matc
+00020760: 6828 7661 6c75 6532 290a 2020 2020 2020  h(value2).      
+00020770: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00020780: 6528 7661 6c75 6531 2c20 7374 7229 3a0a  e(value1, str):.
+00020790: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000207a0: 726e 2076 616c 7565 3120 3d3d 2076 616c  rn value1 == val
+000207b0: 7565 320a 0a20 2020 2064 6566 2076 616c  ue2..    def val
+000207c0: 6964 6174 6528 7365 6c66 2c20 7661 6c75  idate(self, valu
+000207d0: 652c 2072 6563 6f72 645f 6964 3d4e 6f6e  e, record_id=Non
+000207e0: 6529 3a0a 2020 2020 2020 2020 7472 793a  e):.        try:
+000207f0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+00020800: 696e 6720 3d20 7661 6c75 652e 6669 6c65  ing = value.file
+00020810: 6e61 6d65 0a20 2020 2020 2020 2065 7863  name.        exc
+00020820: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
+00020830: 2072 6169 7365 2056 616c 6964 6174 696f   raise Validatio
+00020840: 6e45 7272 6f72 2873 656c 662e 7472 616e  nError(self.tran
+00020850: 736c 6174 6f72 2873 656c 662e 6572 726f  slator(self.erro
+00020860: 725f 6d65 7373 6167 6529 290a 2020 2020  r_message)).    
+00020870: 2020 2020 6966 2073 656c 662e 6361 7365      if self.case
+00020880: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00020890: 2020 2073 7472 696e 6720 3d20 7374 7269     string = stri
+000208a0: 6e67 2e6c 6f77 6572 2829 0a20 2020 2020  ng.lower().     
+000208b0: 2020 2065 6c69 6620 7365 6c66 2e63 6173     elif self.cas
+000208c0: 6520 3d3d 2032 3a0a 2020 2020 2020 2020  e == 2:.        
+000208d0: 2020 2020 7374 7269 6e67 203d 2073 7472      string = str
+000208e0: 696e 672e 7570 7065 7228 290a 2020 2020  ing.upper().    
+000208f0: 2020 2020 6966 2073 656c 662e 6c61 7374      if self.last
+00020900: 646f 743a 0a20 2020 2020 2020 2020 2020  dot:.           
+00020910: 2064 6f74 203d 2073 7472 696e 672e 7266   dot = string.rf
+00020920: 696e 6428 222e 2229 0a20 2020 2020 2020  ind(".").       
+00020930: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00020940: 2020 2064 6f74 203d 2073 7472 696e 672e     dot = string.
+00020950: 6669 6e64 2822 2e22 290a 2020 2020 2020  find(".").      
+00020960: 2020 6966 2064 6f74 203d 3d20 2d31 3a0a    if dot == -1:.
+00020970: 2020 2020 2020 2020 2020 2020 646f 7420              dot 
+00020980: 3d20 6c65 6e28 7374 7269 6e67 290a 2020  = len(string).  
+00020990: 2020 2020 2020 6966 2073 656c 662e 6669        if self.fi
+000209a0: 6c65 6e61 6d65 2061 6e64 206e 6f74 2073  lename and not s
+000209b0: 656c 662e 6d61 7463 6828 7365 6c66 2e66  elf.match(self.f
+000209c0: 696c 656e 616d 652c 2073 7472 696e 675b  ilename, string[
+000209d0: 3a64 6f74 5d29 3a0a 2020 2020 2020 2020  :dot]):.        
+000209e0: 2020 2020 7261 6973 6520 5661 6c69 6461      raise Valida
+000209f0: 7469 6f6e 4572 726f 7228 7365 6c66 2e74  tionError(self.t
+00020a00: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
+00020a10: 7272 6f72 5f6d 6573 7361 6765 2929 0a20  rror_message)). 
+00020a20: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00020a30: 2e65 7874 656e 7369 6f6e 2061 6e64 206e  .extension and n
+00020a40: 6f74 2073 656c 662e 6d61 7463 6828 7365  ot self.match(se
+00020a50: 6c66 2e65 7874 656e 7369 6f6e 2c20 7374  lf.extension, st
+00020a60: 7269 6e67 5b64 6f74 202b 2031 203a 5d29  ring[dot + 1 :])
+00020a70: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00020a80: 6973 6520 5661 6c69 6461 7469 6f6e 4572  ise ValidationEr
+00020a90: 726f 7228 7365 6c66 2e74 7261 6e73 6c61  ror(self.transla
+00020aa0: 746f 7228 7365 6c66 2e65 7272 6f72 5f6d  tor(self.error_m
+00020ab0: 6573 7361 6765 2929 0a20 2020 2020 2020  essage)).       
+00020ac0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00020ad0: 2020 2072 6574 7572 6e20 7661 6c75 650a     return value.
+00020ae0: 0a0a 636c 6173 7320 4953 5f55 504c 4f41  ..class IS_UPLOA
+00020af0: 445f 4649 4c45 4e41 4d45 2856 616c 6964  D_FILENAME(Valid
+00020b00: 6174 6f72 293a 0a20 2020 2022 2222 0a20  ator):.    """. 
+00020b10: 2020 2046 6f72 206e 6577 2061 7070 6c69     For new appli
+00020b20: 6361 7469 6f6e 732c 2075 7365 2049 535f  cations, use IS_
+00020b30: 4649 4c45 2829 2e0a 0a20 2020 2043 6865  FILE()...    Che
+00020b40: 636b 7320 6966 206e 616d 6520 616e 6420  cks if name and 
+00020b50: 6578 7465 6e73 696f 6e20 6f66 2066 696c  extension of fil
+00020b60: 6520 7570 6c6f 6164 6564 2074 6872 6f75  e uploaded throu
+00020b70: 6768 2066 696c 6520 696e 7075 7420 6d61  gh file input ma
+00020b80: 7463 6865 730a 2020 2020 6769 7665 6e20  tches.    given 
+00020b90: 6372 6974 6572 6961 2e0a 0a20 2020 2044  criteria...    D
+00020ba0: 6f65 7320 2a6e 6f74 2a20 656e 7375 7265  oes *not* ensure
+00020bb0: 2074 6865 2066 696c 6520 7479 7065 2069   the file type i
+00020bc0: 6e20 616e 7920 7761 792e 2052 6574 7572  n any way. Retur
+00020bd0: 6e73 2076 616c 6964 6174 696f 6e20 6661  ns validation fa
+00020be0: 696c 7572 650a 2020 2020 6966 206e 6f20  ilure.    if no 
+00020bf0: 6461 7461 2077 6173 2075 706c 6f61 6465  data was uploade
+00020c00: 642e 0a0a 2020 2020 4172 6773 3a0a 2020  d...    Args:.  
+00020c10: 2020 2020 2020 6669 6c65 6e61 6d65 3a20        filename: 
+00020c20: 6669 6c65 6e61 6d65 2028 6265 666f 7265  filename (before
+00020c30: 2064 6f74 2920 7265 6765 780a 2020 2020   dot) regex.    
+00020c40: 2020 2020 6578 7465 6e73 696f 6e3a 2065      extension: e
+00020c50: 7874 656e 7369 6f6e 2028 6166 7465 7220  xtension (after 
+00020c60: 646f 7429 2072 6567 6578 0a20 2020 2020  dot) regex.     
+00020c70: 2020 206c 6173 7464 6f74 3a20 7768 6963     lastdot: whic
+00020c80: 6820 646f 7420 7368 6f75 6c64 2062 6520  h dot should be 
+00020c90: 7573 6564 2061 7320 6120 6669 6c65 6e61  used as a filena
+00020ca0: 6d65 202f 2065 7874 656e 7369 6f6e 2073  me / extension s
+00020cb0: 6570 6172 6174 6f72 3a0a 2020 2020 2020  eparator:.      
+00020cc0: 2020 2020 2020 5472 7565 206d 6561 6e73        True means
+00020cd0: 206c 6173 7420 646f 742c 2065 672e 2066   last dot, eg. f
+00020ce0: 696c 652e 706e 6720 2d3e 2066 696c 6520  ile.png -> file 
+00020cf0: 2f20 706e 670a 2020 2020 2020 2020 2020  / png.          
+00020d00: 2020 4661 6c73 6520 6d65 616e 7320 6669    False means fi
+00020d10: 7273 7420 646f 742c 2065 672e 2066 696c  rst dot, eg. fil
+00020d20: 652e 7461 722e 677a 202d 3e20 6669 6c65  e.tar.gz -> file
+00020d30: 202f 2074 6172 2e67 7a0a 2020 2020 2020   / tar.gz.      
+00020d40: 2020 6361 7365 3a20 3020 2d20 6b65 6570    case: 0 - keep
+00020d50: 2074 6865 2063 6173 652c 2031 202d 2074   the case, 1 - t
+00020d60: 7261 6e73 666f 726d 2074 6865 2073 7472  ransform the str
+00020d70: 696e 6720 696e 746f 206c 6f77 6572 6361  ing into lowerca
+00020d80: 7365 2028 6465 6661 756c 7429 2c0a 2020  se (default),.  
+00020d90: 2020 2020 2020 2020 2020 3220 2d20 7472            2 - tr
+00020da0: 616e 7366 6f72 6d20 7468 6520 7374 7269  ansform the stri
+00020db0: 6e67 2069 6e74 6f20 7570 7065 7263 6173  ng into uppercas
+00020dc0: 650a 0a20 2020 2049 6620 7468 6572 6520  e..    If there 
+00020dd0: 6973 206e 6f20 646f 7420 7072 6573 656e  is no dot presen
+00020de0: 742c 2065 7874 656e 7369 6f6e 2063 6865  t, extension che
+00020df0: 636b 7320 7769 6c6c 2062 6520 646f 6e65  cks will be done
+00020e00: 2061 6761 696e 7374 2065 6d70 7479 0a20   against empty. 
+00020e10: 2020 2073 7472 696e 6720 616e 6420 6669     string and fi
+00020e20: 6c65 6e61 6d65 2063 6865 636b 7320 6167  lename checks ag
+00020e30: 6169 6e73 7420 7768 6f6c 6520 7661 6c75  ainst whole valu
+00020e40: 652e 0a0a 2020 2020 4578 616d 706c 6573  e...    Examples
+00020e50: 3a0a 2020 2020 2020 2020 4368 6563 6b20  :.        Check 
+00020e60: 6966 2066 696c 6520 6861 7320 6120 7064  if file has a pd
+00020e70: 6620 6578 7465 6e73 696f 6e20 2863 6173  f extension (cas
+00020e80: 6520 696e 7365 6e73 6974 6976 6529 3a0a  e insensitive):.
+00020e90: 0a20 2020 2020 2020 2049 4e50 5554 285f  .        INPUT(_
+00020ea0: 7479 7065 3d27 6669 6c65 272c 205f 6e61  type='file', _na
+00020eb0: 6d65 3d27 6e61 6d65 272c 0a20 2020 2020  me='name',.     
+00020ec0: 2020 2020 2020 2020 2020 2072 6571 7569             requi
+00020ed0: 7265 733d 4953 5f55 504c 4f41 445f 4649  res=IS_UPLOAD_FI
+00020ee0: 4c45 4e41 4d45 2865 7874 656e 7369 6f6e  LENAME(extension
+00020ef0: 3d27 7064 6627 2929 0a0a 2020 2020 2020  ='pdf'))..      
+00020f00: 2020 4368 6563 6b20 6966 2066 696c 6520    Check if file 
+00020f10: 6861 7320 6120 7461 722e 677a 2065 7874  has a tar.gz ext
+00020f20: 656e 7369 6f6e 2061 6e64 206e 616d 6520  ension and name 
+00020f30: 7374 6172 7469 6e67 2077 6974 6820 6261  starting with ba
+00020f40: 636b 7570 3a0a 0a20 2020 2020 2020 2049  ckup:..        I
+00020f50: 4e50 5554 285f 7479 7065 3d27 6669 6c65  NPUT(_type='file
+00020f60: 272c 205f 6e61 6d65 3d27 6e61 6d65 272c  ', _name='name',
+00020f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020f80: 2072 6571 7569 7265 733d 4953 5f55 504c   requires=IS_UPL
+00020f90: 4f41 445f 4649 4c45 4e41 4d45 2866 696c  OAD_FILENAME(fil
+00020fa0: 656e 616d 653d 2762 6163 6b75 702e 2a27  ename='backup.*'
+00020fb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00020fc0: 2020 6578 7465 6e73 696f 6e3d 2774 6172    extension='tar
+00020fd0: 2e67 7a27 2c20 6c61 7374 646f 743d 4661  .gz', lastdot=Fa
+00020fe0: 6c73 6529 290a 0a20 2020 2020 2020 2043  lse))..        C
+00020ff0: 6865 636b 2069 6620 6669 6c65 2068 6173  heck if file has
+00021000: 206e 6f20 6578 7465 6e73 696f 6e20 616e   no extension an
+00021010: 6420 6e61 6d65 206d 6174 6368 696e 6720  d name matching 
+00021020: 5245 4144 4d45 0a20 2020 2020 2020 2028  README.        (
+00021030: 6361 7365 2073 656e 7369 7469 7665 293a  case sensitive):
+00021040: 0a0a 2020 2020 2020 2020 2020 2020 494e  ..            IN
+00021050: 5055 5428 5f74 7970 653d 2766 696c 6527  PUT(_type='file'
+00021060: 2c20 5f6e 616d 653d 276e 616d 6527 2c0a  , _name='name',.
+00021070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021080: 7265 7175 6972 6573 3d49 535f 5550 4c4f  requires=IS_UPLO
+00021090: 4144 5f46 494c 454e 414d 4528 6669 6c65  AD_FILENAME(file
+000210a0: 6e61 6d65 3d27 5e52 4541 444d 4524 272c  name='^README$',
+000210b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000210c0: 2065 7874 656e 7369 6f6e 3d27 5e24 272c   extension='^$',
+000210d0: 2063 6173 653d 3029 0a0a 2020 2020 2222   case=0)..    ""
+000210e0: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+000210f0: 745f 5f28 0a20 2020 2020 2020 2073 656c  t__(.        sel
+00021100: 662c 0a20 2020 2020 2020 2066 696c 656e  f,.        filen
+00021110: 616d 653d 4e6f 6e65 2c0a 2020 2020 2020  ame=None,.      
+00021120: 2020 6578 7465 6e73 696f 6e3d 4e6f 6e65    extension=None
+00021130: 2c0a 2020 2020 2020 2020 6c61 7374 646f  ,.        lastdo
+00021140: 743d 5472 7565 2c0a 2020 2020 2020 2020  t=True,.        
+00021150: 6361 7365 3d31 2c0a 2020 2020 2020 2020  case=1,.        
+00021160: 6572 726f 725f 6d65 7373 6167 653d 2245  error_message="E
+00021170: 6e74 6572 2076 616c 6964 2066 696c 656e  nter valid filen
+00021180: 616d 6522 2c0a 2020 2020 293a 0a20 2020  ame",.    ):.   
+00021190: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+000211a0: 6365 2866 696c 656e 616d 652c 2073 7472  ce(filename, str
+000211b0: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
+000211c0: 696c 656e 616d 6520 3d20 7265 2e63 6f6d  ilename = re.com
+000211d0: 7069 6c65 2866 696c 656e 616d 6529 0a20  pile(filename). 
+000211e0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000211f0: 616e 6365 2865 7874 656e 7369 6f6e 2c20  ance(extension, 
+00021200: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
+00021210: 2020 6578 7465 6e73 696f 6e20 3d20 7265    extension = re
+00021220: 2e63 6f6d 7069 6c65 2865 7874 656e 7369  .compile(extensi
+00021230: 6f6e 290a 2020 2020 2020 2020 7365 6c66  on).        self
+00021240: 2e66 696c 656e 616d 6520 3d20 6669 6c65  .filename = file
+00021250: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
+00021260: 662e 6578 7465 6e73 696f 6e20 3d20 6578  f.extension = ex
+00021270: 7465 6e73 696f 6e0a 2020 2020 2020 2020  tension.        
+00021280: 7365 6c66 2e6c 6173 7464 6f74 203d 206c  self.lastdot = l
+00021290: 6173 7464 6f74 0a20 2020 2020 2020 2073  astdot.        s
+000212a0: 656c 662e 6361 7365 203d 2063 6173 650a  elf.case = case.
+000212b0: 2020 2020 2020 2020 7365 6c66 2e65 7272          self.err
+000212c0: 6f72 5f6d 6573 7361 6765 203d 2065 7272  or_message = err
+000212d0: 6f72 5f6d 6573 7361 6765 0a0a 2020 2020  or_message..    
+000212e0: 6465 6620 7661 6c69 6461 7465 2873 656c  def validate(sel
+000212f0: 662c 2076 616c 7565 2c20 7265 636f 7264  f, value, record
+00021300: 5f69 643d 4e6f 6e65 293a 0a20 2020 2020  _id=None):.     
+00021310: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00021320: 2020 2020 7374 7269 6e67 203d 2076 616c      string = val
+00021330: 7565 2e66 696c 656e 616d 650a 2020 2020  ue.filename.    
+00021340: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
+00021350: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00021360: 6c69 6461 7469 6f6e 4572 726f 7228 7365  lidationError(se
+00021370: 6c66 2e74 7261 6e73 6c61 746f 7228 7365  lf.translator(se
+00021380: 6c66 2e65 7272 6f72 5f6d 6573 7361 6765  lf.error_message
+00021390: 2929 0a20 2020 2020 2020 2069 6620 7365  )).        if se
+000213a0: 6c66 2e63 6173 6520 3d3d 2031 3a0a 2020  lf.case == 1:.  
+000213b0: 2020 2020 2020 2020 2020 7374 7269 6e67            string
+000213c0: 203d 2073 7472 696e 672e 6c6f 7765 7228   = string.lower(
+000213d0: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+000213e0: 656c 662e 6361 7365 203d 3d20 323a 0a20  elf.case == 2:. 
+000213f0: 2020 2020 2020 2020 2020 2073 7472 696e             strin
+00021400: 6720 3d20 7374 7269 6e67 2e75 7070 6572  g = string.upper
+00021410: 2829 0a20 2020 2020 2020 2069 6620 7365  ().        if se
+00021420: 6c66 2e6c 6173 7464 6f74 3a0a 2020 2020  lf.lastdot:.    
+00021430: 2020 2020 2020 2020 646f 7420 3d20 7374          dot = st
+00021440: 7269 6e67 2e72 6669 6e64 2822 2e22 290a  ring.rfind(".").
+00021450: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00021460: 2020 2020 2020 2020 2020 646f 7420 3d20            dot = 
+00021470: 7374 7269 6e67 2e66 696e 6428 222e 2229  string.find(".")
+00021480: 0a20 2020 2020 2020 2069 6620 646f 7420  .        if dot 
+00021490: 3d3d 202d 313a 0a20 2020 2020 2020 2020  == -1:.         
+000214a0: 2020 2064 6f74 203d 206c 656e 2873 7472     dot = len(str
+000214b0: 696e 6729 0a20 2020 2020 2020 2069 6620  ing).        if 
+000214c0: 7365 6c66 2e66 696c 656e 616d 6520 616e  self.filename an
+000214d0: 6420 6e6f 7420 7365 6c66 2e66 696c 656e  d not self.filen
+000214e0: 616d 652e 6d61 7463 6828 7374 7269 6e67  ame.match(string
+000214f0: 5b3a 646f 745d 293a 0a20 2020 2020 2020  [:dot]):.       
+00021500: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
+00021510: 6174 696f 6e45 7272 6f72 2873 656c 662e  ationError(self.
+00021520: 7472 616e 736c 6174 6f72 2873 656c 662e  translator(self.
+00021530: 6572 726f 725f 6d65 7373 6167 6529 290a  error_message)).
+00021540: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+00021550: 662e 6578 7465 6e73 696f 6e20 616e 6420  f.extension and 
+00021560: 6e6f 7420 7365 6c66 2e65 7874 656e 7369  not self.extensi
+00021570: 6f6e 2e6d 6174 6368 2873 7472 696e 675b  on.match(string[
+00021580: 646f 7420 2b20 3120 3a5d 293a 0a20 2020  dot + 1 :]):.   
+00021590: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000215a0: 616c 6964 6174 696f 6e45 7272 6f72 2873  alidationError(s
+000215b0: 656c 662e 7472 616e 736c 6174 6f72 2873  elf.translator(s
+000215c0: 656c 662e 6572 726f 725f 6d65 7373 6167  elf.error_messag
+000215d0: 6529 290a 2020 2020 2020 2020 656c 7365  e)).        else
+000215e0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000215f0: 7475 726e 2076 616c 7565 0a0a 0a63 6c61  turn value...cla
+00021600: 7373 2049 535f 4950 5634 2856 616c 6964  ss IS_IPV4(Valid
+00021610: 6174 6f72 293a 0a20 2020 2022 2222 0a20  ator):.    """. 
+00021620: 2020 2043 6865 636b 7320 6966 2066 6965     Checks if fie
+00021630: 6c64 2773 2076 616c 7565 2069 7320 616e  ld's value is an
+00021640: 2049 5020 7665 7273 696f 6e20 3420 6164   IP version 4 ad
+00021650: 6472 6573 7320 696e 2064 6563 696d 616c  dress in decimal
+00021660: 2066 6f72 6d2e 2043 616e 0a20 2020 2062   form. Can.    b
+00021670: 6520 7365 7420 746f 2066 6f72 6365 2061  e set to force a
+00021680: 6464 7265 7373 6573 2066 726f 6d20 6365  ddresses from ce
+00021690: 7274 6169 6e20 7261 6e67 652e 0a0a 2020  rtain range...  
+000216a0: 2020 4950 7634 2072 6567 6578 2074 616b    IPv4 regex tak
+000216b0: 656e 2066 726f 6d3a 2068 7474 703a 2f2f  en from: http://
+000216c0: 7265 6765 786c 6962 2e63 6f6d 2f52 4544  regexlib.com/RED
+000216d0: 6574 6169 6c73 2e61 7370 783f 7265 6765  etails.aspx?rege
+000216e0: 7870 5f69 643d 3134 3131 0a0a 2020 2020  xp_id=1411..    
+000216f0: 4172 6773 3a0a 0a20 2020 2020 2020 206d  Args:..        m
+00021700: 696e 6970 3a20 6c6f 7765 7374 2061 6c6c  inip: lowest all
+00021710: 6f77 6564 2061 6464 7265 7373 3b20 6163  owed address; ac
+00021720: 6365 7074 733a 0a0a 2020 2020 2020 2020  cepts:..        
+00021730: 2020 2020 2d20 7374 722c 2065 672e 2031      - str, eg. 1
+00021740: 3932 2e31 3638 2e30 2e31 0a20 2020 2020  92.168.0.1.     
+00021750: 2020 2020 2020 202d 206c 6973 7420 6f72         - list or
+00021760: 2074 7570 6c65 206f 6620 6f63 7465 7473   tuple of octets
+00021770: 2c20 6567 2e20 5b31 3932 2c20 3136 382c  , eg. [192, 168,
+00021780: 2030 2c20 315d 0a20 2020 2020 2020 206d   0, 1].        m
+00021790: 6178 6970 3a20 6869 6768 6573 7420 616c  axip: highest al
+000217a0: 6c6f 7765 6420 6164 6472 6573 733b 2073  lowed address; s
+000217b0: 616d 6520 6173 2061 626f 7665 0a20 2020  ame as above.   
+000217c0: 2020 2020 2069 6e76 6572 743a 2054 7275       invert: Tru
+000217d0: 6520 746f 2061 6c6c 6f77 2061 6464 7265  e to allow addre
+000217e0: 7373 6573 206f 6e6c 7920 6672 6f6d 206f  sses only from o
+000217f0: 7574 7369 6465 206f 6620 6769 7665 6e20  utside of given 
+00021800: 7261 6e67 653b 206e 6f74 650a 2020 2020  range; note.    
+00021810: 2020 2020 2020 2020 7468 6174 2072 616e          that ran
+00021820: 6765 2062 6f75 6e64 6172 6965 7320 6172  ge boundaries ar
+00021830: 6520 6e6f 7420 6d61 7463 6865 6420 7468  e not matched th
+00021840: 6973 2077 6179 0a20 2020 2020 2020 2069  is way.        i
+00021850: 735f 6c6f 6361 6c68 6f73 743a 206c 6f63  s_localhost: loc
+00021860: 616c 686f 7374 2061 6464 7265 7373 2074  alhost address t
+00021870: 7265 6174 6d65 6e74 3a0a 0a20 2020 2020  reatment:..     
+00021880: 2020 2020 2020 202d 204e 6f6e 6520 2864         - None (d
+00021890: 6566 6175 6c74 293a 2069 6e64 6966 6665  efault): indiffe
+000218a0: 7265 6e74 0a20 2020 2020 2020 2020 2020  rent.           
+000218b0: 202d 2054 7275 6520 2865 6e66 6f72 6365   - True (enforce
+000218c0: 293a 2071 7565 7279 2061 6464 7265 7373  ): query address
+000218d0: 206d 7573 7420 6d61 7463 6820 6c6f 6361   must match loca
+000218e0: 6c68 6f73 7420 6164 6472 6573 7320 2831  lhost address (1
+000218f0: 3237 2e30 2e30 2e31 290a 2020 2020 2020  27.0.0.1).      
+00021900: 2020 2020 2020 2d20 4661 6c73 6520 2866        - False (f
+00021910: 6f72 6269 6429 3a20 7175 6572 7920 6164  orbid): query ad
+00021920: 6472 6573 7320 6d75 7374 206e 6f74 206d  dress must not m
+00021930: 6174 6368 206c 6f63 616c 686f 7374 2061  atch localhost a
+00021940: 6464 7265 7373 0a20 2020 2020 2020 2069  ddress.        i
+00021950: 735f 7072 6976 6174 653a 2073 616d 6520  s_private: same 
+00021960: 6173 2061 626f 7665 2c20 6578 6365 7074  as above, except
+00021970: 2074 6861 7420 7175 6572 7920 6164 6472   that query addr
+00021980: 6573 7320 6973 2063 6865 636b 6564 2061  ess is checked a
+00021990: 6761 696e 7374 0a20 2020 2020 2020 2020  gainst.         
+000219a0: 2020 2074 776f 2061 6464 7265 7373 2072     two address r
+000219b0: 616e 6765 733a 2031 3732 2e31 362e 302e  anges: 172.16.0.
+000219c0: 3020 2d20 3137 322e 3331 2e32 3535 2e32  0 - 172.31.255.2
+000219d0: 3535 2061 6e64 0a20 2020 2020 2020 2020  55 and.         
+000219e0: 2020 2031 3932 2e31 3638 2e30 2e30 202d     192.168.0.0 -
+000219f0: 2031 3932 2e31 3638 2e32 3535 2e32 3535   192.168.255.255
+00021a00: 0a20 2020 2020 2020 2069 735f 6175 746f  .        is_auto
+00021a10: 6d61 7469 633a 2073 616d 6520 6173 2061  matic: same as a
+00021a20: 626f 7665 2c20 6578 6365 7074 2074 6861  bove, except tha
+00021a30: 7420 7175 6572 7920 6164 6472 6573 7320  t query address 
+00021a40: 6973 2063 6865 636b 6564 2061 6761 696e  is checked again
+00021a50: 7374 0a20 2020 2020 2020 2020 2020 206f  st.            o
+00021a60: 6e65 2061 6464 7265 7373 2072 616e 6765  ne address range
+00021a70: 3a20 3136 392e 3235 342e 302e 3020 2d20  : 169.254.0.0 - 
+00021a80: 3136 392e 3235 342e 3235 352e 3235 350a  169.254.255.255.
+00021a90: 0a20 2020 204d 696e 6970 2061 6e64 206d  .    Minip and m
+00021aa0: 6178 6970 206d 6179 2061 6c73 6f20 6265  axip may also be
+00021ab0: 206c 6973 7473 206f 7220 7475 706c 6573   lists or tuples
+00021ac0: 206f 6620 6164 6472 6573 7365 7320 696e   of addresses in
+00021ad0: 2061 6c6c 2061 626f 7665 0a20 2020 2066   all above.    f
+00021ae0: 6f72 6d73 2028 7374 722c 2069 6e74 2c20  orms (str, int, 
+00021af0: 6c69 7374 202f 2074 7570 6c65 292c 2061  list / tuple), a
+00021b00: 6c6c 6f77 696e 6720 7365 7475 7020 6f66  llowing setup of
+00021b10: 206d 756c 7469 706c 6520 6164 6472 6573   multiple addres
+00021b20: 7320 7261 6e67 6573 3a3a 0a0a 2020 2020  s ranges::..    
+00021b30: 2020 2020 6d69 6e69 7020 3d20 286d 696e      minip = (min
+00021b40: 6970 312c 206d 696e 6970 322c 202e 2e2e  ip1, minip2, ...
+00021b50: 206d 696e 6970 4e29 0a20 2020 2020 2020   minipN).       
+00021b60: 2020 2020 2020 2020 2020 2020 7c20 2020              |   
+00021b70: 2020 2020 7c20 2020 2020 2020 2020 2020      |           
+00021b80: 7c0a 2020 2020 2020 2020 2020 2020 2020  |.              
+00021b90: 2020 2020 207c 2020 2020 2020 207c 2020       |       |  
+00021ba0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00021bb0: 2020 206d 6178 6970 203d 2028 6d61 7869     maxip = (maxi
+00021bc0: 7031 2c20 6d61 7869 7032 2c20 2e2e 2e20  p1, maxip2, ... 
+00021bd0: 6d61 7869 704e 290a 0a20 2020 204c 6f6e  maxipN)..    Lon
+00021be0: 6765 7220 6974 6572 6162 6c65 2077 696c  ger iterable wil
+00021bf0: 6c20 6265 2074 7275 6e63 6174 6564 2074  l be truncated t
+00021c00: 6f20 6d61 7463 6820 6c65 6e67 7468 206f  o match length o
+00021c10: 6620 7368 6f72 7465 7220 6f6e 652e 0a0a  f shorter one...
+00021c20: 2020 2020 4578 616d 706c 6573 3a0a 2020      Examples:.  
+00021c30: 2020 2020 2020 4368 6563 6b20 666f 7220        Check for 
+00021c40: 7661 6c69 6420 4950 7634 2061 6464 7265  valid IPv4 addre
+00021c50: 7373 3a0a 0a20 2020 2020 2020 2020 2020  ss:..           
+00021c60: 2049 4e50 5554 285f 7479 7065 3d27 7465   INPUT(_type='te
+00021c70: 7874 272c 205f 6e61 6d65 3d27 6e61 6d65  xt', _name='name
+00021c80: 272c 2072 6571 7569 7265 733d 4953 5f49  ', requires=IS_I
+00021c90: 5056 3428 2929 0a0a 2020 2020 2020 2020  PV4())..        
+00021ca0: 4368 6563 6b20 666f 7220 7661 6c69 6420  Check for valid 
+00021cb0: 4950 7634 2061 6464 7265 7373 2062 656c  IPv4 address bel
+00021cc0: 6f6e 6769 6e67 2074 6f20 7370 6563 6966  onging to specif
+00021cd0: 6963 2072 616e 6765 3a0a 0a20 2020 2020  ic range:..     
+00021ce0: 2020 2020 2020 2049 4e50 5554 285f 7479         INPUT(_ty
+00021cf0: 7065 3d27 7465 7874 272c 205f 6e61 6d65  pe='text', _name
+00021d00: 3d27 6e61 6d65 272c 0a20 2020 2020 2020  ='name',.       
+00021d10: 2020 2020 2020 2020 2072 6571 7569 7265           require
+00021d20: 733d 4953 5f49 5056 3428 6d69 6e69 703d  s=IS_IPV4(minip=
+00021d30: 2731 3030 2e32 3030 2e30 2e30 272c 206d  '100.200.0.0', m
+00021d40: 6178 6970 3d27 3130 302e 3230 302e 3235  axip='100.200.25
+00021d50: 352e 3235 3527 2929 0a0a 2020 2020 2020  5.255'))..      
+00021d60: 2020 4368 6563 6b20 666f 7220 7661 6c69    Check for vali
+00021d70: 6420 4950 7634 2061 6464 7265 7373 2062  d IPv4 address b
+00021d80: 656c 6f6e 6769 6e67 2074 6f20 6569 7468  elonging to eith
+00021d90: 6572 2031 3030 2e31 3130 2e30 2e30 202d  er 100.110.0.0 -
+00021da0: 0a20 2020 2020 2020 2031 3030 2e31 3130  .        100.110
+00021db0: 2e32 3535 2e32 3535 206f 7220 3230 302e  .255.255 or 200.
+00021dc0: 3530 2e30 2e30 202d 2032 3030 2e35 302e  50.0.0 - 200.50.
+00021dd0: 302e 3235 3520 6164 6472 6573 7320 7261  0.255 address ra
+00021de0: 6e67 653a 0a0a 2020 2020 2020 2020 2020  nge:..          
+00021df0: 2020 494e 5055 5428 5f74 7970 653d 2774    INPUT(_type='t
+00021e00: 6578 7427 2c20 5f6e 616d 653d 276e 616d  ext', _name='nam
+00021e10: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
+00021e20: 2020 2020 7265 7175 6972 6573 3d49 535f      requires=IS_
+00021e30: 4950 5634 286d 696e 6970 3d28 2731 3030  IPV4(minip=('100
+00021e40: 2e31 3130 2e30 2e30 272c 2027 3230 302e  .110.0.0', '200.
+00021e50: 3530 2e30 2e30 2729 2c0a 2020 2020 2020  50.0.0'),.      
 00021e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021e70: 2020 2020 2020 2020 2020 206d 6178 6970             maxip
-00021e80: 3d28 2731 3030 2e31 3130 2e32 3535 2e32  =('100.110.255.2
-00021e90: 3535 272c 2027 3230 302e 3530 2e30 2e32  55', '200.50.0.2
-00021ea0: 3535 2729 2929 0a0a 2020 2020 2020 2020  55')))..        
-00021eb0: 4368 6563 6b20 666f 7220 7661 6c69 6420  Check for valid 
-00021ec0: 4950 7634 2061 6464 7265 7373 2062 656c  IPv4 address bel
-00021ed0: 6f6e 6769 6e67 2074 6f20 7072 6976 6174  onging to privat
-00021ee0: 6520 6164 6472 6573 7320 7370 6163 653a  e address space:
-00021ef0: 0a0a 2020 2020 2020 2020 2020 2020 494e  ..            IN
-00021f00: 5055 5428 5f74 7970 653d 2774 6578 7427  PUT(_type='text'
-00021f10: 2c20 5f6e 616d 653d 276e 616d 6527 2c20  , _name='name', 
-00021f20: 7265 7175 6972 6573 3d49 535f 4950 5634  requires=IS_IPV4
-00021f30: 2869 735f 7072 6976 6174 653d 5472 7565  (is_private=True
-00021f40: 2929 0a0a 2020 2020 2020 2020 4368 6563  ))..        Chec
-00021f50: 6b20 666f 7220 7661 6c69 6420 4950 7634  k for valid IPv4
-00021f60: 2061 6464 7265 7373 2074 6861 7420 6973   address that is
-00021f70: 206e 6f74 2061 206c 6f63 616c 686f 7374   not a localhost
-00021f80: 2061 6464 7265 7373 3a0a 0a20 2020 2020   address:..     
-00021f90: 2020 2020 2020 2049 4e50 5554 285f 7479         INPUT(_ty
-00021fa0: 7065 3d27 7465 7874 272c 205f 6e61 6d65  pe='text', _name
-00021fb0: 3d27 6e61 6d65 272c 2072 6571 7569 7265  ='name', require
-00021fc0: 733d 4953 5f49 5056 3428 6973 5f6c 6f63  s=IS_IPV4(is_loc
-00021fd0: 616c 686f 7374 3d46 616c 7365 2929 0a0a  alhost=False))..
-00021fe0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00021ff0: 4953 5f49 5056 3428 2928 2731 2e32 2e33  IS_IPV4()('1.2.3
-00022000: 2e34 2729 0a20 2020 2020 2020 2020 2020  .4').           
-00022010: 2028 2731 2e32 2e33 2e34 272c 204e 6f6e   ('1.2.3.4', Non
-00022020: 6529 0a20 2020 2020 2020 2020 2020 203e  e).            >
-00022030: 3e3e 2049 535f 4950 5634 2829 2827 3235  >> IS_IPV4()('25
-00022040: 352e 3235 352e 3235 352e 3235 3527 290a  5.255.255.255').
-00022050: 2020 2020 2020 2020 2020 2020 2827 3235              ('25
-00022060: 352e 3235 352e 3235 352e 3235 3527 2c20  5.255.255.255', 
-00022070: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
-00022080: 2020 3e3e 3e20 4953 5f49 5056 3428 2928    >>> IS_IPV4()(
-00022090: 2731 2e32 2e33 2e34 2027 290a 2020 2020  '1.2.3.4 ').    
-000220a0: 2020 2020 2020 2020 2827 312e 322e 332e          ('1.2.3.
-000220b0: 3420 272c 2027 656e 7465 7220 7661 6c69  4 ', 'enter vali
-000220c0: 6420 4950 7634 2061 6464 7265 7373 2729  d IPv4 address')
-000220d0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-000220e0: 2049 535f 4950 5634 2829 2827 312e 322e   IS_IPV4()('1.2.
-000220f0: 332e 342e 3527 290a 2020 2020 2020 2020  3.4.5').        
-00022100: 2020 2020 2827 312e 322e 332e 342e 3527      ('1.2.3.4.5'
-00022110: 2c20 2765 6e74 6572 2076 616c 6964 2049  , 'enter valid I
-00022120: 5076 3420 6164 6472 6573 7327 290a 2020  Pv4 address').  
-00022130: 2020 2020 2020 2020 2020 3e3e 3e20 4953            >>> IS
-00022140: 5f49 5056 3428 2928 2731 3233 2e31 3233  _IPV4()('123.123
-00022150: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
-00022160: 2731 3233 2e31 3233 272c 2027 656e 7465  '123.123', 'ente
-00022170: 7220 7661 6c69 6420 4950 7634 2061 6464  r valid IPv4 add
-00022180: 7265 7373 2729 0a20 2020 2020 2020 2020  ress').         
-00022190: 2020 203e 3e3e 2049 535f 4950 5634 2829     >>> IS_IPV4()
-000221a0: 2827 3131 3131 2e32 2e33 2e34 2729 0a20  ('1111.2.3.4'). 
-000221b0: 2020 2020 2020 2020 2020 2028 2731 3131             ('111
-000221c0: 312e 322e 332e 3427 2c20 2765 6e74 6572  1.2.3.4', 'enter
-000221d0: 2076 616c 6964 2049 5076 3420 6164 6472   valid IPv4 addr
-000221e0: 6573 7327 290a 2020 2020 2020 2020 2020  ess').          
-000221f0: 2020 3e3e 3e20 4953 5f49 5056 3428 2928    >>> IS_IPV4()(
-00022200: 2730 3131 312e 322e 332e 3427 290a 2020  '0111.2.3.4').  
-00022210: 2020 2020 2020 2020 2020 2827 3031 3131            ('0111
-00022220: 2e32 2e33 2e34 272c 2027 656e 7465 7220  .2.3.4', 'enter 
-00022230: 7661 6c69 6420 4950 7634 2061 6464 7265  valid IPv4 addre
-00022240: 7373 2729 0a20 2020 2020 2020 2020 2020  ss').           
-00022250: 203e 3e3e 2049 535f 4950 5634 2829 2827   >>> IS_IPV4()('
-00022260: 3235 362e 322e 332e 3427 290a 2020 2020  256.2.3.4').    
-00022270: 2020 2020 2020 2020 2827 3235 362e 322e          ('256.2.
-00022280: 332e 3427 2c20 2765 6e74 6572 2076 616c  3.4', 'enter val
-00022290: 6964 2049 5076 3420 6164 6472 6573 7327  id IPv4 address'
-000222a0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-000222b0: 3e20 4953 5f49 5056 3428 2928 2733 3030  > IS_IPV4()('300
-000222c0: 2e32 2e33 2e34 2729 0a20 2020 2020 2020  .2.3.4').       
-000222d0: 2020 2020 2028 2733 3030 2e32 2e33 2e34       ('300.2.3.4
-000222e0: 272c 2027 656e 7465 7220 7661 6c69 6420  ', 'enter valid 
-000222f0: 4950 7634 2061 6464 7265 7373 2729 0a20  IPv4 address'). 
-00022300: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
-00022310: 535f 4950 5634 286d 696e 6970 3d27 312e  S_IPV4(minip='1.
-00022320: 322e 332e 3427 2c20 6d61 7869 703d 2731  2.3.4', maxip='1
-00022330: 2e32 2e33 2e34 2729 2827 312e 322e 332e  .2.3.4')('1.2.3.
-00022340: 3427 290a 2020 2020 2020 2020 2020 2020  4').            
-00022350: 2827 312e 322e 332e 3427 2c20 4e6f 6e65  ('1.2.3.4', None
-00022360: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-00022370: 3e20 4953 5f49 5056 3428 6d69 6e69 703d  > IS_IPV4(minip=
-00022380: 2731 2e32 2e33 2e35 272c 206d 6178 6970  '1.2.3.5', maxip
-00022390: 3d27 312e 322e 332e 3927 2c20 6572 726f  ='1.2.3.9', erro
-000223a0: 725f 6d65 7373 6167 653d 2742 6164 2069  r_message='Bad i
-000223b0: 7027 2928 2731 2e32 2e33 2e34 2729 0a20  p')('1.2.3.4'). 
-000223c0: 2020 2020 2020 2020 2020 2028 2731 2e32             ('1.2
-000223d0: 2e33 2e34 272c 2027 6261 6420 6970 2729  .3.4', 'bad ip')
-000223e0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-000223f0: 2049 535f 4950 5634 286d 6178 6970 3d27   IS_IPV4(maxip='
-00022400: 312e 322e 332e 3427 2c20 696e 7665 7274  1.2.3.4', invert
-00022410: 3d54 7275 6529 2827 3132 372e 302e 302e  =True)('127.0.0.
-00022420: 3127 290a 2020 2020 2020 2020 2020 2020  1').            
-00022430: 2827 3132 372e 302e 302e 3127 2c20 4e6f  ('127.0.0.1', No
-00022440: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
-00022450: 3e3e 3e20 4953 5f49 5056 3428 6d61 7869  >>> IS_IPV4(maxi
-00022460: 703d 2731 2e32 2e33 2e34 272c 2069 6e76  p='1.2.3.4', inv
-00022470: 6572 743d 5472 7565 2928 2731 2e32 2e33  ert=True)('1.2.3
-00022480: 2e34 2729 0a20 2020 2020 2020 2020 2020  .4').           
-00022490: 2028 2731 2e32 2e33 2e34 272c 2027 656e   ('1.2.3.4', 'en
-000224a0: 7465 7220 7661 6c69 6420 4950 7634 2061  ter valid IPv4 a
-000224b0: 6464 7265 7373 2729 0a20 2020 2020 2020  ddress').       
-000224c0: 2020 2020 203e 3e3e 2049 535f 4950 5634       >>> IS_IPV4
-000224d0: 2869 735f 6c6f 6361 6c68 6f73 743d 5472  (is_localhost=Tr
-000224e0: 7565 2928 2731 3237 2e30 2e30 2e31 2729  ue)('127.0.0.1')
-000224f0: 0a20 2020 2020 2020 2020 2020 2028 2731  .            ('1
-00022500: 3237 2e30 2e30 2e31 272c 204e 6f6e 6529  27.0.0.1', None)
-00022510: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00022520: 2049 535f 4950 5634 2869 735f 6c6f 6361   IS_IPV4(is_loca
-00022530: 6c68 6f73 743d 5472 7565 2928 2731 2e32  lhost=True)('1.2
-00022540: 2e33 2e34 2729 0a20 2020 2020 2020 2020  .3.4').         
-00022550: 2020 2028 2731 2e32 2e33 2e34 272c 2027     ('1.2.3.4', '
-00022560: 656e 7465 7220 7661 6c69 6420 4950 7634  enter valid IPv4
-00022570: 2061 6464 7265 7373 2729 0a20 2020 2020   address').     
-00022580: 2020 2020 2020 203e 3e3e 2049 535f 4950         >>> IS_IP
-00022590: 5634 2869 735f 6c6f 6361 6c68 6f73 743d  V4(is_localhost=
-000225a0: 4661 6c73 6529 2827 3132 372e 302e 302e  False)('127.0.0.
-000225b0: 3127 290a 2020 2020 2020 2020 2020 2020  1').            
-000225c0: 2827 3132 372e 302e 302e 3127 2c20 2765  ('127.0.0.1', 'e
-000225d0: 6e74 6572 2076 616c 6964 2049 5076 3420  nter valid IPv4 
-000225e0: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
-000225f0: 2020 2020 2020 3e3e 3e20 4953 5f49 5056        >>> IS_IPV
-00022600: 3428 6d61 7869 703d 2731 3030 2e30 2e30  4(maxip='100.0.0
-00022610: 2e30 272c 2069 735f 6c6f 6361 6c68 6f73  .0', is_localhos
-00022620: 743d 5472 7565 2928 2731 3237 2e30 2e30  t=True)('127.0.0
-00022630: 2e31 2729 0a20 2020 2020 2020 2020 2020  .1').           
-00022640: 2028 2731 3237 2e30 2e30 2e31 272c 2027   ('127.0.0.1', '
-00022650: 656e 7465 7220 7661 6c69 6420 4950 7634  enter valid IPv4
-00022660: 2061 6464 7265 7373 2729 0a0a 2020 2020   address')..    
-00022670: 2222 220a 0a20 2020 2052 4547 4558 5f49  """..    REGEX_I
-00022680: 5056 3420 3d20 7265 2e63 6f6d 7069 6c65  PV4 = re.compile
-00022690: 280a 2020 2020 2020 2020 7222 5e28 285b  (.        r"^(([
-000226a0: 312d 395d 3f5c 647c 315c 645c 647c 325b  1-9]?\d|1\d\d|2[
-000226b0: 302d 345d 5c64 7c32 355b 302d 355d 295c  0-4]\d|25[0-5])\
-000226c0: 2e29 7b33 7d28 5b31 2d39 5d3f 5c64 7c31  .){3}([1-9]?\d|1
-000226d0: 5c64 5c64 7c32 5b30 2d34 5d5c 647c 3235  \d\d|2[0-4]\d|25
-000226e0: 5b30 2d35 5d29 2422 0a20 2020 2029 0a20  [0-5])$".    ). 
-000226f0: 2020 206e 756d 6265 7273 203d 2028 3136     numbers = (16
-00022700: 3737 3732 3136 2c20 3635 3533 362c 2032  777216, 65536, 2
-00022710: 3536 2c20 3129 0a20 2020 206c 6f63 616c  56, 1).    local
-00022720: 686f 7374 203d 2032 3133 3037 3036 3433  host = 213070643
-00022730: 330a 2020 2020 7072 6976 6174 6520 3d20  3.    private = 
-00022740: 2828 3238 3836 3732 3937 3238 2c20 3238  ((2886729728, 28
-00022750: 3836 3739 3532 3633 292c 2028 3332 3332  86795263), (3232
-00022760: 3233 3535 3230 2c20 3332 3332 3330 3130  235520, 32323010
-00022770: 3535 2929 0a20 2020 2061 7574 6f6d 6174  55)).    automat
-00022780: 6963 203d 2028 3238 3531 3939 3536 3438  ic = (2851995648
-00022790: 2c20 3238 3532 3036 3131 3833 290a 0a20  , 2852061183).. 
-000227a0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-000227b0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-000227c0: 2020 2020 2020 206d 696e 6970 3d22 302e         minip="0.
-000227d0: 302e 302e 3022 2c0a 2020 2020 2020 2020  0.0.0",.        
-000227e0: 6d61 7869 703d 2232 3535 2e32 3535 2e32  maxip="255.255.2
-000227f0: 3535 2e32 3535 222c 0a20 2020 2020 2020  55.255",.       
-00022800: 2069 6e76 6572 743d 4661 6c73 652c 0a20   invert=False,. 
-00022810: 2020 2020 2020 2069 735f 6c6f 6361 6c68         is_localh
-00022820: 6f73 743d 4e6f 6e65 2c0a 2020 2020 2020  ost=None,.      
-00022830: 2020 6973 5f70 7269 7661 7465 3d4e 6f6e    is_private=Non
-00022840: 652c 0a20 2020 2020 2020 2069 735f 6175  e,.        is_au
-00022850: 746f 6d61 7469 633d 4e6f 6e65 2c0a 2020  tomatic=None,.  
-00022860: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00022870: 6167 653d 2245 6e74 6572 2076 616c 6964  age="Enter valid
-00022880: 2049 5076 3420 6164 6472 6573 7322 2c0a   IPv4 address",.
-00022890: 2020 2020 293a 0a0a 2020 2020 2020 2020      ):..        
-000228a0: 666f 7220 6e2c 2076 616c 7565 2069 6e20  for n, value in 
-000228b0: 656e 756d 6572 6174 6528 286d 696e 6970  enumerate((minip
-000228c0: 2c20 6d61 7869 7029 293a 0a20 2020 2020  , maxip)):.     
-000228d0: 2020 2020 2020 2074 656d 7020 3d20 5b5d         temp = []
-000228e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000228f0: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
-00022900: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
-00022910: 2020 2020 2020 2020 7465 6d70 2e61 7070          temp.app
-00022920: 656e 6428 7661 6c75 652e 7370 6c69 7428  end(value.split(
-00022930: 222e 2229 290a 2020 2020 2020 2020 2020  ".")).          
-00022940: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-00022950: 6528 7661 6c75 652c 2028 6c69 7374 2c20  e(value, (list, 
-00022960: 7475 706c 6529 293a 0a20 2020 2020 2020  tuple)):.       
-00022970: 2020 2020 2020 2020 2069 6620 280a 2020           if (.  
-00022980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022990: 2020 6c65 6e28 7661 6c75 6529 0a20 2020    len(value).   
-000229a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000229b0: 203d 3d20 6c65 6e28 5b69 7465 6d20 666f   == len([item fo
-000229c0: 7220 6974 656d 2069 6e20 7661 6c75 6520  r item in value 
-000229d0: 6966 2069 7369 6e73 7461 6e63 6528 6974  if isinstance(it
-000229e0: 656d 2c20 696e 7429 5d29 0a20 2020 2020  em, int)]).     
-000229f0: 2020 2020 2020 2020 2020 2020 2020 203d                 =
-00022a00: 3d20 340a 2020 2020 2020 2020 2020 2020  = 4.            
-00022a10: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00022a20: 2020 2020 2020 2020 2020 2074 656d 702e             temp.
-00022a30: 6170 7065 6e64 2876 616c 7565 290a 2020  append(value).  
-00022a40: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00022a50: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00022a60: 2020 2020 2020 2020 666f 7220 6974 656d          for item
-00022a70: 2069 6e20 7661 6c75 653a 0a20 2020 2020   in value:.     
-00022a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022a90: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00022aa0: 2869 7465 6d2c 2073 7472 293a 0a20 2020  (item, str):.   
+00021e70: 2020 2020 2020 206d 6178 6970 3d28 2731         maxip=('1
+00021e80: 3030 2e31 3130 2e32 3535 2e32 3535 272c  00.110.255.255',
+00021e90: 2027 3230 302e 3530 2e30 2e32 3535 2729   '200.50.0.255')
+00021ea0: 2929 0a0a 2020 2020 2020 2020 4368 6563  ))..        Chec
+00021eb0: 6b20 666f 7220 7661 6c69 6420 4950 7634  k for valid IPv4
+00021ec0: 2061 6464 7265 7373 2062 656c 6f6e 6769   address belongi
+00021ed0: 6e67 2074 6f20 7072 6976 6174 6520 6164  ng to private ad
+00021ee0: 6472 6573 7320 7370 6163 653a 0a0a 2020  dress space:..  
+00021ef0: 2020 2020 2020 2020 2020 494e 5055 5428            INPUT(
+00021f00: 5f74 7970 653d 2774 6578 7427 2c20 5f6e  _type='text', _n
+00021f10: 616d 653d 276e 616d 6527 2c20 7265 7175  ame='name', requ
+00021f20: 6972 6573 3d49 535f 4950 5634 2869 735f  ires=IS_IPV4(is_
+00021f30: 7072 6976 6174 653d 5472 7565 2929 0a0a  private=True))..
+00021f40: 2020 2020 2020 2020 4368 6563 6b20 666f          Check fo
+00021f50: 7220 7661 6c69 6420 4950 7634 2061 6464  r valid IPv4 add
+00021f60: 7265 7373 2074 6861 7420 6973 206e 6f74  ress that is not
+00021f70: 2061 206c 6f63 616c 686f 7374 2061 6464   a localhost add
+00021f80: 7265 7373 3a0a 0a20 2020 2020 2020 2020  ress:..         
+00021f90: 2020 2049 4e50 5554 285f 7479 7065 3d27     INPUT(_type='
+00021fa0: 7465 7874 272c 205f 6e61 6d65 3d27 6e61  text', _name='na
+00021fb0: 6d65 272c 2072 6571 7569 7265 733d 4953  me', requires=IS
+00021fc0: 5f49 5056 3428 6973 5f6c 6f63 616c 686f  _IPV4(is_localho
+00021fd0: 7374 3d46 616c 7365 2929 0a0a 2020 2020  st=False))..    
+00021fe0: 2020 2020 2020 2020 3e3e 3e20 4953 5f49          >>> IS_I
+00021ff0: 5056 3428 2928 2731 2e32 2e33 2e34 2729  PV4()('1.2.3.4')
+00022000: 0a20 2020 2020 2020 2020 2020 2028 2731  .            ('1
+00022010: 2e32 2e33 2e34 272c 204e 6f6e 6529 0a20  .2.3.4', None). 
+00022020: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
+00022030: 535f 4950 5634 2829 2827 3235 352e 3235  S_IPV4()('255.25
+00022040: 352e 3235 352e 3235 3527 290a 2020 2020  5.255.255').    
+00022050: 2020 2020 2020 2020 2827 3235 352e 3235          ('255.25
+00022060: 352e 3235 352e 3235 3527 2c20 4e6f 6e65  5.255.255', None
+00022070: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00022080: 3e20 4953 5f49 5056 3428 2928 2731 2e32  > IS_IPV4()('1.2
+00022090: 2e33 2e34 2027 290a 2020 2020 2020 2020  .3.4 ').        
+000220a0: 2020 2020 2827 312e 322e 332e 3420 272c      ('1.2.3.4 ',
+000220b0: 2027 656e 7465 7220 7661 6c69 6420 4950   'enter valid IP
+000220c0: 7634 2061 6464 7265 7373 2729 0a20 2020  v4 address').   
+000220d0: 2020 2020 2020 2020 203e 3e3e 2049 535f           >>> IS_
+000220e0: 4950 5634 2829 2827 312e 322e 332e 342e  IPV4()('1.2.3.4.
+000220f0: 3527 290a 2020 2020 2020 2020 2020 2020  5').            
+00022100: 2827 312e 322e 332e 342e 3527 2c20 2765  ('1.2.3.4.5', 'e
+00022110: 6e74 6572 2076 616c 6964 2049 5076 3420  nter valid IPv4 
+00022120: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
+00022130: 2020 2020 2020 3e3e 3e20 4953 5f49 5056        >>> IS_IPV
+00022140: 3428 2928 2731 3233 2e31 3233 2729 0a20  4()('123.123'). 
+00022150: 2020 2020 2020 2020 2020 2028 2731 3233             ('123
+00022160: 2e31 3233 272c 2027 656e 7465 7220 7661  .123', 'enter va
+00022170: 6c69 6420 4950 7634 2061 6464 7265 7373  lid IPv4 address
+00022180: 2729 0a20 2020 2020 2020 2020 2020 203e  ').            >
+00022190: 3e3e 2049 535f 4950 5634 2829 2827 3131  >> IS_IPV4()('11
+000221a0: 3131 2e32 2e33 2e34 2729 0a20 2020 2020  11.2.3.4').     
+000221b0: 2020 2020 2020 2028 2731 3131 312e 322e         ('1111.2.
+000221c0: 332e 3427 2c20 2765 6e74 6572 2076 616c  3.4', 'enter val
+000221d0: 6964 2049 5076 3420 6164 6472 6573 7327  id IPv4 address'
+000221e0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+000221f0: 3e20 4953 5f49 5056 3428 2928 2730 3131  > IS_IPV4()('011
+00022200: 312e 322e 332e 3427 290a 2020 2020 2020  1.2.3.4').      
+00022210: 2020 2020 2020 2827 3031 3131 2e32 2e33        ('0111.2.3
+00022220: 2e34 272c 2027 656e 7465 7220 7661 6c69  .4', 'enter vali
+00022230: 6420 4950 7634 2061 6464 7265 7373 2729  d IPv4 address')
+00022240: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00022250: 2049 535f 4950 5634 2829 2827 3235 362e   IS_IPV4()('256.
+00022260: 322e 332e 3427 290a 2020 2020 2020 2020  2.3.4').        
+00022270: 2020 2020 2827 3235 362e 322e 332e 3427      ('256.2.3.4'
+00022280: 2c20 2765 6e74 6572 2076 616c 6964 2049  , 'enter valid I
+00022290: 5076 3420 6164 6472 6573 7327 290a 2020  Pv4 address').  
+000222a0: 2020 2020 2020 2020 2020 3e3e 3e20 4953            >>> IS
+000222b0: 5f49 5056 3428 2928 2733 3030 2e32 2e33  _IPV4()('300.2.3
+000222c0: 2e34 2729 0a20 2020 2020 2020 2020 2020  .4').           
+000222d0: 2028 2733 3030 2e32 2e33 2e34 272c 2027   ('300.2.3.4', '
+000222e0: 656e 7465 7220 7661 6c69 6420 4950 7634  enter valid IPv4
+000222f0: 2061 6464 7265 7373 2729 0a20 2020 2020   address').     
+00022300: 2020 2020 2020 203e 3e3e 2049 535f 4950         >>> IS_IP
+00022310: 5634 286d 696e 6970 3d27 312e 322e 332e  V4(minip='1.2.3.
+00022320: 3427 2c20 6d61 7869 703d 2731 2e32 2e33  4', maxip='1.2.3
+00022330: 2e34 2729 2827 312e 322e 332e 3427 290a  .4')('1.2.3.4').
+00022340: 2020 2020 2020 2020 2020 2020 2827 312e              ('1.
+00022350: 322e 332e 3427 2c20 4e6f 6e65 290a 2020  2.3.4', None).  
+00022360: 2020 2020 2020 2020 2020 3e3e 3e20 4953            >>> IS
+00022370: 5f49 5056 3428 6d69 6e69 703d 2731 2e32  _IPV4(minip='1.2
+00022380: 2e33 2e35 272c 206d 6178 6970 3d27 312e  .3.5', maxip='1.
+00022390: 322e 332e 3927 2c20 6572 726f 725f 6d65  2.3.9', error_me
+000223a0: 7373 6167 653d 2742 6164 2069 7027 2928  ssage='Bad ip')(
+000223b0: 2731 2e32 2e33 2e34 2729 0a20 2020 2020  '1.2.3.4').     
+000223c0: 2020 2020 2020 2028 2731 2e32 2e33 2e34         ('1.2.3.4
+000223d0: 272c 2027 6261 6420 6970 2729 0a20 2020  ', 'bad ip').   
+000223e0: 2020 2020 2020 2020 203e 3e3e 2049 535f           >>> IS_
+000223f0: 4950 5634 286d 6178 6970 3d27 312e 322e  IPV4(maxip='1.2.
+00022400: 332e 3427 2c20 696e 7665 7274 3d54 7275  3.4', invert=Tru
+00022410: 6529 2827 3132 372e 302e 302e 3127 290a  e)('127.0.0.1').
+00022420: 2020 2020 2020 2020 2020 2020 2827 3132              ('12
+00022430: 372e 302e 302e 3127 2c20 4e6f 6e65 290a  7.0.0.1', None).
+00022440: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00022450: 4953 5f49 5056 3428 6d61 7869 703d 2731  IS_IPV4(maxip='1
+00022460: 2e32 2e33 2e34 272c 2069 6e76 6572 743d  .2.3.4', invert=
+00022470: 5472 7565 2928 2731 2e32 2e33 2e34 2729  True)('1.2.3.4')
+00022480: 0a20 2020 2020 2020 2020 2020 2028 2731  .            ('1
+00022490: 2e32 2e33 2e34 272c 2027 656e 7465 7220  .2.3.4', 'enter 
+000224a0: 7661 6c69 6420 4950 7634 2061 6464 7265  valid IPv4 addre
+000224b0: 7373 2729 0a20 2020 2020 2020 2020 2020  ss').           
+000224c0: 203e 3e3e 2049 535f 4950 5634 2869 735f   >>> IS_IPV4(is_
+000224d0: 6c6f 6361 6c68 6f73 743d 5472 7565 2928  localhost=True)(
+000224e0: 2731 3237 2e30 2e30 2e31 2729 0a20 2020  '127.0.0.1').   
+000224f0: 2020 2020 2020 2020 2028 2731 3237 2e30           ('127.0
+00022500: 2e30 2e31 272c 204e 6f6e 6529 0a20 2020  .0.1', None).   
+00022510: 2020 2020 2020 2020 203e 3e3e 2049 535f           >>> IS_
+00022520: 4950 5634 2869 735f 6c6f 6361 6c68 6f73  IPV4(is_localhos
+00022530: 743d 5472 7565 2928 2731 2e32 2e33 2e34  t=True)('1.2.3.4
+00022540: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
+00022550: 2731 2e32 2e33 2e34 272c 2027 656e 7465  '1.2.3.4', 'ente
+00022560: 7220 7661 6c69 6420 4950 7634 2061 6464  r valid IPv4 add
+00022570: 7265 7373 2729 0a20 2020 2020 2020 2020  ress').         
+00022580: 2020 203e 3e3e 2049 535f 4950 5634 2869     >>> IS_IPV4(i
+00022590: 735f 6c6f 6361 6c68 6f73 743d 4661 6c73  s_localhost=Fals
+000225a0: 6529 2827 3132 372e 302e 302e 3127 290a  e)('127.0.0.1').
+000225b0: 2020 2020 2020 2020 2020 2020 2827 3132              ('12
+000225c0: 372e 302e 302e 3127 2c20 2765 6e74 6572  7.0.0.1', 'enter
+000225d0: 2076 616c 6964 2049 5076 3420 6164 6472   valid IPv4 addr
+000225e0: 6573 7327 290a 2020 2020 2020 2020 2020  ess').          
+000225f0: 2020 3e3e 3e20 4953 5f49 5056 3428 6d61    >>> IS_IPV4(ma
+00022600: 7869 703d 2731 3030 2e30 2e30 2e30 272c  xip='100.0.0.0',
+00022610: 2069 735f 6c6f 6361 6c68 6f73 743d 5472   is_localhost=Tr
+00022620: 7565 2928 2731 3237 2e30 2e30 2e31 2729  ue)('127.0.0.1')
+00022630: 0a20 2020 2020 2020 2020 2020 2028 2731  .            ('1
+00022640: 3237 2e30 2e30 2e31 272c 2027 656e 7465  27.0.0.1', 'ente
+00022650: 7220 7661 6c69 6420 4950 7634 2061 6464  r valid IPv4 add
+00022660: 7265 7373 2729 0a0a 2020 2020 2222 220a  ress')..    """.
+00022670: 0a20 2020 2052 4547 4558 5f49 5056 3420  .    REGEX_IPV4 
+00022680: 3d20 7265 2e63 6f6d 7069 6c65 280a 2020  = re.compile(.  
+00022690: 2020 2020 2020 7222 5e28 285b 312d 395d        r"^(([1-9]
+000226a0: 3f5c 647c 315c 645c 647c 325b 302d 345d  ?\d|1\d\d|2[0-4]
+000226b0: 5c64 7c32 355b 302d 355d 295c 2e29 7b33  \d|25[0-5])\.){3
+000226c0: 7d28 5b31 2d39 5d3f 5c64 7c31 5c64 5c64  }([1-9]?\d|1\d\d
+000226d0: 7c32 5b30 2d34 5d5c 647c 3235 5b30 2d35  |2[0-4]\d|25[0-5
+000226e0: 5d29 2422 0a20 2020 2029 0a20 2020 206e  ])$".    ).    n
+000226f0: 756d 6265 7273 203d 2028 3136 3737 3732  umbers = (167772
+00022700: 3136 2c20 3635 3533 362c 2032 3536 2c20  16, 65536, 256, 
+00022710: 3129 0a20 2020 206c 6f63 616c 686f 7374  1).    localhost
+00022720: 203d 2032 3133 3037 3036 3433 330a 2020   = 2130706433.  
+00022730: 2020 7072 6976 6174 6520 3d20 2828 3238    private = ((28
+00022740: 3836 3732 3937 3238 2c20 3238 3836 3739  86729728, 288679
+00022750: 3532 3633 292c 2028 3332 3332 3233 3535  5263), (32322355
+00022760: 3230 2c20 3332 3332 3330 3130 3535 2929  20, 3232301055))
+00022770: 0a20 2020 2061 7574 6f6d 6174 6963 203d  .    automatic =
+00022780: 2028 3238 3531 3939 3536 3438 2c20 3238   (2851995648, 28
+00022790: 3532 3036 3131 3833 290a 0a20 2020 2064  52061183)..    d
+000227a0: 6566 205f 5f69 6e69 745f 5f28 0a20 2020  ef __init__(.   
+000227b0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000227c0: 2020 206d 696e 6970 3d22 302e 302e 302e     minip="0.0.0.
+000227d0: 3022 2c0a 2020 2020 2020 2020 6d61 7869  0",.        maxi
+000227e0: 703d 2232 3535 2e32 3535 2e32 3535 2e32  p="255.255.255.2
+000227f0: 3535 222c 0a20 2020 2020 2020 2069 6e76  55",.        inv
+00022800: 6572 743d 4661 6c73 652c 0a20 2020 2020  ert=False,.     
+00022810: 2020 2069 735f 6c6f 6361 6c68 6f73 743d     is_localhost=
+00022820: 4e6f 6e65 2c0a 2020 2020 2020 2020 6973  None,.        is
+00022830: 5f70 7269 7661 7465 3d4e 6f6e 652c 0a20  _private=None,. 
+00022840: 2020 2020 2020 2069 735f 6175 746f 6d61         is_automa
+00022850: 7469 633d 4e6f 6e65 2c0a 2020 2020 2020  tic=None,.      
+00022860: 2020 6572 726f 725f 6d65 7373 6167 653d    error_message=
+00022870: 2245 6e74 6572 2076 616c 6964 2049 5076  "Enter valid IPv
+00022880: 3420 6164 6472 6573 7322 2c0a 2020 2020  4 address",.    
+00022890: 293a 0a0a 2020 2020 2020 2020 666f 7220  ):..        for 
+000228a0: 6e2c 2076 616c 7565 2069 6e20 656e 756d  n, value in enum
+000228b0: 6572 6174 6528 286d 696e 6970 2c20 6d61  erate((minip, ma
+000228c0: 7869 7029 293a 0a20 2020 2020 2020 2020  xip)):.         
+000228d0: 2020 2074 656d 7020 3d20 5b5d 0a20 2020     temp = [].   
+000228e0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+000228f0: 7374 616e 6365 2876 616c 7565 2c20 7374  stance(value, st
+00022900: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00022910: 2020 2020 7465 6d70 2e61 7070 656e 6428      temp.append(
+00022920: 7661 6c75 652e 7370 6c69 7428 222e 2229  value.split(".")
+00022930: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00022940: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
+00022950: 6c75 652c 2028 6c69 7374 2c20 7475 706c  lue, (list, tupl
+00022960: 6529 293a 0a20 2020 2020 2020 2020 2020  e)):.           
+00022970: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
+00022980: 2020 2020 2020 2020 2020 2020 2020 6c65                le
+00022990: 6e28 7661 6c75 6529 0a20 2020 2020 2020  n(value).       
+000229a0: 2020 2020 2020 2020 2020 2020 203d 3d20               == 
+000229b0: 6c65 6e28 5b69 7465 6d20 666f 7220 6974  len([item for it
+000229c0: 656d 2069 6e20 7661 6c75 6520 6966 2069  em in value if i
+000229d0: 7369 6e73 7461 6e63 6528 6974 656d 2c20  sinstance(item, 
+000229e0: 696e 7429 5d29 0a20 2020 2020 2020 2020  int)]).         
+000229f0: 2020 2020 2020 2020 2020 203d 3d20 340a             == 4.
+00022a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022a10: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00022a20: 2020 2020 2020 2074 656d 702e 6170 7065         temp.appe
+00022a30: 6e64 2876 616c 7565 290a 2020 2020 2020  nd(value).      
+00022a40: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00022a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022a60: 2020 2020 666f 7220 6974 656d 2069 6e20      for item in 
+00022a70: 7661 6c75 653a 0a20 2020 2020 2020 2020  value:.         
+00022a80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00022a90: 6620 6973 696e 7374 616e 6365 2869 7465  f isinstance(ite
+00022aa0: 6d2c 2073 7472 293a 0a20 2020 2020 2020  m, str):.       
 00022ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022ac0: 2020 2020 2020 2020 2074 656d 702e 6170           temp.ap
-00022ad0: 7065 6e64 2869 7465 6d2e 7370 6c69 7428  pend(item.split(
-00022ae0: 222e 2229 290a 2020 2020 2020 2020 2020  ".")).          
-00022af0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00022b00: 6966 2069 7369 6e73 7461 6e63 6528 6974  if isinstance(it
-00022b10: 656d 2c20 286c 6973 742c 2074 7570 6c65  em, (list, tuple
-00022b20: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00022b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022b40: 7465 6d70 2e61 7070 656e 6428 6974 656d  temp.append(item
-00022b50: 290a 2020 2020 2020 2020 2020 2020 6e75  ).            nu
-00022b60: 6d62 6572 7320 3d20 5b5d 0a20 2020 2020  mbers = [].     
-00022b70: 2020 2020 2020 2066 6f72 2069 7465 6d20         for item 
-00022b80: 696e 2074 656d 703a 0a20 2020 2020 2020  in temp:.       
-00022b90: 2020 2020 2020 2020 206e 756d 6265 7220           number 
-00022ba0: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
-00022bb0: 2020 2020 666f 7220 692c 206a 2069 6e20      for i, j in 
-00022bc0: 7a69 7028 7365 6c66 2e6e 756d 6265 7273  zip(self.numbers
-00022bd0: 2c20 6974 656d 293a 0a20 2020 2020 2020  , item):.       
-00022be0: 2020 2020 2020 2020 2020 2020 206e 756d               num
-00022bf0: 6265 7220 2b3d 2069 202a 2069 6e74 286a  ber += i * int(j
-00022c00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00022c10: 2020 6e75 6d62 6572 732e 6170 7065 6e64    numbers.append
-00022c20: 286e 756d 6265 7229 0a20 2020 2020 2020  (number).       
-00022c30: 2020 2020 2069 6620 6e20 3d3d 2030 3a0a       if n == 0:.
-00022c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c50: 7365 6c66 2e6d 696e 6970 203d 206e 756d  self.minip = num
-00022c60: 6265 7273 0a20 2020 2020 2020 2020 2020  bers.           
-00022c70: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00022c80: 2020 2020 2020 2073 656c 662e 6d61 7869         self.maxi
-00022c90: 7020 3d20 6e75 6d62 6572 730a 2020 2020  p = numbers.    
-00022ca0: 2020 2020 7365 6c66 2e69 6e76 6572 7420      self.invert 
-00022cb0: 3d20 696e 7665 7274 0a20 2020 2020 2020  = invert.       
-00022cc0: 2073 656c 662e 6973 5f6c 6f63 616c 686f   self.is_localho
-00022cd0: 7374 203d 2069 735f 6c6f 6361 6c68 6f73  st = is_localhos
-00022ce0: 740a 2020 2020 2020 2020 7365 6c66 2e69  t.        self.i
-00022cf0: 735f 7072 6976 6174 6520 3d20 6973 5f70  s_private = is_p
-00022d00: 7269 7661 7465 0a20 2020 2020 2020 2073  rivate.        s
-00022d10: 656c 662e 6973 5f61 7574 6f6d 6174 6963  elf.is_automatic
-00022d20: 203d 2069 735f 6175 746f 6d61 7469 630a   = is_automatic.
-00022d30: 2020 2020 2020 2020 7365 6c66 2e65 7272          self.err
-00022d40: 6f72 5f6d 6573 7361 6765 203d 2065 7272  or_message = err
-00022d50: 6f72 5f6d 6573 7361 6765 0a0a 2020 2020  or_message..    
-00022d60: 6465 6620 7661 6c69 6461 7465 2873 656c  def validate(sel
-00022d70: 662c 2076 616c 7565 2c20 7265 636f 7264  f, value, record
-00022d80: 5f69 643d 4e6f 6e65 293a 0a20 2020 2020  _id=None):.     
-00022d90: 2020 2069 6620 7265 2e6d 6174 6368 2873     if re.match(s
-00022da0: 656c 662e 5245 4745 585f 4950 5634 2c20  elf.REGEX_IPV4, 
-00022db0: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
-00022dc0: 2020 2020 6e75 6d62 6572 203d 2030 0a20      number = 0. 
-00022dd0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00022de0: 2c20 6a20 696e 207a 6970 2873 656c 662e  , j in zip(self.
-00022df0: 6e75 6d62 6572 732c 2076 616c 7565 2e73  numbers, value.s
-00022e00: 706c 6974 2822 2e22 2929 3a0a 2020 2020  plit(".")):.    
-00022e10: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-00022e20: 6572 202b 3d20 6920 2a20 696e 7428 6a29  er += i * int(j)
-00022e30: 0a20 2020 2020 2020 2020 2020 206f 6b20  .            ok 
-00022e40: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
-00022e50: 2020 2020 2066 6f72 2062 6f74 746f 6d2c       for bottom,
-00022e60: 2074 6f70 2069 6e20 7a69 7028 7365 6c66   top in zip(self
-00022e70: 2e6d 696e 6970 2c20 7365 6c66 2e6d 6178  .minip, self.max
-00022e80: 6970 293a 0a20 2020 2020 2020 2020 2020  ip):.           
-00022e90: 2020 2020 2069 6620 7365 6c66 2e69 6e76       if self.inv
-00022ea0: 6572 7420 213d 2028 626f 7474 6f6d 203c  ert != (bottom <
-00022eb0: 3d20 6e75 6d62 6572 203c 3d20 746f 7029  = number <= top)
-00022ec0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00022ed0: 2020 2020 2020 6f6b 203d 2054 7275 650a        ok = True.
-00022ee0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00022ef0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00022f00: 2020 6f6b 0a20 2020 2020 2020 2020 2020    ok.           
-00022f10: 2020 2020 2061 6e64 2073 656c 662e 6973       and self.is
-00022f20: 5f6c 6f63 616c 686f 7374 2069 7320 6e6f  _localhost is no
-00022f30: 7420 4e6f 6e65 0a20 2020 2020 2020 2020  t None.         
-00022f40: 2020 2020 2020 2061 6e64 2073 656c 662e         and self.
-00022f50: 6973 5f6c 6f63 616c 686f 7374 2021 3d20  is_localhost != 
-00022f60: 286e 756d 6265 7220 3d3d 2073 656c 662e  (number == self.
-00022f70: 6c6f 6361 6c68 6f73 7429 0a20 2020 2020  localhost).     
-00022f80: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00022f90: 2020 2020 2020 2020 2020 6f6b 203d 2046            ok = F
-00022fa0: 616c 7365 0a0a 2020 2020 2020 2020 2020  alse..          
-00022fb0: 2020 7072 6976 6174 6520 3d20 616e 7928    private = any(
-00022fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022fd0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00022fe0: 2020 2020 2020 2070 7269 7661 7465 5f6e         private_n
-00022ff0: 756d 6265 725b 305d 203c 3d20 6e75 6d62  umber[0] <= numb
-00023000: 6572 203c 3d20 7072 6976 6174 655f 6e75  er <= private_nu
-00023010: 6d62 6572 5b31 5d0a 2020 2020 2020 2020  mber[1].        
-00023020: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00023030: 7072 6976 6174 655f 6e75 6d62 6572 2069  private_number i
-00023040: 6e20 7365 6c66 2e70 7269 7661 7465 0a20  n self.private. 
-00023050: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00023060: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00023070: 2020 2020 2020 2020 2020 2069 6620 6f6b             if ok
-00023080: 2061 6e64 2073 656c 662e 6973 5f70 7269   and self.is_pri
-00023090: 7661 7465 2069 7320 6e6f 7420 4e6f 6e65  vate is not None
-000230a0: 2061 6e64 2073 656c 662e 6973 5f70 7269   and self.is_pri
-000230b0: 7661 7465 2021 3d20 7072 6976 6174 653a  vate != private:
-000230c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000230d0: 206f 6b20 3d20 4661 6c73 650a 0a20 2020   ok = False..   
-000230e0: 2020 2020 2020 2020 2061 7574 6f6d 6174           automat
-000230f0: 6963 203d 2073 656c 662e 6175 746f 6d61  ic = self.automa
-00023100: 7469 635b 305d 203c 3d20 6e75 6d62 6572  tic[0] <= number
-00023110: 203c 3d20 7365 6c66 2e61 7574 6f6d 6174   <= self.automat
-00023120: 6963 5b31 5d0a 2020 2020 2020 2020 2020  ic[1].          
-00023130: 2020 6966 206f 6b20 616e 6420 7365 6c66    if ok and self
-00023140: 2e69 735f 6175 746f 6d61 7469 6320 6973  .is_automatic is
-00023150: 206e 6f74 204e 6f6e 6520 616e 6420 7365   not None and se
-00023160: 6c66 2e69 735f 6175 746f 6d61 7469 6320  lf.is_automatic 
-00023170: 213d 2061 7574 6f6d 6174 6963 3a0a 2020  != automatic:.  
-00023180: 2020 2020 2020 2020 2020 2020 2020 6f6b                ok
-00023190: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
-000231a0: 2020 2020 2020 6966 206f 6b3a 0a20 2020        if ok:.   
-000231b0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-000231c0: 7572 6e20 7661 6c75 650a 0a20 2020 2020  urn value..     
-000231d0: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
-000231e0: 696f 6e45 7272 6f72 2873 656c 662e 7472  ionError(self.tr
-000231f0: 616e 736c 6174 6f72 2873 656c 662e 6572  anslator(self.er
-00023200: 726f 725f 6d65 7373 6167 6529 290a 0a0a  ror_message))...
-00023210: 636c 6173 7320 4953 5f49 5056 3628 5661  class IS_IPV6(Va
-00023220: 6c69 6461 746f 7229 3a0a 2020 2020 2222  lidator):.    ""
-00023230: 220a 2020 2020 4368 6563 6b73 2069 6620  ".    Checks if 
-00023240: 6669 656c 6427 7320 7661 6c75 6520 6973  field's value is
-00023250: 2061 6e20 4950 2076 6572 7369 6f6e 2036   an IP version 6
-00023260: 2061 6464 7265 7373 2e0a 0a20 2020 2055   address...    U
-00023270: 7365 7320 7468 6520 6970 6164 6472 6573  ses the ipaddres
-00023280: 7320 6672 6f6d 2074 6865 2050 7974 686f  s from the Pytho
-00023290: 6e20 3320 7374 616e 6461 7264 206c 6962  n 3 standard lib
-000232a0: 7261 7279 0a20 2020 2061 6e64 2069 7473  rary.    and its
-000232b0: 2050 7974 686f 6e20 3220 6261 636b 706f   Python 2 backpo
-000232c0: 7274 2028 696e 2063 6f6e 7472 6962 2f69  rt (in contrib/i
-000232d0: 7061 6464 7265 7373 2e70 7929 2e0a 0a20  paddress.py)... 
-000232e0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-000232f0: 2069 735f 7072 6976 6174 653a 204e 6f6e   is_private: Non
-00023300: 6520 2864 6566 6175 6c74 293a 2069 6e64  e (default): ind
-00023310: 6966 6665 7265 6e74 0a20 2020 2020 2020  ifferent.       
-00023320: 2020 2020 2020 2020 2020 2020 2054 7275               Tru
-00023330: 6520 2865 6e66 6f72 6365 293a 2061 6464  e (enforce): add
-00023340: 7265 7373 206d 7573 7420 6265 2069 6e20  ress must be in 
-00023350: 6663 3030 3a3a 2f37 2072 616e 6765 0a20  fc00::/7 range. 
-00023360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023370: 2020 2046 616c 7365 2028 666f 7262 6964     False (forbid
-00023380: 293a 2061 6464 7265 7373 206d 7573 7420  ): address must 
-00023390: 4e4f 5420 6265 2069 6e20 6663 3030 3a3a  NOT be in fc00::
-000233a0: 2f37 2072 616e 6765 0a20 2020 2020 2020  /7 range.       
-000233b0: 2069 735f 6c69 6e6b 5f6c 6f63 616c 3a20   is_link_local: 
-000233c0: 5361 6d65 2061 7320 6162 6f76 6520 6275  Same as above bu
-000233d0: 7420 7573 6573 2066 6538 303a 3a2f 3130  t uses fe80::/10
-000233e0: 2072 616e 6765 0a20 2020 2020 2020 2069   range.        i
-000233f0: 735f 7265 7365 7276 6564 3a20 5361 6d65  s_reserved: Same
-00023400: 2061 7320 6162 6f76 6520 6275 7420 7573   as above but us
-00023410: 6573 2049 4554 4620 7265 7365 7276 6564  es IETF reserved
-00023420: 2072 616e 6765 0a20 2020 2020 2020 2069   range.        i
-00023430: 735f 6d75 6c74 6963 6173 743a 2053 616d  s_multicast: Sam
-00023440: 6520 6173 2061 626f 7665 2062 7574 2075  e as above but u
-00023450: 7365 7320 6666 3030 3a3a 2f38 2072 616e  ses ff00::/8 ran
-00023460: 6765 0a20 2020 2020 2020 2069 735f 726f  ge.        is_ro
-00023470: 7574 6561 626c 653a 2053 696d 696c 6172  uteable: Similar
-00023480: 2074 6f20 6162 6f76 6520 6275 7420 656e   to above but en
-00023490: 666f 7263 6573 206e 6f74 2070 7269 7661  forces not priva
-000234a0: 7465 2c20 6c69 6e6b 5f6c 6f63 616c 2c0a  te, link_local,.
+00022ac0: 2020 2020 2074 656d 702e 6170 7065 6e64       temp.append
+00022ad0: 2869 7465 6d2e 7370 6c69 7428 222e 2229  (item.split(".")
+00022ae0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00022af0: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+00022b00: 7369 6e73 7461 6e63 6528 6974 656d 2c20  sinstance(item, 
+00022b10: 286c 6973 742c 2074 7570 6c65 2929 3a0a  (list, tuple)):.
+00022b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022b30: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
+00022b40: 2e61 7070 656e 6428 6974 656d 290a 2020  .append(item).  
+00022b50: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
+00022b60: 7320 3d20 5b5d 0a20 2020 2020 2020 2020  s = [].         
+00022b70: 2020 2066 6f72 2069 7465 6d20 696e 2074     for item in t
+00022b80: 656d 703a 0a20 2020 2020 2020 2020 2020  emp:.           
+00022b90: 2020 2020 206e 756d 6265 7220 3d20 300a       number = 0.
+00022ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022bb0: 666f 7220 692c 206a 2069 6e20 7a69 7028  for i, j in zip(
+00022bc0: 7365 6c66 2e6e 756d 6265 7273 2c20 6974  self.numbers, it
+00022bd0: 656d 293a 0a20 2020 2020 2020 2020 2020  em):.           
+00022be0: 2020 2020 2020 2020 206e 756d 6265 7220           number 
+00022bf0: 2b3d 2069 202a 2069 6e74 286a 290a 2020  += i * int(j).  
+00022c00: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+00022c10: 6d62 6572 732e 6170 7065 6e64 286e 756d  mbers.append(num
+00022c20: 6265 7229 0a20 2020 2020 2020 2020 2020  ber).           
+00022c30: 2069 6620 6e20 3d3d 2030 3a0a 2020 2020   if n == 0:.    
+00022c40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00022c50: 2e6d 696e 6970 203d 206e 756d 6265 7273  .minip = numbers
+00022c60: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00022c70: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00022c80: 2020 2073 656c 662e 6d61 7869 7020 3d20     self.maxip = 
+00022c90: 6e75 6d62 6572 730a 2020 2020 2020 2020  numbers.        
+00022ca0: 7365 6c66 2e69 6e76 6572 7420 3d20 696e  self.invert = in
+00022cb0: 7665 7274 0a20 2020 2020 2020 2073 656c  vert.        sel
+00022cc0: 662e 6973 5f6c 6f63 616c 686f 7374 203d  f.is_localhost =
+00022cd0: 2069 735f 6c6f 6361 6c68 6f73 740a 2020   is_localhost.  
+00022ce0: 2020 2020 2020 7365 6c66 2e69 735f 7072        self.is_pr
+00022cf0: 6976 6174 6520 3d20 6973 5f70 7269 7661  ivate = is_priva
+00022d00: 7465 0a20 2020 2020 2020 2073 656c 662e  te.        self.
+00022d10: 6973 5f61 7574 6f6d 6174 6963 203d 2069  is_automatic = i
+00022d20: 735f 6175 746f 6d61 7469 630a 2020 2020  s_automatic.    
+00022d30: 2020 2020 7365 6c66 2e65 7272 6f72 5f6d      self.error_m
+00022d40: 6573 7361 6765 203d 2065 7272 6f72 5f6d  essage = error_m
+00022d50: 6573 7361 6765 0a0a 2020 2020 6465 6620  essage..    def 
+00022d60: 7661 6c69 6461 7465 2873 656c 662c 2076  validate(self, v
+00022d70: 616c 7565 2c20 7265 636f 7264 5f69 643d  alue, record_id=
+00022d80: 4e6f 6e65 293a 0a20 2020 2020 2020 2069  None):.        i
+00022d90: 6620 7265 2e6d 6174 6368 2873 656c 662e  f re.match(self.
+00022da0: 5245 4745 585f 4950 5634 2c20 7661 6c75  REGEX_IPV4, valu
+00022db0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00022dc0: 6e75 6d62 6572 203d 2030 0a20 2020 2020  number = 0.     
+00022dd0: 2020 2020 2020 2066 6f72 2069 2c20 6a20         for i, j 
+00022de0: 696e 207a 6970 2873 656c 662e 6e75 6d62  in zip(self.numb
+00022df0: 6572 732c 2076 616c 7565 2e73 706c 6974  ers, value.split
+00022e00: 2822 2e22 2929 3a0a 2020 2020 2020 2020  (".")):.        
+00022e10: 2020 2020 2020 2020 6e75 6d62 6572 202b          number +
+00022e20: 3d20 6920 2a20 696e 7428 6a29 0a20 2020  = i * int(j).   
+00022e30: 2020 2020 2020 2020 206f 6b20 3d20 4661           ok = Fa
+00022e40: 6c73 650a 0a20 2020 2020 2020 2020 2020  lse..           
+00022e50: 2066 6f72 2062 6f74 746f 6d2c 2074 6f70   for bottom, top
+00022e60: 2069 6e20 7a69 7028 7365 6c66 2e6d 696e   in zip(self.min
+00022e70: 6970 2c20 7365 6c66 2e6d 6178 6970 293a  ip, self.maxip):
+00022e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022e90: 2069 6620 7365 6c66 2e69 6e76 6572 7420   if self.invert 
+00022ea0: 213d 2028 626f 7474 6f6d 203c 3d20 6e75  != (bottom <= nu
+00022eb0: 6d62 6572 203c 3d20 746f 7029 3a0a 2020  mber <= top):.  
+00022ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022ed0: 2020 6f6b 203d 2054 7275 650a 0a20 2020    ok = True..   
+00022ee0: 2020 2020 2020 2020 2069 6620 280a 2020           if (.  
+00022ef0: 2020 2020 2020 2020 2020 2020 2020 6f6b                ok
+00022f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022f10: 2061 6e64 2073 656c 662e 6973 5f6c 6f63   and self.is_loc
+00022f20: 616c 686f 7374 2069 7320 6e6f 7420 4e6f  alhost is not No
+00022f30: 6e65 0a20 2020 2020 2020 2020 2020 2020  ne.             
+00022f40: 2020 2061 6e64 2073 656c 662e 6973 5f6c     and self.is_l
+00022f50: 6f63 616c 686f 7374 2021 3d20 286e 756d  ocalhost != (num
+00022f60: 6265 7220 3d3d 2073 656c 662e 6c6f 6361  ber == self.loca
+00022f70: 6c68 6f73 7429 0a20 2020 2020 2020 2020  lhost).         
+00022f80: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00022f90: 2020 2020 2020 6f6b 203d 2046 616c 7365        ok = False
+00022fa0: 0a0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00022fb0: 6976 6174 6520 3d20 616e 7928 0a20 2020  ivate = any(.   
+00022fc0: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+00022fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022fe0: 2020 2070 7269 7661 7465 5f6e 756d 6265     private_numbe
+00022ff0: 725b 305d 203c 3d20 6e75 6d62 6572 203c  r[0] <= number <
+00023000: 3d20 7072 6976 6174 655f 6e75 6d62 6572  = private_number
+00023010: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00023020: 2020 2020 2020 2020 666f 7220 7072 6976          for priv
+00023030: 6174 655f 6e75 6d62 6572 2069 6e20 7365  ate_number in se
+00023040: 6c66 2e70 7269 7661 7465 0a20 2020 2020  lf.private.     
+00023050: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00023060: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00023070: 2020 2020 2020 2069 6620 6f6b 2061 6e64         if ok and
+00023080: 2073 656c 662e 6973 5f70 7269 7661 7465   self.is_private
+00023090: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+000230a0: 2073 656c 662e 6973 5f70 7269 7661 7465   self.is_private
+000230b0: 2021 3d20 7072 6976 6174 653a 0a20 2020   != private:.   
+000230c0: 2020 2020 2020 2020 2020 2020 206f 6b20               ok 
+000230d0: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
+000230e0: 2020 2020 2061 7574 6f6d 6174 6963 203d       automatic =
+000230f0: 2073 656c 662e 6175 746f 6d61 7469 635b   self.automatic[
+00023100: 305d 203c 3d20 6e75 6d62 6572 203c 3d20  0] <= number <= 
+00023110: 7365 6c66 2e61 7574 6f6d 6174 6963 5b31  self.automatic[1
+00023120: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+00023130: 206f 6b20 616e 6420 7365 6c66 2e69 735f   ok and self.is_
+00023140: 6175 746f 6d61 7469 6320 6973 206e 6f74  automatic is not
+00023150: 204e 6f6e 6520 616e 6420 7365 6c66 2e69   None and self.i
+00023160: 735f 6175 746f 6d61 7469 6320 213d 2061  s_automatic != a
+00023170: 7574 6f6d 6174 6963 3a0a 2020 2020 2020  utomatic:.      
+00023180: 2020 2020 2020 2020 2020 6f6b 203d 2046            ok = F
+00023190: 616c 7365 0a0a 2020 2020 2020 2020 2020  alse..          
+000231a0: 2020 6966 206f 6b3a 0a20 2020 2020 2020    if ok:.       
+000231b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000231c0: 7661 6c75 650a 0a20 2020 2020 2020 2072  value..        r
+000231d0: 6169 7365 2056 616c 6964 6174 696f 6e45  aise ValidationE
+000231e0: 7272 6f72 2873 656c 662e 7472 616e 736c  rror(self.transl
+000231f0: 6174 6f72 2873 656c 662e 6572 726f 725f  ator(self.error_
+00023200: 6d65 7373 6167 6529 290a 0a0a 636c 6173  message))...clas
+00023210: 7320 4953 5f49 5056 3628 5661 6c69 6461  s IS_IPV6(Valida
+00023220: 746f 7229 3a0a 2020 2020 2222 220a 2020  tor):.    """.  
+00023230: 2020 4368 6563 6b73 2069 6620 6669 656c    Checks if fiel
+00023240: 6427 7320 7661 6c75 6520 6973 2061 6e20  d's value is an 
+00023250: 4950 2076 6572 7369 6f6e 2036 2061 6464  IP version 6 add
+00023260: 7265 7373 2e0a 0a20 2020 2055 7365 7320  ress...    Uses 
+00023270: 7468 6520 6970 6164 6472 6573 7320 6672  the ipaddress fr
+00023280: 6f6d 2074 6865 2050 7974 686f 6e20 3320  om the Python 3 
+00023290: 7374 616e 6461 7264 206c 6962 7261 7279  standard library
+000232a0: 0a20 2020 2061 6e64 2069 7473 2050 7974  .    and its Pyt
+000232b0: 686f 6e20 3220 6261 636b 706f 7274 2028  hon 2 backport (
+000232c0: 696e 2063 6f6e 7472 6962 2f69 7061 6464  in contrib/ipadd
+000232d0: 7265 7373 2e70 7929 2e0a 0a20 2020 2041  ress.py)...    A
+000232e0: 7267 733a 0a20 2020 2020 2020 2069 735f  rgs:.        is_
+000232f0: 7072 6976 6174 653a 204e 6f6e 6520 2864  private: None (d
+00023300: 6566 6175 6c74 293a 2069 6e64 6966 6665  efault): indiffe
+00023310: 7265 6e74 0a20 2020 2020 2020 2020 2020  rent.           
+00023320: 2020 2020 2020 2020 2054 7275 6520 2865           True (e
+00023330: 6e66 6f72 6365 293a 2061 6464 7265 7373  nforce): address
+00023340: 206d 7573 7420 6265 2069 6e20 6663 3030   must be in fc00
+00023350: 3a3a 2f37 2072 616e 6765 0a20 2020 2020  ::/7 range.     
+00023360: 2020 2020 2020 2020 2020 2020 2020 2046                 F
+00023370: 616c 7365 2028 666f 7262 6964 293a 2061  alse (forbid): a
+00023380: 6464 7265 7373 206d 7573 7420 4e4f 5420  ddress must NOT 
+00023390: 6265 2069 6e20 6663 3030 3a3a 2f37 2072  be in fc00::/7 r
+000233a0: 616e 6765 0a20 2020 2020 2020 2069 735f  ange.        is_
+000233b0: 6c69 6e6b 5f6c 6f63 616c 3a20 5361 6d65  link_local: Same
+000233c0: 2061 7320 6162 6f76 6520 6275 7420 7573   as above but us
+000233d0: 6573 2066 6538 303a 3a2f 3130 2072 616e  es fe80::/10 ran
+000233e0: 6765 0a20 2020 2020 2020 2069 735f 7265  ge.        is_re
+000233f0: 7365 7276 6564 3a20 5361 6d65 2061 7320  served: Same as 
+00023400: 6162 6f76 6520 6275 7420 7573 6573 2049  above but uses I
+00023410: 4554 4620 7265 7365 7276 6564 2072 616e  ETF reserved ran
+00023420: 6765 0a20 2020 2020 2020 2069 735f 6d75  ge.        is_mu
+00023430: 6c74 6963 6173 743a 2053 616d 6520 6173  lticast: Same as
+00023440: 2061 626f 7665 2062 7574 2075 7365 7320   above but uses 
+00023450: 6666 3030 3a3a 2f38 2072 616e 6765 0a20  ff00::/8 range. 
+00023460: 2020 2020 2020 2069 735f 726f 7574 6561         is_routea
+00023470: 626c 653a 2053 696d 696c 6172 2074 6f20  ble: Similar to 
+00023480: 6162 6f76 6520 6275 7420 656e 666f 7263  above but enforc
+00023490: 6573 206e 6f74 2070 7269 7661 7465 2c20  es not private, 
+000234a0: 6c69 6e6b 5f6c 6f63 616c 2c0a 2020 2020  link_local,.    
 000234b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000234c0: 2020 2020 2020 7265 7365 7276 6564 206f        reserved o
-000234d0: 7220 6d75 6c74 6963 6173 740a 2020 2020  r multicast.    
-000234e0: 2020 2020 6973 5f36 746f 343a 2053 616d      is_6to4: Sam
-000234f0: 6520 6173 2061 626f 7665 2062 7574 2075  e as above but u
-00023500: 7365 7320 3230 3032 3a3a 2f31 3620 7261  ses 2002::/16 ra
-00023510: 6e67 650a 2020 2020 2020 2020 6973 5f74  nge.        is_t
-00023520: 6572 6564 6f3a 2053 616d 6520 6173 2061  eredo: Same as a
-00023530: 626f 7665 2062 7574 2075 7365 7320 3230  bove but uses 20
-00023540: 3031 3a3a 2f33 3220 7261 6e67 650a 2020  01::/32 range.  
-00023550: 2020 2020 2020 7375 626e 6574 733a 2076        subnets: v
-00023560: 616c 7565 206d 7573 7420 6265 2061 206d  alue must be a m
-00023570: 656d 6265 7220 6f66 2061 7420 6c65 6173  ember of at leas
-00023580: 7420 6f6e 6520 6672 6f6d 206c 6973 7420  t one from list 
-00023590: 6f66 2073 7562 6e65 7473 0a0a 2020 2020  of subnets..    
-000235a0: 4578 616d 706c 6573 3a0a 2020 2020 2020  Examples:.      
-000235b0: 2020 4368 6563 6b20 666f 7220 7661 6c69    Check for vali
-000235c0: 6420 4950 7636 2061 6464 7265 7373 3a0a  d IPv6 address:.
-000235d0: 0a20 2020 2020 2020 2020 2020 2049 4e50  .            INP
-000235e0: 5554 285f 7479 7065 3d27 7465 7874 272c  UT(_type='text',
-000235f0: 205f 6e61 6d65 3d27 6e61 6d65 272c 2072   _name='name', r
-00023600: 6571 7569 7265 733d 4953 5f49 5056 3628  equires=IS_IPV6(
-00023610: 2929 0a0a 2020 2020 2020 2020 4368 6563  ))..        Chec
-00023620: 6b20 666f 7220 7661 6c69 6420 4950 7636  k for valid IPv6
-00023630: 2061 6464 7265 7373 2069 7320 6120 6c69   address is a li
-00023640: 6e6b 5f6c 6f63 616c 2061 6464 7265 7373  nk_local address
-00023650: 3a0a 0a20 2020 2020 2020 2020 2020 2049  :..            I
-00023660: 4e50 5554 285f 7479 7065 3d27 7465 7874  NPUT(_type='text
-00023670: 272c 205f 6e61 6d65 3d27 6e61 6d65 272c  ', _name='name',
-00023680: 2072 6571 7569 7265 733d 4953 5f49 5056   requires=IS_IPV
-00023690: 3628 6973 5f6c 696e 6b5f 6c6f 6361 6c3d  6(is_link_local=
-000236a0: 5472 7565 2929 0a0a 2020 2020 2020 2020  True))..        
-000236b0: 4368 6563 6b20 666f 7220 7661 6c69 6420  Check for valid 
-000236c0: 4950 7636 2061 6464 7265 7373 2074 6861  IPv6 address tha
-000236d0: 7420 6973 2049 6e74 6572 6e65 7420 726f  t is Internet ro
-000236e0: 7574 6561 626c 653a 0a0a 2020 2020 2020  uteable:..      
-000236f0: 2020 2020 2020 494e 5055 5428 5f74 7970        INPUT(_typ
-00023700: 653d 2774 6578 7427 2c20 5f6e 616d 653d  e='text', _name=
-00023710: 276e 616d 6527 2c20 7265 7175 6972 6573  'name', requires
-00023720: 3d49 535f 4950 5636 2869 735f 726f 7574  =IS_IPV6(is_rout
-00023730: 6561 626c 653d 5472 7565 2929 0a0a 2020  eable=True))..  
-00023740: 2020 2020 2020 4368 6563 6b20 666f 7220        Check for 
-00023750: 7661 6c69 6420 4950 7636 2061 6464 7265  valid IPv6 addre
-00023760: 7373 2069 6e20 7370 6563 6966 6965 6420  ss in specified 
-00023770: 7375 626e 6574 3a0a 0a20 2020 2020 2020  subnet:..       
-00023780: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
-00023790: 3d27 7465 7874 272c 205f 6e61 6d65 3d27  ='text', _name='
-000237a0: 6e61 6d65 272c 2072 6571 7569 7265 733d  name', requires=
-000237b0: 4953 5f49 5056 3628 7375 626e 6574 733d  IS_IPV6(subnets=
-000237c0: 5b27 3230 3031 3a3a 2f33 3227 5d29 0a0a  ['2001::/32'])..
-000237d0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-000237e0: 4953 5f49 5056 3628 2928 2766 6538 303a  IS_IPV6()('fe80:
-000237f0: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
-00023800: 6233 6166 2729 0a20 2020 2020 2020 2020  b3af').         
-00023810: 2020 2028 2766 6538 303a 3a31 3236 633a     ('fe80::126c:
-00023820: 3866 6661 3a66 6532 323a 6233 6166 272c  8ffa:fe22:b3af',
-00023830: 204e 6f6e 6529 0a20 2020 2020 2020 2020   None).         
-00023840: 2020 203e 3e3e 2049 535f 4950 5636 2829     >>> IS_IPV6()
-00023850: 2827 3139 322e 3136 382e 312e 3127 290a  ('192.168.1.1').
-00023860: 2020 2020 2020 2020 2020 2020 2827 3139              ('19
-00023870: 322e 3136 382e 312e 3127 2c20 2765 6e74  2.168.1.1', 'ent
-00023880: 6572 2076 616c 6964 2049 5076 3620 6164  er valid IPv6 ad
-00023890: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
-000238a0: 2020 2020 3e3e 3e20 4953 5f49 5056 3628      >>> IS_IPV6(
-000238b0: 6572 726f 725f 6d65 7373 6167 653d 2742  error_message='B
-000238c0: 6164 2069 7027 2928 2731 3932 2e31 3638  ad ip')('192.168
-000238d0: 2e31 2e31 2729 0a20 2020 2020 2020 2020  .1.1').         
-000238e0: 2020 2028 2731 3932 2e31 3638 2e31 2e31     ('192.168.1.1
-000238f0: 272c 2027 6261 6420 6970 2729 0a20 2020  ', 'bad ip').   
-00023900: 2020 2020 2020 2020 203e 3e3e 2049 535f           >>> IS_
-00023910: 4950 5636 2869 735f 6c69 6e6b 5f6c 6f63  IPV6(is_link_loc
-00023920: 616c 3d54 7275 6529 2827 6665 3830 3a3a  al=True)('fe80::
-00023930: 3132 3663 3a38 6666 613a 6665 3232 3a62  126c:8ffa:fe22:b
-00023940: 3361 6627 290a 2020 2020 2020 2020 2020  3af').          
-00023950: 2020 2827 6665 3830 3a3a 3132 3663 3a38    ('fe80::126c:8
-00023960: 6666 613a 6665 3232 3a62 3361 6627 2c20  ffa:fe22:b3af', 
-00023970: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
-00023980: 2020 3e3e 3e20 4953 5f49 5056 3628 6973    >>> IS_IPV6(is
-00023990: 5f6c 696e 6b5f 6c6f 6361 6c3d 4661 6c73  _link_local=Fals
-000239a0: 6529 2827 6665 3830 3a3a 3132 3663 3a38  e)('fe80::126c:8
-000239b0: 6666 613a 6665 3232 3a62 3361 6627 290a  ffa:fe22:b3af').
-000239c0: 2020 2020 2020 2020 2020 2020 2827 6665              ('fe
-000239d0: 3830 3a3a 3132 3663 3a38 6666 613a 6665  80::126c:8ffa:fe
-000239e0: 3232 3a62 3361 6627 2c20 2765 6e74 6572  22:b3af', 'enter
-000239f0: 2076 616c 6964 2049 5076 3620 6164 6472   valid IPv6 addr
-00023a00: 6573 7327 290a 2020 2020 2020 2020 2020  ess').          
-00023a10: 2020 3e3e 3e20 4953 5f49 5056 3628 6973    >>> IS_IPV6(is
-00023a20: 5f6c 696e 6b5f 6c6f 6361 6c3d 5472 7565  _link_local=True
-00023a30: 2928 2732 3030 313a 3a31 3236 633a 3866  )('2001::126c:8f
-00023a40: 6661 3a66 6532 323a 6233 6166 2729 0a20  fa:fe22:b3af'). 
-00023a50: 2020 2020 2020 2020 2020 2028 2732 3030             ('200
-00023a60: 313a 3a31 3236 633a 3866 6661 3a66 6532  1::126c:8ffa:fe2
-00023a70: 323a 6233 6166 272c 2027 656e 7465 7220  2:b3af', 'enter 
-00023a80: 7661 6c69 6420 4950 7636 2061 6464 7265  valid IPv6 addre
-00023a90: 7373 2729 0a20 2020 2020 2020 2020 2020  ss').           
-00023aa0: 203e 3e3e 2049 535f 4950 5636 2869 735f   >>> IS_IPV6(is_
-00023ab0: 6d75 6c74 6963 6173 743d 5472 7565 2928  multicast=True)(
-00023ac0: 2732 3030 313a 3a31 3236 633a 3866 6661  '2001::126c:8ffa
-00023ad0: 3a66 6532 323a 6233 6166 2729 0a20 2020  :fe22:b3af').   
-00023ae0: 2020 2020 2020 2020 2028 2732 3030 313a           ('2001:
-00023af0: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
-00023b00: 6233 6166 272c 2027 656e 7465 7220 7661  b3af', 'enter va
-00023b10: 6c69 6420 4950 7636 2061 6464 7265 7373  lid IPv6 address
-00023b20: 2729 0a20 2020 2020 2020 2020 2020 203e  ').            >
-00023b30: 3e3e 2049 535f 4950 5636 2869 735f 6d75  >> IS_IPV6(is_mu
-00023b40: 6c74 6963 6173 743d 5472 7565 2928 2766  lticast=True)('f
-00023b50: 6630 303a 3a31 3236 633a 3866 6661 3a66  f00::126c:8ffa:f
-00023b60: 6532 323a 6233 6166 2729 0a20 2020 2020  e22:b3af').     
-00023b70: 2020 2020 2020 2028 2766 6630 303a 3a31         ('ff00::1
-00023b80: 3236 633a 3866 6661 3a66 6532 323a 6233  26c:8ffa:fe22:b3
-00023b90: 6166 272c 204e 6f6e 6529 0a20 2020 2020  af', None).     
-00023ba0: 2020 2020 2020 203e 3e3e 2049 535f 4950         >>> IS_IP
-00023bb0: 5636 2869 735f 726f 7574 6561 626c 653d  V6(is_routeable=
-00023bc0: 5472 7565 2928 2732 3030 313a 3a31 3236  True)('2001::126
-00023bd0: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
-00023be0: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
-00023bf0: 2732 3030 313a 3a31 3236 633a 3866 6661  '2001::126c:8ffa
-00023c00: 3a66 6532 323a 6233 6166 272c 204e 6f6e  :fe22:b3af', Non
-00023c10: 6529 0a20 2020 2020 2020 2020 2020 203e  e).            >
-00023c20: 3e3e 2049 535f 4950 5636 2869 735f 726f  >> IS_IPV6(is_ro
-00023c30: 7574 6561 626c 653d 5472 7565 2928 2766  uteable=True)('f
-00023c40: 6630 303a 3a31 3236 633a 3866 6661 3a66  f00::126c:8ffa:f
-00023c50: 6532 323a 6233 6166 2729 0a20 2020 2020  e22:b3af').     
-00023c60: 2020 2020 2020 2028 2766 6630 303a 3a31         ('ff00::1
-00023c70: 3236 633a 3866 6661 3a66 6532 323a 6233  26c:8ffa:fe22:b3
-00023c80: 6166 272c 2027 656e 7465 7220 7661 6c69  af', 'enter vali
-00023c90: 6420 4950 7636 2061 6464 7265 7373 2729  d IPv6 address')
-00023ca0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00023cb0: 2049 535f 4950 5636 2873 7562 6e65 7473   IS_IPV6(subnets
-00023cc0: 3d27 3230 3031 3a3a 2f33 3227 2928 2732  ='2001::/32')('2
-00023cd0: 3030 313a 3a38 6666 613a 6665 3232 3a62  001::8ffa:fe22:b
-00023ce0: 3361 6627 290a 2020 2020 2020 2020 2020  3af').          
-00023cf0: 2020 2827 3230 3031 3a3a 3866 6661 3a66    ('2001::8ffa:f
-00023d00: 6532 323a 6233 6166 272c 204e 6f6e 6529  e22:b3af', None)
-00023d10: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00023d20: 2049 535f 4950 5636 2873 7562 6e65 7473   IS_IPV6(subnets
-00023d30: 3d27 6662 3030 3a3a 2f38 2729 2827 3230  ='fb00::/8')('20
-00023d40: 3031 3a3a 3866 6661 3a66 6532 323a 6233  01::8ffa:fe22:b3
-00023d50: 6166 2729 0a20 2020 2020 2020 2020 2020  af').           
-00023d60: 2028 2732 3030 313a 3a38 6666 613a 6665   ('2001::8ffa:fe
-00023d70: 3232 3a62 3361 6627 2c20 2765 6e74 6572  22:b3af', 'enter
-00023d80: 2076 616c 6964 2049 5076 3620 6164 6472   valid IPv6 addr
-00023d90: 6573 7327 290a 2020 2020 2020 2020 2020  ess').          
-00023da0: 2020 3e3e 3e20 4953 5f49 5056 3628 7375    >>> IS_IPV6(su
-00023db0: 626e 6574 733d 5b27 6663 3030 3a3a 2f38  bnets=['fc00::/8
-00023dc0: 272c 2732 3030 313a 3a2f 3332 275d 2928  ','2001::/32'])(
-00023dd0: 2732 3030 313a 3a38 6666 613a 6665 3232  '2001::8ffa:fe22
-00023de0: 3a62 3361 6627 290a 2020 2020 2020 2020  :b3af').        
-00023df0: 2020 2020 2827 3230 3031 3a3a 3866 6661      ('2001::8ffa
-00023e00: 3a66 6532 323a 6233 6166 272c 204e 6f6e  :fe22:b3af', Non
-00023e10: 6529 0a20 2020 2020 2020 2020 2020 203e  e).            >
-00023e20: 3e3e 2049 535f 4950 5636 2873 7562 6e65  >> IS_IPV6(subne
-00023e30: 7473 3d27 696e 7661 6c69 6473 7562 6e65  ts='invalidsubne
-00023e40: 7427 2928 2732 3030 313a 3a38 6666 613a  t')('2001::8ffa:
-00023e50: 6665 3232 3a62 3361 6627 290a 2020 2020  fe22:b3af').    
-00023e60: 2020 2020 2020 2020 2827 3230 3031 3a3a          ('2001::
-00023e70: 3866 6661 3a66 6532 323a 6233 6166 272c  8ffa:fe22:b3af',
-00023e80: 2027 696e 7661 6c69 6420 7375 626e 6574   'invalid subnet
-00023e90: 2070 726f 7669 6465 6427 290a 0a20 2020   provided')..   
-00023ea0: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
-00023eb0: 696e 6974 5f5f 280a 2020 2020 2020 2020  init__(.        
-00023ec0: 7365 6c66 2c0a 2020 2020 2020 2020 6973  self,.        is
-00023ed0: 5f70 7269 7661 7465 3d4e 6f6e 652c 0a20  _private=None,. 
-00023ee0: 2020 2020 2020 2069 735f 6c69 6e6b 5f6c         is_link_l
-00023ef0: 6f63 616c 3d4e 6f6e 652c 0a20 2020 2020  ocal=None,.     
-00023f00: 2020 2069 735f 7265 7365 7276 6564 3d4e     is_reserved=N
-00023f10: 6f6e 652c 0a20 2020 2020 2020 2069 735f  one,.        is_
-00023f20: 6d75 6c74 6963 6173 743d 4e6f 6e65 2c0a  multicast=None,.
-00023f30: 2020 2020 2020 2020 6973 5f72 6f75 7465          is_route
-00023f40: 6162 6c65 3d4e 6f6e 652c 0a20 2020 2020  able=None,.     
-00023f50: 2020 2069 735f 3674 6f34 3d4e 6f6e 652c     is_6to4=None,
-00023f60: 0a20 2020 2020 2020 2069 735f 7465 7265  .        is_tere
-00023f70: 646f 3d4e 6f6e 652c 0a20 2020 2020 2020  do=None,.       
-00023f80: 2073 7562 6e65 7473 3d4e 6f6e 652c 0a20   subnets=None,. 
-00023f90: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00023fa0: 7361 6765 3d22 456e 7465 7220 7661 6c69  sage="Enter vali
-00023fb0: 6420 4950 7636 2061 6464 7265 7373 222c  d IPv6 address",
-00023fc0: 0a20 2020 2029 3a0a 0a20 2020 2020 2020  .    ):..       
-00023fd0: 2073 656c 662e 6973 5f70 7269 7661 7465   self.is_private
-00023fe0: 203d 2069 735f 7072 6976 6174 650a 2020   = is_private.  
-00023ff0: 2020 2020 2020 7365 6c66 2e69 735f 6c69        self.is_li
-00024000: 6e6b 5f6c 6f63 616c 203d 2069 735f 6c69  nk_local = is_li
-00024010: 6e6b 5f6c 6f63 616c 0a20 2020 2020 2020  nk_local.       
-00024020: 2073 656c 662e 6973 5f72 6573 6572 7665   self.is_reserve
-00024030: 6420 3d20 6973 5f72 6573 6572 7665 640a  d = is_reserved.
-00024040: 2020 2020 2020 2020 7365 6c66 2e69 735f          self.is_
-00024050: 6d75 6c74 6963 6173 7420 3d20 6973 5f6d  multicast = is_m
-00024060: 756c 7469 6361 7374 0a20 2020 2020 2020  ulticast.       
-00024070: 2073 656c 662e 6973 5f72 6f75 7465 6162   self.is_routeab
-00024080: 6c65 203d 2069 735f 726f 7574 6561 626c  le = is_routeabl
-00024090: 650a 2020 2020 2020 2020 7365 6c66 2e69  e.        self.i
-000240a0: 735f 3674 6f34 203d 2069 735f 3674 6f34  s_6to4 = is_6to4
-000240b0: 0a20 2020 2020 2020 2073 656c 662e 6973  .        self.is
-000240c0: 5f74 6572 6564 6f20 3d20 6973 5f74 6572  _teredo = is_ter
-000240d0: 6564 6f0a 2020 2020 2020 2020 7365 6c66  edo.        self
-000240e0: 2e73 7562 6e65 7473 203d 2073 7562 6e65  .subnets = subne
-000240f0: 7473 0a20 2020 2020 2020 2073 656c 662e  ts.        self.
-00024100: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00024110: 6572 726f 725f 6d65 7373 6167 650a 0a20  error_message.. 
-00024120: 2020 2064 6566 2076 616c 6964 6174 6528     def validate(
-00024130: 7365 6c66 2c20 7661 6c75 652c 2072 6563  self, value, rec
-00024140: 6f72 645f 6964 3d4e 6f6e 6529 3a0a 2020  ord_id=None):.  
-00024150: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-00024160: 2020 2020 2020 2069 7020 3d20 6970 6164         ip = ipad
-00024170: 6472 6573 732e 4950 7636 4164 6472 6573  dress.IPv6Addres
-00024180: 7328 746f 5f75 6e69 636f 6465 2876 616c  s(to_unicode(val
-00024190: 7565 2929 0a20 2020 2020 2020 2020 2020  ue)).           
-000241a0: 206f 6b20 3d20 5472 7565 0a20 2020 2020   ok = True.     
-000241b0: 2020 2065 7863 6570 7420 6970 6164 6472     except ipaddr
-000241c0: 6573 732e 4164 6472 6573 7356 616c 7565  ess.AddressValue
-000241d0: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
-000241e0: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
-000241f0: 696f 6e45 7272 6f72 2873 656c 662e 7472  ionError(self.tr
-00024200: 616e 736c 6174 6f72 2873 656c 662e 6572  anslator(self.er
-00024210: 726f 725f 6d65 7373 6167 6529 290a 0a20  ror_message)).. 
-00024220: 2020 2020 2020 2069 6620 7365 6c66 2e73         if self.s
-00024230: 7562 6e65 7473 3a0a 2020 2020 2020 2020  ubnets:.        
-00024240: 2020 2020 2320 6974 6572 6174 6520 7468      # iterate th
-00024250: 726f 7567 6820 7365 6c66 2e73 7562 6e65  rough self.subne
-00024260: 7473 2074 6f20 7365 6520 6966 2076 616c  ts to see if val
-00024270: 7565 2069 7320 6120 6d65 6d62 6572 0a20  ue is a member. 
-00024280: 2020 2020 2020 2020 2020 206f 6b20 3d20             ok = 
-00024290: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-000242a0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000242b0: 7365 6c66 2e73 7562 6e65 7473 2c20 7374  self.subnets, st
-000242c0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-000242d0: 2020 2020 7365 6c66 2e73 7562 6e65 7473      self.subnets
-000242e0: 203d 205b 7365 6c66 2e73 7562 6e65 7473   = [self.subnets
-000242f0: 5d0a 2020 2020 2020 2020 2020 2020 666f  ].            fo
-00024300: 7220 6e65 7477 6f72 6b20 696e 2073 656c  r network in sel
-00024310: 662e 7375 626e 6574 733a 0a20 2020 2020  f.subnets:.     
-00024320: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+000234c0: 2020 7265 7365 7276 6564 206f 7220 6d75    reserved or mu
+000234d0: 6c74 6963 6173 740a 2020 2020 2020 2020  lticast.        
+000234e0: 6973 5f36 746f 343a 2053 616d 6520 6173  is_6to4: Same as
+000234f0: 2061 626f 7665 2062 7574 2075 7365 7320   above but uses 
+00023500: 3230 3032 3a3a 2f31 3620 7261 6e67 650a  2002::/16 range.
+00023510: 2020 2020 2020 2020 6973 5f74 6572 6564          is_tered
+00023520: 6f3a 2053 616d 6520 6173 2061 626f 7665  o: Same as above
+00023530: 2062 7574 2075 7365 7320 3230 3031 3a3a   but uses 2001::
+00023540: 2f33 3220 7261 6e67 650a 2020 2020 2020  /32 range.      
+00023550: 2020 7375 626e 6574 733a 2076 616c 7565    subnets: value
+00023560: 206d 7573 7420 6265 2061 206d 656d 6265   must be a membe
+00023570: 7220 6f66 2061 7420 6c65 6173 7420 6f6e  r of at least on
+00023580: 6520 6672 6f6d 206c 6973 7420 6f66 2073  e from list of s
+00023590: 7562 6e65 7473 0a0a 2020 2020 4578 616d  ubnets..    Exam
+000235a0: 706c 6573 3a0a 2020 2020 2020 2020 4368  ples:.        Ch
+000235b0: 6563 6b20 666f 7220 7661 6c69 6420 4950  eck for valid IP
+000235c0: 7636 2061 6464 7265 7373 3a0a 0a20 2020  v6 address:..   
+000235d0: 2020 2020 2020 2020 2049 4e50 5554 285f           INPUT(_
+000235e0: 7479 7065 3d27 7465 7874 272c 205f 6e61  type='text', _na
+000235f0: 6d65 3d27 6e61 6d65 272c 2072 6571 7569  me='name', requi
+00023600: 7265 733d 4953 5f49 5056 3628 2929 0a0a  res=IS_IPV6())..
+00023610: 2020 2020 2020 2020 4368 6563 6b20 666f          Check fo
+00023620: 7220 7661 6c69 6420 4950 7636 2061 6464  r valid IPv6 add
+00023630: 7265 7373 2069 7320 6120 6c69 6e6b 5f6c  ress is a link_l
+00023640: 6f63 616c 2061 6464 7265 7373 3a0a 0a20  ocal address:.. 
+00023650: 2020 2020 2020 2020 2020 2049 4e50 5554             INPUT
+00023660: 285f 7479 7065 3d27 7465 7874 272c 205f  (_type='text', _
+00023670: 6e61 6d65 3d27 6e61 6d65 272c 2072 6571  name='name', req
+00023680: 7569 7265 733d 4953 5f49 5056 3628 6973  uires=IS_IPV6(is
+00023690: 5f6c 696e 6b5f 6c6f 6361 6c3d 5472 7565  _link_local=True
+000236a0: 2929 0a0a 2020 2020 2020 2020 4368 6563  ))..        Chec
+000236b0: 6b20 666f 7220 7661 6c69 6420 4950 7636  k for valid IPv6
+000236c0: 2061 6464 7265 7373 2074 6861 7420 6973   address that is
+000236d0: 2049 6e74 6572 6e65 7420 726f 7574 6561   Internet routea
+000236e0: 626c 653a 0a0a 2020 2020 2020 2020 2020  ble:..          
+000236f0: 2020 494e 5055 5428 5f74 7970 653d 2774    INPUT(_type='t
+00023700: 6578 7427 2c20 5f6e 616d 653d 276e 616d  ext', _name='nam
+00023710: 6527 2c20 7265 7175 6972 6573 3d49 535f  e', requires=IS_
+00023720: 4950 5636 2869 735f 726f 7574 6561 626c  IPV6(is_routeabl
+00023730: 653d 5472 7565 2929 0a0a 2020 2020 2020  e=True))..      
+00023740: 2020 4368 6563 6b20 666f 7220 7661 6c69    Check for vali
+00023750: 6420 4950 7636 2061 6464 7265 7373 2069  d IPv6 address i
+00023760: 6e20 7370 6563 6966 6965 6420 7375 626e  n specified subn
+00023770: 6574 3a0a 0a20 2020 2020 2020 2020 2020  et:..           
+00023780: 2049 4e50 5554 285f 7479 7065 3d27 7465   INPUT(_type='te
+00023790: 7874 272c 205f 6e61 6d65 3d27 6e61 6d65  xt', _name='name
+000237a0: 272c 2072 6571 7569 7265 733d 4953 5f49  ', requires=IS_I
+000237b0: 5056 3628 7375 626e 6574 733d 5b27 3230  PV6(subnets=['20
+000237c0: 3031 3a3a 2f33 3227 5d29 0a0a 2020 2020  01::/32'])..    
+000237d0: 2020 2020 2020 2020 3e3e 3e20 4953 5f49          >>> IS_I
+000237e0: 5056 3628 2928 2766 6538 303a 3a31 3236  PV6()('fe80::126
+000237f0: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
+00023800: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
+00023810: 2766 6538 303a 3a31 3236 633a 3866 6661  'fe80::126c:8ffa
+00023820: 3a66 6532 323a 6233 6166 272c 204e 6f6e  :fe22:b3af', Non
+00023830: 6529 0a20 2020 2020 2020 2020 2020 203e  e).            >
+00023840: 3e3e 2049 535f 4950 5636 2829 2827 3139  >> IS_IPV6()('19
+00023850: 322e 3136 382e 312e 3127 290a 2020 2020  2.168.1.1').    
+00023860: 2020 2020 2020 2020 2827 3139 322e 3136          ('192.16
+00023870: 382e 312e 3127 2c20 2765 6e74 6572 2076  8.1.1', 'enter v
+00023880: 616c 6964 2049 5076 3620 6164 6472 6573  alid IPv6 addres
+00023890: 7327 290a 2020 2020 2020 2020 2020 2020  s').            
+000238a0: 3e3e 3e20 4953 5f49 5056 3628 6572 726f  >>> IS_IPV6(erro
+000238b0: 725f 6d65 7373 6167 653d 2742 6164 2069  r_message='Bad i
+000238c0: 7027 2928 2731 3932 2e31 3638 2e31 2e31  p')('192.168.1.1
+000238d0: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
+000238e0: 2731 3932 2e31 3638 2e31 2e31 272c 2027  '192.168.1.1', '
+000238f0: 6261 6420 6970 2729 0a20 2020 2020 2020  bad ip').       
+00023900: 2020 2020 203e 3e3e 2049 535f 4950 5636       >>> IS_IPV6
+00023910: 2869 735f 6c69 6e6b 5f6c 6f63 616c 3d54  (is_link_local=T
+00023920: 7275 6529 2827 6665 3830 3a3a 3132 3663  rue)('fe80::126c
+00023930: 3a38 6666 613a 6665 3232 3a62 3361 6627  :8ffa:fe22:b3af'
+00023940: 290a 2020 2020 2020 2020 2020 2020 2827  ).            ('
+00023950: 6665 3830 3a3a 3132 3663 3a38 6666 613a  fe80::126c:8ffa:
+00023960: 6665 3232 3a62 3361 6627 2c20 4e6f 6e65  fe22:b3af', None
+00023970: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00023980: 3e20 4953 5f49 5056 3628 6973 5f6c 696e  > IS_IPV6(is_lin
+00023990: 6b5f 6c6f 6361 6c3d 4661 6c73 6529 2827  k_local=False)('
+000239a0: 6665 3830 3a3a 3132 3663 3a38 6666 613a  fe80::126c:8ffa:
+000239b0: 6665 3232 3a62 3361 6627 290a 2020 2020  fe22:b3af').    
+000239c0: 2020 2020 2020 2020 2827 6665 3830 3a3a          ('fe80::
+000239d0: 3132 3663 3a38 6666 613a 6665 3232 3a62  126c:8ffa:fe22:b
+000239e0: 3361 6627 2c20 2765 6e74 6572 2076 616c  3af', 'enter val
+000239f0: 6964 2049 5076 3620 6164 6472 6573 7327  id IPv6 address'
+00023a00: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00023a10: 3e20 4953 5f49 5056 3628 6973 5f6c 696e  > IS_IPV6(is_lin
+00023a20: 6b5f 6c6f 6361 6c3d 5472 7565 2928 2732  k_local=True)('2
+00023a30: 3030 313a 3a31 3236 633a 3866 6661 3a66  001::126c:8ffa:f
+00023a40: 6532 323a 6233 6166 2729 0a20 2020 2020  e22:b3af').     
+00023a50: 2020 2020 2020 2028 2732 3030 313a 3a31         ('2001::1
+00023a60: 3236 633a 3866 6661 3a66 6532 323a 6233  26c:8ffa:fe22:b3
+00023a70: 6166 272c 2027 656e 7465 7220 7661 6c69  af', 'enter vali
+00023a80: 6420 4950 7636 2061 6464 7265 7373 2729  d IPv6 address')
+00023a90: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00023aa0: 2049 535f 4950 5636 2869 735f 6d75 6c74   IS_IPV6(is_mult
+00023ab0: 6963 6173 743d 5472 7565 2928 2732 3030  icast=True)('200
+00023ac0: 313a 3a31 3236 633a 3866 6661 3a66 6532  1::126c:8ffa:fe2
+00023ad0: 323a 6233 6166 2729 0a20 2020 2020 2020  2:b3af').       
+00023ae0: 2020 2020 2028 2732 3030 313a 3a31 3236       ('2001::126
+00023af0: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
+00023b00: 272c 2027 656e 7465 7220 7661 6c69 6420  ', 'enter valid 
+00023b10: 4950 7636 2061 6464 7265 7373 2729 0a20  IPv6 address'). 
+00023b20: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
+00023b30: 535f 4950 5636 2869 735f 6d75 6c74 6963  S_IPV6(is_multic
+00023b40: 6173 743d 5472 7565 2928 2766 6630 303a  ast=True)('ff00:
+00023b50: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
+00023b60: 6233 6166 2729 0a20 2020 2020 2020 2020  b3af').         
+00023b70: 2020 2028 2766 6630 303a 3a31 3236 633a     ('ff00::126c:
+00023b80: 3866 6661 3a66 6532 323a 6233 6166 272c  8ffa:fe22:b3af',
+00023b90: 204e 6f6e 6529 0a20 2020 2020 2020 2020   None).         
+00023ba0: 2020 203e 3e3e 2049 535f 4950 5636 2869     >>> IS_IPV6(i
+00023bb0: 735f 726f 7574 6561 626c 653d 5472 7565  s_routeable=True
+00023bc0: 2928 2732 3030 313a 3a31 3236 633a 3866  )('2001::126c:8f
+00023bd0: 6661 3a66 6532 323a 6233 6166 2729 0a20  fa:fe22:b3af'). 
+00023be0: 2020 2020 2020 2020 2020 2028 2732 3030             ('200
+00023bf0: 313a 3a31 3236 633a 3866 6661 3a66 6532  1::126c:8ffa:fe2
+00023c00: 323a 6233 6166 272c 204e 6f6e 6529 0a20  2:b3af', None). 
+00023c10: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
+00023c20: 535f 4950 5636 2869 735f 726f 7574 6561  S_IPV6(is_routea
+00023c30: 626c 653d 5472 7565 2928 2766 6630 303a  ble=True)('ff00:
+00023c40: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
+00023c50: 6233 6166 2729 0a20 2020 2020 2020 2020  b3af').         
+00023c60: 2020 2028 2766 6630 303a 3a31 3236 633a     ('ff00::126c:
+00023c70: 3866 6661 3a66 6532 323a 6233 6166 272c  8ffa:fe22:b3af',
+00023c80: 2027 656e 7465 7220 7661 6c69 6420 4950   'enter valid IP
+00023c90: 7636 2061 6464 7265 7373 2729 0a20 2020  v6 address').   
+00023ca0: 2020 2020 2020 2020 203e 3e3e 2049 535f           >>> IS_
+00023cb0: 4950 5636 2873 7562 6e65 7473 3d27 3230  IPV6(subnets='20
+00023cc0: 3031 3a3a 2f33 3227 2928 2732 3030 313a  01::/32')('2001:
+00023cd0: 3a38 6666 613a 6665 3232 3a62 3361 6627  :8ffa:fe22:b3af'
+00023ce0: 290a 2020 2020 2020 2020 2020 2020 2827  ).            ('
+00023cf0: 3230 3031 3a3a 3866 6661 3a66 6532 323a  2001::8ffa:fe22:
+00023d00: 6233 6166 272c 204e 6f6e 6529 0a20 2020  b3af', None).   
+00023d10: 2020 2020 2020 2020 203e 3e3e 2049 535f           >>> IS_
+00023d20: 4950 5636 2873 7562 6e65 7473 3d27 6662  IPV6(subnets='fb
+00023d30: 3030 3a3a 2f38 2729 2827 3230 3031 3a3a  00::/8')('2001::
+00023d40: 3866 6661 3a66 6532 323a 6233 6166 2729  8ffa:fe22:b3af')
+00023d50: 0a20 2020 2020 2020 2020 2020 2028 2732  .            ('2
+00023d60: 3030 313a 3a38 6666 613a 6665 3232 3a62  001::8ffa:fe22:b
+00023d70: 3361 6627 2c20 2765 6e74 6572 2076 616c  3af', 'enter val
+00023d80: 6964 2049 5076 3620 6164 6472 6573 7327  id IPv6 address'
+00023d90: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00023da0: 3e20 4953 5f49 5056 3628 7375 626e 6574  > IS_IPV6(subnet
+00023db0: 733d 5b27 6663 3030 3a3a 2f38 272c 2732  s=['fc00::/8','2
+00023dc0: 3030 313a 3a2f 3332 275d 2928 2732 3030  001::/32'])('200
+00023dd0: 313a 3a38 6666 613a 6665 3232 3a62 3361  1::8ffa:fe22:b3a
+00023de0: 6627 290a 2020 2020 2020 2020 2020 2020  f').            
+00023df0: 2827 3230 3031 3a3a 3866 6661 3a66 6532  ('2001::8ffa:fe2
+00023e00: 323a 6233 6166 272c 204e 6f6e 6529 0a20  2:b3af', None). 
+00023e10: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
+00023e20: 535f 4950 5636 2873 7562 6e65 7473 3d27  S_IPV6(subnets='
+00023e30: 696e 7661 6c69 6473 7562 6e65 7427 2928  invalidsubnet')(
+00023e40: 2732 3030 313a 3a38 6666 613a 6665 3232  '2001::8ffa:fe22
+00023e50: 3a62 3361 6627 290a 2020 2020 2020 2020  :b3af').        
+00023e60: 2020 2020 2827 3230 3031 3a3a 3866 6661      ('2001::8ffa
+00023e70: 3a66 6532 323a 6233 6166 272c 2027 696e  :fe22:b3af', 'in
+00023e80: 7661 6c69 6420 7375 626e 6574 2070 726f  valid subnet pro
+00023e90: 7669 6465 6427 290a 0a20 2020 2022 2222  vided')..    """
+00023ea0: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+00023eb0: 5f5f 280a 2020 2020 2020 2020 7365 6c66  __(.        self
+00023ec0: 2c0a 2020 2020 2020 2020 6973 5f70 7269  ,.        is_pri
+00023ed0: 7661 7465 3d4e 6f6e 652c 0a20 2020 2020  vate=None,.     
+00023ee0: 2020 2069 735f 6c69 6e6b 5f6c 6f63 616c     is_link_local
+00023ef0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2069  =None,.        i
+00023f00: 735f 7265 7365 7276 6564 3d4e 6f6e 652c  s_reserved=None,
+00023f10: 0a20 2020 2020 2020 2069 735f 6d75 6c74  .        is_mult
+00023f20: 6963 6173 743d 4e6f 6e65 2c0a 2020 2020  icast=None,.    
+00023f30: 2020 2020 6973 5f72 6f75 7465 6162 6c65      is_routeable
+00023f40: 3d4e 6f6e 652c 0a20 2020 2020 2020 2069  =None,.        i
+00023f50: 735f 3674 6f34 3d4e 6f6e 652c 0a20 2020  s_6to4=None,.   
+00023f60: 2020 2020 2069 735f 7465 7265 646f 3d4e       is_teredo=N
+00023f70: 6f6e 652c 0a20 2020 2020 2020 2073 7562  one,.        sub
+00023f80: 6e65 7473 3d4e 6f6e 652c 0a20 2020 2020  nets=None,.     
+00023f90: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00023fa0: 3d22 456e 7465 7220 7661 6c69 6420 4950  ="Enter valid IP
+00023fb0: 7636 2061 6464 7265 7373 222c 0a20 2020  v6 address",.   
+00023fc0: 2029 3a0a 0a20 2020 2020 2020 2073 656c   ):..        sel
+00023fd0: 662e 6973 5f70 7269 7661 7465 203d 2069  f.is_private = i
+00023fe0: 735f 7072 6976 6174 650a 2020 2020 2020  s_private.      
+00023ff0: 2020 7365 6c66 2e69 735f 6c69 6e6b 5f6c    self.is_link_l
+00024000: 6f63 616c 203d 2069 735f 6c69 6e6b 5f6c  ocal = is_link_l
+00024010: 6f63 616c 0a20 2020 2020 2020 2073 656c  ocal.        sel
+00024020: 662e 6973 5f72 6573 6572 7665 6420 3d20  f.is_reserved = 
+00024030: 6973 5f72 6573 6572 7665 640a 2020 2020  is_reserved.    
+00024040: 2020 2020 7365 6c66 2e69 735f 6d75 6c74      self.is_mult
+00024050: 6963 6173 7420 3d20 6973 5f6d 756c 7469  icast = is_multi
+00024060: 6361 7374 0a20 2020 2020 2020 2073 656c  cast.        sel
+00024070: 662e 6973 5f72 6f75 7465 6162 6c65 203d  f.is_routeable =
+00024080: 2069 735f 726f 7574 6561 626c 650a 2020   is_routeable.  
+00024090: 2020 2020 2020 7365 6c66 2e69 735f 3674        self.is_6t
+000240a0: 6f34 203d 2069 735f 3674 6f34 0a20 2020  o4 = is_6to4.   
+000240b0: 2020 2020 2073 656c 662e 6973 5f74 6572       self.is_ter
+000240c0: 6564 6f20 3d20 6973 5f74 6572 6564 6f0a  edo = is_teredo.
+000240d0: 2020 2020 2020 2020 7365 6c66 2e73 7562          self.sub
+000240e0: 6e65 7473 203d 2073 7562 6e65 7473 0a20  nets = subnets. 
+000240f0: 2020 2020 2020 2073 656c 662e 6572 726f         self.erro
+00024100: 725f 6d65 7373 6167 6520 3d20 6572 726f  r_message = erro
+00024110: 725f 6d65 7373 6167 650a 0a20 2020 2064  r_message..    d
+00024120: 6566 2076 616c 6964 6174 6528 7365 6c66  ef validate(self
+00024130: 2c20 7661 6c75 652c 2072 6563 6f72 645f  , value, record_
+00024140: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
+00024150: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00024160: 2020 2069 7020 3d20 6970 6164 6472 6573     ip = ipaddres
+00024170: 732e 4950 7636 4164 6472 6573 7328 746f  s.IPv6Address(to
+00024180: 5f75 6e69 636f 6465 2876 616c 7565 2929  _unicode(value))
+00024190: 0a20 2020 2020 2020 2020 2020 206f 6b20  .            ok 
+000241a0: 3d20 5472 7565 0a20 2020 2020 2020 2065  = True.        e
+000241b0: 7863 6570 7420 6970 6164 6472 6573 732e  xcept ipaddress.
+000241c0: 4164 6472 6573 7356 616c 7565 4572 726f  AddressValueErro
+000241d0: 723a 0a20 2020 2020 2020 2020 2020 2072  r:.            r
+000241e0: 6169 7365 2056 616c 6964 6174 696f 6e45  aise ValidationE
+000241f0: 7272 6f72 2873 656c 662e 7472 616e 736c  rror(self.transl
+00024200: 6174 6f72 2873 656c 662e 6572 726f 725f  ator(self.error_
+00024210: 6d65 7373 6167 6529 290a 0a20 2020 2020  message))..     
+00024220: 2020 2069 6620 7365 6c66 2e73 7562 6e65     if self.subne
+00024230: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
+00024240: 2320 6974 6572 6174 6520 7468 726f 7567  # iterate throug
+00024250: 6820 7365 6c66 2e73 7562 6e65 7473 2074  h self.subnets t
+00024260: 6f20 7365 6520 6966 2076 616c 7565 2069  o see if value i
+00024270: 7320 6120 6d65 6d62 6572 0a20 2020 2020  s a member.     
+00024280: 2020 2020 2020 206f 6b20 3d20 4661 6c73         ok = Fals
+00024290: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
+000242a0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+000242b0: 2e73 7562 6e65 7473 2c20 7374 7229 3a0a  .subnets, str):.
+000242c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000242d0: 7365 6c66 2e73 7562 6e65 7473 203d 205b  self.subnets = [
+000242e0: 7365 6c66 2e73 7562 6e65 7473 5d0a 2020  self.subnets].  
+000242f0: 2020 2020 2020 2020 2020 666f 7220 6e65            for ne
+00024300: 7477 6f72 6b20 696e 2073 656c 662e 7375  twork in self.su
+00024310: 626e 6574 733a 0a20 2020 2020 2020 2020  bnets:.         
+00024320: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
 00024330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024340: 2020 2020 6970 6e65 7420 3d20 6970 6164      ipnet = ipad
-00024350: 6472 6573 732e 4950 7636 4e65 7477 6f72  dress.IPv6Networ
-00024360: 6b28 746f 5f75 6e69 636f 6465 286e 6574  k(to_unicode(net
-00024370: 776f 726b 2929 0a20 2020 2020 2020 2020  work)).         
-00024380: 2020 2020 2020 2065 7863 6570 7420 2869         except (i
-00024390: 7061 6464 7265 7373 2e4e 6574 6d61 736b  paddress.Netmask
-000243a0: 5661 6c75 6545 7272 6f72 2c20 6970 6164  ValueError, ipad
-000243b0: 6472 6573 732e 4164 6472 6573 7356 616c  dress.AddressVal
-000243c0: 7565 4572 726f 7229 3a0a 2020 2020 2020  ueError):.      
-000243d0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000243e0: 6973 6520 5661 6c69 6461 7469 6f6e 4572  ise ValidationEr
-000243f0: 726f 7228 7365 6c66 2e74 7261 6e73 6c61  ror(self.transla
-00024400: 746f 7228 2269 6e76 616c 6964 2073 7562  tor("invalid sub
-00024410: 6e65 7420 7072 6f76 6964 6564 2229 290a  net provided")).
-00024420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024430: 6966 2069 7020 696e 2069 706e 6574 3a0a  if ip in ipnet:.
+00024340: 6970 6e65 7420 3d20 6970 6164 6472 6573  ipnet = ipaddres
+00024350: 732e 4950 7636 4e65 7477 6f72 6b28 746f  s.IPv6Network(to
+00024360: 5f75 6e69 636f 6465 286e 6574 776f 726b  _unicode(network
+00024370: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00024380: 2020 2065 7863 6570 7420 2869 7061 6464     except (ipadd
+00024390: 7265 7373 2e4e 6574 6d61 736b 5661 6c75  ress.NetmaskValu
+000243a0: 6545 7272 6f72 2c20 6970 6164 6472 6573  eError, ipaddres
+000243b0: 732e 4164 6472 6573 7356 616c 7565 4572  s.AddressValueEr
+000243c0: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
+000243d0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000243e0: 5661 6c69 6461 7469 6f6e 4572 726f 7228  ValidationError(
+000243f0: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
+00024400: 2269 6e76 616c 6964 2073 7562 6e65 7420  "invalid subnet 
+00024410: 7072 6f76 6964 6564 2229 290a 2020 2020  provided")).    
+00024420: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00024430: 7020 696e 2069 706e 6574 3a0a 2020 2020  p in ipnet:.    
 00024440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024450: 2020 2020 6f6b 203d 2054 7275 650a 0a20      ok = True.. 
-00024460: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
-00024470: 735f 726f 7574 6561 626c 653a 0a20 2020  s_routeable:.   
-00024480: 2020 2020 2020 2020 2073 656c 662e 6973           self.is
-00024490: 5f70 7269 7661 7465 203d 2046 616c 7365  _private = False
-000244a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000244b0: 662e 6973 5f72 6573 6572 7665 6420 3d20  f.is_reserved = 
-000244c0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-000244d0: 2020 7365 6c66 2e69 735f 6d75 6c74 6963    self.is_multic
-000244e0: 6173 7420 3d20 4661 6c73 650a 0a20 2020  ast = False..   
-000244f0: 2020 2020 2069 6620 6f6b 2061 6e64 2073       if ok and s
-00024500: 656c 662e 6973 5f70 7269 7661 7465 2069  elf.is_private i
-00024510: 7320 6e6f 7420 4e6f 6e65 2061 6e64 2073  s not None and s
-00024520: 656c 662e 6973 5f70 7269 7661 7465 2021  elf.is_private !
-00024530: 3d20 6970 2e69 735f 7072 6976 6174 653a  = ip.is_private:
-00024540: 0a20 2020 2020 2020 2020 2020 206f 6b20  .            ok 
-00024550: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-00024560: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
-00024570: 206f 6b0a 2020 2020 2020 2020 2020 2020   ok.            
-00024580: 616e 6420 7365 6c66 2e69 735f 6c69 6e6b  and self.is_link
-00024590: 5f6c 6f63 616c 2069 7320 6e6f 7420 4e6f  _local is not No
-000245a0: 6e65 0a20 2020 2020 2020 2020 2020 2061  ne.            a
-000245b0: 6e64 2073 656c 662e 6973 5f6c 696e 6b5f  nd self.is_link_
-000245c0: 6c6f 6361 6c20 213d 2069 702e 6973 5f6c  local != ip.is_l
-000245d0: 696e 6b5f 6c6f 6361 6c0a 2020 2020 2020  ink_local.      
-000245e0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-000245f0: 206f 6b20 3d20 4661 6c73 650a 2020 2020   ok = False.    
-00024600: 2020 2020 6966 206f 6b20 616e 6420 7365      if ok and se
-00024610: 6c66 2e69 735f 7265 7365 7276 6564 2069  lf.is_reserved i
-00024620: 7320 6e6f 7420 4e6f 6e65 2061 6e64 2073  s not None and s
-00024630: 656c 662e 6973 5f72 6573 6572 7665 6420  elf.is_reserved 
-00024640: 213d 2069 702e 6973 5f72 6573 6572 7665  != ip.is_reserve
-00024650: 643a 0a20 2020 2020 2020 2020 2020 206f  d:.            o
-00024660: 6b20 3d20 4661 6c73 650a 2020 2020 2020  k = False.      
-00024670: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
-00024680: 2020 206f 6b0a 2020 2020 2020 2020 2020     ok.          
-00024690: 2020 616e 6420 7365 6c66 2e69 735f 6d75    and self.is_mu
-000246a0: 6c74 6963 6173 7420 6973 206e 6f74 204e  lticast is not N
-000246b0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-000246c0: 616e 6420 7365 6c66 2e69 735f 6d75 6c74  and self.is_mult
-000246d0: 6963 6173 7420 213d 2069 702e 6973 5f6d  icast != ip.is_m
-000246e0: 756c 7469 6361 7374 0a20 2020 2020 2020  ulticast.       
-000246f0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-00024700: 6f6b 203d 2046 616c 7365 0a20 2020 2020  ok = False.     
-00024710: 2020 2069 6620 6f6b 2061 6e64 2073 656c     if ok and sel
-00024720: 662e 6973 5f36 746f 3420 6973 206e 6f74  f.is_6to4 is not
-00024730: 204e 6f6e 6520 616e 6420 7365 6c66 2e69   None and self.i
-00024740: 735f 3674 6f34 2021 3d20 626f 6f6c 2869  s_6to4 != bool(i
-00024750: 702e 7369 7874 6f66 6f75 7229 3a0a 2020  p.sixtofour):.  
-00024760: 2020 2020 2020 2020 2020 6f6b 203d 2046            ok = F
-00024770: 616c 7365 0a20 2020 2020 2020 2069 6620  alse.        if 
-00024780: 6f6b 2061 6e64 2073 656c 662e 6973 5f74  ok and self.is_t
-00024790: 6572 6564 6f20 6973 206e 6f74 204e 6f6e  eredo is not Non
-000247a0: 6520 616e 6420 7365 6c66 2e69 735f 7465  e and self.is_te
-000247b0: 7265 646f 2021 3d20 626f 6f6c 2869 702e  redo != bool(ip.
-000247c0: 7465 7265 646f 293a 0a20 2020 2020 2020  teredo):.       
-000247d0: 2020 2020 206f 6b20 3d20 4661 6c73 650a       ok = False.
-000247e0: 0a20 2020 2020 2020 2069 6620 6f6b 3a0a  .        if ok:.
-000247f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00024800: 726e 2076 616c 7565 0a0a 2020 2020 2020  rn value..      
-00024810: 2020 7261 6973 6520 5661 6c69 6461 7469    raise Validati
-00024820: 6f6e 4572 726f 7228 7365 6c66 2e74 7261  onError(self.tra
-00024830: 6e73 6c61 746f 7228 7365 6c66 2e65 7272  nslator(self.err
-00024840: 6f72 5f6d 6573 7361 6765 2929 0a0a 0a63  or_message))...c
-00024850: 6c61 7373 2049 535f 4950 4144 4452 4553  lass IS_IPADDRES
-00024860: 5328 5661 6c69 6461 746f 7229 3a0a 2020  S(Validator):.  
-00024870: 2020 2222 220a 2020 2020 4368 6563 6b73    """.    Checks
-00024880: 2069 6620 6669 656c 6427 7320 7661 6c75   if field's valu
-00024890: 6520 6973 2061 6e20 4950 2041 6464 7265  e is an IP Addre
-000248a0: 7373 2028 7634 206f 7220 7636 292e 2043  ss (v4 or v6). C
-000248b0: 616e 2062 6520 7365 7420 746f 2066 6f72  an be set to for
-000248c0: 6365 0a20 2020 2061 6464 7265 7373 6573  ce.    addresses
-000248d0: 2066 726f 6d20 7769 7468 696e 2061 2073   from within a s
-000248e0: 7065 6369 6669 6320 7261 6e67 652e 2043  pecific range. C
-000248f0: 6865 636b 7320 6172 6520 646f 6e65 2077  hecks are done w
-00024900: 6974 6820 7468 6520 636f 7272 6563 740a  ith the correct.
-00024910: 2020 2020 4953 5f49 5056 3420 616e 6420      IS_IPV4 and 
-00024920: 4953 5f49 5056 3620 7661 6c69 6461 746f  IS_IPV6 validato
-00024930: 7273 2e0a 0a20 2020 2055 7365 7320 7468  rs...    Uses th
-00024940: 6520 6970 6164 6472 6573 7320 6672 6f6d  e ipaddress from
-00024950: 2074 6865 2050 7974 686f 6e20 3320 7374   the Python 3 st
-00024960: 616e 6461 7264 206c 6962 7261 7279 0a20  andard library. 
-00024970: 2020 2061 6e64 2069 7473 2050 7974 686f     and its Pytho
-00024980: 6e20 3220 6261 636b 706f 7274 2028 696e  n 2 backport (in
-00024990: 2063 6f6e 7472 6962 2f69 7061 6464 7265   contrib/ipaddre
-000249a0: 7373 2e70 7929 2e0a 0a20 2020 2041 7267  ss.py)...    Arg
-000249b0: 733a 0a20 2020 2020 2020 206d 696e 6970  s:.        minip
-000249c0: 3a20 6c6f 7765 7374 2061 6c6c 6f77 6564  : lowest allowed
-000249d0: 2061 6464 7265 7373 3b20 6163 6365 7074   address; accept
-000249e0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-000249f0: 2020 7374 722c 2065 672e 2031 3932 2e31    str, eg. 192.1
-00024a00: 3638 2e30 2e31 0a20 2020 2020 2020 2020  68.0.1.         
-00024a10: 2020 2020 2020 6c69 7374 206f 7220 7475        list or tu
-00024a20: 706c 6520 6f66 206f 6374 6574 732c 2065  ple of octets, e
-00024a30: 672e 205b 3139 322c 2031 3638 2c20 302c  g. [192, 168, 0,
-00024a40: 2031 5d0a 2020 2020 2020 2020 6d61 7869   1].        maxi
-00024a50: 703a 2068 6967 6865 7374 2061 6c6c 6f77  p: highest allow
-00024a60: 6564 2061 6464 7265 7373 3b20 7361 6d65  ed address; same
-00024a70: 2061 7320 6162 6f76 650a 2020 2020 2020   as above.      
-00024a80: 2020 696e 7665 7274 3a20 5472 7565 2074    invert: True t
-00024a90: 6f20 616c 6c6f 7720 6164 6472 6573 7365  o allow addresse
-00024aa0: 7320 6f6e 6c79 2066 726f 6d20 6f75 7473  s only from outs
-00024ab0: 6964 6520 6f66 2067 6976 656e 2072 616e  ide of given ran
-00024ac0: 6765 3b20 6e6f 7465 0a20 2020 2020 2020  ge; note.       
-00024ad0: 2020 2020 2020 2020 2074 6861 7420 7261           that ra
-00024ae0: 6e67 6520 626f 756e 6461 7269 6573 2061  nge boundaries a
-00024af0: 7265 206e 6f74 206d 6174 6368 6564 2074  re not matched t
-00024b00: 6869 7320 7761 790a 0a20 2020 2049 5076  his way..    IPv
-00024b10: 3420 7370 6563 6966 6963 2061 7267 756d  4 specific argum
-00024b20: 656e 7473 3a0a 0a20 2020 2020 2020 202d  ents:..        -
-00024b30: 2069 735f 6c6f 6361 6c68 6f73 743a 206c   is_localhost: l
-00024b40: 6f63 616c 686f 7374 2061 6464 7265 7373  ocalhost address
-00024b50: 2074 7265 6174 6d65 6e74 3a0a 0a20 2020   treatment:..   
-00024b60: 2020 2020 2020 2020 202d 204e 6f6e 6520           - None 
-00024b70: 2864 6566 6175 6c74 293a 2069 6e64 6966  (default): indif
-00024b80: 6665 7265 6e74 0a20 2020 2020 2020 2020  ferent.         
-00024b90: 2020 202d 2054 7275 6520 2865 6e66 6f72     - True (enfor
-00024ba0: 6365 293a 2071 7565 7279 2061 6464 7265  ce): query addre
-00024bb0: 7373 206d 7573 7420 6d61 7463 6820 6c6f  ss must match lo
-00024bc0: 6361 6c68 6f73 7420 6164 6472 6573 730a  calhost address.
-00024bd0: 2020 2020 2020 2020 2020 2020 2020 2831                (1
-00024be0: 3237 2e30 2e30 2e31 290a 2020 2020 2020  27.0.0.1).      
-00024bf0: 2020 2020 2020 2d20 4661 6c73 6520 2866        - False (f
-00024c00: 6f72 6269 6429 3a20 7175 6572 7920 6164  orbid): query ad
-00024c10: 6472 6573 7320 6d75 7374 206e 6f74 206d  dress must not m
-00024c20: 6174 6368 206c 6f63 616c 686f 7374 2061  atch localhost a
-00024c30: 6464 7265 7373 0a20 2020 2020 2020 202d  ddress.        -
-00024c40: 2069 735f 7072 6976 6174 653a 2073 616d   is_private: sam
-00024c50: 6520 6173 2061 626f 7665 2c20 6578 6365  e as above, exce
-00024c60: 7074 2074 6861 7420 7175 6572 7920 6164  pt that query ad
-00024c70: 6472 6573 7320 6973 2063 6865 636b 6564  dress is checked
-00024c80: 2061 6761 696e 7374 0a20 2020 2020 2020   against.       
-00024c90: 2020 2074 776f 2061 6464 7265 7373 2072     two address r
-00024ca0: 616e 6765 733a 2031 3732 2e31 362e 302e  anges: 172.16.0.
-00024cb0: 3020 2d20 3137 322e 3331 2e32 3535 2e32  0 - 172.31.255.2
-00024cc0: 3535 2061 6e64 0a20 2020 2020 2020 2020  55 and.         
-00024cd0: 2031 3932 2e31 3638 2e30 2e30 202d 2031   192.168.0.0 - 1
-00024ce0: 3932 2e31 3638 2e32 3535 2e32 3535 0a20  92.168.255.255. 
-00024cf0: 2020 2020 2020 202d 2069 735f 6175 746f         - is_auto
-00024d00: 6d61 7469 633a 2073 616d 6520 6173 2061  matic: same as a
-00024d10: 626f 7665 2c20 6578 6365 7074 2074 6861  bove, except tha
-00024d20: 7420 7175 6572 7920 6164 6472 6573 7320  t query address 
-00024d30: 6973 2063 6865 636b 6564 2061 6761 696e  is checked again
-00024d40: 7374 0a20 2020 2020 2020 2020 206f 6e65  st.          one
-00024d50: 2061 6464 7265 7373 2072 616e 6765 3a20   address range: 
-00024d60: 3136 392e 3235 342e 302e 3020 2d20 3136  169.254.0.0 - 16
-00024d70: 392e 3235 342e 3235 352e 3235 350a 2020  9.254.255.255.  
-00024d80: 2020 2020 2020 2d20 6973 5f69 7076 343a        - is_ipv4:
-00024d90: 2065 6974 6865 723a 0a0a 2020 2020 2020   either:..      
-00024da0: 2020 2020 2020 2d20 4e6f 6e65 2028 6465        - None (de
-00024db0: 6661 756c 7429 3a20 696e 6469 6666 6572  fault): indiffer
-00024dc0: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
-00024dd0: 2d20 5472 7565 2028 656e 666f 7263 6529  - True (enforce)
-00024de0: 3a20 6d75 7374 2062 6520 616e 2049 5076  : must be an IPv
-00024df0: 3420 6164 6472 6573 730a 2020 2020 2020  4 address.      
-00024e00: 2020 2020 2020 2d20 4661 6c73 6520 2866        - False (f
-00024e10: 6f72 6269 6429 3a20 6d75 7374 204e 4f54  orbid): must NOT
-00024e20: 2062 6520 616e 2049 5076 3420 6164 6472   be an IPv4 addr
-00024e30: 6573 730a 0a20 2020 2049 5076 3620 7370  ess..    IPv6 sp
-00024e40: 6563 6966 6963 2061 7267 756d 656e 7473  ecific arguments
-00024e50: 3a0a 0a20 2020 2020 2020 202d 2069 735f  :..        - is_
-00024e60: 6c69 6e6b 5f6c 6f63 616c 3a20 5361 6d65  link_local: Same
-00024e70: 2061 7320 6162 6f76 6520 6275 7420 7573   as above but us
-00024e80: 6573 2066 6538 303a 3a2f 3130 2072 616e  es fe80::/10 ran
-00024e90: 6765 0a20 2020 2020 2020 202d 2069 735f  ge.        - is_
-00024ea0: 7265 7365 7276 6564 3a20 5361 6d65 2061  reserved: Same a
-00024eb0: 7320 6162 6f76 6520 6275 7420 7573 6573  s above but uses
-00024ec0: 2049 4554 4620 7265 7365 7276 6564 2072   IETF reserved r
-00024ed0: 616e 6765 0a20 2020 2020 2020 202d 2069  ange.        - i
-00024ee0: 735f 6d75 6c74 6963 6173 743a 2053 616d  s_multicast: Sam
-00024ef0: 6520 6173 2061 626f 7665 2062 7574 2075  e as above but u
-00024f00: 7365 7320 6666 3030 3a3a 2f38 2072 616e  ses ff00::/8 ran
-00024f10: 6765 0a20 2020 2020 2020 202d 2069 735f  ge.        - is_
-00024f20: 726f 7574 6561 626c 653a 2053 696d 696c  routeable: Simil
-00024f30: 6172 2074 6f20 6162 6f76 6520 6275 7420  ar to above but 
-00024f40: 656e 666f 7263 6573 206e 6f74 2070 7269  enforces not pri
-00024f50: 7661 7465 2c20 6c69 6e6b 5f6c 6f63 616c  vate, link_local
-00024f60: 2c0a 2020 2020 2020 2020 2020 7265 7365  ,.          rese
-00024f70: 7276 6564 206f 7220 6d75 6c74 6963 6173  rved or multicas
-00024f80: 740a 2020 2020 2020 2020 2d20 6973 5f36  t.        - is_6
-00024f90: 746f 343a 2053 616d 6520 6173 2061 626f  to4: Same as abo
-00024fa0: 7665 2062 7574 2075 7365 7320 3230 3032  ve but uses 2002
-00024fb0: 3a3a 2f31 3620 7261 6e67 650a 2020 2020  ::/16 range.    
-00024fc0: 2020 2020 2d20 6973 5f74 6572 6564 6f3a      - is_teredo:
-00024fd0: 2053 616d 6520 6173 2061 626f 7665 2062   Same as above b
-00024fe0: 7574 2075 7365 7320 3230 3031 3a3a 2f33  ut uses 2001::/3
-00024ff0: 3220 7261 6e67 650a 2020 2020 2020 2020  2 range.        
-00025000: 2d20 7375 626e 6574 733a 2076 616c 7565  - subnets: value
-00025010: 206d 7573 7420 6265 2061 206d 656d 6265   must be a membe
-00025020: 7220 6f66 2061 7420 6c65 6173 7420 6f6e  r of at least on
-00025030: 6520 6672 6f6d 206c 6973 7420 6f66 2073  e from list of s
-00025040: 7562 6e65 7473 0a20 2020 2020 2020 202d  ubnets.        -
-00025050: 2069 735f 6970 7636 3a20 6569 7468 6572   is_ipv6: either
-00025060: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
-00025070: 204e 6f6e 6520 2864 6566 6175 6c74 293a   None (default):
-00025080: 2069 6e64 6966 6665 7265 6e74 0a20 2020   indifferent.   
-00025090: 2020 2020 2020 2020 202d 2054 7275 6520           - True 
-000250a0: 2865 6e66 6f72 6365 293a 206d 7573 7420  (enforce): must 
-000250b0: 6265 2061 6e20 4950 7636 2061 6464 7265  be an IPv6 addre
-000250c0: 7373 0a20 2020 2020 2020 2020 2020 202d  ss.            -
-000250d0: 2046 616c 7365 2028 666f 7262 6964 293a   False (forbid):
-000250e0: 206d 7573 7420 4e4f 5420 6265 2061 6e20   must NOT be an 
-000250f0: 4950 7636 2061 6464 7265 7373 0a0a 2020  IPv6 address..  
-00025100: 2020 4d69 6e69 7020 616e 6420 6d61 7869    Minip and maxi
-00025110: 7020 6d61 7920 616c 736f 2062 6520 6c69  p may also be li
-00025120: 7374 7320 6f72 2074 7570 6c65 7320 6f66  sts or tuples of
-00025130: 2061 6464 7265 7373 6573 2069 6e20 616c   addresses in al
-00025140: 6c20 6162 6f76 650a 2020 2020 666f 726d  l above.    form
-00025150: 7320 2873 7472 2c20 696e 742c 206c 6973  s (str, int, lis
-00025160: 7420 2f20 7475 706c 6529 2c20 616c 6c6f  t / tuple), allo
-00025170: 7769 6e67 2073 6574 7570 206f 6620 6d75  wing setup of mu
-00025180: 6c74 6970 6c65 2061 6464 7265 7373 2072  ltiple address r
-00025190: 616e 6765 733a 3a0a 0a20 2020 2020 2020  anges::..       
-000251a0: 206d 696e 6970 203d 2028 6d69 6e69 7031   minip = (minip1
-000251b0: 2c20 6d69 6e69 7032 2c20 2e2e 2e20 6d69  , minip2, ... mi
-000251c0: 6e69 704e 290a 2020 2020 2020 2020 2020  nipN).          
-000251d0: 2020 2020 2020 2020 207c 2020 2020 2020           |      
-000251e0: 207c 2020 2020 2020 2020 2020 207c 0a20   |           |. 
-000251f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025200: 2020 7c20 2020 2020 2020 7c20 2020 2020    |       |     
-00025210: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00025220: 6d61 7869 7020 3d20 286d 6178 6970 312c  maxip = (maxip1,
-00025230: 206d 6178 6970 322c 202e 2e2e 206d 6178   maxip2, ... max
-00025240: 6970 4e29 0a0a 2020 2020 4c6f 6e67 6572  ipN)..    Longer
-00025250: 2069 7465 7261 626c 6520 7769 6c6c 2062   iterable will b
-00025260: 6520 7472 756e 6361 7465 6420 746f 206d  e truncated to m
-00025270: 6174 6368 206c 656e 6774 6820 6f66 2073  atch length of s
-00025280: 686f 7274 6572 206f 6e65 2e0a 0a20 2020  horter one...   
-00025290: 2020 2020 203e 3e3e 2049 535f 4950 4144       >>> IS_IPAD
-000252a0: 4452 4553 5328 2928 2731 3932 2e31 3638  DRESS()('192.168
-000252b0: 2e31 2e35 2729 0a20 2020 2020 2020 2028  .1.5').        (
-000252c0: 2731 3932 2e31 3638 2e31 2e35 272c 204e  '192.168.1.5', N
-000252d0: 6f6e 6529 0a20 2020 2020 2020 203e 3e3e  one).        >>>
-000252e0: 2049 535f 4950 4144 4452 4553 5328 6973   IS_IPADDRESS(is
-000252f0: 5f69 7076 363d 4661 6c73 6529 2827 3139  _ipv6=False)('19
-00025300: 322e 3136 382e 312e 3527 290a 2020 2020  2.168.1.5').    
-00025310: 2020 2020 2827 3139 322e 3136 382e 312e      ('192.168.1.
-00025320: 3527 2c20 4e6f 6e65 290a 2020 2020 2020  5', None).      
-00025330: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
-00025340: 5353 2829 2827 3235 352e 3235 352e 3235  SS()('255.255.25
-00025350: 352e 3235 3527 290a 2020 2020 2020 2020  5.255').        
-00025360: 2827 3235 352e 3235 352e 3235 352e 3235  ('255.255.255.25
-00025370: 3527 2c20 4e6f 6e65 290a 2020 2020 2020  5', None).      
-00025380: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
-00025390: 5353 2829 2827 3139 322e 3136 382e 312e  SS()('192.168.1.
-000253a0: 3520 2729 0a20 2020 2020 2020 2028 2731  5 ').        ('1
-000253b0: 3932 2e31 3638 2e31 2e35 2027 2c20 2765  92.168.1.5 ', 'e
-000253c0: 6e74 6572 2076 616c 6964 2049 5020 6164  nter valid IP ad
-000253d0: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
-000253e0: 3e3e 3e20 4953 5f49 5041 4444 5245 5353  >>> IS_IPADDRESS
-000253f0: 2829 2827 3139 322e 3136 382e 312e 312e  ()('192.168.1.1.
-00025400: 3527 290a 2020 2020 2020 2020 2827 3139  5').        ('19
-00025410: 322e 3136 382e 312e 312e 3527 2c20 2765  2.168.1.1.5', 'e
-00025420: 6e74 6572 2076 616c 6964 2049 5020 6164  nter valid IP ad
-00025430: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
-00025440: 3e3e 3e20 4953 5f49 5041 4444 5245 5353  >>> IS_IPADDRESS
-00025450: 2829 2827 3132 332e 3132 3327 290a 2020  ()('123.123').  
-00025460: 2020 2020 2020 2827 3132 332e 3132 3327        ('123.123'
-00025470: 2c20 2765 6e74 6572 2076 616c 6964 2049  , 'enter valid I
-00025480: 5020 6164 6472 6573 7327 290a 2020 2020  P address').    
-00025490: 2020 2020 3e3e 3e20 4953 5f49 5041 4444      >>> IS_IPADD
-000254a0: 5245 5353 2829 2827 3131 3131 2e32 2e33  RESS()('1111.2.3
-000254b0: 2e34 2729 0a20 2020 2020 2020 2028 2731  .4').        ('1
-000254c0: 3131 312e 322e 332e 3427 2c20 2765 6e74  111.2.3.4', 'ent
-000254d0: 6572 2076 616c 6964 2049 5020 6164 6472  er valid IP addr
-000254e0: 6573 7327 290a 2020 2020 2020 2020 3e3e  ess').        >>
-000254f0: 3e20 4953 5f49 5041 4444 5245 5353 2829  > IS_IPADDRESS()
-00025500: 2827 3031 3131 2e32 2e33 2e34 2729 0a20  ('0111.2.3.4'). 
-00025510: 2020 2020 2020 2028 2730 3131 312e 322e         ('0111.2.
-00025520: 332e 3427 2c20 2765 6e74 6572 2076 616c  3.4', 'enter val
-00025530: 6964 2049 5020 6164 6472 6573 7327 290a  id IP address').
-00025540: 2020 2020 2020 2020 3e3e 3e20 4953 5f49          >>> IS_I
-00025550: 5041 4444 5245 5353 2829 2827 3235 362e  PADDRESS()('256.
-00025560: 322e 332e 3427 290a 2020 2020 2020 2020  2.3.4').        
-00025570: 2827 3235 362e 322e 332e 3427 2c20 2765  ('256.2.3.4', 'e
-00025580: 6e74 6572 2076 616c 6964 2049 5020 6164  nter valid IP ad
-00025590: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
-000255a0: 3e3e 3e20 4953 5f49 5041 4444 5245 5353  >>> IS_IPADDRESS
-000255b0: 2829 2827 3330 302e 322e 332e 3427 290a  ()('300.2.3.4').
-000255c0: 2020 2020 2020 2020 2827 3330 302e 322e          ('300.2.
-000255d0: 332e 3427 2c20 2765 6e74 6572 2076 616c  3.4', 'enter val
-000255e0: 6964 2049 5020 6164 6472 6573 7327 290a  id IP address').
-000255f0: 2020 2020 2020 2020 3e3e 3e20 4953 5f49          >>> IS_I
-00025600: 5041 4444 5245 5353 286d 696e 6970 3d27  PADDRESS(minip='
-00025610: 3139 322e 3136 382e 312e 3027 2c20 6d61  192.168.1.0', ma
-00025620: 7869 703d 2731 3932 2e31 3638 2e31 2e32  xip='192.168.1.2
-00025630: 3535 2729 2827 3139 322e 3136 382e 312e  55')('192.168.1.
-00025640: 3130 3027 290a 2020 2020 2020 2020 2827  100').        ('
-00025650: 3139 322e 3136 382e 312e 3130 3027 2c20  192.168.1.100', 
-00025660: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
-00025670: 3e20 4953 5f49 5041 4444 5245 5353 286d  > IS_IPADDRESS(m
-00025680: 696e 6970 3d27 312e 322e 332e 3527 2c20  inip='1.2.3.5', 
-00025690: 6d61 7869 703d 2731 2e32 2e33 2e39 272c  maxip='1.2.3.9',
-000256a0: 2065 7272 6f72 5f6d 6573 7361 6765 3d27   error_message='
-000256b0: 4261 6420 6970 2729 2827 312e 322e 332e  Bad ip')('1.2.3.
-000256c0: 3427 290a 2020 2020 2020 2020 2827 312e  4').        ('1.
-000256d0: 322e 332e 3427 2c20 2762 6164 2069 7027  2.3.4', 'bad ip'
-000256e0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
-000256f0: 5f49 5041 4444 5245 5353 286d 6178 6970  _IPADDRESS(maxip
-00025700: 3d27 312e 322e 332e 3427 2c20 696e 7665  ='1.2.3.4', inve
-00025710: 7274 3d54 7275 6529 2827 3132 372e 302e  rt=True)('127.0.
-00025720: 302e 3127 290a 2020 2020 2020 2020 2827  0.1').        ('
-00025730: 3132 372e 302e 302e 3127 2c20 4e6f 6e65  127.0.0.1', None
-00025740: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
-00025750: 5f49 5041 4444 5245 5353 286d 6178 6970  _IPADDRESS(maxip
-00025760: 3d27 3139 322e 3136 382e 312e 3427 2c20  ='192.168.1.4', 
-00025770: 696e 7665 7274 3d54 7275 6529 2827 3139  invert=True)('19
-00025780: 322e 3136 382e 312e 3427 290a 2020 2020  2.168.1.4').    
-00025790: 2020 2020 2827 3139 322e 3136 382e 312e      ('192.168.1.
-000257a0: 3427 2c20 2765 6e74 6572 2076 616c 6964  4', 'enter valid
-000257b0: 2049 5020 6164 6472 6573 7327 290a 2020   IP address').  
-000257c0: 2020 2020 2020 3e3e 3e20 4953 5f49 5041        >>> IS_IPA
-000257d0: 4444 5245 5353 2869 735f 6c6f 6361 6c68  DDRESS(is_localh
-000257e0: 6f73 743d 5472 7565 2928 2731 3237 2e30  ost=True)('127.0
-000257f0: 2e30 2e31 2729 0a20 2020 2020 2020 2028  .0.1').        (
-00025800: 2731 3237 2e30 2e30 2e31 272c 204e 6f6e  '127.0.0.1', Non
-00025810: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
-00025820: 535f 4950 4144 4452 4553 5328 6973 5f6c  S_IPADDRESS(is_l
-00025830: 6f63 616c 686f 7374 3d54 7275 6529 2827  ocalhost=True)('
-00025840: 3139 322e 3136 382e 312e 3130 2729 0a20  192.168.1.10'). 
-00025850: 2020 2020 2020 2028 2731 3932 2e31 3638         ('192.168
-00025860: 2e31 2e31 3027 2c20 2765 6e74 6572 2076  .1.10', 'enter v
-00025870: 616c 6964 2049 5020 6164 6472 6573 7327  alid IP address'
-00025880: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
-00025890: 5f49 5041 4444 5245 5353 2869 735f 6c6f  _IPADDRESS(is_lo
-000258a0: 6361 6c68 6f73 743d 4661 6c73 6529 2827  calhost=False)('
-000258b0: 3132 372e 302e 302e 3127 290a 2020 2020  127.0.0.1').    
-000258c0: 2020 2020 2827 3132 372e 302e 302e 3127      ('127.0.0.1'
-000258d0: 2c20 2765 6e74 6572 2076 616c 6964 2049  , 'enter valid I
-000258e0: 5020 6164 6472 6573 7327 290a 2020 2020  P address').    
-000258f0: 2020 2020 3e3e 3e20 4953 5f49 5041 4444      >>> IS_IPADD
-00025900: 5245 5353 286d 6178 6970 3d27 3130 302e  RESS(maxip='100.
-00025910: 302e 302e 3027 2c20 6973 5f6c 6f63 616c  0.0.0', is_local
-00025920: 686f 7374 3d54 7275 6529 2827 3132 372e  host=True)('127.
-00025930: 302e 302e 3127 290a 2020 2020 2020 2020  0.0.1').        
-00025940: 2827 3132 372e 302e 302e 3127 2c20 2765  ('127.0.0.1', 'e
-00025950: 6e74 6572 2076 616c 6964 2049 5020 6164  nter valid IP ad
-00025960: 6472 6573 7327 290a 0a20 2020 2020 2020  dress')..       
-00025970: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
-00025980: 5328 2928 2766 6538 303a 3a31 3236 633a  S()('fe80::126c:
-00025990: 3866 6661 3a66 6532 323a 6233 6166 2729  8ffa:fe22:b3af')
-000259a0: 0a20 2020 2020 2020 2028 2766 6538 303a  .        ('fe80:
-000259b0: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
-000259c0: 6233 6166 272c 204e 6f6e 6529 0a20 2020  b3af', None).   
-000259d0: 2020 2020 203e 3e3e 2049 535f 4950 4144       >>> IS_IPAD
-000259e0: 4452 4553 5328 6973 5f69 7076 343d 4661  DRESS(is_ipv4=Fa
-000259f0: 6c73 6529 2827 6665 3830 3a3a 3132 3663  lse)('fe80::126c
-00025a00: 3a38 6666 613a 6665 3232 3a62 3361 6627  :8ffa:fe22:b3af'
-00025a10: 290a 2020 2020 2020 2020 2827 6665 3830  ).        ('fe80
-00025a20: 3a3a 3132 3663 3a38 6666 613a 6665 3232  ::126c:8ffa:fe22
-00025a30: 3a62 3361 6627 2c20 4e6f 6e65 290a 2020  :b3af', None).  
-00025a40: 2020 2020 2020 3e3e 3e20 4953 5f49 5041        >>> IS_IPA
-00025a50: 4444 5245 5353 2829 2827 6665 3830 3a3a  DDRESS()('fe80::
-00025a60: 3132 3663 3a38 6666 613a 6665 3232 3a62  126c:8ffa:fe22:b
-00025a70: 3361 6620 2027 290a 2020 2020 2020 2020  3af  ').        
-00025a80: 2827 6665 3830 3a3a 3132 3663 3a38 6666  ('fe80::126c:8ff
-00025a90: 613a 6665 3232 3a62 3361 6620 2027 2c20  a:fe22:b3af  ', 
-00025aa0: 2765 6e74 6572 2076 616c 6964 2049 5020  'enter valid IP 
-00025ab0: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
-00025ac0: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
-00025ad0: 5353 2869 735f 6970 7634 3d54 7275 6529  SS(is_ipv4=True)
-00025ae0: 2827 6665 3830 3a3a 3132 3663 3a38 6666  ('fe80::126c:8ff
-00025af0: 613a 6665 3232 3a62 3361 6627 290a 2020  a:fe22:b3af').  
-00025b00: 2020 2020 2020 2827 6665 3830 3a3a 3132        ('fe80::12
-00025b10: 3663 3a38 6666 613a 6665 3232 3a62 3361  6c:8ffa:fe22:b3a
-00025b20: 6627 2c20 2765 6e74 6572 2076 616c 6964  f', 'enter valid
-00025b30: 2049 5020 6164 6472 6573 7327 290a 2020   IP address').  
-00025b40: 2020 2020 2020 3e3e 3e20 4953 5f49 5041        >>> IS_IPA
-00025b50: 4444 5245 5353 2869 735f 6970 7636 3d54  DDRESS(is_ipv6=T
-00025b60: 7275 6529 2827 3139 322e 3136 382e 312e  rue)('192.168.1.
-00025b70: 3127 290a 2020 2020 2020 2020 2827 3139  1').        ('19
-00025b80: 322e 3136 382e 312e 3127 2c20 2765 6e74  2.168.1.1', 'ent
-00025b90: 6572 2076 616c 6964 2049 5020 6164 6472  er valid IP addr
-00025ba0: 6573 7327 290a 2020 2020 2020 2020 3e3e  ess').        >>
-00025bb0: 3e20 4953 5f49 5041 4444 5245 5353 2869  > IS_IPADDRESS(i
-00025bc0: 735f 6970 7636 3d54 7275 652c 2065 7272  s_ipv6=True, err
-00025bd0: 6f72 5f6d 6573 7361 6765 3d27 4261 6420  or_message='Bad 
-00025be0: 6970 2729 2827 3139 322e 3136 382e 312e  ip')('192.168.1.
-00025bf0: 3127 290a 2020 2020 2020 2020 2827 3139  1').        ('19
-00025c00: 322e 3136 382e 312e 3127 2c20 2762 6164  2.168.1.1', 'bad
-00025c10: 2069 7027 290a 2020 2020 2020 2020 3e3e   ip').        >>
-00025c20: 3e20 4953 5f49 5041 4444 5245 5353 2869  > IS_IPADDRESS(i
-00025c30: 735f 6c69 6e6b 5f6c 6f63 616c 3d54 7275  s_link_local=Tru
-00025c40: 6529 2827 6665 3830 3a3a 3132 3663 3a38  e)('fe80::126c:8
-00025c50: 6666 613a 6665 3232 3a62 3361 6627 290a  ffa:fe22:b3af').
-00025c60: 2020 2020 2020 2020 2827 6665 3830 3a3a          ('fe80::
-00025c70: 3132 3663 3a38 6666 613a 6665 3232 3a62  126c:8ffa:fe22:b
-00025c80: 3361 6627 2c20 4e6f 6e65 290a 2020 2020  3af', None).    
-00025c90: 2020 2020 3e3e 3e20 4953 5f49 5041 4444      >>> IS_IPADD
-00025ca0: 5245 5353 2869 735f 6c69 6e6b 5f6c 6f63  RESS(is_link_loc
-00025cb0: 616c 3d46 616c 7365 2928 2766 6538 303a  al=False)('fe80:
-00025cc0: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
-00025cd0: 6233 6166 2729 0a20 2020 2020 2020 2028  b3af').        (
-00025ce0: 2766 6538 303a 3a31 3236 633a 3866 6661  'fe80::126c:8ffa
-00025cf0: 3a66 6532 323a 6233 6166 272c 2027 656e  :fe22:b3af', 'en
-00025d00: 7465 7220 7661 6c69 6420 4950 2061 6464  ter valid IP add
-00025d10: 7265 7373 2729 0a20 2020 2020 2020 203e  ress').        >
-00025d20: 3e3e 2049 535f 4950 4144 4452 4553 5328  >> IS_IPADDRESS(
-00025d30: 6973 5f6c 696e 6b5f 6c6f 6361 6c3d 5472  is_link_local=Tr
-00025d40: 7565 2928 2732 3030 313a 3a31 3236 633a  ue)('2001::126c:
-00025d50: 3866 6661 3a66 6532 323a 6233 6166 2729  8ffa:fe22:b3af')
-00025d60: 0a20 2020 2020 2020 2028 2732 3030 313a  .        ('2001:
-00025d70: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
-00025d80: 6233 6166 272c 2027 656e 7465 7220 7661  b3af', 'enter va
-00025d90: 6c69 6420 4950 2061 6464 7265 7373 2729  lid IP address')
-00025da0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
-00025db0: 4950 4144 4452 4553 5328 6973 5f6d 756c  IPADDRESS(is_mul
-00025dc0: 7469 6361 7374 3d54 7275 6529 2827 3230  ticast=True)('20
-00025dd0: 3031 3a3a 3132 3663 3a38 6666 613a 6665  01::126c:8ffa:fe
-00025de0: 3232 3a62 3361 6627 290a 2020 2020 2020  22:b3af').      
-00025df0: 2020 2827 3230 3031 3a3a 3132 3663 3a38    ('2001::126c:8
-00025e00: 6666 613a 6665 3232 3a62 3361 6627 2c20  ffa:fe22:b3af', 
-00025e10: 2765 6e74 6572 2076 616c 6964 2049 5020  'enter valid IP 
-00025e20: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
-00025e30: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
-00025e40: 5353 2869 735f 6d75 6c74 6963 6173 743d  SS(is_multicast=
-00025e50: 5472 7565 2928 2766 6630 303a 3a31 3236  True)('ff00::126
-00025e60: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
-00025e70: 2729 0a20 2020 2020 2020 2028 2766 6630  ').        ('ff0
-00025e80: 303a 3a31 3236 633a 3866 6661 3a66 6532  0::126c:8ffa:fe2
-00025e90: 323a 6233 6166 272c 204e 6f6e 6529 0a20  2:b3af', None). 
-00025ea0: 2020 2020 2020 203e 3e3e 2049 535f 4950         >>> IS_IP
-00025eb0: 4144 4452 4553 5328 6973 5f72 6f75 7465  ADDRESS(is_route
-00025ec0: 6162 6c65 3d54 7275 6529 2827 3230 3031  able=True)('2001
-00025ed0: 3a3a 3132 3663 3a38 6666 613a 6665 3232  ::126c:8ffa:fe22
-00025ee0: 3a62 3361 6627 290a 2020 2020 2020 2020  :b3af').        
-00025ef0: 2827 3230 3031 3a3a 3132 3663 3a38 6666  ('2001::126c:8ff
-00025f00: 613a 6665 3232 3a62 3361 6627 2c20 4e6f  a:fe22:b3af', No
-00025f10: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
-00025f20: 4953 5f49 5041 4444 5245 5353 2869 735f  IS_IPADDRESS(is_
-00025f30: 726f 7574 6561 626c 653d 5472 7565 2928  routeable=True)(
-00025f40: 2766 6630 303a 3a31 3236 633a 3866 6661  'ff00::126c:8ffa
-00025f50: 3a66 6532 323a 6233 6166 2729 0a20 2020  :fe22:b3af').   
-00025f60: 2020 2020 2028 2766 6630 303a 3a31 3236       ('ff00::126
-00025f70: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
-00025f80: 272c 2027 656e 7465 7220 7661 6c69 6420  ', 'enter valid 
-00025f90: 4950 2061 6464 7265 7373 2729 0a20 2020  IP address').   
-00025fa0: 2020 2020 203e 3e3e 2049 535f 4950 4144       >>> IS_IPAD
-00025fb0: 4452 4553 5328 7375 626e 6574 733d 2732  DRESS(subnets='2
-00025fc0: 3030 313a 3a2f 3332 2729 2827 3230 3031  001::/32')('2001
-00025fd0: 3a3a 3866 6661 3a66 6532 323a 6233 6166  ::8ffa:fe22:b3af
-00025fe0: 2729 0a20 2020 2020 2020 2028 2732 3030  ').        ('200
-00025ff0: 313a 3a38 6666 613a 6665 3232 3a62 3361  1::8ffa:fe22:b3a
-00026000: 6627 2c20 4e6f 6e65 290a 2020 2020 2020  f', None).      
-00026010: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
-00026020: 5353 2873 7562 6e65 7473 3d27 6662 3030  SS(subnets='fb00
-00026030: 3a3a 2f38 2729 2827 3230 3031 3a3a 3866  ::/8')('2001::8f
-00026040: 6661 3a66 6532 323a 6233 6166 2729 0a20  fa:fe22:b3af'). 
-00026050: 2020 2020 2020 2028 2732 3030 313a 3a38         ('2001::8
-00026060: 6666 613a 6665 3232 3a62 3361 6627 2c20  ffa:fe22:b3af', 
-00026070: 2765 6e74 6572 2076 616c 6964 2049 5020  'enter valid IP 
-00026080: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
-00026090: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
-000260a0: 5353 2873 7562 6e65 7473 3d5b 2766 6330  SS(subnets=['fc0
-000260b0: 303a 3a2f 3827 2c27 3230 3031 3a3a 2f33  0::/8','2001::/3
-000260c0: 3227 5d29 2827 3230 3031 3a3a 3866 6661  2'])('2001::8ffa
-000260d0: 3a66 6532 323a 6233 6166 2729 0a20 2020  :fe22:b3af').   
-000260e0: 2020 2020 2028 2732 3030 313a 3a38 6666       ('2001::8ff
-000260f0: 613a 6665 3232 3a62 3361 6627 2c20 4e6f  a:fe22:b3af', No
-00026100: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
-00026110: 4953 5f49 5041 4444 5245 5353 2873 7562  IS_IPADDRESS(sub
-00026120: 6e65 7473 3d27 696e 7661 6c69 6473 7562  nets='invalidsub
-00026130: 6e65 7427 2928 2732 3030 313a 3a38 6666  net')('2001::8ff
-00026140: 613a 6665 3232 3a62 3361 6627 290a 2020  a:fe22:b3af').  
-00026150: 2020 2020 2020 2827 3230 3031 3a3a 3866        ('2001::8f
-00026160: 6661 3a66 6532 323a 6233 6166 272c 2027  fa:fe22:b3af', '
-00026170: 696e 7661 6c69 6420 7375 626e 6574 2070  invalid subnet p
-00026180: 726f 7669 6465 6427 290a 2020 2020 2222  rovided').    ""
-00026190: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
-000261a0: 745f 5f28 0a20 2020 2020 2020 2073 656c  t__(.        sel
-000261b0: 662c 0a20 2020 2020 2020 206d 696e 6970  f,.        minip
-000261c0: 3d22 302e 302e 302e 3022 2c0a 2020 2020  ="0.0.0.0",.    
-000261d0: 2020 2020 6d61 7869 703d 2232 3535 2e32      maxip="255.2
-000261e0: 3535 2e32 3535 2e32 3535 222c 0a20 2020  55.255.255",.   
-000261f0: 2020 2020 2069 6e76 6572 743d 4661 6c73       invert=Fals
-00026200: 652c 0a20 2020 2020 2020 2069 735f 6c6f  e,.        is_lo
-00026210: 6361 6c68 6f73 743d 4e6f 6e65 2c0a 2020  calhost=None,.  
-00026220: 2020 2020 2020 6973 5f70 7269 7661 7465        is_private
-00026230: 3d4e 6f6e 652c 0a20 2020 2020 2020 2069  =None,.        i
-00026240: 735f 6175 746f 6d61 7469 633d 4e6f 6e65  s_automatic=None
-00026250: 2c0a 2020 2020 2020 2020 6973 5f69 7076  ,.        is_ipv
-00026260: 343d 4e6f 6e65 2c0a 2020 2020 2020 2020  4=None,.        
-00026270: 6973 5f6c 696e 6b5f 6c6f 6361 6c3d 4e6f  is_link_local=No
-00026280: 6e65 2c0a 2020 2020 2020 2020 6973 5f72  ne,.        is_r
-00026290: 6573 6572 7665 643d 4e6f 6e65 2c0a 2020  eserved=None,.  
-000262a0: 2020 2020 2020 6973 5f6d 756c 7469 6361        is_multica
-000262b0: 7374 3d4e 6f6e 652c 0a20 2020 2020 2020  st=None,.       
-000262c0: 2069 735f 726f 7574 6561 626c 653d 4e6f   is_routeable=No
-000262d0: 6e65 2c0a 2020 2020 2020 2020 6973 5f36  ne,.        is_6
-000262e0: 746f 343d 4e6f 6e65 2c0a 2020 2020 2020  to4=None,.      
-000262f0: 2020 6973 5f74 6572 6564 6f3d 4e6f 6e65    is_teredo=None
-00026300: 2c0a 2020 2020 2020 2020 7375 626e 6574  ,.        subnet
-00026310: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-00026320: 6973 5f69 7076 363d 4e6f 6e65 2c0a 2020  is_ipv6=None,.  
-00026330: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00026340: 6167 653d 2245 6e74 6572 2076 616c 6964  age="Enter valid
-00026350: 2049 5020 6164 6472 6573 7322 2c0a 2020   IP address",.  
-00026360: 2020 293a 0a0a 2020 2020 2020 2020 7365    ):..        se
-00026370: 6c66 2e6d 696e 6970 203d 2028 6d69 6e69  lf.minip = (mini
-00026380: 702c 290a 2020 2020 2020 2020 7365 6c66  p,).        self
-00026390: 2e6d 6178 6970 203d 2028 6d61 7869 702c  .maxip = (maxip,
-000263a0: 290a 2020 2020 2020 2020 7365 6c66 2e69  ).        self.i
-000263b0: 6e76 6572 7420 3d20 696e 7665 7274 0a20  nvert = invert. 
-000263c0: 2020 2020 2020 2073 656c 662e 6973 5f6c         self.is_l
-000263d0: 6f63 616c 686f 7374 203d 2069 735f 6c6f  ocalhost = is_lo
-000263e0: 6361 6c68 6f73 740a 2020 2020 2020 2020  calhost.        
-000263f0: 7365 6c66 2e69 735f 7072 6976 6174 6520  self.is_private 
-00026400: 3d20 6973 5f70 7269 7661 7465 0a20 2020  = is_private.   
-00026410: 2020 2020 2073 656c 662e 6973 5f61 7574       self.is_aut
-00026420: 6f6d 6174 6963 203d 2069 735f 6175 746f  omatic = is_auto
-00026430: 6d61 7469 630a 2020 2020 2020 2020 7365  matic.        se
-00026440: 6c66 2e69 735f 6970 7634 203d 2069 735f  lf.is_ipv4 = is_
-00026450: 6970 7634 206f 7220 6973 5f69 7076 3620  ipv4 or is_ipv6 
-00026460: 6973 2046 616c 7365 0a20 2020 2020 2020  is False.       
-00026470: 2073 656c 662e 6973 5f70 7269 7661 7465   self.is_private
-00026480: 203d 2069 735f 7072 6976 6174 650a 2020   = is_private.  
-00026490: 2020 2020 2020 7365 6c66 2e69 735f 6c69        self.is_li
-000264a0: 6e6b 5f6c 6f63 616c 203d 2069 735f 6c69  nk_local = is_li
-000264b0: 6e6b 5f6c 6f63 616c 0a20 2020 2020 2020  nk_local.       
-000264c0: 2073 656c 662e 6973 5f72 6573 6572 7665   self.is_reserve
-000264d0: 6420 3d20 6973 5f72 6573 6572 7665 640a  d = is_reserved.
-000264e0: 2020 2020 2020 2020 7365 6c66 2e69 735f          self.is_
-000264f0: 6d75 6c74 6963 6173 7420 3d20 6973 5f6d  multicast = is_m
-00026500: 756c 7469 6361 7374 0a20 2020 2020 2020  ulticast.       
-00026510: 2073 656c 662e 6973 5f72 6f75 7465 6162   self.is_routeab
-00026520: 6c65 203d 2069 735f 726f 7574 6561 626c  le = is_routeabl
-00026530: 650a 2020 2020 2020 2020 7365 6c66 2e69  e.        self.i
-00026540: 735f 3674 6f34 203d 2069 735f 3674 6f34  s_6to4 = is_6to4
-00026550: 0a20 2020 2020 2020 2073 656c 662e 6973  .        self.is
-00026560: 5f74 6572 6564 6f20 3d20 6973 5f74 6572  _teredo = is_ter
-00026570: 6564 6f0a 2020 2020 2020 2020 7365 6c66  edo.        self
-00026580: 2e73 7562 6e65 7473 203d 2073 7562 6e65  .subnets = subne
-00026590: 7473 0a20 2020 2020 2020 2073 656c 662e  ts.        self.
-000265a0: 6973 5f69 7076 3620 3d20 6973 5f69 7076  is_ipv6 = is_ipv
-000265b0: 3620 6f72 2069 735f 6970 7634 2069 7320  6 or is_ipv4 is 
-000265c0: 4661 6c73 650a 2020 2020 2020 2020 7365  False.        se
-000265d0: 6c66 2e65 7272 6f72 5f6d 6573 7361 6765  lf.error_message
-000265e0: 203d 2065 7272 6f72 5f6d 6573 7361 6765   = error_message
-000265f0: 0a0a 2020 2020 6465 6620 7661 6c69 6461  ..    def valida
-00026600: 7465 2873 656c 662c 2076 616c 7565 2c20  te(self, value, 
-00026610: 7265 636f 7264 5f69 643d 4e6f 6e65 293a  record_id=None):
-00026620: 0a20 2020 2020 2020 2049 5041 6464 7265  .        IPAddre
-00026630: 7373 203d 2069 7061 6464 7265 7373 2e69  ss = ipaddress.i
-00026640: 705f 6164 6472 6573 730a 2020 2020 2020  p_address.      
-00026650: 2020 4950 7636 4164 6472 6573 7320 3d20    IPv6Address = 
-00026660: 6970 6164 6472 6573 732e 4950 7636 4164  ipaddress.IPv6Ad
-00026670: 6472 6573 730a 2020 2020 2020 2020 4950  dress.        IP
-00026680: 7634 4164 6472 6573 7320 3d20 6970 6164  v4Address = ipad
-00026690: 6472 6573 732e 4950 7634 4164 6472 6573  dress.IPv4Addres
-000266a0: 730a 0a20 2020 2020 2020 2074 7279 3a0a  s..        try:.
-000266b0: 2020 2020 2020 2020 2020 2020 6970 203d              ip =
-000266c0: 2049 5041 6464 7265 7373 2874 6f5f 756e   IPAddress(to_un
-000266d0: 6963 6f64 6528 7661 6c75 6529 290a 2020  icode(value)).  
-000266e0: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
-000266f0: 7565 4572 726f 723a 0a20 2020 2020 2020  ueError:.       
-00026700: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
-00026710: 6174 696f 6e45 7272 6f72 2873 656c 662e  ationError(self.
-00026720: 7472 616e 736c 6174 6f72 2873 656c 662e  translator(self.
-00026730: 6572 726f 725f 6d65 7373 6167 6529 290a  error_message)).
-00026740: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00026750: 2e69 735f 6970 7634 2061 6e64 2069 7369  .is_ipv4 and isi
-00026760: 6e73 7461 6e63 6528 6970 2c20 4950 7636  nstance(ip, IPv6
-00026770: 4164 6472 6573 7329 3a0a 2020 2020 2020  Address):.      
-00026780: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
-00026790: 6461 7469 6f6e 4572 726f 7228 7365 6c66  dationError(self
-000267a0: 2e74 7261 6e73 6c61 746f 7228 7365 6c66  .translator(self
-000267b0: 2e65 7272 6f72 5f6d 6573 7361 6765 2929  .error_message))
-000267c0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-000267d0: 6c66 2e69 735f 6970 7636 2061 6e64 2069  lf.is_ipv6 and i
-000267e0: 7369 6e73 7461 6e63 6528 6970 2c20 4950  sinstance(ip, IP
-000267f0: 7634 4164 6472 6573 7329 3a0a 2020 2020  v4Address):.    
-00026800: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00026810: 6c69 6461 7469 6f6e 4572 726f 7228 7365  lidationError(se
-00026820: 6c66 2e74 7261 6e73 6c61 746f 7228 7365  lf.translator(se
-00026830: 6c66 2e65 7272 6f72 5f6d 6573 7361 6765  lf.error_message
-00026840: 2929 0a20 2020 2020 2020 2065 6c69 6620  )).        elif 
-00026850: 7365 6c66 2e69 735f 6970 7634 206f 7220  self.is_ipv4 or 
-00026860: 6973 696e 7374 616e 6365 2869 702c 2049  isinstance(ip, I
-00026870: 5076 3441 6464 7265 7373 293a 0a20 2020  Pv4Address):.   
-00026880: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00026890: 4953 5f49 5056 3428 0a20 2020 2020 2020  IS_IPV4(.       
-000268a0: 2020 2020 2020 2020 206d 696e 6970 3d73           minip=s
-000268b0: 656c 662e 6d69 6e69 702c 0a20 2020 2020  elf.minip,.     
-000268c0: 2020 2020 2020 2020 2020 206d 6178 6970             maxip
-000268d0: 3d73 656c 662e 6d61 7869 702c 0a20 2020  =self.maxip,.   
-000268e0: 2020 2020 2020 2020 2020 2020 2069 6e76               inv
-000268f0: 6572 743d 7365 6c66 2e69 6e76 6572 742c  ert=self.invert,
-00026900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026910: 2069 735f 6c6f 6361 6c68 6f73 743d 7365   is_localhost=se
-00026920: 6c66 2e69 735f 6c6f 6361 6c68 6f73 742c  lf.is_localhost,
-00026930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026940: 2069 735f 7072 6976 6174 653d 7365 6c66   is_private=self
-00026950: 2e69 735f 7072 6976 6174 652c 0a20 2020  .is_private,.   
-00026960: 2020 2020 2020 2020 2020 2020 2069 735f               is_
-00026970: 6175 746f 6d61 7469 633d 7365 6c66 2e69  automatic=self.i
-00026980: 735f 6175 746f 6d61 7469 632c 0a20 2020  s_automatic,.   
-00026990: 2020 2020 2020 2020 2020 2020 2065 7272               err
-000269a0: 6f72 5f6d 6573 7361 6765 3d73 656c 662e  or_message=self.
-000269b0: 6572 726f 725f 6d65 7373 6167 652c 0a20  error_message,. 
-000269c0: 2020 2020 2020 2020 2020 2029 2e76 616c             ).val
-000269d0: 6964 6174 6528 7661 6c75 652c 2072 6563  idate(value, rec
-000269e0: 6f72 645f 6964 290a 2020 2020 2020 2020  ord_id).        
-000269f0: 656c 6966 2073 656c 662e 6973 5f69 7076  elif self.is_ipv
-00026a00: 3620 6f72 2069 7369 6e73 7461 6e63 6528  6 or isinstance(
-00026a10: 6970 2c20 4950 7636 4164 6472 6573 7329  ip, IPv6Address)
-00026a20: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00026a30: 7475 726e 2049 535f 4950 5636 280a 2020  turn IS_IPV6(.  
-00026a40: 2020 2020 2020 2020 2020 2020 2020 6973                is
-00026a50: 5f70 7269 7661 7465 3d73 656c 662e 6973  _private=self.is
-00026a60: 5f70 7269 7661 7465 2c0a 2020 2020 2020  _private,.      
-00026a70: 2020 2020 2020 2020 2020 6973 5f6c 696e            is_lin
-00026a80: 6b5f 6c6f 6361 6c3d 7365 6c66 2e69 735f  k_local=self.is_
-00026a90: 6c69 6e6b 5f6c 6f63 616c 2c0a 2020 2020  link_local,.    
-00026aa0: 2020 2020 2020 2020 2020 2020 6973 5f72              is_r
-00026ab0: 6573 6572 7665 643d 7365 6c66 2e69 735f  eserved=self.is_
-00026ac0: 7265 7365 7276 6564 2c0a 2020 2020 2020  reserved,.      
-00026ad0: 2020 2020 2020 2020 2020 6973 5f6d 756c            is_mul
-00026ae0: 7469 6361 7374 3d73 656c 662e 6973 5f6d  ticast=self.is_m
-00026af0: 756c 7469 6361 7374 2c0a 2020 2020 2020  ulticast,.      
-00026b00: 2020 2020 2020 2020 2020 6973 5f72 6f75            is_rou
-00026b10: 7465 6162 6c65 3d73 656c 662e 6973 5f72  teable=self.is_r
-00026b20: 6f75 7465 6162 6c65 2c0a 2020 2020 2020  outeable,.      
-00026b30: 2020 2020 2020 2020 2020 6973 5f36 746f            is_6to
-00026b40: 343d 7365 6c66 2e69 735f 3674 6f34 2c0a  4=self.is_6to4,.
-00026b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026b60: 6973 5f74 6572 6564 6f3d 7365 6c66 2e69  is_teredo=self.i
-00026b70: 735f 7465 7265 646f 2c0a 2020 2020 2020  s_teredo,.      
-00026b80: 2020 2020 2020 2020 2020 7375 626e 6574            subnet
-00026b90: 733d 7365 6c66 2e73 7562 6e65 7473 2c0a  s=self.subnets,.
-00026ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026bb0: 6572 726f 725f 6d65 7373 6167 653d 7365  error_message=se
-00026bc0: 6c66 2e65 7272 6f72 5f6d 6573 7361 6765  lf.error_message
-00026bd0: 2c0a 2020 2020 2020 2020 2020 2020 292e  ,.            ).
-00026be0: 7661 6c69 6461 7465 2876 616c 7565 2c20  validate(value, 
-00026bf0: 7265 636f 7264 5f69 6429 0a20 2020 2020  record_id).     
-00026c00: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00026c10: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
-00026c20: 6174 696f 6e45 7272 6f72 2873 656c 662e  ationError(self.
-00026c30: 7472 616e 736c 6174 6f72 2873 656c 662e  translator(self.
-00026c40: 6572 726f 725f 6d65 7373 6167 6529 290a  error_message)).
+00024450: 6f6b 203d 2054 7275 650a 0a20 2020 2020  ok = True..     
+00024460: 2020 2069 6620 7365 6c66 2e69 735f 726f     if self.is_ro
+00024470: 7574 6561 626c 653a 0a20 2020 2020 2020  uteable:.       
+00024480: 2020 2020 2073 656c 662e 6973 5f70 7269       self.is_pri
+00024490: 7661 7465 203d 2046 616c 7365 0a20 2020  vate = False.   
+000244a0: 2020 2020 2020 2020 2073 656c 662e 6973           self.is
+000244b0: 5f72 6573 6572 7665 6420 3d20 4661 6c73  _reserved = Fals
+000244c0: 650a 2020 2020 2020 2020 2020 2020 7365  e.            se
+000244d0: 6c66 2e69 735f 6d75 6c74 6963 6173 7420  lf.is_multicast 
+000244e0: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
+000244f0: 2069 6620 6f6b 2061 6e64 2073 656c 662e   if ok and self.
+00024500: 6973 5f70 7269 7661 7465 2069 7320 6e6f  is_private is no
+00024510: 7420 4e6f 6e65 2061 6e64 2073 656c 662e  t None and self.
+00024520: 6973 5f70 7269 7661 7465 2021 3d20 6970  is_private != ip
+00024530: 2e69 735f 7072 6976 6174 653a 0a20 2020  .is_private:.   
+00024540: 2020 2020 2020 2020 206f 6b20 3d20 4661           ok = Fa
+00024550: 6c73 650a 2020 2020 2020 2020 6966 2028  lse.        if (
+00024560: 0a20 2020 2020 2020 2020 2020 206f 6b0a  .            ok.
+00024570: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00024580: 7365 6c66 2e69 735f 6c69 6e6b 5f6c 6f63  self.is_link_loc
+00024590: 616c 2069 7320 6e6f 7420 4e6f 6e65 0a20  al is not None. 
+000245a0: 2020 2020 2020 2020 2020 2061 6e64 2073             and s
+000245b0: 656c 662e 6973 5f6c 696e 6b5f 6c6f 6361  elf.is_link_loca
+000245c0: 6c20 213d 2069 702e 6973 5f6c 696e 6b5f  l != ip.is_link_
+000245d0: 6c6f 6361 6c0a 2020 2020 2020 2020 293a  local.        ):
+000245e0: 0a20 2020 2020 2020 2020 2020 206f 6b20  .            ok 
+000245f0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+00024600: 6966 206f 6b20 616e 6420 7365 6c66 2e69  if ok and self.i
+00024610: 735f 7265 7365 7276 6564 2069 7320 6e6f  s_reserved is no
+00024620: 7420 4e6f 6e65 2061 6e64 2073 656c 662e  t None and self.
+00024630: 6973 5f72 6573 6572 7665 6420 213d 2069  is_reserved != i
+00024640: 702e 6973 5f72 6573 6572 7665 643a 0a20  p.is_reserved:. 
+00024650: 2020 2020 2020 2020 2020 206f 6b20 3d20             ok = 
+00024660: 4661 6c73 650a 2020 2020 2020 2020 6966  False.        if
+00024670: 2028 0a20 2020 2020 2020 2020 2020 206f   (.            o
+00024680: 6b0a 2020 2020 2020 2020 2020 2020 616e  k.            an
+00024690: 6420 7365 6c66 2e69 735f 6d75 6c74 6963  d self.is_multic
+000246a0: 6173 7420 6973 206e 6f74 204e 6f6e 650a  ast is not None.
+000246b0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+000246c0: 7365 6c66 2e69 735f 6d75 6c74 6963 6173  self.is_multicas
+000246d0: 7420 213d 2069 702e 6973 5f6d 756c 7469  t != ip.is_multi
+000246e0: 6361 7374 0a20 2020 2020 2020 2029 3a0a  cast.        ):.
+000246f0: 2020 2020 2020 2020 2020 2020 6f6b 203d              ok =
+00024700: 2046 616c 7365 0a20 2020 2020 2020 2069   False.        i
+00024710: 6620 6f6b 2061 6e64 2073 656c 662e 6973  f ok and self.is
+00024720: 5f36 746f 3420 6973 206e 6f74 204e 6f6e  _6to4 is not Non
+00024730: 6520 616e 6420 7365 6c66 2e69 735f 3674  e and self.is_6t
+00024740: 6f34 2021 3d20 626f 6f6c 2869 702e 7369  o4 != bool(ip.si
+00024750: 7874 6f66 6f75 7229 3a0a 2020 2020 2020  xtofour):.      
+00024760: 2020 2020 2020 6f6b 203d 2046 616c 7365        ok = False
+00024770: 0a20 2020 2020 2020 2069 6620 6f6b 2061  .        if ok a
+00024780: 6e64 2073 656c 662e 6973 5f74 6572 6564  nd self.is_tered
+00024790: 6f20 6973 206e 6f74 204e 6f6e 6520 616e  o is not None an
+000247a0: 6420 7365 6c66 2e69 735f 7465 7265 646f  d self.is_teredo
+000247b0: 2021 3d20 626f 6f6c 2869 702e 7465 7265   != bool(ip.tere
+000247c0: 646f 293a 0a20 2020 2020 2020 2020 2020  do):.           
+000247d0: 206f 6b20 3d20 4661 6c73 650a 0a20 2020   ok = False..   
+000247e0: 2020 2020 2069 6620 6f6b 3a0a 2020 2020       if ok:.    
+000247f0: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+00024800: 616c 7565 0a0a 2020 2020 2020 2020 7261  alue..        ra
+00024810: 6973 6520 5661 6c69 6461 7469 6f6e 4572  ise ValidationEr
+00024820: 726f 7228 7365 6c66 2e74 7261 6e73 6c61  ror(self.transla
+00024830: 746f 7228 7365 6c66 2e65 7272 6f72 5f6d  tor(self.error_m
+00024840: 6573 7361 6765 2929 0a0a 0a63 6c61 7373  essage))...class
+00024850: 2049 535f 4950 4144 4452 4553 5328 5661   IS_IPADDRESS(Va
+00024860: 6c69 6461 746f 7229 3a0a 2020 2020 2222  lidator):.    ""
+00024870: 220a 2020 2020 4368 6563 6b73 2069 6620  ".    Checks if 
+00024880: 6669 656c 6427 7320 7661 6c75 6520 6973  field's value is
+00024890: 2061 6e20 4950 2041 6464 7265 7373 2028   an IP Address (
+000248a0: 7634 206f 7220 7636 292e 2043 616e 2062  v4 or v6). Can b
+000248b0: 6520 7365 7420 746f 2066 6f72 6365 0a20  e set to force. 
+000248c0: 2020 2061 6464 7265 7373 6573 2066 726f     addresses fro
+000248d0: 6d20 7769 7468 696e 2061 2073 7065 6369  m within a speci
+000248e0: 6669 6320 7261 6e67 652e 2043 6865 636b  fic range. Check
+000248f0: 7320 6172 6520 646f 6e65 2077 6974 6820  s are done with 
+00024900: 7468 6520 636f 7272 6563 740a 2020 2020  the correct.    
+00024910: 4953 5f49 5056 3420 616e 6420 4953 5f49  IS_IPV4 and IS_I
+00024920: 5056 3620 7661 6c69 6461 746f 7273 2e0a  PV6 validators..
+00024930: 0a20 2020 2055 7365 7320 7468 6520 6970  .    Uses the ip
+00024940: 6164 6472 6573 7320 6672 6f6d 2074 6865  address from the
+00024950: 2050 7974 686f 6e20 3320 7374 616e 6461   Python 3 standa
+00024960: 7264 206c 6962 7261 7279 0a20 2020 2061  rd library.    a
+00024970: 6e64 2069 7473 2050 7974 686f 6e20 3220  nd its Python 2 
+00024980: 6261 636b 706f 7274 2028 696e 2063 6f6e  backport (in con
+00024990: 7472 6962 2f69 7061 6464 7265 7373 2e70  trib/ipaddress.p
+000249a0: 7929 2e0a 0a20 2020 2041 7267 733a 0a20  y)...    Args:. 
+000249b0: 2020 2020 2020 206d 696e 6970 3a20 6c6f         minip: lo
+000249c0: 7765 7374 2061 6c6c 6f77 6564 2061 6464  west allowed add
+000249d0: 7265 7373 3b20 6163 6365 7074 733a 0a20  ress; accepts:. 
+000249e0: 2020 2020 2020 2020 2020 2020 2020 7374                st
+000249f0: 722c 2065 672e 2031 3932 2e31 3638 2e30  r, eg. 192.168.0
+00024a00: 2e31 0a20 2020 2020 2020 2020 2020 2020  .1.             
+00024a10: 2020 6c69 7374 206f 7220 7475 706c 6520    list or tuple 
+00024a20: 6f66 206f 6374 6574 732c 2065 672e 205b  of octets, eg. [
+00024a30: 3139 322c 2031 3638 2c20 302c 2031 5d0a  192, 168, 0, 1].
+00024a40: 2020 2020 2020 2020 6d61 7869 703a 2068          maxip: h
+00024a50: 6967 6865 7374 2061 6c6c 6f77 6564 2061  ighest allowed a
+00024a60: 6464 7265 7373 3b20 7361 6d65 2061 7320  ddress; same as 
+00024a70: 6162 6f76 650a 2020 2020 2020 2020 696e  above.        in
+00024a80: 7665 7274 3a20 5472 7565 2074 6f20 616c  vert: True to al
+00024a90: 6c6f 7720 6164 6472 6573 7365 7320 6f6e  low addresses on
+00024aa0: 6c79 2066 726f 6d20 6f75 7473 6964 6520  ly from outside 
+00024ab0: 6f66 2067 6976 656e 2072 616e 6765 3b20  of given range; 
+00024ac0: 6e6f 7465 0a20 2020 2020 2020 2020 2020  note.           
+00024ad0: 2020 2020 2074 6861 7420 7261 6e67 6520       that range 
+00024ae0: 626f 756e 6461 7269 6573 2061 7265 206e  boundaries are n
+00024af0: 6f74 206d 6174 6368 6564 2074 6869 7320  ot matched this 
+00024b00: 7761 790a 0a20 2020 2049 5076 3420 7370  way..    IPv4 sp
+00024b10: 6563 6966 6963 2061 7267 756d 656e 7473  ecific arguments
+00024b20: 3a0a 0a20 2020 2020 2020 202d 2069 735f  :..        - is_
+00024b30: 6c6f 6361 6c68 6f73 743a 206c 6f63 616c  localhost: local
+00024b40: 686f 7374 2061 6464 7265 7373 2074 7265  host address tre
+00024b50: 6174 6d65 6e74 3a0a 0a20 2020 2020 2020  atment:..       
+00024b60: 2020 2020 202d 204e 6f6e 6520 2864 6566       - None (def
+00024b70: 6175 6c74 293a 2069 6e64 6966 6665 7265  ault): indiffere
+00024b80: 6e74 0a20 2020 2020 2020 2020 2020 202d  nt.            -
+00024b90: 2054 7275 6520 2865 6e66 6f72 6365 293a   True (enforce):
+00024ba0: 2071 7565 7279 2061 6464 7265 7373 206d   query address m
+00024bb0: 7573 7420 6d61 7463 6820 6c6f 6361 6c68  ust match localh
+00024bc0: 6f73 7420 6164 6472 6573 730a 2020 2020  ost address.    
+00024bd0: 2020 2020 2020 2020 2020 2831 3237 2e30            (127.0
+00024be0: 2e30 2e31 290a 2020 2020 2020 2020 2020  .0.1).          
+00024bf0: 2020 2d20 4661 6c73 6520 2866 6f72 6269    - False (forbi
+00024c00: 6429 3a20 7175 6572 7920 6164 6472 6573  d): query addres
+00024c10: 7320 6d75 7374 206e 6f74 206d 6174 6368  s must not match
+00024c20: 206c 6f63 616c 686f 7374 2061 6464 7265   localhost addre
+00024c30: 7373 0a20 2020 2020 2020 202d 2069 735f  ss.        - is_
+00024c40: 7072 6976 6174 653a 2073 616d 6520 6173  private: same as
+00024c50: 2061 626f 7665 2c20 6578 6365 7074 2074   above, except t
+00024c60: 6861 7420 7175 6572 7920 6164 6472 6573  hat query addres
+00024c70: 7320 6973 2063 6865 636b 6564 2061 6761  s is checked aga
+00024c80: 696e 7374 0a20 2020 2020 2020 2020 2074  inst.          t
+00024c90: 776f 2061 6464 7265 7373 2072 616e 6765  wo address range
+00024ca0: 733a 2031 3732 2e31 362e 302e 3020 2d20  s: 172.16.0.0 - 
+00024cb0: 3137 322e 3331 2e32 3535 2e32 3535 2061  172.31.255.255 a
+00024cc0: 6e64 0a20 2020 2020 2020 2020 2031 3932  nd.          192
+00024cd0: 2e31 3638 2e30 2e30 202d 2031 3932 2e31  .168.0.0 - 192.1
+00024ce0: 3638 2e32 3535 2e32 3535 0a20 2020 2020  68.255.255.     
+00024cf0: 2020 202d 2069 735f 6175 746f 6d61 7469     - is_automati
+00024d00: 633a 2073 616d 6520 6173 2061 626f 7665  c: same as above
+00024d10: 2c20 6578 6365 7074 2074 6861 7420 7175  , except that qu
+00024d20: 6572 7920 6164 6472 6573 7320 6973 2063  ery address is c
+00024d30: 6865 636b 6564 2061 6761 696e 7374 0a20  hecked against. 
+00024d40: 2020 2020 2020 2020 206f 6e65 2061 6464           one add
+00024d50: 7265 7373 2072 616e 6765 3a20 3136 392e  ress range: 169.
+00024d60: 3235 342e 302e 3020 2d20 3136 392e 3235  254.0.0 - 169.25
+00024d70: 342e 3235 352e 3235 350a 2020 2020 2020  4.255.255.      
+00024d80: 2020 2d20 6973 5f69 7076 343a 2065 6974    - is_ipv4: eit
+00024d90: 6865 723a 0a0a 2020 2020 2020 2020 2020  her:..          
+00024da0: 2020 2d20 4e6f 6e65 2028 6465 6661 756c    - None (defaul
+00024db0: 7429 3a20 696e 6469 6666 6572 656e 740a  t): indifferent.
+00024dc0: 2020 2020 2020 2020 2020 2020 2d20 5472              - Tr
+00024dd0: 7565 2028 656e 666f 7263 6529 3a20 6d75  ue (enforce): mu
+00024de0: 7374 2062 6520 616e 2049 5076 3420 6164  st be an IPv4 ad
+00024df0: 6472 6573 730a 2020 2020 2020 2020 2020  dress.          
+00024e00: 2020 2d20 4661 6c73 6520 2866 6f72 6269    - False (forbi
+00024e10: 6429 3a20 6d75 7374 204e 4f54 2062 6520  d): must NOT be 
+00024e20: 616e 2049 5076 3420 6164 6472 6573 730a  an IPv4 address.
+00024e30: 0a20 2020 2049 5076 3620 7370 6563 6966  .    IPv6 specif
+00024e40: 6963 2061 7267 756d 656e 7473 3a0a 0a20  ic arguments:.. 
+00024e50: 2020 2020 2020 202d 2069 735f 6c69 6e6b         - is_link
+00024e60: 5f6c 6f63 616c 3a20 5361 6d65 2061 7320  _local: Same as 
+00024e70: 6162 6f76 6520 6275 7420 7573 6573 2066  above but uses f
+00024e80: 6538 303a 3a2f 3130 2072 616e 6765 0a20  e80::/10 range. 
+00024e90: 2020 2020 2020 202d 2069 735f 7265 7365         - is_rese
+00024ea0: 7276 6564 3a20 5361 6d65 2061 7320 6162  rved: Same as ab
+00024eb0: 6f76 6520 6275 7420 7573 6573 2049 4554  ove but uses IET
+00024ec0: 4620 7265 7365 7276 6564 2072 616e 6765  F reserved range
+00024ed0: 0a20 2020 2020 2020 202d 2069 735f 6d75  .        - is_mu
+00024ee0: 6c74 6963 6173 743a 2053 616d 6520 6173  lticast: Same as
+00024ef0: 2061 626f 7665 2062 7574 2075 7365 7320   above but uses 
+00024f00: 6666 3030 3a3a 2f38 2072 616e 6765 0a20  ff00::/8 range. 
+00024f10: 2020 2020 2020 202d 2069 735f 726f 7574         - is_rout
+00024f20: 6561 626c 653a 2053 696d 696c 6172 2074  eable: Similar t
+00024f30: 6f20 6162 6f76 6520 6275 7420 656e 666f  o above but enfo
+00024f40: 7263 6573 206e 6f74 2070 7269 7661 7465  rces not private
+00024f50: 2c20 6c69 6e6b 5f6c 6f63 616c 2c0a 2020  , link_local,.  
+00024f60: 2020 2020 2020 2020 7265 7365 7276 6564          reserved
+00024f70: 206f 7220 6d75 6c74 6963 6173 740a 2020   or multicast.  
+00024f80: 2020 2020 2020 2d20 6973 5f36 746f 343a        - is_6to4:
+00024f90: 2053 616d 6520 6173 2061 626f 7665 2062   Same as above b
+00024fa0: 7574 2075 7365 7320 3230 3032 3a3a 2f31  ut uses 2002::/1
+00024fb0: 3620 7261 6e67 650a 2020 2020 2020 2020  6 range.        
+00024fc0: 2d20 6973 5f74 6572 6564 6f3a 2053 616d  - is_teredo: Sam
+00024fd0: 6520 6173 2061 626f 7665 2062 7574 2075  e as above but u
+00024fe0: 7365 7320 3230 3031 3a3a 2f33 3220 7261  ses 2001::/32 ra
+00024ff0: 6e67 650a 2020 2020 2020 2020 2d20 7375  nge.        - su
+00025000: 626e 6574 733a 2076 616c 7565 206d 7573  bnets: value mus
+00025010: 7420 6265 2061 206d 656d 6265 7220 6f66  t be a member of
+00025020: 2061 7420 6c65 6173 7420 6f6e 6520 6672   at least one fr
+00025030: 6f6d 206c 6973 7420 6f66 2073 7562 6e65  om list of subne
+00025040: 7473 0a20 2020 2020 2020 202d 2069 735f  ts.        - is_
+00025050: 6970 7636 3a20 6569 7468 6572 3a0a 0a20  ipv6: either:.. 
+00025060: 2020 2020 2020 2020 2020 202d 204e 6f6e             - Non
+00025070: 6520 2864 6566 6175 6c74 293a 2069 6e64  e (default): ind
+00025080: 6966 6665 7265 6e74 0a20 2020 2020 2020  ifferent.       
+00025090: 2020 2020 202d 2054 7275 6520 2865 6e66       - True (enf
+000250a0: 6f72 6365 293a 206d 7573 7420 6265 2061  orce): must be a
+000250b0: 6e20 4950 7636 2061 6464 7265 7373 0a20  n IPv6 address. 
+000250c0: 2020 2020 2020 2020 2020 202d 2046 616c             - Fal
+000250d0: 7365 2028 666f 7262 6964 293a 206d 7573  se (forbid): mus
+000250e0: 7420 4e4f 5420 6265 2061 6e20 4950 7636  t NOT be an IPv6
+000250f0: 2061 6464 7265 7373 0a0a 2020 2020 4d69   address..    Mi
+00025100: 6e69 7020 616e 6420 6d61 7869 7020 6d61  nip and maxip ma
+00025110: 7920 616c 736f 2062 6520 6c69 7374 7320  y also be lists 
+00025120: 6f72 2074 7570 6c65 7320 6f66 2061 6464  or tuples of add
+00025130: 7265 7373 6573 2069 6e20 616c 6c20 6162  resses in all ab
+00025140: 6f76 650a 2020 2020 666f 726d 7320 2873  ove.    forms (s
+00025150: 7472 2c20 696e 742c 206c 6973 7420 2f20  tr, int, list / 
+00025160: 7475 706c 6529 2c20 616c 6c6f 7769 6e67  tuple), allowing
+00025170: 2073 6574 7570 206f 6620 6d75 6c74 6970   setup of multip
+00025180: 6c65 2061 6464 7265 7373 2072 616e 6765  le address range
+00025190: 733a 3a0a 0a20 2020 2020 2020 206d 696e  s::..        min
+000251a0: 6970 203d 2028 6d69 6e69 7031 2c20 6d69  ip = (minip1, mi
+000251b0: 6e69 7032 2c20 2e2e 2e20 6d69 6e69 704e  nip2, ... minipN
+000251c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000251d0: 2020 2020 207c 2020 2020 2020 207c 2020       |       |  
+000251e0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+000251f0: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+00025200: 2020 2020 2020 7c20 2020 2020 2020 2020        |         
+00025210: 2020 7c0a 2020 2020 2020 2020 6d61 7869    |.        maxi
+00025220: 7020 3d20 286d 6178 6970 312c 206d 6178  p = (maxip1, max
+00025230: 6970 322c 202e 2e2e 206d 6178 6970 4e29  ip2, ... maxipN)
+00025240: 0a0a 2020 2020 4c6f 6e67 6572 2069 7465  ..    Longer ite
+00025250: 7261 626c 6520 7769 6c6c 2062 6520 7472  rable will be tr
+00025260: 756e 6361 7465 6420 746f 206d 6174 6368  uncated to match
+00025270: 206c 656e 6774 6820 6f66 2073 686f 7274   length of short
+00025280: 6572 206f 6e65 2e0a 0a20 2020 2020 2020  er one...       
+00025290: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
+000252a0: 5328 2928 2731 3932 2e31 3638 2e31 2e35  S()('192.168.1.5
+000252b0: 2729 0a20 2020 2020 2020 2028 2731 3932  ').        ('192
+000252c0: 2e31 3638 2e31 2e35 272c 204e 6f6e 6529  .168.1.5', None)
+000252d0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+000252e0: 4950 4144 4452 4553 5328 6973 5f69 7076  IPADDRESS(is_ipv
+000252f0: 363d 4661 6c73 6529 2827 3139 322e 3136  6=False)('192.16
+00025300: 382e 312e 3527 290a 2020 2020 2020 2020  8.1.5').        
+00025310: 2827 3139 322e 3136 382e 312e 3527 2c20  ('192.168.1.5', 
+00025320: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+00025330: 3e20 4953 5f49 5041 4444 5245 5353 2829  > IS_IPADDRESS()
+00025340: 2827 3235 352e 3235 352e 3235 352e 3235  ('255.255.255.25
+00025350: 3527 290a 2020 2020 2020 2020 2827 3235  5').        ('25
+00025360: 352e 3235 352e 3235 352e 3235 3527 2c20  5.255.255.255', 
+00025370: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+00025380: 3e20 4953 5f49 5041 4444 5245 5353 2829  > IS_IPADDRESS()
+00025390: 2827 3139 322e 3136 382e 312e 3520 2729  ('192.168.1.5 ')
+000253a0: 0a20 2020 2020 2020 2028 2731 3932 2e31  .        ('192.1
+000253b0: 3638 2e31 2e35 2027 2c20 2765 6e74 6572  68.1.5 ', 'enter
+000253c0: 2076 616c 6964 2049 5020 6164 6472 6573   valid IP addres
+000253d0: 7327 290a 2020 2020 2020 2020 3e3e 3e20  s').        >>> 
+000253e0: 4953 5f49 5041 4444 5245 5353 2829 2827  IS_IPADDRESS()('
+000253f0: 3139 322e 3136 382e 312e 312e 3527 290a  192.168.1.1.5').
+00025400: 2020 2020 2020 2020 2827 3139 322e 3136          ('192.16
+00025410: 382e 312e 312e 3527 2c20 2765 6e74 6572  8.1.1.5', 'enter
+00025420: 2076 616c 6964 2049 5020 6164 6472 6573   valid IP addres
+00025430: 7327 290a 2020 2020 2020 2020 3e3e 3e20  s').        >>> 
+00025440: 4953 5f49 5041 4444 5245 5353 2829 2827  IS_IPADDRESS()('
+00025450: 3132 332e 3132 3327 290a 2020 2020 2020  123.123').      
+00025460: 2020 2827 3132 332e 3132 3327 2c20 2765    ('123.123', 'e
+00025470: 6e74 6572 2076 616c 6964 2049 5020 6164  nter valid IP ad
+00025480: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
+00025490: 3e3e 3e20 4953 5f49 5041 4444 5245 5353  >>> IS_IPADDRESS
+000254a0: 2829 2827 3131 3131 2e32 2e33 2e34 2729  ()('1111.2.3.4')
+000254b0: 0a20 2020 2020 2020 2028 2731 3131 312e  .        ('1111.
+000254c0: 322e 332e 3427 2c20 2765 6e74 6572 2076  2.3.4', 'enter v
+000254d0: 616c 6964 2049 5020 6164 6472 6573 7327  alid IP address'
+000254e0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+000254f0: 5f49 5041 4444 5245 5353 2829 2827 3031  _IPADDRESS()('01
+00025500: 3131 2e32 2e33 2e34 2729 0a20 2020 2020  11.2.3.4').     
+00025510: 2020 2028 2730 3131 312e 322e 332e 3427     ('0111.2.3.4'
+00025520: 2c20 2765 6e74 6572 2076 616c 6964 2049  , 'enter valid I
+00025530: 5020 6164 6472 6573 7327 290a 2020 2020  P address').    
+00025540: 2020 2020 3e3e 3e20 4953 5f49 5041 4444      >>> IS_IPADD
+00025550: 5245 5353 2829 2827 3235 362e 322e 332e  RESS()('256.2.3.
+00025560: 3427 290a 2020 2020 2020 2020 2827 3235  4').        ('25
+00025570: 362e 322e 332e 3427 2c20 2765 6e74 6572  6.2.3.4', 'enter
+00025580: 2076 616c 6964 2049 5020 6164 6472 6573   valid IP addres
+00025590: 7327 290a 2020 2020 2020 2020 3e3e 3e20  s').        >>> 
+000255a0: 4953 5f49 5041 4444 5245 5353 2829 2827  IS_IPADDRESS()('
+000255b0: 3330 302e 322e 332e 3427 290a 2020 2020  300.2.3.4').    
+000255c0: 2020 2020 2827 3330 302e 322e 332e 3427      ('300.2.3.4'
+000255d0: 2c20 2765 6e74 6572 2076 616c 6964 2049  , 'enter valid I
+000255e0: 5020 6164 6472 6573 7327 290a 2020 2020  P address').    
+000255f0: 2020 2020 3e3e 3e20 4953 5f49 5041 4444      >>> IS_IPADD
+00025600: 5245 5353 286d 696e 6970 3d27 3139 322e  RESS(minip='192.
+00025610: 3136 382e 312e 3027 2c20 6d61 7869 703d  168.1.0', maxip=
+00025620: 2731 3932 2e31 3638 2e31 2e32 3535 2729  '192.168.1.255')
+00025630: 2827 3139 322e 3136 382e 312e 3130 3027  ('192.168.1.100'
+00025640: 290a 2020 2020 2020 2020 2827 3139 322e  ).        ('192.
+00025650: 3136 382e 312e 3130 3027 2c20 4e6f 6e65  168.1.100', None
+00025660: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+00025670: 5f49 5041 4444 5245 5353 286d 696e 6970  _IPADDRESS(minip
+00025680: 3d27 312e 322e 332e 3527 2c20 6d61 7869  ='1.2.3.5', maxi
+00025690: 703d 2731 2e32 2e33 2e39 272c 2065 7272  p='1.2.3.9', err
+000256a0: 6f72 5f6d 6573 7361 6765 3d27 4261 6420  or_message='Bad 
+000256b0: 6970 2729 2827 312e 322e 332e 3427 290a  ip')('1.2.3.4').
+000256c0: 2020 2020 2020 2020 2827 312e 322e 332e          ('1.2.3.
+000256d0: 3427 2c20 2762 6164 2069 7027 290a 2020  4', 'bad ip').  
+000256e0: 2020 2020 2020 3e3e 3e20 4953 5f49 5041        >>> IS_IPA
+000256f0: 4444 5245 5353 286d 6178 6970 3d27 312e  DDRESS(maxip='1.
+00025700: 322e 332e 3427 2c20 696e 7665 7274 3d54  2.3.4', invert=T
+00025710: 7275 6529 2827 3132 372e 302e 302e 3127  rue)('127.0.0.1'
+00025720: 290a 2020 2020 2020 2020 2827 3132 372e  ).        ('127.
+00025730: 302e 302e 3127 2c20 4e6f 6e65 290a 2020  0.0.1', None).  
+00025740: 2020 2020 2020 3e3e 3e20 4953 5f49 5041        >>> IS_IPA
+00025750: 4444 5245 5353 286d 6178 6970 3d27 3139  DDRESS(maxip='19
+00025760: 322e 3136 382e 312e 3427 2c20 696e 7665  2.168.1.4', inve
+00025770: 7274 3d54 7275 6529 2827 3139 322e 3136  rt=True)('192.16
+00025780: 382e 312e 3427 290a 2020 2020 2020 2020  8.1.4').        
+00025790: 2827 3139 322e 3136 382e 312e 3427 2c20  ('192.168.1.4', 
+000257a0: 2765 6e74 6572 2076 616c 6964 2049 5020  'enter valid IP 
+000257b0: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
+000257c0: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
+000257d0: 5353 2869 735f 6c6f 6361 6c68 6f73 743d  SS(is_localhost=
+000257e0: 5472 7565 2928 2731 3237 2e30 2e30 2e31  True)('127.0.0.1
+000257f0: 2729 0a20 2020 2020 2020 2028 2731 3237  ').        ('127
+00025800: 2e30 2e30 2e31 272c 204e 6f6e 6529 0a20  .0.0.1', None). 
+00025810: 2020 2020 2020 203e 3e3e 2049 535f 4950         >>> IS_IP
+00025820: 4144 4452 4553 5328 6973 5f6c 6f63 616c  ADDRESS(is_local
+00025830: 686f 7374 3d54 7275 6529 2827 3139 322e  host=True)('192.
+00025840: 3136 382e 312e 3130 2729 0a20 2020 2020  168.1.10').     
+00025850: 2020 2028 2731 3932 2e31 3638 2e31 2e31     ('192.168.1.1
+00025860: 3027 2c20 2765 6e74 6572 2076 616c 6964  0', 'enter valid
+00025870: 2049 5020 6164 6472 6573 7327 290a 2020   IP address').  
+00025880: 2020 2020 2020 3e3e 3e20 4953 5f49 5041        >>> IS_IPA
+00025890: 4444 5245 5353 2869 735f 6c6f 6361 6c68  DDRESS(is_localh
+000258a0: 6f73 743d 4661 6c73 6529 2827 3132 372e  ost=False)('127.
+000258b0: 302e 302e 3127 290a 2020 2020 2020 2020  0.0.1').        
+000258c0: 2827 3132 372e 302e 302e 3127 2c20 2765  ('127.0.0.1', 'e
+000258d0: 6e74 6572 2076 616c 6964 2049 5020 6164  nter valid IP ad
+000258e0: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
+000258f0: 3e3e 3e20 4953 5f49 5041 4444 5245 5353  >>> IS_IPADDRESS
+00025900: 286d 6178 6970 3d27 3130 302e 302e 302e  (maxip='100.0.0.
+00025910: 3027 2c20 6973 5f6c 6f63 616c 686f 7374  0', is_localhost
+00025920: 3d54 7275 6529 2827 3132 372e 302e 302e  =True)('127.0.0.
+00025930: 3127 290a 2020 2020 2020 2020 2827 3132  1').        ('12
+00025940: 372e 302e 302e 3127 2c20 2765 6e74 6572  7.0.0.1', 'enter
+00025950: 2076 616c 6964 2049 5020 6164 6472 6573   valid IP addres
+00025960: 7327 290a 0a20 2020 2020 2020 203e 3e3e  s')..        >>>
+00025970: 2049 535f 4950 4144 4452 4553 5328 2928   IS_IPADDRESS()(
+00025980: 2766 6538 303a 3a31 3236 633a 3866 6661  'fe80::126c:8ffa
+00025990: 3a66 6532 323a 6233 6166 2729 0a20 2020  :fe22:b3af').   
+000259a0: 2020 2020 2028 2766 6538 303a 3a31 3236       ('fe80::126
+000259b0: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
+000259c0: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
+000259d0: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
+000259e0: 5328 6973 5f69 7076 343d 4661 6c73 6529  S(is_ipv4=False)
+000259f0: 2827 6665 3830 3a3a 3132 3663 3a38 6666  ('fe80::126c:8ff
+00025a00: 613a 6665 3232 3a62 3361 6627 290a 2020  a:fe22:b3af').  
+00025a10: 2020 2020 2020 2827 6665 3830 3a3a 3132        ('fe80::12
+00025a20: 3663 3a38 6666 613a 6665 3232 3a62 3361  6c:8ffa:fe22:b3a
+00025a30: 6627 2c20 4e6f 6e65 290a 2020 2020 2020  f', None).      
+00025a40: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
+00025a50: 5353 2829 2827 6665 3830 3a3a 3132 3663  SS()('fe80::126c
+00025a60: 3a38 6666 613a 6665 3232 3a62 3361 6620  :8ffa:fe22:b3af 
+00025a70: 2027 290a 2020 2020 2020 2020 2827 6665   ').        ('fe
+00025a80: 3830 3a3a 3132 3663 3a38 6666 613a 6665  80::126c:8ffa:fe
+00025a90: 3232 3a62 3361 6620 2027 2c20 2765 6e74  22:b3af  ', 'ent
+00025aa0: 6572 2076 616c 6964 2049 5020 6164 6472  er valid IP addr
+00025ab0: 6573 7327 290a 2020 2020 2020 2020 3e3e  ess').        >>
+00025ac0: 3e20 4953 5f49 5041 4444 5245 5353 2869  > IS_IPADDRESS(i
+00025ad0: 735f 6970 7634 3d54 7275 6529 2827 6665  s_ipv4=True)('fe
+00025ae0: 3830 3a3a 3132 3663 3a38 6666 613a 6665  80::126c:8ffa:fe
+00025af0: 3232 3a62 3361 6627 290a 2020 2020 2020  22:b3af').      
+00025b00: 2020 2827 6665 3830 3a3a 3132 3663 3a38    ('fe80::126c:8
+00025b10: 6666 613a 6665 3232 3a62 3361 6627 2c20  ffa:fe22:b3af', 
+00025b20: 2765 6e74 6572 2076 616c 6964 2049 5020  'enter valid IP 
+00025b30: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
+00025b40: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
+00025b50: 5353 2869 735f 6970 7636 3d54 7275 6529  SS(is_ipv6=True)
+00025b60: 2827 3139 322e 3136 382e 312e 3127 290a  ('192.168.1.1').
+00025b70: 2020 2020 2020 2020 2827 3139 322e 3136          ('192.16
+00025b80: 382e 312e 3127 2c20 2765 6e74 6572 2076  8.1.1', 'enter v
+00025b90: 616c 6964 2049 5020 6164 6472 6573 7327  alid IP address'
+00025ba0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+00025bb0: 5f49 5041 4444 5245 5353 2869 735f 6970  _IPADDRESS(is_ip
+00025bc0: 7636 3d54 7275 652c 2065 7272 6f72 5f6d  v6=True, error_m
+00025bd0: 6573 7361 6765 3d27 4261 6420 6970 2729  essage='Bad ip')
+00025be0: 2827 3139 322e 3136 382e 312e 3127 290a  ('192.168.1.1').
+00025bf0: 2020 2020 2020 2020 2827 3139 322e 3136          ('192.16
+00025c00: 382e 312e 3127 2c20 2762 6164 2069 7027  8.1.1', 'bad ip'
+00025c10: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+00025c20: 5f49 5041 4444 5245 5353 2869 735f 6c69  _IPADDRESS(is_li
+00025c30: 6e6b 5f6c 6f63 616c 3d54 7275 6529 2827  nk_local=True)('
+00025c40: 6665 3830 3a3a 3132 3663 3a38 6666 613a  fe80::126c:8ffa:
+00025c50: 6665 3232 3a62 3361 6627 290a 2020 2020  fe22:b3af').    
+00025c60: 2020 2020 2827 6665 3830 3a3a 3132 3663      ('fe80::126c
+00025c70: 3a38 6666 613a 6665 3232 3a62 3361 6627  :8ffa:fe22:b3af'
+00025c80: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+00025c90: 3e3e 3e20 4953 5f49 5041 4444 5245 5353  >>> IS_IPADDRESS
+00025ca0: 2869 735f 6c69 6e6b 5f6c 6f63 616c 3d46  (is_link_local=F
+00025cb0: 616c 7365 2928 2766 6538 303a 3a31 3236  alse)('fe80::126
+00025cc0: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
+00025cd0: 2729 0a20 2020 2020 2020 2028 2766 6538  ').        ('fe8
+00025ce0: 303a 3a31 3236 633a 3866 6661 3a66 6532  0::126c:8ffa:fe2
+00025cf0: 323a 6233 6166 272c 2027 656e 7465 7220  2:b3af', 'enter 
+00025d00: 7661 6c69 6420 4950 2061 6464 7265 7373  valid IP address
+00025d10: 2729 0a20 2020 2020 2020 203e 3e3e 2049  ').        >>> I
+00025d20: 535f 4950 4144 4452 4553 5328 6973 5f6c  S_IPADDRESS(is_l
+00025d30: 696e 6b5f 6c6f 6361 6c3d 5472 7565 2928  ink_local=True)(
+00025d40: 2732 3030 313a 3a31 3236 633a 3866 6661  '2001::126c:8ffa
+00025d50: 3a66 6532 323a 6233 6166 2729 0a20 2020  :fe22:b3af').   
+00025d60: 2020 2020 2028 2732 3030 313a 3a31 3236       ('2001::126
+00025d70: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
+00025d80: 272c 2027 656e 7465 7220 7661 6c69 6420  ', 'enter valid 
+00025d90: 4950 2061 6464 7265 7373 2729 0a20 2020  IP address').   
+00025da0: 2020 2020 203e 3e3e 2049 535f 4950 4144       >>> IS_IPAD
+00025db0: 4452 4553 5328 6973 5f6d 756c 7469 6361  DRESS(is_multica
+00025dc0: 7374 3d54 7275 6529 2827 3230 3031 3a3a  st=True)('2001::
+00025dd0: 3132 3663 3a38 6666 613a 6665 3232 3a62  126c:8ffa:fe22:b
+00025de0: 3361 6627 290a 2020 2020 2020 2020 2827  3af').        ('
+00025df0: 3230 3031 3a3a 3132 3663 3a38 6666 613a  2001::126c:8ffa:
+00025e00: 6665 3232 3a62 3361 6627 2c20 2765 6e74  fe22:b3af', 'ent
+00025e10: 6572 2076 616c 6964 2049 5020 6164 6472  er valid IP addr
+00025e20: 6573 7327 290a 2020 2020 2020 2020 3e3e  ess').        >>
+00025e30: 3e20 4953 5f49 5041 4444 5245 5353 2869  > IS_IPADDRESS(i
+00025e40: 735f 6d75 6c74 6963 6173 743d 5472 7565  s_multicast=True
+00025e50: 2928 2766 6630 303a 3a31 3236 633a 3866  )('ff00::126c:8f
+00025e60: 6661 3a66 6532 323a 6233 6166 2729 0a20  fa:fe22:b3af'). 
+00025e70: 2020 2020 2020 2028 2766 6630 303a 3a31         ('ff00::1
+00025e80: 3236 633a 3866 6661 3a66 6532 323a 6233  26c:8ffa:fe22:b3
+00025e90: 6166 272c 204e 6f6e 6529 0a20 2020 2020  af', None).     
+00025ea0: 2020 203e 3e3e 2049 535f 4950 4144 4452     >>> IS_IPADDR
+00025eb0: 4553 5328 6973 5f72 6f75 7465 6162 6c65  ESS(is_routeable
+00025ec0: 3d54 7275 6529 2827 3230 3031 3a3a 3132  =True)('2001::12
+00025ed0: 3663 3a38 6666 613a 6665 3232 3a62 3361  6c:8ffa:fe22:b3a
+00025ee0: 6627 290a 2020 2020 2020 2020 2827 3230  f').        ('20
+00025ef0: 3031 3a3a 3132 3663 3a38 6666 613a 6665  01::126c:8ffa:fe
+00025f00: 3232 3a62 3361 6627 2c20 4e6f 6e65 290a  22:b3af', None).
+00025f10: 2020 2020 2020 2020 3e3e 3e20 4953 5f49          >>> IS_I
+00025f20: 5041 4444 5245 5353 2869 735f 726f 7574  PADDRESS(is_rout
+00025f30: 6561 626c 653d 5472 7565 2928 2766 6630  eable=True)('ff0
+00025f40: 303a 3a31 3236 633a 3866 6661 3a66 6532  0::126c:8ffa:fe2
+00025f50: 323a 6233 6166 2729 0a20 2020 2020 2020  2:b3af').       
+00025f60: 2028 2766 6630 303a 3a31 3236 633a 3866   ('ff00::126c:8f
+00025f70: 6661 3a66 6532 323a 6233 6166 272c 2027  fa:fe22:b3af', '
+00025f80: 656e 7465 7220 7661 6c69 6420 4950 2061  enter valid IP a
+00025f90: 6464 7265 7373 2729 0a20 2020 2020 2020  ddress').       
+00025fa0: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
+00025fb0: 5328 7375 626e 6574 733d 2732 3030 313a  S(subnets='2001:
+00025fc0: 3a2f 3332 2729 2827 3230 3031 3a3a 3866  :/32')('2001::8f
+00025fd0: 6661 3a66 6532 323a 6233 6166 2729 0a20  fa:fe22:b3af'). 
+00025fe0: 2020 2020 2020 2028 2732 3030 313a 3a38         ('2001::8
+00025ff0: 6666 613a 6665 3232 3a62 3361 6627 2c20  ffa:fe22:b3af', 
+00026000: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+00026010: 3e20 4953 5f49 5041 4444 5245 5353 2873  > IS_IPADDRESS(s
+00026020: 7562 6e65 7473 3d27 6662 3030 3a3a 2f38  ubnets='fb00::/8
+00026030: 2729 2827 3230 3031 3a3a 3866 6661 3a66  ')('2001::8ffa:f
+00026040: 6532 323a 6233 6166 2729 0a20 2020 2020  e22:b3af').     
+00026050: 2020 2028 2732 3030 313a 3a38 6666 613a     ('2001::8ffa:
+00026060: 6665 3232 3a62 3361 6627 2c20 2765 6e74  fe22:b3af', 'ent
+00026070: 6572 2076 616c 6964 2049 5020 6164 6472  er valid IP addr
+00026080: 6573 7327 290a 2020 2020 2020 2020 3e3e  ess').        >>
+00026090: 3e20 4953 5f49 5041 4444 5245 5353 2873  > IS_IPADDRESS(s
+000260a0: 7562 6e65 7473 3d5b 2766 6330 303a 3a2f  ubnets=['fc00::/
+000260b0: 3827 2c27 3230 3031 3a3a 2f33 3227 5d29  8','2001::/32'])
+000260c0: 2827 3230 3031 3a3a 3866 6661 3a66 6532  ('2001::8ffa:fe2
+000260d0: 323a 6233 6166 2729 0a20 2020 2020 2020  2:b3af').       
+000260e0: 2028 2732 3030 313a 3a38 6666 613a 6665   ('2001::8ffa:fe
+000260f0: 3232 3a62 3361 6627 2c20 4e6f 6e65 290a  22:b3af', None).
+00026100: 2020 2020 2020 2020 3e3e 3e20 4953 5f49          >>> IS_I
+00026110: 5041 4444 5245 5353 2873 7562 6e65 7473  PADDRESS(subnets
+00026120: 3d27 696e 7661 6c69 6473 7562 6e65 7427  ='invalidsubnet'
+00026130: 2928 2732 3030 313a 3a38 6666 613a 6665  )('2001::8ffa:fe
+00026140: 3232 3a62 3361 6627 290a 2020 2020 2020  22:b3af').      
+00026150: 2020 2827 3230 3031 3a3a 3866 6661 3a66    ('2001::8ffa:f
+00026160: 6532 323a 6233 6166 272c 2027 696e 7661  e22:b3af', 'inva
+00026170: 6c69 6420 7375 626e 6574 2070 726f 7669  lid subnet provi
+00026180: 6465 6427 290a 2020 2020 2222 220a 0a20  ded').    """.. 
+00026190: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+000261a0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000261b0: 2020 2020 2020 206d 696e 6970 3d22 302e         minip="0.
+000261c0: 302e 302e 3022 2c0a 2020 2020 2020 2020  0.0.0",.        
+000261d0: 6d61 7869 703d 2232 3535 2e32 3535 2e32  maxip="255.255.2
+000261e0: 3535 2e32 3535 222c 0a20 2020 2020 2020  55.255",.       
+000261f0: 2069 6e76 6572 743d 4661 6c73 652c 0a20   invert=False,. 
+00026200: 2020 2020 2020 2069 735f 6c6f 6361 6c68         is_localh
+00026210: 6f73 743d 4e6f 6e65 2c0a 2020 2020 2020  ost=None,.      
+00026220: 2020 6973 5f70 7269 7661 7465 3d4e 6f6e    is_private=Non
+00026230: 652c 0a20 2020 2020 2020 2069 735f 6175  e,.        is_au
+00026240: 746f 6d61 7469 633d 4e6f 6e65 2c0a 2020  tomatic=None,.  
+00026250: 2020 2020 2020 6973 5f69 7076 343d 4e6f        is_ipv4=No
+00026260: 6e65 2c0a 2020 2020 2020 2020 6973 5f6c  ne,.        is_l
+00026270: 696e 6b5f 6c6f 6361 6c3d 4e6f 6e65 2c0a  ink_local=None,.
+00026280: 2020 2020 2020 2020 6973 5f72 6573 6572          is_reser
+00026290: 7665 643d 4e6f 6e65 2c0a 2020 2020 2020  ved=None,.      
+000262a0: 2020 6973 5f6d 756c 7469 6361 7374 3d4e    is_multicast=N
+000262b0: 6f6e 652c 0a20 2020 2020 2020 2069 735f  one,.        is_
+000262c0: 726f 7574 6561 626c 653d 4e6f 6e65 2c0a  routeable=None,.
+000262d0: 2020 2020 2020 2020 6973 5f36 746f 343d          is_6to4=
+000262e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6973  None,.        is
+000262f0: 5f74 6572 6564 6f3d 4e6f 6e65 2c0a 2020  _teredo=None,.  
+00026300: 2020 2020 2020 7375 626e 6574 733d 4e6f        subnets=No
+00026310: 6e65 2c0a 2020 2020 2020 2020 6973 5f69  ne,.        is_i
+00026320: 7076 363d 4e6f 6e65 2c0a 2020 2020 2020  pv6=None,.      
+00026330: 2020 6572 726f 725f 6d65 7373 6167 653d    error_message=
+00026340: 2245 6e74 6572 2076 616c 6964 2049 5020  "Enter valid IP 
+00026350: 6164 6472 6573 7322 2c0a 2020 2020 293a  address",.    ):
+00026360: 0a0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
+00026370: 696e 6970 203d 2028 6d69 6e69 702c 290a  inip = (minip,).
+00026380: 2020 2020 2020 2020 7365 6c66 2e6d 6178          self.max
+00026390: 6970 203d 2028 6d61 7869 702c 290a 2020  ip = (maxip,).  
+000263a0: 2020 2020 2020 7365 6c66 2e69 6e76 6572        self.inver
+000263b0: 7420 3d20 696e 7665 7274 0a20 2020 2020  t = invert.     
+000263c0: 2020 2073 656c 662e 6973 5f6c 6f63 616c     self.is_local
+000263d0: 686f 7374 203d 2069 735f 6c6f 6361 6c68  host = is_localh
+000263e0: 6f73 740a 2020 2020 2020 2020 7365 6c66  ost.        self
+000263f0: 2e69 735f 7072 6976 6174 6520 3d20 6973  .is_private = is
+00026400: 5f70 7269 7661 7465 0a20 2020 2020 2020  _private.       
+00026410: 2073 656c 662e 6973 5f61 7574 6f6d 6174   self.is_automat
+00026420: 6963 203d 2069 735f 6175 746f 6d61 7469  ic = is_automati
+00026430: 630a 2020 2020 2020 2020 7365 6c66 2e69  c.        self.i
+00026440: 735f 6970 7634 203d 2069 735f 6970 7634  s_ipv4 = is_ipv4
+00026450: 206f 7220 6973 5f69 7076 3620 6973 2046   or is_ipv6 is F
+00026460: 616c 7365 0a20 2020 2020 2020 2073 656c  alse.        sel
+00026470: 662e 6973 5f70 7269 7661 7465 203d 2069  f.is_private = i
+00026480: 735f 7072 6976 6174 650a 2020 2020 2020  s_private.      
+00026490: 2020 7365 6c66 2e69 735f 6c69 6e6b 5f6c    self.is_link_l
+000264a0: 6f63 616c 203d 2069 735f 6c69 6e6b 5f6c  ocal = is_link_l
+000264b0: 6f63 616c 0a20 2020 2020 2020 2073 656c  ocal.        sel
+000264c0: 662e 6973 5f72 6573 6572 7665 6420 3d20  f.is_reserved = 
+000264d0: 6973 5f72 6573 6572 7665 640a 2020 2020  is_reserved.    
+000264e0: 2020 2020 7365 6c66 2e69 735f 6d75 6c74      self.is_mult
+000264f0: 6963 6173 7420 3d20 6973 5f6d 756c 7469  icast = is_multi
+00026500: 6361 7374 0a20 2020 2020 2020 2073 656c  cast.        sel
+00026510: 662e 6973 5f72 6f75 7465 6162 6c65 203d  f.is_routeable =
+00026520: 2069 735f 726f 7574 6561 626c 650a 2020   is_routeable.  
+00026530: 2020 2020 2020 7365 6c66 2e69 735f 3674        self.is_6t
+00026540: 6f34 203d 2069 735f 3674 6f34 0a20 2020  o4 = is_6to4.   
+00026550: 2020 2020 2073 656c 662e 6973 5f74 6572       self.is_ter
+00026560: 6564 6f20 3d20 6973 5f74 6572 6564 6f0a  edo = is_teredo.
+00026570: 2020 2020 2020 2020 7365 6c66 2e73 7562          self.sub
+00026580: 6e65 7473 203d 2073 7562 6e65 7473 0a20  nets = subnets. 
+00026590: 2020 2020 2020 2073 656c 662e 6973 5f69         self.is_i
+000265a0: 7076 3620 3d20 6973 5f69 7076 3620 6f72  pv6 = is_ipv6 or
+000265b0: 2069 735f 6970 7634 2069 7320 4661 6c73   is_ipv4 is Fals
+000265c0: 650a 2020 2020 2020 2020 7365 6c66 2e65  e.        self.e
+000265d0: 7272 6f72 5f6d 6573 7361 6765 203d 2065  rror_message = e
+000265e0: 7272 6f72 5f6d 6573 7361 6765 0a0a 2020  rror_message..  
+000265f0: 2020 6465 6620 7661 6c69 6461 7465 2873    def validate(s
+00026600: 656c 662c 2076 616c 7565 2c20 7265 636f  elf, value, reco
+00026610: 7264 5f69 643d 4e6f 6e65 293a 0a20 2020  rd_id=None):.   
+00026620: 2020 2020 2049 5041 6464 7265 7373 203d       IPAddress =
+00026630: 2069 7061 6464 7265 7373 2e69 705f 6164   ipaddress.ip_ad
+00026640: 6472 6573 730a 2020 2020 2020 2020 4950  dress.        IP
+00026650: 7636 4164 6472 6573 7320 3d20 6970 6164  v6Address = ipad
+00026660: 6472 6573 732e 4950 7636 4164 6472 6573  dress.IPv6Addres
+00026670: 730a 2020 2020 2020 2020 4950 7634 4164  s.        IPv4Ad
+00026680: 6472 6573 7320 3d20 6970 6164 6472 6573  dress = ipaddres
+00026690: 732e 4950 7634 4164 6472 6573 730a 0a20  s.IPv4Address.. 
+000266a0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+000266b0: 2020 2020 2020 2020 6970 203d 2049 5041          ip = IPA
+000266c0: 6464 7265 7373 2874 6f5f 756e 6963 6f64  ddress(to_unicod
+000266d0: 6528 7661 6c75 6529 290a 2020 2020 2020  e(value)).      
+000266e0: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
+000266f0: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+00026700: 2072 6169 7365 2056 616c 6964 6174 696f   raise Validatio
+00026710: 6e45 7272 6f72 2873 656c 662e 7472 616e  nError(self.tran
+00026720: 736c 6174 6f72 2873 656c 662e 6572 726f  slator(self.erro
+00026730: 725f 6d65 7373 6167 6529 290a 0a20 2020  r_message))..   
+00026740: 2020 2020 2069 6620 7365 6c66 2e69 735f       if self.is_
+00026750: 6970 7634 2061 6e64 2069 7369 6e73 7461  ipv4 and isinsta
+00026760: 6e63 6528 6970 2c20 4950 7636 4164 6472  nce(ip, IPv6Addr
+00026770: 6573 7329 3a0a 2020 2020 2020 2020 2020  ess):.          
+00026780: 2020 7261 6973 6520 5661 6c69 6461 7469    raise Validati
+00026790: 6f6e 4572 726f 7228 7365 6c66 2e74 7261  onError(self.tra
+000267a0: 6e73 6c61 746f 7228 7365 6c66 2e65 7272  nslator(self.err
+000267b0: 6f72 5f6d 6573 7361 6765 2929 0a20 2020  or_message)).   
+000267c0: 2020 2020 2065 6c69 6620 7365 6c66 2e69       elif self.i
+000267d0: 735f 6970 7636 2061 6e64 2069 7369 6e73  s_ipv6 and isins
+000267e0: 7461 6e63 6528 6970 2c20 4950 7634 4164  tance(ip, IPv4Ad
+000267f0: 6472 6573 7329 3a0a 2020 2020 2020 2020  dress):.        
+00026800: 2020 2020 7261 6973 6520 5661 6c69 6461      raise Valida
+00026810: 7469 6f6e 4572 726f 7228 7365 6c66 2e74  tionError(self.t
+00026820: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
+00026830: 7272 6f72 5f6d 6573 7361 6765 2929 0a20  rror_message)). 
+00026840: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00026850: 2e69 735f 6970 7634 206f 7220 6973 696e  .is_ipv4 or isin
+00026860: 7374 616e 6365 2869 702c 2049 5076 3441  stance(ip, IPv4A
+00026870: 6464 7265 7373 293a 0a20 2020 2020 2020  ddress):.       
+00026880: 2020 2020 2072 6574 7572 6e20 4953 5f49       return IS_I
+00026890: 5056 3428 0a20 2020 2020 2020 2020 2020  PV4(.           
+000268a0: 2020 2020 206d 696e 6970 3d73 656c 662e       minip=self.
+000268b0: 6d69 6e69 702c 0a20 2020 2020 2020 2020  minip,.         
+000268c0: 2020 2020 2020 206d 6178 6970 3d73 656c         maxip=sel
+000268d0: 662e 6d61 7869 702c 0a20 2020 2020 2020  f.maxip,.       
+000268e0: 2020 2020 2020 2020 2069 6e76 6572 743d           invert=
+000268f0: 7365 6c66 2e69 6e76 6572 742c 0a20 2020  self.invert,.   
+00026900: 2020 2020 2020 2020 2020 2020 2069 735f               is_
+00026910: 6c6f 6361 6c68 6f73 743d 7365 6c66 2e69  localhost=self.i
+00026920: 735f 6c6f 6361 6c68 6f73 742c 0a20 2020  s_localhost,.   
+00026930: 2020 2020 2020 2020 2020 2020 2069 735f               is_
+00026940: 7072 6976 6174 653d 7365 6c66 2e69 735f  private=self.is_
+00026950: 7072 6976 6174 652c 0a20 2020 2020 2020  private,.       
+00026960: 2020 2020 2020 2020 2069 735f 6175 746f           is_auto
+00026970: 6d61 7469 633d 7365 6c66 2e69 735f 6175  matic=self.is_au
+00026980: 746f 6d61 7469 632c 0a20 2020 2020 2020  tomatic,.       
+00026990: 2020 2020 2020 2020 2065 7272 6f72 5f6d           error_m
+000269a0: 6573 7361 6765 3d73 656c 662e 6572 726f  essage=self.erro
+000269b0: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
+000269c0: 2020 2020 2020 2029 2e76 616c 6964 6174         ).validat
+000269d0: 6528 7661 6c75 652c 2072 6563 6f72 645f  e(value, record_
+000269e0: 6964 290a 2020 2020 2020 2020 656c 6966  id).        elif
+000269f0: 2073 656c 662e 6973 5f69 7076 3620 6f72   self.is_ipv6 or
+00026a00: 2069 7369 6e73 7461 6e63 6528 6970 2c20   isinstance(ip, 
+00026a10: 4950 7636 4164 6472 6573 7329 3a0a 2020  IPv6Address):.  
+00026a20: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00026a30: 2049 535f 4950 5636 280a 2020 2020 2020   IS_IPV6(.      
+00026a40: 2020 2020 2020 2020 2020 6973 5f70 7269            is_pri
+00026a50: 7661 7465 3d73 656c 662e 6973 5f70 7269  vate=self.is_pri
+00026a60: 7661 7465 2c0a 2020 2020 2020 2020 2020  vate,.          
+00026a70: 2020 2020 2020 6973 5f6c 696e 6b5f 6c6f        is_link_lo
+00026a80: 6361 6c3d 7365 6c66 2e69 735f 6c69 6e6b  cal=self.is_link
+00026a90: 5f6c 6f63 616c 2c0a 2020 2020 2020 2020  _local,.        
+00026aa0: 2020 2020 2020 2020 6973 5f72 6573 6572          is_reser
+00026ab0: 7665 643d 7365 6c66 2e69 735f 7265 7365  ved=self.is_rese
+00026ac0: 7276 6564 2c0a 2020 2020 2020 2020 2020  rved,.          
+00026ad0: 2020 2020 2020 6973 5f6d 756c 7469 6361        is_multica
+00026ae0: 7374 3d73 656c 662e 6973 5f6d 756c 7469  st=self.is_multi
+00026af0: 6361 7374 2c0a 2020 2020 2020 2020 2020  cast,.          
+00026b00: 2020 2020 2020 6973 5f72 6f75 7465 6162        is_routeab
+00026b10: 6c65 3d73 656c 662e 6973 5f72 6f75 7465  le=self.is_route
+00026b20: 6162 6c65 2c0a 2020 2020 2020 2020 2020  able,.          
+00026b30: 2020 2020 2020 6973 5f36 746f 343d 7365        is_6to4=se
+00026b40: 6c66 2e69 735f 3674 6f34 2c0a 2020 2020  lf.is_6to4,.    
+00026b50: 2020 2020 2020 2020 2020 2020 6973 5f74              is_t
+00026b60: 6572 6564 6f3d 7365 6c66 2e69 735f 7465  eredo=self.is_te
+00026b70: 7265 646f 2c0a 2020 2020 2020 2020 2020  redo,.          
+00026b80: 2020 2020 2020 7375 626e 6574 733d 7365        subnets=se
+00026b90: 6c66 2e73 7562 6e65 7473 2c0a 2020 2020  lf.subnets,.    
+00026ba0: 2020 2020 2020 2020 2020 2020 6572 726f              erro
+00026bb0: 725f 6d65 7373 6167 653d 7365 6c66 2e65  r_message=self.e
+00026bc0: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
+00026bd0: 2020 2020 2020 2020 2020 292e 7661 6c69            ).vali
+00026be0: 6461 7465 2876 616c 7565 2c20 7265 636f  date(value, reco
+00026bf0: 7264 5f69 6429 0a20 2020 2020 2020 2065  rd_id).        e
+00026c00: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00026c10: 2072 6169 7365 2056 616c 6964 6174 696f   raise Validatio
+00026c20: 6e45 7272 6f72 2873 656c 662e 7472 616e  nError(self.tran
+00026c30: 736c 6174 6f72 2873 656c 662e 6572 726f  slator(self.erro
+00026c40: 725f 6d65 7373 6167 6529 290a            r_message)).
```

### Comparing `pydal-20221110.1/tests/_adapt.py` & `PyDAL-20230407.2/tests/_adapt.py`

 * *Files identical despite different names*

### Comparing `pydal-20221110.1/tests/_helpers.py` & `PyDAL-20230407.2/tests/_helpers.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,11 +1,12 @@
-from ._compat import unittest
-from ._adapt import DEFAULT_URI, drop
 from pydal import DAL
 
+from ._adapt import DEFAULT_URI, drop
+from ._compat import unittest
+
 
 class DALtest(unittest.TestCase):
     def __init__(self, *args, **kwargs):
         super(DALtest, self).__init__(*args, **kwargs)
         self._connections = []
 
     def connect(self, *args, **kwargs):
```

### Comparing `pydal-20221110.1/tests/base.py` & `PyDAL-20230407.2/tests/base.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,507 +1,508 @@
 00000000: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
 00000010: 662d 3820 2d2a 2d0a 0a69 6d70 6f72 7420  f-8 -*-..import 
-00000020: 7465 6d70 6669 6c65 0a69 6d70 6f72 7420  tempfile.import 
-00000030: 7368 7574 696c 0a0a 6672 6f6d 202e 5f63  shutil..from ._c
-00000040: 6f6d 7061 7420 696d 706f 7274 2075 6e69  ompat import uni
-00000050: 7474 6573 740a 6672 6f6d 202e 5f61 6461  ttest.from ._ada
-00000060: 7074 2069 6d70 6f72 7420 4445 4641 554c  pt import DEFAUL
-00000070: 545f 5552 492c 2064 726f 702c 2049 535f  T_URI, drop, IS_
-00000080: 4d53 5351 4c2c 2049 535f 494d 4150 2c20  MSSQL, IS_IMAP, 
-00000090: 4953 5f47 4145 2c20 4953 5f54 4552 4144  IS_GAE, IS_TERAD
-000000a0: 4154 412c 2049 535f 4f52 4143 4c45 0a66  ATA, IS_ORACLE.f
-000000b0: 726f 6d20 7079 6461 6c20 696d 706f 7274  rom pydal import
-000000c0: 2044 414c 2c20 4669 656c 640a 6672 6f6d   DAL, Field.from
-000000d0: 2070 7964 616c 2e5f 636f 6d70 6174 2069   pydal._compat i
-000000e0: 6d70 6f72 7420 5059 320a 0a0a 4075 6e69  mport PY2...@uni
-000000f0: 7474 6573 742e 736b 6970 4966 2849 535f  ttest.skipIf(IS_
-00000100: 494d 4150 2c20 2252 6566 6572 656e 6365  IMAP, "Reference
-00000110: 206e 6f74 204e 756c 6c20 756e 7375 7070   not Null unsupp
-00000120: 6f72 7465 6420 6f6e 2049 4d41 5022 290a  orted on IMAP").
-00000130: 4075 6e69 7474 6573 742e 736b 6970 4966  @unittest.skipIf
-00000140: 2849 535f 4f52 4143 4c45 2c20 2252 6566  (IS_ORACLE, "Ref
-00000150: 6572 656e 6365 204e 6f74 204e 756c 6c20  erence Not Null 
-00000160: 756e 7375 7070 6f72 7465 6420 6f6e 204f  unsupported on O
-00000170: 7261 636c 6522 290a 636c 6173 7320 5465  racle").class Te
-00000180: 7374 5265 6665 7265 6e63 654e 4f54 4e55  stReferenceNOTNU
-00000190: 4c4c 2875 6e69 7474 6573 742e 5465 7374  LL(unittest.Test
-000001a0: 4361 7365 293a 0a20 2020 2023 2031 3a4e  Case):.    # 1:N
-000001b0: 206e 6f74 206e 756c 6c0a 0a20 2020 2064   not null..    d
-000001c0: 6566 2074 6573 7452 756e 2873 656c 6629  ef testRun(self)
-000001d0: 3a0a 2020 2020 2020 2020 666f 7220 7265  :.        for re
-000001e0: 662c 2062 6967 696e 7420 696e 205b 2822  f, bigint in [("
-000001f0: 7265 6665 7265 6e63 6522 2c20 4661 6c73  reference", Fals
-00000200: 6529 2c20 2822 6269 672d 7265 6665 7265  e), ("big-refere
-00000210: 6e63 6522 2c20 5472 7565 295d 3a0a 2020  nce", True)]:.  
-00000220: 2020 2020 2020 2020 2020 6462 203d 2044            db = D
-00000230: 414c 2844 4546 4155 4c54 5f55 5249 2c20  AL(DEFAULT_URI, 
-00000240: 6368 6563 6b5f 7265 7365 7276 6564 3d5b  check_reserved=[
-00000250: 2261 6c6c 225d 2c20 6269 6769 6e74 5f69  "all"], bigint_i
-00000260: 643d 6269 6769 6e74 290a 2020 2020 2020  d=bigint).      
-00000270: 2020 2020 2020 6966 2062 6967 696e 7420        if bigint 
-00000280: 616e 6420 2262 6967 2d69 6422 206e 6f74  and "big-id" not
-00000290: 2069 6e20 6462 2e5f 6164 6170 7465 722e   in db._adapter.
-000002a0: 7479 7065 733a 0a20 2020 2020 2020 2020  types:.         
-000002b0: 2020 2020 2020 2063 6f6e 7469 6e75 650a         continue.
-000002c0: 2020 2020 2020 2020 2020 2020 6462 2e64              db.d
-000002d0: 6566 696e 655f 7461 626c 6528 2274 7422  efine_table("tt"
-000002e0: 2c20 4669 656c 6428 2276 7622 2929 0a20  , Field("vv")). 
-000002f0: 2020 2020 2020 2020 2020 2064 622e 6465             db.de
-00000300: 6669 6e65 5f74 6162 6c65 280a 2020 2020  fine_table(.    
-00000310: 2020 2020 2020 2020 2020 2020 2274 7474              "ttt
-00000320: 222c 2046 6965 6c64 2822 7676 2229 2c20  ", Field("vv"), 
-00000330: 4669 656c 6428 2274 745f 6964 222c 2022  Field("tt_id", "
-00000340: 2573 2074 7422 2025 2072 6566 2c20 6e6f  %s tt" % ref, no
-00000350: 746e 756c 6c3d 5472 7565 290a 2020 2020  tnull=True).    
-00000360: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00000370: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00000380: 7452 6169 7365 7328 4578 6365 7074 696f  tRaises(Exceptio
-00000390: 6e2c 2064 622e 7474 742e 696e 7365 7274  n, db.ttt.insert
-000003a0: 2c20 7676 3d22 7079 6461 6c22 290a 2020  , vv="pydal").  
-000003b0: 2020 2020 2020 2020 2020 2320 5468 6520            # The 
-000003c0: 666f 6c6c 6f77 696e 6720 6973 206d 616e  following is man
-000003d0: 6461 746f 7279 2066 6f72 2062 6163 6b65  datory for backe
-000003e0: 6e64 7320 6173 2050 4720 746f 2063 6c6f  nds as PG to clo
-000003f0: 7365 2074 6865 2061 626f 7274 6564 2074  se the aborted t
-00000400: 7261 6e73 6163 7469 6f6e 0a20 2020 2020  ransaction.     
-00000410: 2020 2020 2020 2064 622e 636f 6d6d 6974         db.commit
-00000420: 2829 0a20 2020 2020 2020 2020 2020 2064  ().            d
-00000430: 726f 7028 6462 2e74 7474 290a 2020 2020  rop(db.ttt).    
-00000440: 2020 2020 2020 2020 6472 6f70 2864 622e          drop(db.
+00000020: 7368 7574 696c 0a69 6d70 6f72 7420 7465  shutil.import te
+00000030: 6d70 6669 6c65 0a0a 6672 6f6d 2070 7964  mpfile..from pyd
+00000040: 616c 2069 6d70 6f72 7420 4441 4c2c 2046  al import DAL, F
+00000050: 6965 6c64 0a66 726f 6d20 7079 6461 6c2e  ield.from pydal.
+00000060: 5f63 6f6d 7061 7420 696d 706f 7274 2050  _compat import P
+00000070: 5932 0a0a 6672 6f6d 202e 5f61 6461 7074  Y2..from ._adapt
+00000080: 2069 6d70 6f72 7420 2844 4546 4155 4c54   import (DEFAULT
+00000090: 5f55 5249 2c20 4953 5f47 4145 2c20 4953  _URI, IS_GAE, IS
+000000a0: 5f49 4d41 502c 2049 535f 4d53 5351 4c2c  _IMAP, IS_MSSQL,
+000000b0: 2049 535f 4f52 4143 4c45 2c0a 2020 2020   IS_ORACLE,.    
+000000c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000000d0: 2049 535f 5445 5241 4441 5441 2c20 6472   IS_TERADATA, dr
+000000e0: 6f70 290a 6672 6f6d 202e 5f63 6f6d 7061  op).from ._compa
+000000f0: 7420 696d 706f 7274 2075 6e69 7474 6573  t import unittes
+00000100: 740a 0a0a 4075 6e69 7474 6573 742e 736b  t...@unittest.sk
+00000110: 6970 4966 2849 535f 494d 4150 2c20 2252  ipIf(IS_IMAP, "R
+00000120: 6566 6572 656e 6365 206e 6f74 204e 756c  eference not Nul
+00000130: 6c20 756e 7375 7070 6f72 7465 6420 6f6e  l unsupported on
+00000140: 2049 4d41 5022 290a 4075 6e69 7474 6573   IMAP").@unittes
+00000150: 742e 736b 6970 4966 2849 535f 4f52 4143  t.skipIf(IS_ORAC
+00000160: 4c45 2c20 2252 6566 6572 656e 6365 204e  LE, "Reference N
+00000170: 6f74 204e 756c 6c20 756e 7375 7070 6f72  ot Null unsuppor
+00000180: 7465 6420 6f6e 204f 7261 636c 6522 290a  ted on Oracle").
+00000190: 636c 6173 7320 5465 7374 5265 6665 7265  class TestRefere
+000001a0: 6e63 654e 4f54 4e55 4c4c 2875 6e69 7474  nceNOTNULL(unitt
+000001b0: 6573 742e 5465 7374 4361 7365 293a 0a20  est.TestCase):. 
+000001c0: 2020 2023 2031 3a4e 206e 6f74 206e 756c     # 1:N not nul
+000001d0: 6c0a 0a20 2020 2064 6566 2074 6573 7452  l..    def testR
+000001e0: 756e 2873 656c 6629 3a0a 2020 2020 2020  un(self):.      
+000001f0: 2020 666f 7220 7265 662c 2062 6967 696e    for ref, bigin
+00000200: 7420 696e 205b 2822 7265 6665 7265 6e63  t in [("referenc
+00000210: 6522 2c20 4661 6c73 6529 2c20 2822 6269  e", False), ("bi
+00000220: 672d 7265 6665 7265 6e63 6522 2c20 5472  g-reference", Tr
+00000230: 7565 295d 3a0a 2020 2020 2020 2020 2020  ue)]:.          
+00000240: 2020 6462 203d 2044 414c 2844 4546 4155    db = DAL(DEFAU
+00000250: 4c54 5f55 5249 2c20 6368 6563 6b5f 7265  LT_URI, check_re
+00000260: 7365 7276 6564 3d5b 2261 6c6c 225d 2c20  served=["all"], 
+00000270: 6269 6769 6e74 5f69 643d 6269 6769 6e74  bigint_id=bigint
+00000280: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00000290: 2062 6967 696e 7420 616e 6420 2262 6967   bigint and "big
+000002a0: 2d69 6422 206e 6f74 2069 6e20 6462 2e5f  -id" not in db._
+000002b0: 6164 6170 7465 722e 7479 7065 733a 0a20  adapter.types:. 
+000002c0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000002d0: 6f6e 7469 6e75 650a 2020 2020 2020 2020  ontinue.        
+000002e0: 2020 2020 6462 2e64 6566 696e 655f 7461      db.define_ta
+000002f0: 626c 6528 2274 7422 2c20 4669 656c 6428  ble("tt", Field(
+00000300: 2276 7622 2929 0a20 2020 2020 2020 2020  "vv")).         
+00000310: 2020 2064 622e 6465 6669 6e65 5f74 6162     db.define_tab
+00000320: 6c65 280a 2020 2020 2020 2020 2020 2020  le(.            
+00000330: 2020 2020 2274 7474 222c 2046 6965 6c64      "ttt", Field
+00000340: 2822 7676 2229 2c20 4669 656c 6428 2274  ("vv"), Field("t
+00000350: 745f 6964 222c 2022 2573 2074 7422 2025  t_id", "%s tt" %
+00000360: 2072 6566 2c20 6e6f 746e 756c 6c3d 5472   ref, notnull=Tr
+00000370: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
+00000380: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00000390: 6c66 2e61 7373 6572 7452 6169 7365 7328  lf.assertRaises(
+000003a0: 4578 6365 7074 696f 6e2c 2064 622e 7474  Exception, db.tt
+000003b0: 742e 696e 7365 7274 2c20 7676 3d22 7079  t.insert, vv="py
+000003c0: 6461 6c22 290a 2020 2020 2020 2020 2020  dal").          
+000003d0: 2020 2320 5468 6520 666f 6c6c 6f77 696e    # The followin
+000003e0: 6720 6973 206d 616e 6461 746f 7279 2066  g is mandatory f
+000003f0: 6f72 2062 6163 6b65 6e64 7320 6173 2050  or backends as P
+00000400: 4720 746f 2063 6c6f 7365 2074 6865 2061  G to close the a
+00000410: 626f 7274 6564 2074 7261 6e73 6163 7469  borted transacti
+00000420: 6f6e 0a20 2020 2020 2020 2020 2020 2064  on.            d
+00000430: 622e 636f 6d6d 6974 2829 0a20 2020 2020  b.commit().     
+00000440: 2020 2020 2020 2064 726f 7028 6462 2e74         drop(db.t
 00000450: 7474 290a 2020 2020 2020 2020 2020 2020  tt).            
-00000460: 6462 2e63 6c6f 7365 2829 0a0a 0a40 756e  db.close()...@un
-00000470: 6974 7465 7374 2e73 6b69 7049 6628 4953  ittest.skipIf(IS
-00000480: 5f49 4d41 502c 2022 5265 6665 7265 6e63  _IMAP, "Referenc
-00000490: 6520 556e 6971 7565 2075 6e73 7570 706f  e Unique unsuppo
-000004a0: 7274 6564 206f 6e20 494d 4150 2229 0a40  rted on IMAP").@
-000004b0: 756e 6974 7465 7374 2e73 6b69 7049 6628  unittest.skipIf(
-000004c0: 4953 5f47 4145 2c20 2252 6566 6572 656e  IS_GAE, "Referen
-000004d0: 6365 2055 6e69 7175 6520 756e 7375 7070  ce Unique unsupp
-000004e0: 6f72 7465 6420 6f6e 2047 4145 2229 0a40  orted on GAE").@
-000004f0: 756e 6974 7465 7374 2e73 6b69 7049 6628  unittest.skipIf(
-00000500: 4953 5f4f 5241 434c 452c 2022 5265 6665  IS_ORACLE, "Refe
-00000510: 7265 6e63 6520 556e 6971 7565 2075 6e73  rence Unique uns
-00000520: 7570 706f 7274 6564 206f 6e20 4f72 6163  upported on Orac
-00000530: 6c65 2229 0a63 6c61 7373 2054 6573 7452  le").class TestR
-00000540: 6566 6572 656e 6365 554e 4951 5545 2875  eferenceUNIQUE(u
-00000550: 6e69 7474 6573 742e 5465 7374 4361 7365  nittest.TestCase
-00000560: 293a 0a20 2020 2023 2031 3a31 2072 656c  ):.    # 1:1 rel
-00000570: 6174 696f 6e0a 0a20 2020 2064 6566 2074  ation..    def t
-00000580: 6573 7452 756e 2873 656c 6629 3a0a 2020  estRun(self):.  
-00000590: 2020 2020 2020 666f 7220 7265 662c 2062        for ref, b
-000005a0: 6967 696e 7420 696e 205b 2822 7265 6665  igint in [("refe
-000005b0: 7265 6e63 6522 2c20 4661 6c73 6529 2c20  rence", False), 
-000005c0: 2822 6269 672d 7265 6665 7265 6e63 6522  ("big-reference"
-000005d0: 2c20 5472 7565 295d 3a0a 2020 2020 2020  , True)]:.      
-000005e0: 2020 2020 2020 6462 203d 2044 414c 2844        db = DAL(D
-000005f0: 4546 4155 4c54 5f55 5249 2c20 6368 6563  EFAULT_URI, chec
-00000600: 6b5f 7265 7365 7276 6564 3d5b 2261 6c6c  k_reserved=["all
-00000610: 225d 2c20 6269 6769 6e74 5f69 643d 6269  "], bigint_id=bi
-00000620: 6769 6e74 290a 2020 2020 2020 2020 2020  gint).          
-00000630: 2020 6966 2062 6967 696e 7420 616e 6420    if bigint and 
-00000640: 2262 6967 2d69 6422 206e 6f74 2069 6e20  "big-id" not in 
-00000650: 6462 2e5f 6164 6170 7465 722e 7479 7065  db._adapter.type
-00000660: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00000670: 2020 2063 6f6e 7469 6e75 650a 2020 2020     continue.    
-00000680: 2020 2020 2020 2020 6462 2e64 6566 696e          db.defin
-00000690: 655f 7461 626c 6528 2274 7422 2c20 4669  e_table("tt", Fi
-000006a0: 656c 6428 2276 7622 2929 0a20 2020 2020  eld("vv")).     
-000006b0: 2020 2020 2020 2064 622e 6465 6669 6e65         db.define
-000006c0: 5f74 6162 6c65 280a 2020 2020 2020 2020  _table(.        
-000006d0: 2020 2020 2020 2020 2274 7474 222c 0a20          "ttt",. 
-000006e0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-000006f0: 6965 6c64 2822 7676 2229 2c0a 2020 2020  ield("vv"),.    
-00000700: 2020 2020 2020 2020 2020 2020 4669 656c              Fiel
-00000710: 6428 2274 745f 6964 222c 2022 2573 2074  d("tt_id", "%s t
-00000720: 7422 2025 2072 6566 2c20 756e 6971 7565  t" % ref, unique
-00000730: 3d54 7275 6529 2c0a 2020 2020 2020 2020  =True),.        
-00000740: 2020 2020 2020 2020 4669 656c 6428 2274          Field("t
-00000750: 745f 7571 222c 2022 696e 7465 6765 7222  t_uq", "integer"
-00000760: 2c20 756e 6971 7565 3d54 7275 6529 2c0a  , unique=True),.
-00000770: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00000780: 2020 2020 2020 2020 2020 6964 5f31 203d            id_1 =
-00000790: 2064 622e 7474 2e69 6e73 6572 7428 7676   db.tt.insert(vv
-000007a0: 3d22 7079 6461 6c22 290a 2020 2020 2020  ="pydal").      
-000007b0: 2020 2020 2020 6964 5f32 203d 2064 622e        id_2 = db.
-000007c0: 7474 2e69 6e73 6572 7428 7676 3d22 7079  tt.insert(vv="py
-000007d0: 6461 6c22 290a 2020 2020 2020 2020 2020  dal").          
-000007e0: 2020 2320 4e75 6c6c 2074 745f 6964 0a20    # Null tt_id. 
-000007f0: 2020 2020 2020 2020 2020 2064 622e 7474             db.tt
-00000800: 742e 696e 7365 7274 2876 763d 2270 7964  t.insert(vv="pyd
-00000810: 616c 222c 2074 745f 7571 3d31 290a 2020  al", tt_uq=1).  
-00000820: 2020 2020 2020 2020 2020 2320 6669 7273            # firs
-00000830: 7420 696e 7365 7274 2069 7320 4f4b 0a20  t insert is OK. 
-00000840: 2020 2020 2020 2020 2020 2064 622e 7474             db.tt
-00000850: 742e 696e 7365 7274 2874 745f 6964 3d69  t.insert(tt_id=i
-00000860: 645f 312c 2074 745f 7571 3d32 290a 2020  d_1, tt_uq=2).  
-00000870: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00000880: 7373 6572 7452 6169 7365 7328 4578 6365  ssertRaises(Exce
-00000890: 7074 696f 6e2c 2064 622e 7474 742e 696e  ption, db.ttt.in
-000008a0: 7365 7274 2c20 7474 5f69 643d 6964 5f31  sert, tt_id=id_1
-000008b0: 2c20 7474 5f75 713d 3329 0a20 2020 2020  , tt_uq=3).     
-000008c0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000008d0: 7274 5261 6973 6573 2845 7863 6570 7469  rtRaises(Excepti
-000008e0: 6f6e 2c20 6462 2e74 7474 2e69 6e73 6572  on, db.ttt.inser
-000008f0: 742c 2074 745f 6964 3d69 645f 322c 2074  t, tt_id=id_2, t
-00000900: 745f 7571 3d32 290a 2020 2020 2020 2020  t_uq=2).        
-00000910: 2020 2020 2320 5468 6520 666f 6c6c 6f77      # The follow
-00000920: 696e 6720 6973 206d 616e 6461 746f 7279  ing is mandatory
-00000930: 2066 6f72 2062 6163 6b65 6e64 7320 6173   for backends as
-00000940: 2050 4720 746f 2063 6c6f 7365 2074 6865   PG to close the
-00000950: 2061 626f 7274 6564 2074 7261 6e73 6163   aborted transac
-00000960: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-00000970: 2064 622e 636f 6d6d 6974 2829 0a20 2020   db.commit().   
-00000980: 2020 2020 2020 2020 2064 726f 7028 6462           drop(db
-00000990: 2e74 7474 290a 2020 2020 2020 2020 2020  .ttt).          
-000009a0: 2020 6472 6f70 2864 622e 7474 290a 2020    drop(db.tt).  
-000009b0: 2020 2020 2020 2020 2020 6462 2e63 6c6f            db.clo
-000009c0: 7365 2829 0a0a 0a40 756e 6974 7465 7374  se()...@unittest
-000009d0: 2e73 6b69 7049 6628 4953 5f49 4d41 502c  .skipIf(IS_IMAP,
-000009e0: 2022 5265 6665 7265 6e63 6520 556e 6971   "Reference Uniq
-000009f0: 7565 206e 6f74 204e 756c 6c20 756e 7375  ue not Null unsu
-00000a00: 7070 6f72 7465 6420 6f6e 2049 4d41 5022  pported on IMAP"
-00000a10: 290a 4075 6e69 7474 6573 742e 736b 6970  ).@unittest.skip
-00000a20: 4966 2849 535f 4741 452c 2022 5265 6665  If(IS_GAE, "Refe
-00000a30: 7265 6e63 6520 556e 6971 7565 206e 6f74  rence Unique not
-00000a40: 204e 756c 6c20 756e 7375 7070 6f72 7465   Null unsupporte
-00000a50: 6420 6f6e 2047 4145 2229 0a40 756e 6974  d on GAE").@unit
-00000a60: 7465 7374 2e73 6b69 7049 6628 4953 5f4f  test.skipIf(IS_O
-00000a70: 5241 434c 452c 2022 5265 6665 7265 6e63  RACLE, "Referenc
-00000a80: 6520 556e 6971 7565 206e 6f74 204e 756c  e Unique not Nul
-00000a90: 6c20 756e 7375 7070 6f72 7465 6420 6f6e  l unsupported on
-00000aa0: 204f 7261 636c 6522 290a 636c 6173 7320   Oracle").class 
-00000ab0: 5465 7374 5265 6665 7265 6e63 6555 4e49  TestReferenceUNI
-00000ac0: 5155 454e 6f74 4e75 6c6c 2875 6e69 7474  QUENotNull(unitt
-00000ad0: 6573 742e 5465 7374 4361 7365 293a 0a20  est.TestCase):. 
-00000ae0: 2020 2023 2031 3a31 2072 656c 6174 696f     # 1:1 relatio
-00000af0: 6e20 6e6f 7420 6e75 6c6c 0a0a 2020 2020  n not null..    
-00000b00: 6465 6620 7465 7374 5275 6e28 7365 6c66  def testRun(self
-00000b10: 293a 0a20 2020 2020 2020 2066 6f72 2072  ):.        for r
-00000b20: 6566 2c20 6269 6769 6e74 2069 6e20 5b28  ef, bigint in [(
-00000b30: 2272 6566 6572 656e 6365 222c 2046 616c  "reference", Fal
-00000b40: 7365 292c 2028 2262 6967 2d72 6566 6572  se), ("big-refer
-00000b50: 656e 6365 222c 2054 7275 6529 5d3a 0a20  ence", True)]:. 
-00000b60: 2020 2020 2020 2020 2020 2064 6220 3d20             db = 
-00000b70: 4441 4c28 4445 4641 554c 545f 5552 492c  DAL(DEFAULT_URI,
-00000b80: 2063 6865 636b 5f72 6573 6572 7665 643d   check_reserved=
-00000b90: 5b22 616c 6c22 5d2c 2062 6967 696e 745f  ["all"], bigint_
-00000ba0: 6964 3d62 6967 696e 7429 0a20 2020 2020  id=bigint).     
-00000bb0: 2020 2020 2020 2069 6620 6269 6769 6e74         if bigint
-00000bc0: 2061 6e64 2022 6269 672d 6964 2220 6e6f   and "big-id" no
-00000bd0: 7420 696e 2064 622e 5f61 6461 7074 6572  t in db._adapter
-00000be0: 2e74 7970 6573 3a0a 2020 2020 2020 2020  .types:.        
-00000bf0: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-00000c00: 0a20 2020 2020 2020 2020 2020 2064 622e  .            db.
-00000c10: 6465 6669 6e65 5f74 6162 6c65 2822 7474  define_table("tt
-00000c20: 222c 2046 6965 6c64 2822 7676 2229 290a  ", Field("vv")).
-00000c30: 2020 2020 2020 2020 2020 2020 6462 2e64              db.d
-00000c40: 6566 696e 655f 7461 626c 6528 0a20 2020  efine_table(.   
-00000c50: 2020 2020 2020 2020 2020 2020 2022 7474               "tt
-00000c60: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-00000c70: 2020 2020 4669 656c 6428 2276 7622 292c      Field("vv"),
-00000c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000c90: 2046 6965 6c64 2822 7474 5f69 6422 2c20   Field("tt_id", 
-00000ca0: 2225 7320 7474 2220 2520 7265 662c 2075  "%s tt" % ref, u
-00000cb0: 6e69 7175 653d 5472 7565 2c20 6e6f 746e  nique=True, notn
-00000cc0: 756c 6c3d 5472 7565 292c 0a20 2020 2020  ull=True),.     
-00000cd0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00000ce0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00000cf0: 5261 6973 6573 2845 7863 6570 7469 6f6e  Raises(Exception
-00000d00: 2c20 6462 2e74 7474 2e69 6e73 6572 742c  , db.ttt.insert,
-00000d10: 2076 763d 2270 7964 616c 2229 0a20 2020   vv="pydal").   
-00000d20: 2020 2020 2020 2020 2064 622e 636f 6d6d           db.comm
-00000d30: 6974 2829 0a20 2020 2020 2020 2020 2020  it().           
-00000d40: 2069 645f 6920 3d20 6462 2e74 742e 696e   id_i = db.tt.in
-00000d50: 7365 7274 2876 763d 2270 7964 616c 2229  sert(vv="pydal")
-00000d60: 0a20 2020 2020 2020 2020 2020 2023 2066  .            # f
-00000d70: 6972 7374 2069 6e73 6572 7420 6973 204f  irst insert is O
-00000d80: 4b0a 2020 2020 2020 2020 2020 2020 6462  K.            db
-00000d90: 2e74 7474 2e69 6e73 6572 7428 7474 5f69  .ttt.insert(tt_i
-00000da0: 643d 6964 5f69 290a 2020 2020 2020 2020  d=id_i).        
-00000db0: 2020 2020 7365 6c66 2e61 7373 6572 7452      self.assertR
-00000dc0: 6169 7365 7328 4578 6365 7074 696f 6e2c  aises(Exception,
-00000dd0: 2064 622e 7474 742e 696e 7365 7274 2c20   db.ttt.insert, 
-00000de0: 7474 5f69 643d 6964 5f69 290a 2020 2020  tt_id=id_i).    
-00000df0: 2020 2020 2020 2020 2320 5468 6520 666f          # The fo
-00000e00: 6c6c 6f77 696e 6720 6973 206d 616e 6461  llowing is manda
-00000e10: 746f 7279 2066 6f72 2062 6163 6b65 6e64  tory for backend
-00000e20: 7320 6173 2050 4720 746f 2063 6c6f 7365  s as PG to close
-00000e30: 2074 6865 2061 626f 7274 6564 2074 7261   the aborted tra
-00000e40: 6e73 6163 7469 6f6e 0a20 2020 2020 2020  nsaction.       
-00000e50: 2020 2020 2064 622e 636f 6d6d 6974 2829       db.commit()
-00000e60: 0a20 2020 2020 2020 2020 2020 2064 726f  .            dro
-00000e70: 7028 6462 2e74 7474 290a 2020 2020 2020  p(db.ttt).      
-00000e80: 2020 2020 2020 6472 6f70 2864 622e 7474        drop(db.tt
-00000e90: 290a 2020 2020 2020 2020 2020 2020 6462  ).            db
-00000ea0: 2e63 6c6f 7365 2829 0a0a 0a40 756e 6974  .close()...@unit
-00000eb0: 7465 7374 2e73 6b69 7049 6628 4953 5f49  test.skipIf(IS_I
-00000ec0: 4d41 502c 2022 536b 6970 2075 6e69 636f  MAP, "Skip unico
-00000ed0: 6465 206f 6e20 494d 4150 2229 0a40 756e  de on IMAP").@un
-00000ee0: 6974 7465 7374 2e73 6b69 7049 6628 4953  ittest.skipIf(IS
-00000ef0: 5f4d 5353 514c 2061 6e64 206e 6f74 2050  _MSSQL and not P
-00000f00: 5932 2c20 2253 6b69 7020 756e 6963 6f64  Y2, "Skip unicod
-00000f10: 6520 6f6e 2070 7933 2061 6e64 204d 5353  e on py3 and MSS
-00000f20: 514c 2229 0a63 6c61 7373 2054 6573 7455  QL").class TestU
-00000f30: 6e69 636f 6465 2875 6e69 7474 6573 742e  nicode(unittest.
-00000f40: 5465 7374 4361 7365 293a 0a20 2020 2064  TestCase):.    d
-00000f50: 6566 2074 6573 7452 756e 2873 656c 6629  ef testRun(self)
-00000f60: 3a0a 2020 2020 2020 2020 6462 203d 2044  :.        db = D
-00000f70: 414c 2844 4546 4155 4c54 5f55 5249 2c20  AL(DEFAULT_URI, 
-00000f80: 6368 6563 6b5f 7265 7365 7276 6564 3d5b  check_reserved=[
-00000f90: 2261 6c6c 225d 290a 2020 2020 2020 2020  "all"]).        
-00000fa0: 6462 2e64 6566 696e 655f 7461 626c 6528  db.define_table(
-00000fb0: 2274 7422 2c20 4669 656c 6428 2276 7622  "tt", Field("vv"
-00000fc0: 2929 0a20 2020 2020 2020 2076 7620 3d20  )).        vv = 
-00000fd0: 22e1 bc80 ceb3 cebf cf81 ceb1 ceb6 ceb5  "...............
-00000fe0: 220a 2020 2020 2020 2020 6964 5f69 203d  ".        id_i =
-00000ff0: 2064 622e 7474 2e69 6e73 6572 7428 7676   db.tt.insert(vv
-00001000: 3d76 7629 0a20 2020 2020 2020 2072 6f77  =vv).        row
-00001010: 203d 2064 6228 6462 2e74 742e 6964 203d   = db(db.tt.id =
-00001020: 3d20 6964 5f69 292e 7365 6c65 6374 2829  = id_i).select()
-00001030: 2e66 6972 7374 2829 0a20 2020 2020 2020  .first().       
-00001040: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00001050: 6c28 726f 772e 7676 2c20 7676 290a 2020  l(row.vv, vv).  
-00001060: 2020 2020 2020 6462 2e63 6f6d 6d69 7428        db.commit(
-00001070: 290a 2020 2020 2020 2020 6472 6f70 2864  ).        drop(d
-00001080: 622e 7474 290a 2020 2020 2020 2020 6462  b.tt).        db
-00001090: 2e63 6c6f 7365 2829 0a0a 0a63 6c61 7373  .close()...class
-000010a0: 2054 6573 7450 6172 7365 4461 7465 5469   TestParseDateTi
-000010b0: 6d65 2875 6e69 7474 6573 742e 5465 7374  me(unittest.Test
-000010c0: 4361 7365 293a 0a20 2020 2064 6566 2074  Case):.    def t
-000010d0: 6573 7452 756e 2873 656c 6629 3a0a 2020  estRun(self):.  
-000010e0: 2020 2020 2020 6462 203d 2044 414c 2844        db = DAL(D
-000010f0: 4546 4155 4c54 5f55 5249 2c20 6368 6563  EFAULT_URI, chec
-00001100: 6b5f 7265 7365 7276 6564 3d5b 2261 6c6c  k_reserved=["all
-00001110: 225d 290a 0a20 2020 2020 2020 2023 3a20  "])..        #: 
-00001120: 736b 6970 2066 6f72 2061 6461 7074 6572  skip for adapter
-00001130: 7320 7468 6174 2075 7365 2064 7269 7665  s that use drive
-00001140: 7273 2066 6f72 2064 6174 6574 696d 6520  rs for datetime 
-00001150: 7061 7273 696e 670a 2020 2020 2020 2020  parsing.        
-00001160: 6966 2064 622e 5f61 6461 7074 6572 2e70  if db._adapter.p
-00001170: 6172 7365 722e 7265 6769 7374 6572 6564  arser.registered
-00001180: 2e67 6574 2822 6461 7465 7469 6d65 2229  .get("datetime")
-00001190: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-000011a0: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
-000011b0: 2020 2020 2020 7061 7273 6520 3d20 6c61        parse = la
-000011c0: 6d62 6461 2076 3a20 6462 2e5f 6164 6170  mbda v: db._adap
-000011d0: 7465 722e 7061 7273 6572 2e70 6172 7365  ter.parser.parse
-000011e0: 2876 2c20 2264 6174 6574 696d 6522 2c20  (v, "datetime", 
-000011f0: 2264 6174 6574 696d 6522 290a 0a20 2020  "datetime")..   
-00001200: 2020 2020 2064 7420 3d20 7061 7273 6528       dt = parse(
-00001210: 2232 3031 352d 3039 2d30 3474 3132 3a33  "2015-09-04t12:3
-00001220: 333a 3336 2e32 3233 3234 3522 290a 2020  3:36.223245").  
-00001230: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00001240: 7445 7175 616c 2864 742e 6d69 6372 6f73  tEqual(dt.micros
-00001250: 6563 6f6e 642c 2032 3233 3234 3529 0a20  econd, 223245). 
-00001260: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00001270: 7274 4571 7561 6c28 6474 2e68 6f75 722c  rtEqual(dt.hour,
-00001280: 2031 3229 0a0a 2020 2020 2020 2020 6474   12)..        dt
-00001290: 203d 2070 6172 7365 2822 3230 3135 2d30   = parse("2015-0
-000012a0: 392d 3034 7431 323a 3333 3a33 362e 3232  9-04t12:33:36.22
-000012b0: 3332 3435 5a22 290a 2020 2020 2020 2020  3245Z").        
-000012c0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-000012d0: 2864 742e 6d69 6372 6f73 6563 6f6e 642c  (dt.microsecond,
-000012e0: 2032 3233 3234 3529 0a20 2020 2020 2020   223245).       
-000012f0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00001300: 6c28 6474 2e68 6f75 722c 2031 3229 0a0a  l(dt.hour, 12)..
-00001310: 2020 2020 2020 2020 6474 203d 2070 6172          dt = par
-00001320: 7365 2822 3230 3135 2d30 392d 3034 7431  se("2015-09-04t1
-00001330: 323a 3333 3a33 362e 3232 3332 3435 2d32  2:33:36.223245-2
-00001340: 3a30 2229 0a20 2020 2020 2020 2073 656c  :0").        sel
-00001350: 662e 6173 7365 7274 4571 7561 6c28 6474  f.assertEqual(dt
-00001360: 2e6d 6963 726f 7365 636f 6e64 2c20 3232  .microsecond, 22
-00001370: 3332 3435 290a 2020 2020 2020 2020 7365  3245).        se
-00001380: 6c66 2e61 7373 6572 7445 7175 616c 2864  lf.assertEqual(d
-00001390: 742e 686f 7572 2c20 3130 290a 0a20 2020  t.hour, 10)..   
-000013a0: 2020 2020 2064 7420 3d20 7061 7273 6528       dt = parse(
-000013b0: 2232 3031 352d 3039 2d30 3474 3132 3a33  "2015-09-04t12:3
-000013c0: 333a 3336 2b31 3a30 2229 0a20 2020 2020  3:36+1:0").     
-000013d0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-000013e0: 7561 6c28 6474 2e6d 6963 726f 7365 636f  ual(dt.microseco
-000013f0: 6e64 2c20 3029 0a20 2020 2020 2020 2073  nd, 0).        s
-00001400: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00001410: 6474 2e68 6f75 722c 2031 3329 0a0a 2020  dt.hour, 13)..  
-00001420: 2020 2020 2020 6474 203d 2070 6172 7365        dt = parse
-00001430: 2822 3230 3135 2d30 392d 3034 7431 323a  ("2015-09-04t12:
-00001440: 3333 3a33 362e 3132 3322 290a 2020 2020  33:36.123").    
-00001450: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00001460: 7175 616c 2864 742e 6d69 6372 6f73 6563  qual(dt.microsec
-00001470: 6f6e 642c 2031 3233 3030 3029 0a0a 2020  ond, 123000)..  
-00001480: 2020 2020 2020 6474 203d 2070 6172 7365        dt = parse
-00001490: 2822 3230 3135 2d30 392d 3034 7431 323a  ("2015-09-04t12:
-000014a0: 3333 3a33 362e 3030 3132 3322 290a 2020  33:36.00123").  
-000014b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000014c0: 7445 7175 616c 2864 742e 6d69 6372 6f73  tEqual(dt.micros
-000014d0: 6563 6f6e 642c 2031 3233 3029 0a0a 2020  econd, 1230)..  
-000014e0: 2020 2020 2020 6474 203d 2070 6172 7365        dt = parse
-000014f0: 2822 3230 3135 2d30 392d 3034 7431 323a  ("2015-09-04t12:
-00001500: 3333 3a33 362e 3132 3334 3536 3738 3930  33:36.1234567890
-00001510: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-00001520: 6173 7365 7274 4571 7561 6c28 6474 2e6d  assertEqual(dt.m
-00001530: 6963 726f 7365 636f 6e64 2c20 3132 3334  icrosecond, 1234
-00001540: 3536 290a 2020 2020 2020 2020 6462 2e63  56).        db.c
-00001550: 6c6f 7365 2829 0a0a 0a40 756e 6974 7465  lose()...@unitte
-00001560: 7374 2e73 6b69 7049 6628 4953 5f49 4d41  st.skipIf(IS_IMA
-00001570: 502c 2022 6368 6169 6e65 6420 6a6f 696e  P, "chained join
-00001580: 2075 6e73 7570 706f 7274 6564 206f 6e20   unsupported on 
-00001590: 494d 4150 2229 0a40 756e 6974 7465 7374  IMAP").@unittest
-000015a0: 2e73 6b69 7049 6628 4953 5f54 4552 4144  .skipIf(IS_TERAD
-000015b0: 4154 412c 2022 6368 6169 6e65 6420 6a6f  ATA, "chained jo
-000015c0: 696e 2075 6e73 7570 706f 7274 6564 206f  in unsupported o
-000015d0: 6e20 5445 5241 4441 5441 2229 0a63 6c61  n TERADATA").cla
-000015e0: 7373 2054 6573 7443 6861 696e 6564 4a6f  ss TestChainedJo
-000015f0: 696e 554e 4951 5545 2875 6e69 7474 6573  inUNIQUE(unittes
-00001600: 742e 5465 7374 4361 7365 293a 0a20 2020  t.TestCase):.   
-00001610: 2023 2031 3a31 2072 656c 6174 696f 6e0a   # 1:1 relation.
-00001620: 0a20 2020 2064 6566 2074 6573 7452 756e  .    def testRun
-00001630: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00001640: 6462 203d 2044 414c 2844 4546 4155 4c54  db = DAL(DEFAULT
-00001650: 5f55 5249 2c20 6368 6563 6b5f 7265 7365  _URI, check_rese
-00001660: 7276 6564 3d5b 2261 6c6c 225d 290a 2020  rved=["all"]).  
-00001670: 2020 2020 2020 6462 2e64 6566 696e 655f        db.define_
-00001680: 7461 626c 6528 2261 6122 2c20 4669 656c  table("aa", Fiel
-00001690: 6428 226e 616d 6522 2929 0a20 2020 2020  d("name")).     
-000016a0: 2020 2064 622e 6465 6669 6e65 5f74 6162     db.define_tab
-000016b0: 6c65 2822 6262 222c 2046 6965 6c64 2822  le("bb", Field("
-000016c0: 6161 222c 2022 7265 6665 7265 6e63 6520  aa", "reference 
-000016d0: 6161 2229 2c20 4669 656c 6428 226e 616d  aa"), Field("nam
-000016e0: 6522 2929 0a20 2020 2020 2020 2066 6f72  e")).        for
-000016f0: 206b 2069 6e20 2822 7822 2c20 2279 222c   k in ("x", "y",
-00001700: 2022 7a22 293a 0a20 2020 2020 2020 2020   "z"):.         
-00001710: 2020 2069 203d 2064 622e 6161 2e69 6e73     i = db.aa.ins
-00001720: 6572 7428 6e61 6d65 3d6b 290a 2020 2020  ert(name=k).    
-00001730: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
-00001740: 2028 2275 222c 2022 7622 2c20 2277 2229   ("u", "v", "w")
-00001750: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00001760: 2020 6462 2e62 622e 696e 7365 7274 2861    db.bb.insert(a
-00001770: 613d 692c 206e 616d 653d 6b20 2b20 6a29  a=i, name=k + j)
-00001780: 0a20 2020 2020 2020 2064 622e 636f 6d6d  .        db.comm
-00001790: 6974 2829 0a20 2020 2020 2020 2072 6f77  it().        row
-000017a0: 7320 3d20 6462 2864 622e 6161 292e 7365  s = db(db.aa).se
-000017b0: 6c65 6374 2829 0a20 2020 2020 2020 2072  lect().        r
-000017c0: 6f77 732e 6a6f 696e 2864 622e 6262 2e61  ows.join(db.bb.a
-000017d0: 612c 2066 6965 6c64 733d 5b64 622e 6262  a, fields=[db.bb
-000017e0: 2e6e 616d 655d 2c20 6f72 6465 7262 793d  .name], orderby=
-000017f0: 5b64 622e 6262 2e6e 616d 655d 290a 2020  [db.bb.name]).  
-00001800: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00001810: 7445 7175 616c 2872 6f77 735b 305d 2e62  tEqual(rows[0].b
-00001820: 625b 305d 2e6e 616d 652c 2022 7875 2229  b[0].name, "xu")
-00001830: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00001840: 7365 7274 4571 7561 6c28 726f 7773 5b30  sertEqual(rows[0
-00001850: 5d2e 6262 5b31 5d2e 6e61 6d65 2c20 2278  ].bb[1].name, "x
-00001860: 7622 290a 2020 2020 2020 2020 7365 6c66  v").        self
-00001870: 2e61 7373 6572 7445 7175 616c 2872 6f77  .assertEqual(row
-00001880: 735b 305d 2e62 625b 325d 2e6e 616d 652c  s[0].bb[2].name,
-00001890: 2022 7877 2229 0a20 2020 2020 2020 2073   "xw").        s
-000018a0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000018b0: 726f 7773 5b31 5d2e 6262 5b30 5d2e 6e61  rows[1].bb[0].na
-000018c0: 6d65 2c20 2279 7522 290a 2020 2020 2020  me, "yu").      
-000018d0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000018e0: 616c 2872 6f77 735b 315d 2e62 625b 315d  al(rows[1].bb[1]
-000018f0: 2e6e 616d 652c 2022 7976 2229 0a20 2020  .name, "yv").   
-00001900: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00001910: 4571 7561 6c28 726f 7773 5b31 5d2e 6262  Equal(rows[1].bb
-00001920: 5b32 5d2e 6e61 6d65 2c20 2279 7722 290a  [2].name, "yw").
-00001930: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00001940: 6572 7445 7175 616c 2872 6f77 735b 325d  ertEqual(rows[2]
-00001950: 2e62 625b 305d 2e6e 616d 652c 2022 7a75  .bb[0].name, "zu
-00001960: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-00001970: 6173 7365 7274 4571 7561 6c28 726f 7773  assertEqual(rows
-00001980: 5b32 5d2e 6262 5b31 5d2e 6e61 6d65 2c20  [2].bb[1].name, 
-00001990: 227a 7622 290a 2020 2020 2020 2020 7365  "zv").        se
-000019a0: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
-000019b0: 6f77 735b 325d 2e62 625b 325d 2e6e 616d  ows[2].bb[2].nam
-000019c0: 652c 2022 7a77 2229 0a0a 2020 2020 2020  e, "zw")..      
-000019d0: 2020 726f 7773 203d 2064 6228 6462 2e62    rows = db(db.b
-000019e0: 6229 2e73 656c 6563 7428 290a 2020 2020  b).select().    
-000019f0: 2020 2020 726f 7773 2e6a 6f69 6e28 6462      rows.join(db
-00001a00: 2e61 612e 6964 2c20 6669 656c 6473 3d5b  .aa.id, fields=[
-00001a10: 6462 2e61 612e 6e61 6d65 5d29 0a0a 2020  db.aa.name])..  
-00001a20: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00001a30: 7445 7175 616c 2872 6f77 735b 305d 2e61  tEqual(rows[0].a
-00001a40: 612e 6e61 6d65 2c20 2278 2229 0a20 2020  a.name, "x").   
-00001a50: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00001a60: 4571 7561 6c28 726f 7773 5b31 5d2e 6161  Equal(rows[1].aa
-00001a70: 2e6e 616d 652c 2022 7822 290a 2020 2020  .name, "x").    
-00001a80: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00001a90: 7175 616c 2872 6f77 735b 325d 2e61 612e  qual(rows[2].aa.
-00001aa0: 6e61 6d65 2c20 2278 2229 0a20 2020 2020  name, "x").     
-00001ab0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00001ac0: 7561 6c28 726f 7773 5b33 5d2e 6161 2e6e  ual(rows[3].aa.n
-00001ad0: 616d 652c 2022 7922 290a 2020 2020 2020  ame, "y").      
-00001ae0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00001af0: 616c 2872 6f77 735b 345d 2e61 612e 6e61  al(rows[4].aa.na
-00001b00: 6d65 2c20 2279 2229 0a20 2020 2020 2020  me, "y").       
-00001b10: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00001b20: 6c28 726f 7773 5b35 5d2e 6161 2e6e 616d  l(rows[5].aa.nam
-00001b30: 652c 2022 7922 290a 2020 2020 2020 2020  e, "y").        
-00001b40: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00001b50: 2872 6f77 735b 365d 2e61 612e 6e61 6d65  (rows[6].aa.name
-00001b60: 2c20 227a 2229 0a20 2020 2020 2020 2073  , "z").        s
-00001b70: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00001b80: 726f 7773 5b37 5d2e 6161 2e6e 616d 652c  rows[7].aa.name,
-00001b90: 2022 7a22 290a 2020 2020 2020 2020 7365   "z").        se
-00001ba0: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
-00001bb0: 6f77 735b 385d 2e61 612e 6e61 6d65 2c20  ows[8].aa.name, 
-00001bc0: 227a 2229 0a0a 2020 2020 2020 2020 726f  "z")..        ro
-00001bd0: 7773 5f6a 736f 6e20 3d20 726f 7773 2e61  ws_json = rows.a
-00001be0: 735f 6a73 6f6e 2829 0a20 2020 2020 2020  s_json().       
-00001bf0: 2064 726f 7028 6462 2e62 6229 0a20 2020   drop(db.bb).   
-00001c00: 2020 2020 2064 726f 7028 6462 2e61 6129       drop(db.aa)
-00001c10: 0a20 2020 2020 2020 2064 622e 636c 6f73  .        db.clos
-00001c20: 6528 290a 0a0a 636c 6173 7320 5465 7374  e()...class Test
-00001c30: 4e75 6c6c 4164 6170 7465 7228 756e 6974  NullAdapter(unit
-00001c40: 7465 7374 2e54 6573 7443 6173 6529 3a0a  test.TestCase):.
-00001c50: 2020 2020 2320 5465 7374 2074 6861 7420      # Test that 
-00001c60: 4e75 6c6c 4164 6170 7465 7220 6361 6e20  NullAdapter can 
-00001c70: 6465 6669 6e65 2074 6162 6c65 730a 0a20  define tables.. 
-00001c80: 2020 2064 6566 2074 6573 7452 756e 2873     def testRun(s
-00001c90: 656c 6629 3a0a 2020 2020 2020 2020 6462  elf):.        db
-00001ca0: 203d 2044 414c 284e 6f6e 6529 0a20 2020   = DAL(None).   
-00001cb0: 2020 2020 2064 622e 6465 6669 6e65 5f74       db.define_t
-00001cc0: 6162 6c65 2822 6e6f 5f74 6162 6c65 222c  able("no_table",
-00001cd0: 2046 6965 6c64 2822 6161 2229 290a 2020   Field("aa")).  
-00001ce0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00001cf0: 7449 7349 6e73 7461 6e63 6528 6462 2e6e  tIsInstance(db.n
-00001d00: 6f5f 7461 626c 652e 6161 2c20 4669 656c  o_table.aa, Fiel
-00001d10: 6429 0a20 2020 2020 2020 2073 656c 662e  d).        self.
-00001d20: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
-00001d30: 2864 622e 6e6f 5f74 6162 6c65 5b22 6161  (db.no_table["aa
-00001d40: 225d 2c20 4669 656c 6429 0a20 2020 2020  "], Field).     
-00001d50: 2020 2064 622e 636c 6f73 6528 290a 0a0a     db.close()...
-00001d60: 4075 6e69 7474 6573 742e 736b 6970 2822  @unittest.skip("
-00001d70: 2229 0a63 6c61 7373 2054 6573 7453 696e  ").class TestSin
-00001d80: 676c 6554 7261 6e73 6163 7469 6f6e 2875  gleTransaction(u
-00001d90: 6e69 7474 6573 742e 5465 7374 4361 7365  nittest.TestCase
-00001da0: 293a 0a0a 2020 2020 6465 6620 7465 7374  ):..    def test
-00001db0: 5f73 696e 676c 655f 7472 616e 7361 6374  _single_transact
-00001dc0: 696f 6e28 7365 6c66 293a 0a20 2020 2020  ion(self):.     
-00001dd0: 2020 200a 2020 2020 2020 2020 6462 203d     .        db =
-00001de0: 2044 414c 2844 4546 4155 4c54 5f55 5249   DAL(DEFAULT_URI
-00001df0: 290a 2020 2020 2020 2020 6462 2e64 6566  ).        db.def
-00001e00: 696e 655f 7461 626c 6528 2774 7427 2c20  ine_table('tt', 
-00001e10: 4669 656c 6428 2761 6127 2929 0a20 2020  Field('aa')).   
-00001e20: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00001e30: 4571 7561 6c28 6462 2864 622e 7474 292e  Equal(db(db.tt).
-00001e40: 636f 756e 7428 292c 2030 290a 2020 2020  count(), 0).    
-00001e50: 2020 2020 6462 2e63 6f6d 6d69 7428 290a      db.commit().
-00001e60: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00001e70: 2020 2020 2020 2020 2077 6974 6820 6462           with db
-00001e80: 2e73 696e 676c 655f 7472 616e 7361 6374  .single_transact
-00001e90: 696f 6e28 293a 0a20 2020 2020 2020 2020  ion():.         
-00001ea0: 2020 2020 2020 2064 622e 7474 2e69 6e73         db.tt.ins
-00001eb0: 6572 7428 6161 3d27 7465 7374 2729 0a20  ert(aa='test'). 
-00001ec0: 2020 2020 2020 2020 2020 2020 2020 2031                 1
-00001ed0: 2f30 0a20 2020 2020 2020 2065 7863 6570  /0.        excep
-00001ee0: 7420 5a65 726f 4469 7669 7369 6f6e 4572  t ZeroDivisionEr
-00001ef0: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-00001f00: 2070 6173 730a 2020 2020 2020 2020 7365   pass.        se
-00001f10: 6c66 2e61 7373 6572 7445 7175 616c 2864  lf.assertEqual(d
-00001f20: 6228 6462 2e74 7429 2e63 6f75 6e74 2829  b(db.tt).count()
-00001f30: 2c20 3029 0a20 2020 2020 2020 2077 6974  , 0).        wit
-00001f40: 6820 6462 2e73 696e 676c 655f 7472 616e  h db.single_tran
-00001f50: 7361 6374 696f 6e28 293a 0a20 2020 2020  saction():.     
-00001f60: 2020 2020 2020 2064 622e 7474 2e69 6e73         db.tt.ins
-00001f70: 6572 7428 6161 3d27 7465 7374 2729 0a20  ert(aa='test'). 
-00001f80: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00001f90: 7274 4571 7561 6c28 6462 2864 622e 7474  rtEqual(db(db.tt
-00001fa0: 292e 636f 756e 7428 292c 2031 290a       ).count(), 1).
+00000460: 6472 6f70 2864 622e 7474 290a 2020 2020  drop(db.tt).    
+00000470: 2020 2020 2020 2020 6462 2e63 6c6f 7365          db.close
+00000480: 2829 0a0a 0a40 756e 6974 7465 7374 2e73  ()...@unittest.s
+00000490: 6b69 7049 6628 4953 5f49 4d41 502c 2022  kipIf(IS_IMAP, "
+000004a0: 5265 6665 7265 6e63 6520 556e 6971 7565  Reference Unique
+000004b0: 2075 6e73 7570 706f 7274 6564 206f 6e20   unsupported on 
+000004c0: 494d 4150 2229 0a40 756e 6974 7465 7374  IMAP").@unittest
+000004d0: 2e73 6b69 7049 6628 4953 5f47 4145 2c20  .skipIf(IS_GAE, 
+000004e0: 2252 6566 6572 656e 6365 2055 6e69 7175  "Reference Uniqu
+000004f0: 6520 756e 7375 7070 6f72 7465 6420 6f6e  e unsupported on
+00000500: 2047 4145 2229 0a40 756e 6974 7465 7374   GAE").@unittest
+00000510: 2e73 6b69 7049 6628 4953 5f4f 5241 434c  .skipIf(IS_ORACL
+00000520: 452c 2022 5265 6665 7265 6e63 6520 556e  E, "Reference Un
+00000530: 6971 7565 2075 6e73 7570 706f 7274 6564  ique unsupported
+00000540: 206f 6e20 4f72 6163 6c65 2229 0a63 6c61   on Oracle").cla
+00000550: 7373 2054 6573 7452 6566 6572 656e 6365  ss TestReference
+00000560: 554e 4951 5545 2875 6e69 7474 6573 742e  UNIQUE(unittest.
+00000570: 5465 7374 4361 7365 293a 0a20 2020 2023  TestCase):.    #
+00000580: 2031 3a31 2072 656c 6174 696f 6e0a 0a20   1:1 relation.. 
+00000590: 2020 2064 6566 2074 6573 7452 756e 2873     def testRun(s
+000005a0: 656c 6629 3a0a 2020 2020 2020 2020 666f  elf):.        fo
+000005b0: 7220 7265 662c 2062 6967 696e 7420 696e  r ref, bigint in
+000005c0: 205b 2822 7265 6665 7265 6e63 6522 2c20   [("reference", 
+000005d0: 4661 6c73 6529 2c20 2822 6269 672d 7265  False), ("big-re
+000005e0: 6665 7265 6e63 6522 2c20 5472 7565 295d  ference", True)]
+000005f0: 3a0a 2020 2020 2020 2020 2020 2020 6462  :.            db
+00000600: 203d 2044 414c 2844 4546 4155 4c54 5f55   = DAL(DEFAULT_U
+00000610: 5249 2c20 6368 6563 6b5f 7265 7365 7276  RI, check_reserv
+00000620: 6564 3d5b 2261 6c6c 225d 2c20 6269 6769  ed=["all"], bigi
+00000630: 6e74 5f69 643d 6269 6769 6e74 290a 2020  nt_id=bigint).  
+00000640: 2020 2020 2020 2020 2020 6966 2062 6967            if big
+00000650: 696e 7420 616e 6420 2262 6967 2d69 6422  int and "big-id"
+00000660: 206e 6f74 2069 6e20 6462 2e5f 6164 6170   not in db._adap
+00000670: 7465 722e 7479 7065 733a 0a20 2020 2020  ter.types:.     
+00000680: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00000690: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
+000006a0: 6462 2e64 6566 696e 655f 7461 626c 6528  db.define_table(
+000006b0: 2274 7422 2c20 4669 656c 6428 2276 7622  "tt", Field("vv"
+000006c0: 2929 0a20 2020 2020 2020 2020 2020 2064  )).            d
+000006d0: 622e 6465 6669 6e65 5f74 6162 6c65 280a  b.define_table(.
+000006e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000006f0: 2274 7474 222c 0a20 2020 2020 2020 2020  "ttt",.         
+00000700: 2020 2020 2020 2046 6965 6c64 2822 7676         Field("vv
+00000710: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+00000720: 2020 2020 4669 656c 6428 2274 745f 6964      Field("tt_id
+00000730: 222c 2022 2573 2074 7422 2025 2072 6566  ", "%s tt" % ref
+00000740: 2c20 756e 6971 7565 3d54 7275 6529 2c0a  , unique=True),.
+00000750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000760: 4669 656c 6428 2274 745f 7571 222c 2022  Field("tt_uq", "
+00000770: 696e 7465 6765 7222 2c20 756e 6971 7565  integer", unique
+00000780: 3d54 7275 6529 2c0a 2020 2020 2020 2020  =True),.        
+00000790: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000007a0: 2020 6964 5f31 203d 2064 622e 7474 2e69    id_1 = db.tt.i
+000007b0: 6e73 6572 7428 7676 3d22 7079 6461 6c22  nsert(vv="pydal"
+000007c0: 290a 2020 2020 2020 2020 2020 2020 6964  ).            id
+000007d0: 5f32 203d 2064 622e 7474 2e69 6e73 6572  _2 = db.tt.inser
+000007e0: 7428 7676 3d22 7079 6461 6c22 290a 2020  t(vv="pydal").  
+000007f0: 2020 2020 2020 2020 2020 2320 4e75 6c6c            # Null
+00000800: 2074 745f 6964 0a20 2020 2020 2020 2020   tt_id.         
+00000810: 2020 2064 622e 7474 742e 696e 7365 7274     db.ttt.insert
+00000820: 2876 763d 2270 7964 616c 222c 2074 745f  (vv="pydal", tt_
+00000830: 7571 3d31 290a 2020 2020 2020 2020 2020  uq=1).          
+00000840: 2020 2320 6669 7273 7420 696e 7365 7274    # first insert
+00000850: 2069 7320 4f4b 0a20 2020 2020 2020 2020   is OK.         
+00000860: 2020 2064 622e 7474 742e 696e 7365 7274     db.ttt.insert
+00000870: 2874 745f 6964 3d69 645f 312c 2074 745f  (tt_id=id_1, tt_
+00000880: 7571 3d32 290a 2020 2020 2020 2020 2020  uq=2).          
+00000890: 2020 7365 6c66 2e61 7373 6572 7452 6169    self.assertRai
+000008a0: 7365 7328 4578 6365 7074 696f 6e2c 2064  ses(Exception, d
+000008b0: 622e 7474 742e 696e 7365 7274 2c20 7474  b.ttt.insert, tt
+000008c0: 5f69 643d 6964 5f31 2c20 7474 5f75 713d  _id=id_1, tt_uq=
+000008d0: 3329 0a20 2020 2020 2020 2020 2020 2073  3).            s
+000008e0: 656c 662e 6173 7365 7274 5261 6973 6573  elf.assertRaises
+000008f0: 2845 7863 6570 7469 6f6e 2c20 6462 2e74  (Exception, db.t
+00000900: 7474 2e69 6e73 6572 742c 2074 745f 6964  tt.insert, tt_id
+00000910: 3d69 645f 322c 2074 745f 7571 3d32 290a  =id_2, tt_uq=2).
+00000920: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
+00000930: 6520 666f 6c6c 6f77 696e 6720 6973 206d  e following is m
+00000940: 616e 6461 746f 7279 2066 6f72 2062 6163  andatory for bac
+00000950: 6b65 6e64 7320 6173 2050 4720 746f 2063  kends as PG to c
+00000960: 6c6f 7365 2074 6865 2061 626f 7274 6564  lose the aborted
+00000970: 2074 7261 6e73 6163 7469 6f6e 0a20 2020   transaction.   
+00000980: 2020 2020 2020 2020 2064 622e 636f 6d6d           db.comm
+00000990: 6974 2829 0a20 2020 2020 2020 2020 2020  it().           
+000009a0: 2064 726f 7028 6462 2e74 7474 290a 2020   drop(db.ttt).  
+000009b0: 2020 2020 2020 2020 2020 6472 6f70 2864            drop(d
+000009c0: 622e 7474 290a 2020 2020 2020 2020 2020  b.tt).          
+000009d0: 2020 6462 2e63 6c6f 7365 2829 0a0a 0a40    db.close()...@
+000009e0: 756e 6974 7465 7374 2e73 6b69 7049 6628  unittest.skipIf(
+000009f0: 4953 5f49 4d41 502c 2022 5265 6665 7265  IS_IMAP, "Refere
+00000a00: 6e63 6520 556e 6971 7565 206e 6f74 204e  nce Unique not N
+00000a10: 756c 6c20 756e 7375 7070 6f72 7465 6420  ull unsupported 
+00000a20: 6f6e 2049 4d41 5022 290a 4075 6e69 7474  on IMAP").@unitt
+00000a30: 6573 742e 736b 6970 4966 2849 535f 4741  est.skipIf(IS_GA
+00000a40: 452c 2022 5265 6665 7265 6e63 6520 556e  E, "Reference Un
+00000a50: 6971 7565 206e 6f74 204e 756c 6c20 756e  ique not Null un
+00000a60: 7375 7070 6f72 7465 6420 6f6e 2047 4145  supported on GAE
+00000a70: 2229 0a40 756e 6974 7465 7374 2e73 6b69  ").@unittest.ski
+00000a80: 7049 6628 4953 5f4f 5241 434c 452c 2022  pIf(IS_ORACLE, "
+00000a90: 5265 6665 7265 6e63 6520 556e 6971 7565  Reference Unique
+00000aa0: 206e 6f74 204e 756c 6c20 756e 7375 7070   not Null unsupp
+00000ab0: 6f72 7465 6420 6f6e 204f 7261 636c 6522  orted on Oracle"
+00000ac0: 290a 636c 6173 7320 5465 7374 5265 6665  ).class TestRefe
+00000ad0: 7265 6e63 6555 4e49 5155 454e 6f74 4e75  renceUNIQUENotNu
+00000ae0: 6c6c 2875 6e69 7474 6573 742e 5465 7374  ll(unittest.Test
+00000af0: 4361 7365 293a 0a20 2020 2023 2031 3a31  Case):.    # 1:1
+00000b00: 2072 656c 6174 696f 6e20 6e6f 7420 6e75   relation not nu
+00000b10: 6c6c 0a0a 2020 2020 6465 6620 7465 7374  ll..    def test
+00000b20: 5275 6e28 7365 6c66 293a 0a20 2020 2020  Run(self):.     
+00000b30: 2020 2066 6f72 2072 6566 2c20 6269 6769     for ref, bigi
+00000b40: 6e74 2069 6e20 5b28 2272 6566 6572 656e  nt in [("referen
+00000b50: 6365 222c 2046 616c 7365 292c 2028 2262  ce", False), ("b
+00000b60: 6967 2d72 6566 6572 656e 6365 222c 2054  ig-reference", T
+00000b70: 7275 6529 5d3a 0a20 2020 2020 2020 2020  rue)]:.         
+00000b80: 2020 2064 6220 3d20 4441 4c28 4445 4641     db = DAL(DEFA
+00000b90: 554c 545f 5552 492c 2063 6865 636b 5f72  ULT_URI, check_r
+00000ba0: 6573 6572 7665 643d 5b22 616c 6c22 5d2c  eserved=["all"],
+00000bb0: 2062 6967 696e 745f 6964 3d62 6967 696e   bigint_id=bigin
+00000bc0: 7429 0a20 2020 2020 2020 2020 2020 2069  t).            i
+00000bd0: 6620 6269 6769 6e74 2061 6e64 2022 6269  f bigint and "bi
+00000be0: 672d 6964 2220 6e6f 7420 696e 2064 622e  g-id" not in db.
+00000bf0: 5f61 6461 7074 6572 2e74 7970 6573 3a0a  _adapter.types:.
+00000c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000c10: 636f 6e74 696e 7565 0a20 2020 2020 2020  continue.       
+00000c20: 2020 2020 2064 622e 6465 6669 6e65 5f74       db.define_t
+00000c30: 6162 6c65 2822 7474 222c 2046 6965 6c64  able("tt", Field
+00000c40: 2822 7676 2229 290a 2020 2020 2020 2020  ("vv")).        
+00000c50: 2020 2020 6462 2e64 6566 696e 655f 7461      db.define_ta
+00000c60: 626c 6528 0a20 2020 2020 2020 2020 2020  ble(.           
+00000c70: 2020 2020 2022 7474 7422 2c0a 2020 2020       "ttt",.    
+00000c80: 2020 2020 2020 2020 2020 2020 4669 656c              Fiel
+00000c90: 6428 2276 7622 292c 0a20 2020 2020 2020  d("vv"),.       
+00000ca0: 2020 2020 2020 2020 2046 6965 6c64 2822           Field("
+00000cb0: 7474 5f69 6422 2c20 2225 7320 7474 2220  tt_id", "%s tt" 
+00000cc0: 2520 7265 662c 2075 6e69 7175 653d 5472  % ref, unique=Tr
+00000cd0: 7565 2c20 6e6f 746e 756c 6c3d 5472 7565  ue, notnull=True
+00000ce0: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
+00000cf0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00000d00: 662e 6173 7365 7274 5261 6973 6573 2845  f.assertRaises(E
+00000d10: 7863 6570 7469 6f6e 2c20 6462 2e74 7474  xception, db.ttt
+00000d20: 2e69 6e73 6572 742c 2076 763d 2270 7964  .insert, vv="pyd
+00000d30: 616c 2229 0a20 2020 2020 2020 2020 2020  al").           
+00000d40: 2064 622e 636f 6d6d 6974 2829 0a20 2020   db.commit().   
+00000d50: 2020 2020 2020 2020 2069 645f 6920 3d20           id_i = 
+00000d60: 6462 2e74 742e 696e 7365 7274 2876 763d  db.tt.insert(vv=
+00000d70: 2270 7964 616c 2229 0a20 2020 2020 2020  "pydal").       
+00000d80: 2020 2020 2023 2066 6972 7374 2069 6e73       # first ins
+00000d90: 6572 7420 6973 204f 4b0a 2020 2020 2020  ert is OK.      
+00000da0: 2020 2020 2020 6462 2e74 7474 2e69 6e73        db.ttt.ins
+00000db0: 6572 7428 7474 5f69 643d 6964 5f69 290a  ert(tt_id=id_i).
+00000dc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00000dd0: 2e61 7373 6572 7452 6169 7365 7328 4578  .assertRaises(Ex
+00000de0: 6365 7074 696f 6e2c 2064 622e 7474 742e  ception, db.ttt.
+00000df0: 696e 7365 7274 2c20 7474 5f69 643d 6964  insert, tt_id=id
+00000e00: 5f69 290a 2020 2020 2020 2020 2020 2020  _i).            
+00000e10: 2320 5468 6520 666f 6c6c 6f77 696e 6720  # The following 
+00000e20: 6973 206d 616e 6461 746f 7279 2066 6f72  is mandatory for
+00000e30: 2062 6163 6b65 6e64 7320 6173 2050 4720   backends as PG 
+00000e40: 746f 2063 6c6f 7365 2074 6865 2061 626f  to close the abo
+00000e50: 7274 6564 2074 7261 6e73 6163 7469 6f6e  rted transaction
+00000e60: 0a20 2020 2020 2020 2020 2020 2064 622e  .            db.
+00000e70: 636f 6d6d 6974 2829 0a20 2020 2020 2020  commit().       
+00000e80: 2020 2020 2064 726f 7028 6462 2e74 7474       drop(db.ttt
+00000e90: 290a 2020 2020 2020 2020 2020 2020 6472  ).            dr
+00000ea0: 6f70 2864 622e 7474 290a 2020 2020 2020  op(db.tt).      
+00000eb0: 2020 2020 2020 6462 2e63 6c6f 7365 2829        db.close()
+00000ec0: 0a0a 0a40 756e 6974 7465 7374 2e73 6b69  ...@unittest.ski
+00000ed0: 7049 6628 4953 5f49 4d41 502c 2022 536b  pIf(IS_IMAP, "Sk
+00000ee0: 6970 2075 6e69 636f 6465 206f 6e20 494d  ip unicode on IM
+00000ef0: 4150 2229 0a40 756e 6974 7465 7374 2e73  AP").@unittest.s
+00000f00: 6b69 7049 6628 4953 5f4d 5353 514c 2061  kipIf(IS_MSSQL a
+00000f10: 6e64 206e 6f74 2050 5932 2c20 2253 6b69  nd not PY2, "Ski
+00000f20: 7020 756e 6963 6f64 6520 6f6e 2070 7933  p unicode on py3
+00000f30: 2061 6e64 204d 5353 514c 2229 0a63 6c61   and MSSQL").cla
+00000f40: 7373 2054 6573 7455 6e69 636f 6465 2875  ss TestUnicode(u
+00000f50: 6e69 7474 6573 742e 5465 7374 4361 7365  nittest.TestCase
+00000f60: 293a 0a20 2020 2064 6566 2074 6573 7452  ):.    def testR
+00000f70: 756e 2873 656c 6629 3a0a 2020 2020 2020  un(self):.      
+00000f80: 2020 6462 203d 2044 414c 2844 4546 4155    db = DAL(DEFAU
+00000f90: 4c54 5f55 5249 2c20 6368 6563 6b5f 7265  LT_URI, check_re
+00000fa0: 7365 7276 6564 3d5b 2261 6c6c 225d 290a  served=["all"]).
+00000fb0: 2020 2020 2020 2020 6462 2e64 6566 696e          db.defin
+00000fc0: 655f 7461 626c 6528 2274 7422 2c20 4669  e_table("tt", Fi
+00000fd0: 656c 6428 2276 7622 2929 0a20 2020 2020  eld("vv")).     
+00000fe0: 2020 2076 7620 3d20 22e1 bc80 ceb3 cebf     vv = ".......
+00000ff0: cf81 ceb1 ceb6 ceb5 220a 2020 2020 2020  ........".      
+00001000: 2020 6964 5f69 203d 2064 622e 7474 2e69    id_i = db.tt.i
+00001010: 6e73 6572 7428 7676 3d76 7629 0a20 2020  nsert(vv=vv).   
+00001020: 2020 2020 2072 6f77 203d 2064 6228 6462       row = db(db
+00001030: 2e74 742e 6964 203d 3d20 6964 5f69 292e  .tt.id == id_i).
+00001040: 7365 6c65 6374 2829 2e66 6972 7374 2829  select().first()
+00001050: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00001060: 7365 7274 4571 7561 6c28 726f 772e 7676  sertEqual(row.vv
+00001070: 2c20 7676 290a 2020 2020 2020 2020 6462  , vv).        db
+00001080: 2e63 6f6d 6d69 7428 290a 2020 2020 2020  .commit().      
+00001090: 2020 6472 6f70 2864 622e 7474 290a 2020    drop(db.tt).  
+000010a0: 2020 2020 2020 6462 2e63 6c6f 7365 2829        db.close()
+000010b0: 0a0a 0a63 6c61 7373 2054 6573 7450 6172  ...class TestPar
+000010c0: 7365 4461 7465 5469 6d65 2875 6e69 7474  seDateTime(unitt
+000010d0: 6573 742e 5465 7374 4361 7365 293a 0a20  est.TestCase):. 
+000010e0: 2020 2064 6566 2074 6573 7452 756e 2873     def testRun(s
+000010f0: 656c 6629 3a0a 2020 2020 2020 2020 6462  elf):.        db
+00001100: 203d 2044 414c 2844 4546 4155 4c54 5f55   = DAL(DEFAULT_U
+00001110: 5249 2c20 6368 6563 6b5f 7265 7365 7276  RI, check_reserv
+00001120: 6564 3d5b 2261 6c6c 225d 290a 0a20 2020  ed=["all"])..   
+00001130: 2020 2020 2023 3a20 736b 6970 2066 6f72       #: skip for
+00001140: 2061 6461 7074 6572 7320 7468 6174 2075   adapters that u
+00001150: 7365 2064 7269 7665 7273 2066 6f72 2064  se drivers for d
+00001160: 6174 6574 696d 6520 7061 7273 696e 670a  atetime parsing.
+00001170: 2020 2020 2020 2020 6966 2064 622e 5f61          if db._a
+00001180: 6461 7074 6572 2e70 6172 7365 722e 7265  dapter.parser.re
+00001190: 6769 7374 6572 6564 2e67 6574 2822 6461  gistered.get("da
+000011a0: 7465 7469 6d65 2229 2069 7320 4e6f 6e65  tetime") is None
+000011b0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000011c0: 7475 726e 0a0a 2020 2020 2020 2020 7061  turn..        pa
+000011d0: 7273 6520 3d20 6c61 6d62 6461 2076 3a20  rse = lambda v: 
+000011e0: 6462 2e5f 6164 6170 7465 722e 7061 7273  db._adapter.pars
+000011f0: 6572 2e70 6172 7365 2876 2c20 2264 6174  er.parse(v, "dat
+00001200: 6574 696d 6522 2c20 2264 6174 6574 696d  etime", "datetim
+00001210: 6522 290a 0a20 2020 2020 2020 2064 7420  e")..        dt 
+00001220: 3d20 7061 7273 6528 2232 3031 352d 3039  = parse("2015-09
+00001230: 2d30 3474 3132 3a33 333a 3336 2e32 3233  -04t12:33:36.223
+00001240: 3234 3522 290a 2020 2020 2020 2020 7365  245").        se
+00001250: 6c66 2e61 7373 6572 7445 7175 616c 2864  lf.assertEqual(d
+00001260: 742e 6d69 6372 6f73 6563 6f6e 642c 2032  t.microsecond, 2
+00001270: 3233 3234 3529 0a20 2020 2020 2020 2073  23245).        s
+00001280: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00001290: 6474 2e68 6f75 722c 2031 3229 0a0a 2020  dt.hour, 12)..  
+000012a0: 2020 2020 2020 6474 203d 2070 6172 7365        dt = parse
+000012b0: 2822 3230 3135 2d30 392d 3034 7431 323a  ("2015-09-04t12:
+000012c0: 3333 3a33 362e 3232 3332 3435 5a22 290a  33:36.223245Z").
+000012d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000012e0: 6572 7445 7175 616c 2864 742e 6d69 6372  ertEqual(dt.micr
+000012f0: 6f73 6563 6f6e 642c 2032 3233 3234 3529  osecond, 223245)
+00001300: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00001310: 7365 7274 4571 7561 6c28 6474 2e68 6f75  sertEqual(dt.hou
+00001320: 722c 2031 3229 0a0a 2020 2020 2020 2020  r, 12)..        
+00001330: 6474 203d 2070 6172 7365 2822 3230 3135  dt = parse("2015
+00001340: 2d30 392d 3034 7431 323a 3333 3a33 362e  -09-04t12:33:36.
+00001350: 3232 3332 3435 2d32 3a30 2229 0a20 2020  223245-2:0").   
+00001360: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00001370: 4571 7561 6c28 6474 2e6d 6963 726f 7365  Equal(dt.microse
+00001380: 636f 6e64 2c20 3232 3332 3435 290a 2020  cond, 223245).  
+00001390: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000013a0: 7445 7175 616c 2864 742e 686f 7572 2c20  tEqual(dt.hour, 
+000013b0: 3130 290a 0a20 2020 2020 2020 2064 7420  10)..        dt 
+000013c0: 3d20 7061 7273 6528 2232 3031 352d 3039  = parse("2015-09
+000013d0: 2d30 3474 3132 3a33 333a 3336 2b31 3a30  -04t12:33:36+1:0
+000013e0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+000013f0: 6173 7365 7274 4571 7561 6c28 6474 2e6d  assertEqual(dt.m
+00001400: 6963 726f 7365 636f 6e64 2c20 3029 0a20  icrosecond, 0). 
+00001410: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00001420: 7274 4571 7561 6c28 6474 2e68 6f75 722c  rtEqual(dt.hour,
+00001430: 2031 3329 0a0a 2020 2020 2020 2020 6474   13)..        dt
+00001440: 203d 2070 6172 7365 2822 3230 3135 2d30   = parse("2015-0
+00001450: 392d 3034 7431 323a 3333 3a33 362e 3132  9-04t12:33:36.12
+00001460: 3322 290a 2020 2020 2020 2020 7365 6c66  3").        self
+00001470: 2e61 7373 6572 7445 7175 616c 2864 742e  .assertEqual(dt.
+00001480: 6d69 6372 6f73 6563 6f6e 642c 2031 3233  microsecond, 123
+00001490: 3030 3029 0a0a 2020 2020 2020 2020 6474  000)..        dt
+000014a0: 203d 2070 6172 7365 2822 3230 3135 2d30   = parse("2015-0
+000014b0: 392d 3034 7431 323a 3333 3a33 362e 3030  9-04t12:33:36.00
+000014c0: 3132 3322 290a 2020 2020 2020 2020 7365  123").        se
+000014d0: 6c66 2e61 7373 6572 7445 7175 616c 2864  lf.assertEqual(d
+000014e0: 742e 6d69 6372 6f73 6563 6f6e 642c 2031  t.microsecond, 1
+000014f0: 3233 3029 0a0a 2020 2020 2020 2020 6474  230)..        dt
+00001500: 203d 2070 6172 7365 2822 3230 3135 2d30   = parse("2015-0
+00001510: 392d 3034 7431 323a 3333 3a33 362e 3132  9-04t12:33:36.12
+00001520: 3334 3536 3738 3930 2229 0a20 2020 2020  34567890").     
+00001530: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00001540: 7561 6c28 6474 2e6d 6963 726f 7365 636f  ual(dt.microseco
+00001550: 6e64 2c20 3132 3334 3536 290a 2020 2020  nd, 123456).    
+00001560: 2020 2020 6462 2e63 6c6f 7365 2829 0a0a      db.close()..
+00001570: 0a40 756e 6974 7465 7374 2e73 6b69 7049  .@unittest.skipI
+00001580: 6628 4953 5f49 4d41 502c 2022 6368 6169  f(IS_IMAP, "chai
+00001590: 6e65 6420 6a6f 696e 2075 6e73 7570 706f  ned join unsuppo
+000015a0: 7274 6564 206f 6e20 494d 4150 2229 0a40  rted on IMAP").@
+000015b0: 756e 6974 7465 7374 2e73 6b69 7049 6628  unittest.skipIf(
+000015c0: 4953 5f54 4552 4144 4154 412c 2022 6368  IS_TERADATA, "ch
+000015d0: 6169 6e65 6420 6a6f 696e 2075 6e73 7570  ained join unsup
+000015e0: 706f 7274 6564 206f 6e20 5445 5241 4441  ported on TERADA
+000015f0: 5441 2229 0a63 6c61 7373 2054 6573 7443  TA").class TestC
+00001600: 6861 696e 6564 4a6f 696e 554e 4951 5545  hainedJoinUNIQUE
+00001610: 2875 6e69 7474 6573 742e 5465 7374 4361  (unittest.TestCa
+00001620: 7365 293a 0a20 2020 2023 2031 3a31 2072  se):.    # 1:1 r
+00001630: 656c 6174 696f 6e0a 0a20 2020 2064 6566  elation..    def
+00001640: 2074 6573 7452 756e 2873 656c 6629 3a0a   testRun(self):.
+00001650: 2020 2020 2020 2020 6462 203d 2044 414c          db = DAL
+00001660: 2844 4546 4155 4c54 5f55 5249 2c20 6368  (DEFAULT_URI, ch
+00001670: 6563 6b5f 7265 7365 7276 6564 3d5b 2261  eck_reserved=["a
+00001680: 6c6c 225d 290a 2020 2020 2020 2020 6462  ll"]).        db
+00001690: 2e64 6566 696e 655f 7461 626c 6528 2261  .define_table("a
+000016a0: 6122 2c20 4669 656c 6428 226e 616d 6522  a", Field("name"
+000016b0: 2929 0a20 2020 2020 2020 2064 622e 6465  )).        db.de
+000016c0: 6669 6e65 5f74 6162 6c65 2822 6262 222c  fine_table("bb",
+000016d0: 2046 6965 6c64 2822 6161 222c 2022 7265   Field("aa", "re
+000016e0: 6665 7265 6e63 6520 6161 2229 2c20 4669  ference aa"), Fi
+000016f0: 656c 6428 226e 616d 6522 2929 0a20 2020  eld("name")).   
+00001700: 2020 2020 2066 6f72 206b 2069 6e20 2822       for k in ("
+00001710: 7822 2c20 2279 222c 2022 7a22 293a 0a20  x", "y", "z"):. 
+00001720: 2020 2020 2020 2020 2020 2069 203d 2064             i = d
+00001730: 622e 6161 2e69 6e73 6572 7428 6e61 6d65  b.aa.insert(name
+00001740: 3d6b 290a 2020 2020 2020 2020 2020 2020  =k).            
+00001750: 666f 7220 6a20 696e 2028 2275 222c 2022  for j in ("u", "
+00001760: 7622 2c20 2277 2229 3a0a 2020 2020 2020  v", "w"):.      
+00001770: 2020 2020 2020 2020 2020 6462 2e62 622e            db.bb.
+00001780: 696e 7365 7274 2861 613d 692c 206e 616d  insert(aa=i, nam
+00001790: 653d 6b20 2b20 6a29 0a20 2020 2020 2020  e=k + j).       
+000017a0: 2064 622e 636f 6d6d 6974 2829 0a20 2020   db.commit().   
+000017b0: 2020 2020 2072 6f77 7320 3d20 6462 2864       rows = db(d
+000017c0: 622e 6161 292e 7365 6c65 6374 2829 0a20  b.aa).select(). 
+000017d0: 2020 2020 2020 2072 6f77 732e 6a6f 696e         rows.join
+000017e0: 2864 622e 6262 2e61 612c 2066 6965 6c64  (db.bb.aa, field
+000017f0: 733d 5b64 622e 6262 2e6e 616d 655d 2c20  s=[db.bb.name], 
+00001800: 6f72 6465 7262 793d 5b64 622e 6262 2e6e  orderby=[db.bb.n
+00001810: 616d 655d 290a 2020 2020 2020 2020 7365  ame]).        se
+00001820: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
+00001830: 6f77 735b 305d 2e62 625b 305d 2e6e 616d  ows[0].bb[0].nam
+00001840: 652c 2022 7875 2229 0a20 2020 2020 2020  e, "xu").       
+00001850: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00001860: 6c28 726f 7773 5b30 5d2e 6262 5b31 5d2e  l(rows[0].bb[1].
+00001870: 6e61 6d65 2c20 2278 7622 290a 2020 2020  name, "xv").    
+00001880: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00001890: 7175 616c 2872 6f77 735b 305d 2e62 625b  qual(rows[0].bb[
+000018a0: 325d 2e6e 616d 652c 2022 7877 2229 0a20  2].name, "xw"). 
+000018b0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000018c0: 7274 4571 7561 6c28 726f 7773 5b31 5d2e  rtEqual(rows[1].
+000018d0: 6262 5b30 5d2e 6e61 6d65 2c20 2279 7522  bb[0].name, "yu"
+000018e0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+000018f0: 7373 6572 7445 7175 616c 2872 6f77 735b  ssertEqual(rows[
+00001900: 315d 2e62 625b 315d 2e6e 616d 652c 2022  1].bb[1].name, "
+00001910: 7976 2229 0a20 2020 2020 2020 2073 656c  yv").        sel
+00001920: 662e 6173 7365 7274 4571 7561 6c28 726f  f.assertEqual(ro
+00001930: 7773 5b31 5d2e 6262 5b32 5d2e 6e61 6d65  ws[1].bb[2].name
+00001940: 2c20 2279 7722 290a 2020 2020 2020 2020  , "yw").        
+00001950: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00001960: 2872 6f77 735b 325d 2e62 625b 305d 2e6e  (rows[2].bb[0].n
+00001970: 616d 652c 2022 7a75 2229 0a20 2020 2020  ame, "zu").     
+00001980: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00001990: 7561 6c28 726f 7773 5b32 5d2e 6262 5b31  ual(rows[2].bb[1
+000019a0: 5d2e 6e61 6d65 2c20 227a 7622 290a 2020  ].name, "zv").  
+000019b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000019c0: 7445 7175 616c 2872 6f77 735b 325d 2e62  tEqual(rows[2].b
+000019d0: 625b 325d 2e6e 616d 652c 2022 7a77 2229  b[2].name, "zw")
+000019e0: 0a0a 2020 2020 2020 2020 726f 7773 203d  ..        rows =
+000019f0: 2064 6228 6462 2e62 6229 2e73 656c 6563   db(db.bb).selec
+00001a00: 7428 290a 2020 2020 2020 2020 726f 7773  t().        rows
+00001a10: 2e6a 6f69 6e28 6462 2e61 612e 6964 2c20  .join(db.aa.id, 
+00001a20: 6669 656c 6473 3d5b 6462 2e61 612e 6e61  fields=[db.aa.na
+00001a30: 6d65 5d29 0a0a 2020 2020 2020 2020 7365  me])..        se
+00001a40: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
+00001a50: 6f77 735b 305d 2e61 612e 6e61 6d65 2c20  ows[0].aa.name, 
+00001a60: 2278 2229 0a20 2020 2020 2020 2073 656c  "x").        sel
+00001a70: 662e 6173 7365 7274 4571 7561 6c28 726f  f.assertEqual(ro
+00001a80: 7773 5b31 5d2e 6161 2e6e 616d 652c 2022  ws[1].aa.name, "
+00001a90: 7822 290a 2020 2020 2020 2020 7365 6c66  x").        self
+00001aa0: 2e61 7373 6572 7445 7175 616c 2872 6f77  .assertEqual(row
+00001ab0: 735b 325d 2e61 612e 6e61 6d65 2c20 2278  s[2].aa.name, "x
+00001ac0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00001ad0: 6173 7365 7274 4571 7561 6c28 726f 7773  assertEqual(rows
+00001ae0: 5b33 5d2e 6161 2e6e 616d 652c 2022 7922  [3].aa.name, "y"
+00001af0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00001b00: 7373 6572 7445 7175 616c 2872 6f77 735b  ssertEqual(rows[
+00001b10: 345d 2e61 612e 6e61 6d65 2c20 2279 2229  4].aa.name, "y")
+00001b20: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00001b30: 7365 7274 4571 7561 6c28 726f 7773 5b35  sertEqual(rows[5
+00001b40: 5d2e 6161 2e6e 616d 652c 2022 7922 290a  ].aa.name, "y").
+00001b50: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00001b60: 6572 7445 7175 616c 2872 6f77 735b 365d  ertEqual(rows[6]
+00001b70: 2e61 612e 6e61 6d65 2c20 227a 2229 0a20  .aa.name, "z"). 
+00001b80: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00001b90: 7274 4571 7561 6c28 726f 7773 5b37 5d2e  rtEqual(rows[7].
+00001ba0: 6161 2e6e 616d 652c 2022 7a22 290a 2020  aa.name, "z").  
+00001bb0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00001bc0: 7445 7175 616c 2872 6f77 735b 385d 2e61  tEqual(rows[8].a
+00001bd0: 612e 6e61 6d65 2c20 227a 2229 0a0a 2020  a.name, "z")..  
+00001be0: 2020 2020 2020 726f 7773 5f6a 736f 6e20        rows_json 
+00001bf0: 3d20 726f 7773 2e61 735f 6a73 6f6e 2829  = rows.as_json()
+00001c00: 0a20 2020 2020 2020 2064 726f 7028 6462  .        drop(db
+00001c10: 2e62 6229 0a20 2020 2020 2020 2064 726f  .bb).        dro
+00001c20: 7028 6462 2e61 6129 0a20 2020 2020 2020  p(db.aa).       
+00001c30: 2064 622e 636c 6f73 6528 290a 0a0a 636c   db.close()...cl
+00001c40: 6173 7320 5465 7374 4e75 6c6c 4164 6170  ass TestNullAdap
+00001c50: 7465 7228 756e 6974 7465 7374 2e54 6573  ter(unittest.Tes
+00001c60: 7443 6173 6529 3a0a 2020 2020 2320 5465  tCase):.    # Te
+00001c70: 7374 2074 6861 7420 4e75 6c6c 4164 6170  st that NullAdap
+00001c80: 7465 7220 6361 6e20 6465 6669 6e65 2074  ter can define t
+00001c90: 6162 6c65 730a 0a20 2020 2064 6566 2074  ables..    def t
+00001ca0: 6573 7452 756e 2873 656c 6629 3a0a 2020  estRun(self):.  
+00001cb0: 2020 2020 2020 6462 203d 2044 414c 284e        db = DAL(N
+00001cc0: 6f6e 6529 0a20 2020 2020 2020 2064 622e  one).        db.
+00001cd0: 6465 6669 6e65 5f74 6162 6c65 2822 6e6f  define_table("no
+00001ce0: 5f74 6162 6c65 222c 2046 6965 6c64 2822  _table", Field("
+00001cf0: 6161 2229 290a 2020 2020 2020 2020 7365  aa")).        se
+00001d00: 6c66 2e61 7373 6572 7449 7349 6e73 7461  lf.assertIsInsta
+00001d10: 6e63 6528 6462 2e6e 6f5f 7461 626c 652e  nce(db.no_table.
+00001d20: 6161 2c20 4669 656c 6429 0a20 2020 2020  aa, Field).     
+00001d30: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
+00001d40: 496e 7374 616e 6365 2864 622e 6e6f 5f74  Instance(db.no_t
+00001d50: 6162 6c65 5b22 6161 225d 2c20 4669 656c  able["aa"], Fiel
+00001d60: 6429 0a20 2020 2020 2020 2064 622e 636c  d).        db.cl
+00001d70: 6f73 6528 290a 0a0a 4075 6e69 7474 6573  ose()...@unittes
+00001d80: 742e 736b 6970 2822 2229 0a63 6c61 7373  t.skip("").class
+00001d90: 2054 6573 7453 696e 676c 6554 7261 6e73   TestSingleTrans
+00001da0: 6163 7469 6f6e 2875 6e69 7474 6573 742e  action(unittest.
+00001db0: 5465 7374 4361 7365 293a 0a20 2020 2064  TestCase):.    d
+00001dc0: 6566 2074 6573 745f 7369 6e67 6c65 5f74  ef test_single_t
+00001dd0: 7261 6e73 6163 7469 6f6e 2873 656c 6629  ransaction(self)
+00001de0: 3a0a 0a20 2020 2020 2020 2064 6220 3d20  :..        db = 
+00001df0: 4441 4c28 4445 4641 554c 545f 5552 4929  DAL(DEFAULT_URI)
+00001e00: 0a20 2020 2020 2020 2064 622e 6465 6669  .        db.defi
+00001e10: 6e65 5f74 6162 6c65 2822 7474 222c 2046  ne_table("tt", F
+00001e20: 6965 6c64 2822 6161 2229 290a 2020 2020  ield("aa")).    
+00001e30: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00001e40: 7175 616c 2864 6228 6462 2e74 7429 2e63  qual(db(db.tt).c
+00001e50: 6f75 6e74 2829 2c20 3029 0a20 2020 2020  ount(), 0).     
+00001e60: 2020 2064 622e 636f 6d6d 6974 2829 0a20     db.commit(). 
+00001e70: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00001e80: 2020 2020 2020 2020 7769 7468 2064 622e          with db.
+00001e90: 7369 6e67 6c65 5f74 7261 6e73 6163 7469  single_transacti
+00001ea0: 6f6e 2829 3a0a 2020 2020 2020 2020 2020  on():.          
+00001eb0: 2020 2020 2020 6462 2e74 742e 696e 7365        db.tt.inse
+00001ec0: 7274 2861 613d 2274 6573 7422 290a 2020  rt(aa="test").  
+00001ed0: 2020 2020 2020 2020 2020 2020 2020 3120                1 
+00001ee0: 2f20 300a 2020 2020 2020 2020 6578 6365  / 0.        exce
+00001ef0: 7074 205a 6572 6f44 6976 6973 696f 6e45  pt ZeroDivisionE
+00001f00: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+00001f10: 2020 7061 7373 0a20 2020 2020 2020 2073    pass.        s
+00001f20: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00001f30: 6462 2864 622e 7474 292e 636f 756e 7428  db(db.tt).count(
+00001f40: 292c 2030 290a 2020 2020 2020 2020 7769  ), 0).        wi
+00001f50: 7468 2064 622e 7369 6e67 6c65 5f74 7261  th db.single_tra
+00001f60: 6e73 6163 7469 6f6e 2829 3a0a 2020 2020  nsaction():.    
+00001f70: 2020 2020 2020 2020 6462 2e74 742e 696e          db.tt.in
+00001f80: 7365 7274 2861 613d 2274 6573 7422 290a  sert(aa="test").
+00001f90: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00001fa0: 6572 7445 7175 616c 2864 6228 6462 2e74  ertEqual(db(db.t
+00001fb0: 7429 2e63 6f75 6e74 2829 2c20 3129 0a    t).count(), 1).
```

### Comparing `pydal-20221110.1/tests/caching.py` & `PyDAL-20230407.2/tests/caching.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,12 +1,14 @@
-import time
 import pickle
+import time
+
 from pydal import DAL, Field
-from ._compat import unittest
+
 from ._adapt import DEFAULT_URI, IS_IMAP, IS_MSSQL
+from ._compat import unittest
 from ._helpers import DALtest
 
 
 class SimpleCache(object):
     storage = {}
 
     def clear(self):
```

### Comparing `pydal-20221110.1/tests/contribs.py` & `PyDAL-20230407.2/tests/contribs.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,15 +1,17 @@
 import os
 import threading
 import time
-from ._compat import unittest
-from ._adapt import IS_GAE
+
 from pydal._compat import to_bytes
-from pydal.contrib.portalocker import lock, unlock, read_locked, write_locked
-from pydal.contrib.portalocker import LockedFile, LOCK_EX
+from pydal.contrib.portalocker import (LOCK_EX, LockedFile, lock, read_locked,
+                                       unlock, write_locked)
+
+from ._adapt import IS_GAE
+from ._compat import unittest
 
 
 def tearDownModule():
     if os.path.isfile("test.txt"):
         os.unlink("test.txt")
```

### Comparing `pydal-20221110.1/tests/indexes.py` & `PyDAL-20230407.2/tests/indexes.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 from pydal import DAL, Field
-from ._compat import unittest
+
 from ._adapt import DEFAULT_URI, IS_POSTGRESQL, drop
+from ._compat import unittest
 
 
 class TestIndexesBasic(unittest.TestCase):
     def testRun(self):
         db = DAL(DEFAULT_URI, check_reserved=["all"])
         db.define_table("tt", Field("aa"))
         rv = db.tt.create_index("idx_aa", db.tt.aa)
```

### Comparing `pydal-20221110.1/tests/is_url_validators.py` & `PyDAL-20230407.2/tests/is_url_validators.py`

 * *Files 1% similar despite different names*

```diff
@@ -2,16 +2,16 @@
 # -*- coding: utf-8 -*-
 """
 Unit tests for IS_URL()
 """
 
 import unittest
 
-from pydal.validators import IS_URL, IS_HTTP_URL, IS_GENERIC_URL
-from pydal.validators import unicode_to_ascii_authority
+from pydal.validators import (IS_GENERIC_URL, IS_HTTP_URL, IS_URL,
+                              unicode_to_ascii_authority)
 
 
 class TestIsUrl(unittest.TestCase):
     def testModeHttp(self):
 
         # defaults to mode='http'
 
@@ -557,164 +557,164 @@
     y = IS_URL(allowed_schemes=["https"], prepend_scheme="https")
     # excludes the option for abbreviated URLs with no scheme
     z = IS_URL(prepend_scheme=None)
     # disables prepending the scheme in the return value
 
     def testUnicodeToAsciiUrl(self):
         self.assertEqual(
-            unicode_to_ascii_authority(u"www.Alliancefran\xe7aise.nu"),
+            unicode_to_ascii_authority("www.Alliancefran\xe7aise.nu"),
             "www.xn--alliancefranaise-npb.nu",
         )
-        self.assertEqual(unicode_to_ascii_authority(u"www.benn.ca"), "www.benn.ca")
+        self.assertEqual(unicode_to_ascii_authority("www.benn.ca"), "www.benn.ca")
         self.assertRaises(
-            UnicodeError, unicode_to_ascii_authority, u"\u4e2d" * 1000
+            UnicodeError, unicode_to_ascii_authority, "\u4e2d" * 1000
         )  # label is too long
 
     def testValidUrls(self):
         self.assertEqual(
-            self.x(u"www.Alliancefrancaise.nu"),
+            self.x("www.Alliancefrancaise.nu"),
             ("http://www.Alliancefrancaise.nu", None),
         )
         self.assertEqual(
-            self.x(u"www.Alliancefran\xe7aise.nu"),
+            self.x("www.Alliancefran\xe7aise.nu"),
             ("http://www.xn--alliancefranaise-npb.nu", None),
         )
         self.assertEqual(
-            self.x(u"www.Alliancefran\xe7aise.nu:8080"),
+            self.x("www.Alliancefran\xe7aise.nu:8080"),
             ("http://www.xn--alliancefranaise-npb.nu:8080", None),
         )
         self.assertEqual(
-            self.x(u"http://www.Alliancefran\xe7aise.nu"),
+            self.x("http://www.Alliancefran\xe7aise.nu"),
             ("http://www.xn--alliancefranaise-npb.nu", None),
         )
         self.assertEqual(
-            self.x(u"http://www.Alliancefran\xe7aise.nu/parnaise/blue"),
+            self.x("http://www.Alliancefran\xe7aise.nu/parnaise/blue"),
             ("http://www.xn--alliancefranaise-npb.nu/parnaise/blue", None),
         )
         self.assertEqual(
-            self.x(u"http://www.Alliancefran\xe7aise.nu/parnaise/blue#fragment"),
+            self.x("http://www.Alliancefran\xe7aise.nu/parnaise/blue#fragment"),
             ("http://www.xn--alliancefranaise-npb.nu/parnaise/blue#fragment", None),
         )
         self.assertEqual(
             self.x(
-                u"http://www.Alliancefran\xe7aise.nu/parnaise/blue?query=value#fragment"
+                "http://www.Alliancefran\xe7aise.nu/parnaise/blue?query=value#fragment"
             ),
             (
                 "http://www.xn--alliancefranaise-npb.nu/parnaise/blue?query=value#fragment",
                 None,
             ),
         )
         self.assertEqual(
             self.x(
-                u"http://www.Alliancefran\xe7aise.nu:8080/parnaise/blue?query=value#fragment"
+                "http://www.Alliancefran\xe7aise.nu:8080/parnaise/blue?query=value#fragment"
             ),
             (
                 "http://www.xn--alliancefranaise-npb.nu:8080/parnaise/blue?query=value#fragment",
                 None,
             ),
         )
         self.assertEqual(
-            self.x(u"www.Alliancefran\xe7aise.nu/parnaise/blue?query=value#fragment"),
+            self.x("www.Alliancefran\xe7aise.nu/parnaise/blue?query=value#fragment"),
             (
                 "http://www.xn--alliancefranaise-npb.nu/parnaise/blue?query=value#fragment",
                 None,
             ),
         )
         self.assertEqual(
-            self.x(u"http://\u4e2d\u4fd4.com"), ("http://xn--fiq13b.com", None)
+            self.x("http://\u4e2d\u4fd4.com"), ("http://xn--fiq13b.com", None)
         )
         self.assertEqual(
-            self.x(u"http://\u4e2d\u4fd4.com/\u4e86"),
+            self.x("http://\u4e2d\u4fd4.com/\u4e86"),
             ("http://xn--fiq13b.com/%4e%86", None),
         )
         self.assertEqual(
-            self.x(u"http://\u4e2d\u4fd4.com/\u4e86?query=\u4e86"),
+            self.x("http://\u4e2d\u4fd4.com/\u4e86?query=\u4e86"),
             ("http://xn--fiq13b.com/%4e%86?query=%4e%86", None),
         )
         self.assertEqual(
-            self.x(u"http://\u4e2d\u4fd4.com/\u4e86?query=\u4e86#fragment"),
+            self.x("http://\u4e2d\u4fd4.com/\u4e86?query=\u4e86#fragment"),
             ("http://xn--fiq13b.com/%4e%86?query=%4e%86#fragment", None),
         )
         self.assertEqual(
-            self.x(u"http://\u4e2d\u4fd4.com?query=\u4e86#fragment"),
+            self.x("http://\u4e2d\u4fd4.com?query=\u4e86#fragment"),
             ("http://xn--fiq13b.com?query=%4e%86#fragment", None),
         )
         self.assertEqual(
-            self.x(u"http://B\xfccher.ch"), ("http://xn--bcher-kva.ch", None)
+            self.x("http://B\xfccher.ch"), ("http://xn--bcher-kva.ch", None)
         )
         self.assertEqual(
-            self.x(u"http://\xe4\xf6\xfc\xdf.com"), ("http://xn--ss-uia6e4a.com", None)
+            self.x("http://\xe4\xf6\xfc\xdf.com"), ("http://xn--ss-uia6e4a.com", None)
         )
         self.assertEqual(
-            self.x(u"http://visegr\xe1d.com"), ("http://xn--visegrd-mwa.com", None)
+            self.x("http://visegr\xe1d.com"), ("http://xn--visegrd-mwa.com", None)
         )
         self.assertEqual(
-            self.x(u"http://h\xe1zipatika.com"), ("http://xn--hzipatika-01a.com", None)
+            self.x("http://h\xe1zipatika.com"), ("http://xn--hzipatika-01a.com", None)
         )
         self.assertEqual(
-            self.x(u"http://www.\xe7ukurova.com"),
+            self.x("http://www.\xe7ukurova.com"),
             ("http://www.xn--ukurova-txa.com", None),
         )
         self.assertEqual(
-            self.x(u"http://nixier\xf6hre.nixieclock-tube.com"),
+            self.x("http://nixier\xf6hre.nixieclock-tube.com"),
             ("http://xn--nixierhre-57a.nixieclock-tube.com", None),
         )
-        self.assertEqual(self.x(u"google.ca."), ("http://google.ca.", None))
+        self.assertEqual(self.x("google.ca."), ("http://google.ca.", None))
 
-        self.assertEqual(self.y(u"https://google.ca"), ("https://google.ca", None))
+        self.assertEqual(self.y("https://google.ca"), ("https://google.ca", None))
         self.assertEqual(
-            self.y(u"https://\u4e2d\u4fd4.com"), ("https://xn--fiq13b.com", None)
+            self.y("https://\u4e2d\u4fd4.com"), ("https://xn--fiq13b.com", None)
         )
 
-        self.assertEqual(self.z(u"google.ca"), ("google.ca", None))
+        self.assertEqual(self.z("google.ca"), ("google.ca", None))
 
     def testInvalidUrls(self):
-        self.assertEqual(self.x(u"://ABC.com"), (u"://ABC.com", "Enter a valid URL"))
+        self.assertEqual(self.x("://ABC.com"), ("://ABC.com", "Enter a valid URL"))
         self.assertEqual(
-            self.x(u"http://\u4e2d\u4fd4.dne"),
-            (u"http://\u4e2d\u4fd4.dne", "Enter a valid URL"),
+            self.x("http://\u4e2d\u4fd4.dne"),
+            ("http://\u4e2d\u4fd4.dne", "Enter a valid URL"),
         )
         self.assertEqual(
-            self.x(u"https://google.dne"), (u"https://google.dne", "Enter a valid URL")
+            self.x("https://google.dne"), ("https://google.dne", "Enter a valid URL")
         )
         self.assertEqual(
-            self.x(u"https://google..ca"), (u"https://google..ca", "Enter a valid URL")
+            self.x("https://google..ca"), ("https://google..ca", "Enter a valid URL")
         )
-        self.assertEqual(self.x(u"google..ca"), (u"google..ca", "Enter a valid URL"))
+        self.assertEqual(self.x("google..ca"), ("google..ca", "Enter a valid URL"))
         self.assertEqual(
-            self.x(u"http://" + u"\u4e2d" * 1000 + u".com"),
-            (u"http://" + u"\u4e2d" * 1000 + u".com", "Enter a valid URL"),
+            self.x("http://" + "\u4e2d" * 1000 + ".com"),
+            ("http://" + "\u4e2d" * 1000 + ".com", "Enter a valid URL"),
         )
 
         self.assertEqual(
-            self.x(u"http://google.com#fragment_\u4e86"),
-            (u"http://google.com#fragment_\u4e86", "Enter a valid URL"),
+            self.x("http://google.com#fragment_\u4e86"),
+            ("http://google.com#fragment_\u4e86", "Enter a valid URL"),
         )
         self.assertEqual(
-            self.x(u"http\u4e86://google.com"),
-            (u"http\u4e86://google.com", "Enter a valid URL"),
+            self.x("http\u4e86://google.com"),
+            ("http\u4e86://google.com", "Enter a valid URL"),
         )
         self.assertEqual(
-            self.x(u"http\u4e86://google.com#fragment_\u4e86"),
-            (u"http\u4e86://google.com#fragment_\u4e86", "Enter a valid URL"),
+            self.x("http\u4e86://google.com#fragment_\u4e86"),
+            ("http\u4e86://google.com#fragment_\u4e86", "Enter a valid URL"),
         )
 
         self.assertEqual(
-            self.y(u"http://\u4e2d\u4fd4.com/\u4e86"),
-            (u"http://\u4e2d\u4fd4.com/\u4e86", "Enter a valid URL"),
+            self.y("http://\u4e2d\u4fd4.com/\u4e86"),
+            ("http://\u4e2d\u4fd4.com/\u4e86", "Enter a valid URL"),
         )
         # self.assertEqual(self.y(u'google.ca'), (u'google.ca', 'Enter a valid URL'))
 
         self.assertEqual(
-            self.z(u"invalid.domain..com"),
-            (u"invalid.domain..com", "Enter a valid URL"),
+            self.z("invalid.domain..com"),
+            ("invalid.domain..com", "Enter a valid URL"),
         )
         self.assertEqual(
-            self.z(u"invalid.\u4e2d\u4fd4.blargg"),
-            (u"invalid.\u4e2d\u4fd4.blargg", "Enter a valid URL"),
+            self.z("invalid.\u4e2d\u4fd4.blargg"),
+            ("invalid.\u4e2d\u4fd4.blargg", "Enter a valid URL"),
         )
 
 
 # ##############################################################################
 
 
 class TestSimple(unittest.TestCase):
```

### Comparing `pydal-20221110.1/tests/nosql.py` & `PyDAL-20230407.2/tests/nosql.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,25 +1,27 @@
 # -*- coding: utf-8 -*-
 """
     Unit tests for NoSQL adapters
 """
 
 from __future__ import print_function
-import sys
-import os
-import glob
+
 import datetime
-from ._compat import unittest
+import glob
+import os
+import sys
 
-from pydal._compat import PY2, basestring, StringIO, to_bytes, long
 from pydal import DAL, Field
-from pydal.objects import Table, Query, Expression
-from pydal.helpers.classes import SQLALL, OpRow
+from pydal._compat import PY2, StringIO, basestring, long, to_bytes
 from pydal.exceptions import NotOnNOSQLError
-from ._adapt import DEFAULT_URI, IS_IMAP, drop, IS_GAE, IS_MONGODB, _quote
+from pydal.helpers.classes import SQLALL, OpRow
+from pydal.objects import Expression, Query, Table
+
+from ._adapt import DEFAULT_URI, IS_GAE, IS_IMAP, IS_MONGODB, _quote, drop
+from ._compat import unittest
 
 if IS_IMAP:
     from pydal.adapters import IMAPAdapter
     from pydal.contrib import mockimaplib
 
     IMAPAdapter.driver = mockimaplib
 elif IS_MONGODB:
@@ -296,22 +298,22 @@
         non_valid_examples = ["1x", "xx$%@%", "xx yy", "yy\na", "yy\n"]
         for a in non_valid_examples:
             self.assertRaises(SyntaxError, Field, a, "string")
 
         # Check that Field names don't allow a unicode string
         non_valid_examples = non_valid_examples = [
             "",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
         ]
         for a in non_valid_examples:
             self.assertRaises(SyntaxError, Field, a, "string")
 
     def testFieldTypes(self):
 
         # Check that string, and password default length is 512
@@ -500,22 +502,22 @@
         non_valid_examples = ["1x", "xx$%@%", "xx yy", "yy\na", "yy\n"]
         for a in non_valid_examples:
             self.assertRaises(SyntaxError, Table, None, a)
 
         # Check that Table names don't allow a unicode string
         non_valid_examples = [
             "",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
         ]
         for a in non_valid_examples:
             self.assertRaises(SyntaxError, Table, None, a)
 
 
 @unittest.skipIf(IS_IMAP, "Skip IMAP")
 class TestAll(unittest.TestCase):
```

### Comparing `pydal-20221110.1/tests/restapi.py` & `PyDAL-20230407.2/tests/restapi.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,12 +1,13 @@
 import unittest
 
 from pydal import DAL, Field
+from pydal.restapi import (ALLOW_ALL_POLICY, DENY_ALL_POLICY, RestAPI,
+                           __version__)
 from pydal.validators import IS_NOT_IN_DB
-from pydal.restapi import RestAPI, ALLOW_ALL_POLICY, DENY_ALL_POLICY, __version__
 
 
 class TestRestAPI(unittest.TestCase):
     def setUp(self):
         db = DAL("sqlite:memory")
 
         db.define_table("color", Field("name", requires=IS_NOT_IN_DB(db, "color.name")))
```

### Comparing `pydal-20221110.1/tests/smart_query.py` & `PyDAL-20230407.2/tests/smart_query.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,13 +1,14 @@
-from ._compat import unittest
-from ._adapt import DEFAULT_URI, IS_GAE, IS_IMAP, drop
-from pydal._compat import integer_types
 from pydal import DAL, Field
+from pydal._compat import integer_types
 from pydal.helpers.methods import smart_query
 
+from ._adapt import DEFAULT_URI, IS_GAE, IS_IMAP, drop
+from ._compat import unittest
+
 
 @unittest.skipIf(IS_IMAP, "Skip nosql")
 class TestSmartQuery(unittest.TestCase):
     def testRun(self):
         db = DAL(DEFAULT_URI, check_reserved=["all"])
 
         # -----------------------------------------------------------------------------
```

### Comparing `pydal-20221110.1/tests/sql.py` & `PyDAL-20230407.2/tests/sql.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,36 +1,30 @@
 # -*- coding: utf-8 -*-
 """
     Basic unit tests
 """
 
 from __future__ import print_function
-import os
-import glob
+
 import datetime
+import glob
 import json
+import os
 import pickle
 from unittest import skipIf
 
-from pydal._compat import basestring, StringIO, integer_types, xrange, BytesIO, to_bytes, PY2
 from pydal import DAL, Field
+from pydal._compat import (PY2, BytesIO, StringIO, basestring, integer_types,
+                           to_bytes, xrange)
 from pydal.helpers.classes import SQLALL, OpRow
-from pydal.objects import Table, Expression, Row
-from ._compat import unittest
-from ._adapt import (
-    DEFAULT_URI,
-    IS_POSTGRESQL,
-    IS_SQLITE,
-    IS_MSSQL,
-    IS_MYSQL,
-    IS_TERADATA,
-    IS_NOSQL,
-    IS_ORACLE,
-)
+from pydal.objects import Expression, Row, Table
 
+from ._adapt import (DEFAULT_URI, IS_MSSQL, IS_MYSQL, IS_NOSQL, IS_ORACLE,
+                     IS_POSTGRESQL, IS_SQLITE, IS_TERADATA)
+from ._compat import unittest
 from ._helpers import DALtest
 
 long = integer_types[-1]
 
 print("Testing against %s engine (%s)" % (DEFAULT_URI.partition(":")[0], DEFAULT_URI))
 
 
@@ -128,22 +122,22 @@
         non_valid_examples = ["1x", "xx$%@%", "xx yy", "yy\na", "yy\n"]
         for a in non_valid_examples:
             self.assertRaises(SyntaxError, Field, a, "string")
 
         # Check that Field names don't allow a unicode string
         non_valid_examples = non_valid_examples = [
             "",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
         ]
         for a in non_valid_examples:
             self.assertRaises(SyntaxError, Field, a, "string")
 
     def testFieldTypes(self):
 
         # Check that string, and password default length is 512
@@ -424,22 +418,22 @@
         non_valid_examples = ["1x", "xx$%@%", "xx yy", "yy\na", "yy\n"]
         for a in non_valid_examples:
             self.assertRaises(SyntaxError, Table, None, a)
 
         # Check that Table names don't allow a unicode string
         non_valid_examples = [
             "",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
-            u"",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
+            "",
         ]
         for a in non_valid_examples:
             self.assertRaises(SyntaxError, Table, None, a)
 
 
 class TestAll(unittest.TestCase):
     def setUp(self):
@@ -778,55 +772,65 @@
         self.assertEqual(sub.query_name()[0], str(sub))
         self.assertEqual(sub.sql_shortref, db._adapter.dialect.quote("foo"))
         self.assertIsInstance(sub.on(sub.aa != None), Expression)
 
     @skipIf(PY2, "sqlite3 on py2 does not allow circular references")
     def testCTE(self):
         db = self.connect()
-        db.define_table('org', Field('name'), Field('boss', 'reference org'))
+        db.define_table("org", Field("name"), Field("boss", "reference org"))
         org = db.org
+
         def insert_workers(boss, *names):
-            return [org.insert(name = name, boss = boss) for name in names]
-        alice = org.insert(name = 'Alice')
-        jim, tim = insert_workers(alice, 'Jim', 'Tim')
-        jessy, jenny =  insert_workers(jim, 'Jessy', 'Jenny')
-        insert_workers(tim, 'Tom')
-        insert_workers(jessy, 'John', 'Jacob')
-
-        works_for = db(org.name == 'Alice').cte(
-            'works_for',
-            org.id,
-            org.name.with_alias('top_boss'),  # i.e. Alice is top_boss
-            org.name,
-            org.boss,
-            Expression(db, '0', type = 'integer').with_alias('xdepth'),
-            Expression(db, '" "', type = 'string').with_alias('boss_chain')
-        ).union( lambda works_for: \
-            db((org.boss == works_for.id) & (org.id != org.boss)).nested_select(
+            return [org.insert(name=name, boss=boss) for name in names]
+
+        alice = org.insert(name="Alice")
+        jim, tim = insert_workers(alice, "Jim", "Tim")
+        jessy, jenny = insert_workers(jim, "Jessy", "Jenny")
+        insert_workers(tim, "Tom")
+        insert_workers(jessy, "John", "Jacob")
+
+        works_for = (
+            db(org.name == "Alice")
+            .cte(
+                "works_for",
                 org.id,
-                works_for.top_boss,
+                org.name.with_alias("top_boss"),  # i.e. Alice is top_boss
                 org.name,
                 org.boss,
-                (works_for.xdepth + 1).with_alias('xdepth'),
-                (' ' + works_for.name + works_for.boss_chain).with_alias('boss_chain')
+                Expression(db, "0", type="integer").with_alias("xdepth"),
+                Expression(db, '" "', type="string").with_alias("boss_chain"),
+            )
+            .union(
+                lambda works_for: db(
+                    (org.boss == works_for.id) & (org.id != org.boss)
+                ).nested_select(
+                    org.id,
+                    works_for.top_boss,
+                    org.name,
+                    org.boss,
+                    (works_for.xdepth + 1).with_alias("xdepth"),
+                    (" " + works_for.name + works_for.boss_chain).with_alias(
+                        "boss_chain"
+                    ),
+                )
             )
         )
         rows = db().select(works_for.ALL).as_dict()
         #  reconstruct boss_chain/depth and test them against query result
         for row in rows.values():
             r = row
             boss_chain = []
             while True:
-                r = rows.get(r['boss'])
+                r = rows.get(r["boss"])
                 if not r:
                     break
-                boss_chain.append(r['name'])
+                boss_chain.append(r["name"])
             depth = len(boss_chain)
-            self.assertEqual(depth, row['xdepth'])
-            self.assertEqual(' '.join(boss_chain), row['boss_chain'].strip())
+            self.assertEqual(depth, row["xdepth"])
+            self.assertEqual(" ".join(boss_chain), row["boss_chain"].strip())
 
     def testSelectArguments(self):
         db = self.connect()
         db.define_table("tt", Field("aa", "integer"), Field("bb"))
         data = [
             dict(aa=1, bb="foo"),
             dict(aa=1, bb="bar"),
@@ -3251,15 +3255,15 @@
     def testme(self):
         return
 
 
 class TestGis(DALtest):
     @unittest.skipIf(True, "WIP")
     def testGeometry(self):
-        from pydal import geoPoint, geoLine, geoPolygon
+        from pydal import geoLine, geoPoint, geoPolygon
 
         if not IS_POSTGRESQL:
             return
         db = self.connect()
         t0 = db.define_table("t0", Field("point", "geometry()"))
         t1 = db.define_table("t1", Field("line", "geometry(public, 4326, 2)"))
         t2 = db.define_table("t2", Field("polygon", "geometry(public, 4326, 2)"))
@@ -3292,15 +3296,15 @@
         y = t0.point.st_y()
         point = db(t0.id).select(x, y).first()
         self.assertEqual(point[x], 1)
         self.assertEqual(point[y], 1)
 
     @unittest.skipIf(True, "WIP")
     def testGeometryCase(self):
-        from pydal import geoPoint, geoLine, geoPolygon
+        from pydal import geoLine, geoPoint, geoPolygon
 
         if not IS_POSTGRESQL:
             return
         db = self.connect(ignore_field_case=False)
         t0 = db.define_table(
             "t0", Field("point", "geometry()"), Field("Point", "geometry()")
         )
@@ -3332,26 +3336,26 @@
     def testJSONExpressions(self):
         db = self.connect()
         if not hasattr(db._adapter.dialect, "json_key"):
             return
         tj = db.define_table("tj", Field("testjson", "json"))
         rec1 = tj.insert(
             testjson={
-                u"a": {u"a1": 2, u"a0": 1},
-                u"b": 3,
-                u"c": {u"c0": {u"c01": [2, 4]}},
-                u"str": "foo",
+                "a": {"a1": 2, "a0": 1},
+                "b": 3,
+                "c": {"c0": {"c01": [2, 4]}},
+                "str": "foo",
             }
         )
         rec2 = tj.insert(
             testjson={
-                u"a": {u"a1": 2, u"a0": 2},
-                u"b": 4,
-                u"c": {u"c0": {u"c01": [2, 3]}},
-                u"str": "bar",
+                "a": {"a1": 2, "a0": 2},
+                "b": 4,
+                "c": {"c0": {"c01": [2, 3]}},
+                "str": "bar",
             }
         )
         rows = db(db.tj.testjson.json_key("a").json_key_value("a0") == 1).select()
         self.assertEqual(len(rows), 1)
         self.assertEqual(rows[0].id, rec1)
         rows = db(db.tj.testjson.json_path_value("{a, a1}") == 2).select()
         self.assertEqual(len(rows), 2)
```

### Comparing `pydal-20221110.1/tests/tags.py` & `PyDAL-20230407.2/tests/tags.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,9 @@
 import unittest
+
 from pydal import DAL, Field
 from pydal.tools.tags import Tags
 
 
 class TestTags(unittest.TestCase):
     def test_tags(self):
         db = DAL("sqlite:memory")
```

### Comparing `pydal-20221110.1/tests/validation.py` & `PyDAL-20230407.2/tests/validation.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,12 +1,14 @@
 import re
-from ._compat import unittest
-from ._adapt import DEFAULT_URI, IS_NOSQL, IS_IMAP, drop
-from pydal._compat import integer_types
+
 from pydal import DAL, Field
+from pydal._compat import integer_types
+
+from ._adapt import DEFAULT_URI, IS_IMAP, IS_NOSQL, drop
+from ._compat import unittest
 
 long = integer_types[-1]
 
 regex_isint = re.compile(r"^[+-]?\d+$")
 
 
 def range_error_message(error_message, what_to_enter, minimum, maximum):
```

### Comparing `pydal-20221110.1/tests/validators.py` & `PyDAL-20230407.2/tests/validators.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,31 +1,31 @@
 #!/usr/bin/env python
 # -*- coding: utf-8 -*-
 
 """Unit tests for http.py """
 
-import unittest
 import datetime
 import decimal
 import re
+import unittest
 
 from pydal import DAL, Field
-from pydal.validators import *
 from pydal._compat import PY2, to_bytes
-from pydal.validators import options_sorter, Validator, UTC
+from pydal.validators import *
+from pydal.validators import UTC, Validator, options_sorter
 
 
 class TestValidators(unittest.TestCase):
     def myassertRegex(self, *args, **kwargs):
         if PY2:
             return getattr(self, "assertRegexpMatches")(*args, **kwargs)
         return getattr(self, "assertRegex")(*args, **kwargs)
 
     def test_MISC(self):
-        """ Test miscelaneous utility functions and some general behavior guarantees """
+        """Test miscelaneous utility functions and some general behavior guarantees"""
 
         self.assertEqual(options_sorter(("a", "a"), ("a", "a")), -1)
         self.assertEqual(options_sorter(("A", "A"), ("a", "a")), -1)
         self.assertEqual(options_sorter(("b", "b"), ("a", "a")), 1)
         self.assertRaises(NotImplementedError, Validator(), 1)
         utc = UTC()
         dt = datetime.datetime.now()
@@ -52,26 +52,26 @@
         self.assertEqual(rtn, ("", "Invalid expression"))
         rtn = IS_MATCH("hell", strict=True)("hellas")
         self.assertEqual(rtn, ("hellas", "Invalid expression"))
         rtn = IS_MATCH("hell$", strict=True)("hellas")
         self.assertEqual(rtn, ("hellas", "Invalid expression"))
         rtn = IS_MATCH("^.hell$", strict=True)("shell")
         self.assertEqual(rtn, ("shell", None))
-        rtn = IS_MATCH(u"hell", is_unicode=True)("")
+        rtn = IS_MATCH("hell", is_unicode=True)("")
         if PY2:
             self.assertEqual(rtn, ("\xc3\xa0\xc3\xb2\xc3\xa8", "Invalid expression"))
         else:
             self.assertEqual(rtn, ("", "Invalid expression"))
-        rtn = IS_MATCH(u"hell", is_unicode=True)(u"hell")
-        self.assertEqual(rtn, (u"hell", None))
-        rtn = IS_MATCH("hell", is_unicode=True)(u"hell")
-        self.assertEqual(rtn, (u"hell", None))
+        rtn = IS_MATCH("hell", is_unicode=True)("hell")
+        self.assertEqual(rtn, ("hell", None))
+        rtn = IS_MATCH("hell", is_unicode=True)("hell")
+        self.assertEqual(rtn, ("hell", None))
         # regr test for #1044
-        rtn = IS_MATCH("hello")(u"\xff")
-        self.assertEqual(rtn, (u"\xff", "Invalid expression"))
+        rtn = IS_MATCH("hello")("\xff")
+        self.assertEqual(rtn, ("\xff", "Invalid expression"))
 
     def test_IS_EQUAL_TO(self):
         rtn = IS_EQUAL_TO("aaa")("aaa")
         self.assertEqual(rtn, ("aaa", None))
         rtn = IS_EQUAL_TO("aaa")("aab")
         self.assertEqual(rtn, ("aab", "No match"))
 
@@ -103,32 +103,32 @@
         rtn = IS_LENGTH(minsize=1)([])
         self.assertEqual(rtn, ([], "Enter from 1 to 255 characters"))
         rtn = IS_LENGTH(minsize=1)([1, 2])
         self.assertEqual(rtn, ([1, 2], None))
         rtn = IS_LENGTH(minsize=1)([1])
         self.assertEqual(rtn, ([1], None))
         # test non utf-8 str
-        cpstr = u"ll".encode("cp1252")
+        cpstr = "ll".encode("cp1252")
         rtn = IS_LENGTH(minsize=4)(cpstr)
         self.assertEqual(rtn, (cpstr, None))
         rtn = IS_LENGTH(maxsize=4)(cpstr)
         self.assertEqual(rtn, (cpstr, None))
         rtn = IS_LENGTH(minsize=0, maxsize=3)(cpstr)
         self.assertEqual(rtn, (cpstr, "Enter from 0 to 3 characters"))
         # test unicode
-        rtn = IS_LENGTH(2)(u"2")
+        rtn = IS_LENGTH(2)("2")
         if PY2:
             self.assertEqual(rtn, ("\xc2\xb02", None))
         else:
-            self.assertEqual(rtn, (u"2", None))
-        rtn = IS_LENGTH(2)(u"12")
+            self.assertEqual(rtn, ("2", None))
+        rtn = IS_LENGTH(2)("12")
         if PY2:
-            self.assertEqual(rtn, (u"\xb012", "Enter from 0 to 2 characters"))
+            self.assertEqual(rtn, ("\xb012", "Enter from 0 to 2 characters"))
         else:
-            self.assertEqual(rtn, (u"12", "Enter from 0 to 2 characters"))
+            self.assertEqual(rtn, ("12", "Enter from 0 to 2 characters"))
         # test automatic str()
         rtn = IS_LENGTH(minsize=1)(1)
         self.assertEqual(rtn, ("1", None))
         rtn = IS_LENGTH(minsize=2)(1)
         self.assertEqual(rtn, (1, "Enter from 2 to 255 characters"))
         # test FieldStorage
         import cgi
@@ -154,15 +154,15 @@
         rtn = IS_LENGTH(minsize=6)(a)
         self.assertEqual(rtn, (a, "Enter from 6 to 255 characters"))
         rtn = IS_LENGTH(6)(a)
         self.assertEqual(rtn, (a, None))
 
     def test_IS_JSON(self):
         rtn = IS_JSON()('{"a": 100}')
-        self.assertEqual(rtn, ({u"a": 100}, None))
+        self.assertEqual(rtn, ({"a": 100}, None))
         rtn = IS_JSON()("spam1234")
         self.assertEqual(rtn, ("spam1234", "Invalid json"))
         rtn = IS_JSON(native_json=True)('{"a": 100}')
         self.assertEqual(rtn, ('{"a": 100}', None))
         rtn = IS_JSON().formatter(None)
         self.assertEqual(rtn, None)
         rtn = IS_JSON().formatter({"a": 100})
@@ -408,17 +408,17 @@
             db, "person.name", error_message="oops", allowed_override=["george"]
         )("george")
         self.assertEqual(rtn, ("george", None))
         rtn = IS_NOT_IN_DB(db, "person.name", error_message="oops")("  ")
         self.assertEqual(rtn, ("  ", "oops"))
         rtn = IS_NOT_IN_DB(db, "person.name")("jerry")
         self.assertEqual(rtn, ("jerry", None))
-        rtn = IS_NOT_IN_DB(db, "person.name")(u"jerry")
+        rtn = IS_NOT_IN_DB(db, "person.name")("jerry")
         self.assertEqual(rtn, ("jerry", None))
-        rtn = IS_NOT_IN_DB(db(db.person.id > 0), "person.name")(u"jerry")
+        rtn = IS_NOT_IN_DB(db(db.person.id > 0), "person.name")("jerry")
         self.assertEqual(rtn, ("jerry", None))
         rtn = IS_NOT_IN_DB(db, db.person, error_message="oops")(1)
         self.assertEqual(rtn, (1, "oops"))
         vldtr = IS_NOT_IN_DB(db, "person.name", error_message="oops")
         vldtr.set_self_id({"name": "costanza", "nickname": "T Bone"})
         rtn = vldtr("george")
         self.assertEqual(rtn, ("george", "oops"))
@@ -954,22 +954,22 @@
         self.assertEqual(rtn, (datetime.date(1982, 12, 14), None))
         rtn = ANY_OF([IS_DATE(format="%m/%d/%Y"), IS_EMAIL()]).formatter(
             datetime.date(1834, 12, 14)
         )
         self.assertEqual(rtn, "12/14/1834")
 
     class CustomValidator(Validator):
-        """ Custom Validator not overloading .validate() """
+        """Custom Validator not overloading .validate()"""
 
         def __call__(self, value):
             return (value, None) if value else (value, "invalid!")
 
     @staticmethod
     def custom_validator_func(value):
-        """ Validation function instead of Validator subclass """
+        """Validation function instead of Validator subclass"""
         return (value, None) if value else (value, "invalid!")
 
     def test_IS_EMPTY_OR(self):
         rtn = IS_EMPTY_OR(IS_EMAIL())("abc@def.com")
         self.assertEqual(rtn, ("abc@def.com", None))
         rtn = IS_EMPTY_OR(IS_EMAIL())("   ")
         self.assertEqual(rtn, (None, None))
@@ -1124,16 +1124,16 @@
         )
         rtn = IS_STRONG(upper=False, number=False, special=False, es=True)("Abcde1!")
         self.assertEqual(rtn, ("Abcde1!", "Minimum length is 8"))
 
     def test_IS_IMAGE(self):
         class DummyImageFile(object):
             def __init__(self, filename, ext, width, height):
-                from io import BytesIO
                 import struct
+                from io import BytesIO
 
                 self.filename = filename + "." + ext
                 self.file = BytesIO()
                 if ext == "bmp":
                     self.file.write(b"BM")
                     self.file.write(b" " * 16)
                     self.file.write(struct.pack("<LL", width, height))
```

